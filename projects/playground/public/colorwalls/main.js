!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=65)}([function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return s}));const r="position",i="normal",a="uv",o="source",u="coords",s={FLOAT:5126,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FLOAT_MAT2X3:35685,FLOAT_MAT2X4:35686,FLOAT_MAT3X2:35687,FLOAT_MAT3X4:35688,FLOAT_MAT4X2:35689,FLOAT_MAT4X3:35690,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT:5125,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_3D:32879,TEXTURE_2D_ARRAY:35866,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042},c=6403,f=33319,d=6407,l=6408,h=6402,b=33321,p=33323,_=32849,g=32856,m=33325,v=33327,E=34843,y=34842,T=33332,M=33338,O=36215,A=36214,S=33334,R=33340,F=36209,j=36208,w=33189,N=33190,I=36012;s.UNSIGNED_BYTE,s.UNSIGNED_SHORT,s.UNSIGNED_INT,s.FLOAT},function(t,e,n){"use strict";n.d(e,"i",(function(){return tt})),n.d(e,"f",(function(){return nt})),n.d(e,"j",(function(){return it})),n.d(e,"k",(function(){return ot})),n.d(e,"h",(function(){return st})),n.d(e,"g",(function(){return ft})),n.d(e,"e",(function(){return lt})),n.d(e,"d",(function(){return bt})),n.d(e,"m",(function(){return pt})),n.d(e,"l",(function(){return _t})),n.d(e,"a",(function(){return mt})),n.d(e,"c",(function(){return vt})),n.d(e,"b",(function(){return Et}));var r=n(8);function i(t){function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}var a=n(4);var o=n(0);const u="CLAMP_TO_EDGE",s="LINEAR",c="NEAREST";const f={renderQuad:{attribs:{[o.b]:{buffer:new Float32Array([-1,1,-1,-1,1,1,1,-1]),storeType:"STATIC"},[o.c]:{buffer:new Float32Array([0,1,0,0,1,1,1,0]),storeType:"STATIC"}},drawType:"TRIANGLE_STRIP",itemCount:4}},d={basicEffect:{vert:`\nattribute vec2 ${o.b};\nattribute vec2 ${o.c};\nvarying vec2 ${o.f};\nvoid main() {\n\t${o.f} = ${o.c};\n\tgl_Position = vec4(${o.b}, 0.0, 1.0);\n}`,frag:`precision mediump float;\nuniform sampler2D ${o.e};\nvarying vec2 ${o.f};\nvoid main() {\n\tgl_FragColor = texture2D(${o.e}, ${o.f});\n}`}};function l(t){return E[t].bindPoint}function h(t,e){return n=>{t.uniform1i(e,n)}}function b(t,e){return n=>{t.uniform1iv(e,n)}}function p(t,e){return n=>{t.uniform2iv(e,n)}}function _(t,e){return n=>{t.uniform3iv(e,n)}}function g(t,e){return n=>{t.uniform4iv(e,n)}}function m(t,e,n,r){const i=l(e);return e=>{t.uniform1i(r,n),t.activeTexture(t.TEXTURE0+n),t.bindTexture(i,e._texture)}}function v(t,e,n,r,i){const a=l(e),o=new Int32Array(i);for(let t=0;t<i;++t)o[t]=n+t;return e=>{t.uniform1iv(r,o);for(const n in e)t.activeTexture(t.TEXTURE0+o[n]),t.bindTexture(a,e[n]._texture)}}const E={[o.d.FLOAT]:{Type:Float32Array,size:4,setter:function(t,e){return n=>{t.uniform1f(e,n)}},arraySetter:function(t,e){return n=>{t.uniform1fv(e,n)}}},[o.d.FLOAT_VEC2]:{Type:Float32Array,size:8,setter:function(t,e){return n=>{t.uniform2fv(e,n)}}},[o.d.FLOAT_VEC3]:{Type:Float32Array,size:12,setter:function(t,e){return n=>{t.uniform3fv(e,n)}}},[o.d.FLOAT_VEC4]:{Type:Float32Array,size:16,setter:function(t,e){return n=>{t.uniform4fv(e,n)}}},[o.d.INT]:{Type:Int32Array,size:4,setter:h,arraySetter:b},[o.d.INT_VEC2]:{Type:Int32Array,size:8,setter:p},[o.d.INT_VEC3]:{Type:Int32Array,size:12,setter:_},[o.d.INT_VEC4]:{Type:Int32Array,size:16,setter:g},[o.d.UNSIGNED_INT]:{Type:Uint32Array,size:4,setter:function(t,e){return n=>{t.uniform1ui(e,n)}},arraySetter:function(t,e){return n=>{t.uniform1uiv(e,n)}}},[o.d.UNSIGNED_INT_VEC2]:{Type:Uint32Array,size:8,setter:function(t,e){return n=>{t.uniform2uiv(e,n)}}},[o.d.UNSIGNED_INT_VEC3]:{Type:Uint32Array,size:12,setter:function(t,e){return n=>{t.uniform3uiv(e,n)}}},[o.d.UNSIGNED_INT_VEC4]:{Type:Uint32Array,size:16,setter:function(t,e){return n=>{t.uniform4uiv(e,n)}}},[o.d.BOOL]:{Type:Uint32Array,size:4,setter:h,arraySetter:b},[o.d.BOOL_VEC2]:{Type:Uint32Array,size:8,setter:p},[o.d.BOOL_VEC3]:{Type:Uint32Array,size:12,setter:_},[o.d.BOOL_VEC4]:{Type:Uint32Array,size:16,setter:g},[o.d.FLOAT_MAT2]:{Type:Float32Array,size:16,setter:function(t,e){return n=>{t.uniformMatrix2fv(e,!1,n)}}},[o.d.FLOAT_MAT3]:{Type:Float32Array,size:36,setter:function(t,e){return n=>{t.uniformMatrix3fv(e,!1,n)}}},[o.d.FLOAT_MAT4]:{Type:Float32Array,size:64,setter:function(t,e){return n=>{t.uniformMatrix4fv(e,!1,n)}}},[o.d.FLOAT_MAT2X3]:{Type:Float32Array,size:24,setter:function(t,e){return n=>{t.uniformMatrix2x3fv(e,!1,n)}}},[o.d.FLOAT_MAT2X4]:{Type:Float32Array,size:32,setter:function(t,e){return n=>{t.uniformMatrix2x4fv(e,!1,n)}}},[o.d.FLOAT_MAT3X2]:{Type:Float32Array,size:24,setter:function(t,e){return n=>{t.uniformMatrix3x2fv(e,!1,n)}}},[o.d.FLOAT_MAT3X4]:{Type:Float32Array,size:48,setter:function(t,e){return n=>{t.uniformMatrix3x4fv(e,!1,n)}}},[o.d.FLOAT_MAT4X2]:{Type:Float32Array,size:32,setter:function(t,e){return n=>{t.uniformMatrix4x2fv(e,!1,n)}}},[o.d.FLOAT_MAT4X3]:{Type:Float32Array,size:48,setter:function(t,e){return n=>{t.uniformMatrix4x3fv(e,!1,n)}}},[o.d.SAMPLER_2D]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D},[o.d.SAMPLER_CUBE]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.SAMPLER_3D]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_3D},[o.d.SAMPLER_2D_SHADOW]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D},[o.d.SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.SAMPLER_2D_ARRAY_SHADOW]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.SAMPLER_CUBE_SHADOW]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.INT_SAMPLER_2D]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D},[o.d.INT_SAMPLER_3D]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_3D},[o.d.INT_SAMPLER_CUBE]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.INT_SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.UNSIGNED_INT_SAMPLER_2D]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D},[o.d.UNSIGNED_INT_SAMPLER_3D]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_3D},[o.d.UNSIGNED_INT_SAMPLER_CUBE]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.UNSIGNED_INT_SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:m,arraySetter:v,bindPoint:o.d.TEXTURE_2D_ARRAY}};function y(t,e,n){return r=>{t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n.itemSize,o.d.FLOAT,r.normalize||!1,r.stride||0,r.offset||0)}}function T(t,e,n){return r=>{t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.itemSize,o.d.INT,r.stride||0,r.offset||0)}}function M(t,e,n){const r=n.size,i=n.count;return n=>{t.bindBuffer(t.ARRAY_BUFFER,n.buffer);const a=r,u=a/i,s=E[o.d.FLOAT].size*a,c=n.normalize||!1,f=n.offset||0,d=s/i;for(let n=0;n<i;++n)t.enableVertexAttribArray(e+n),t.vertexAttribPointer(e+n,u,o.d.FLOAT,c,s,f+d*n)}}const O={[o.d.FLOAT]:{size:4,setter:y,itemSize:1},[o.d.FLOAT_VEC2]:{size:8,setter:y,itemSize:2},[o.d.FLOAT_VEC3]:{size:12,setter:y,itemSize:3},[o.d.FLOAT_VEC4]:{size:16,setter:y,itemSize:4},[o.d.INT]:{size:4,setter:T,itemSize:1},[o.d.INT_VEC2]:{size:8,setter:T,itemSize:2},[o.d.INT_VEC3]:{size:12,setter:T,itemSize:3},[o.d.INT_VEC4]:{size:16,setter:T,itemSize:4},[o.d.UNSIGNED_INT]:{size:4,setter:T,itemSize:1},[o.d.UNSIGNED_INT_VEC2]:{size:8,setter:T,itemSize:2},[o.d.UNSIGNED_INT_VEC3]:{size:12,setter:T,itemSize:3},[o.d.UNSIGNED_INT_VEC4]:{size:16,setter:T,itemSize:4},[o.d.BOOL]:{size:4,setter:T,itemSize:1},[o.d.BOOL_VEC2]:{size:8,setter:T,itemSize:2},[o.d.BOOL_VEC3]:{size:12,setter:T,itemSize:3},[o.d.BOOL_VEC4]:{size:16,setter:T,itemSize:4},[o.d.FLOAT_MAT2]:{size:4,setter:M,count:2},[o.d.FLOAT_MAT3]:{size:9,setter:M,count:3},[o.d.FLOAT_MAT4]:{size:16,setter:M,count:4}};o.d.BYTE,Int8Array,o.d.UNSIGNED_BYTE,Uint8Array,o.d.SHORT,Int16Array,o.d.UNSIGNED_SHORT,Uint16Array,o.d.INT,Int32Array,o.d.UNSIGNED_INT,Uint32Array,o.d.FLOAT,Float32Array,o.d.UNSIGNED_SHORT_4_4_4_4,Uint16Array,o.d.UNSIGNED_SHORT_5_5_5_1,Uint16Array,o.d.UNSIGNED_SHORT_5_6_5,Uint16Array,o.d.HALF_FLOAT,Uint16Array,o.d.UNSIGNED_INT_2_10_10_10_REV,Uint32Array,o.d.UNSIGNED_INT_10F_11F_11F_REV,Uint32Array,o.d.UNSIGNED_INT_5_9_9_9_REV,Uint32Array,o.d.FLOAT_32_UNSIGNED_INT_24_8_REV,Uint32Array,o.d.UNSIGNED_INT_24_8,Uint32Array;function A(t,e){if(e.enable)for(const n of e.enable)t.enable(n);if(e.disable)for(const n of e.disable)t.disable(n);e.blendFunc&&t.blendFunc.apply(t,e.blendFunc),null!=e.depthFunc&&t.depthFunc(e.depthFunc),null!=e.cullFace&&t.cullFace(e.cullFace),null!=e.frontFace&&t.frontFace(e.frontFace),null!=e.lineWidth&&t.lineWidth(e.lineWidth),e.colorMask&&t.colorMask.apply(t,e.colorMask),null!=e.depthMask&&t.depthMask(e.depthMask),e.clearColor&&t.clearColor.apply(t,e.clearColor),null!=e.clearDepth&&t.clearDepth(e.clearDepth),null!=e.clearBits&&t.clear(e.clearBits)}function S(t,e){if(e.enable)for(const n of e.enable)t.disable(n);if(e.disable)for(const n of e.disable)t.enable(n)}let R=1;class F{constructor(t,e="Form"+R++){this._painter=t,this.id=e}update(t){const e=this._painter.gl;t.drawType&&(this._drawType=e[t.drawType]),t.itemCount&&(this._itemCount=t.itemCount),this._attribs=this._attribs||{};for(const n in t.attribs){const r=t.attribs[n];null==this._attribs[n]&&(this._attribs[n]={buffer:e.createBuffer()}),e.bindBuffer(e.ARRAY_BUFFER,this._attribs[n].buffer),e.bufferData(e.ARRAY_BUFFER,r.buffer,e[(r.storeType||"STATIC")+"_DRAW"])}if(t.elements){const n=t.elements.buffer;null==this._elements&&(this._elements={buffer:e.createBuffer(),glType:null}),this._elements.glType=function(t){if(t instanceof Int8Array)return o.d.BYTE;if(t instanceof Uint8Array)return o.d.UNSIGNED_BYTE;if(t instanceof Uint8ClampedArray)return o.d.UNSIGNED_BYTE;if(t instanceof Int16Array)return o.d.SHORT;if(t instanceof Uint16Array)return o.d.UNSIGNED_SHORT;if(t instanceof Int32Array)return o.d.INT;if(t instanceof Uint32Array)return o.d.UNSIGNED_INT;if(t instanceof Float32Array)return o.d.FLOAT;throw new Error("unsupported typed array type")}(n),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._elements.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e[(t.elements.storeType||"STATIC")+"_DRAW"])}return this}destroy(){const t=this._painter.gl;for(const e in this._attribs)t.deleteBuffer(this._attribs[e].buffer);this._attribs={},this._elements&&(t.deleteBuffer(this._elements.buffer),this._elements=void 0)}}var j=n(3),w=n(11);let N=1;class I{constructor(t,e="Texture"+N++){this._painter=t,this.id=e,this._texture=null,this._data={}}update(t){const e=this._painter.gl;if(null==this._texture&&(this._texture=e.createTexture()),e.bindTexture(e.TEXTURE_2D,this._texture),t.wrap&&t.wrap!==this._data.wrap||t.wrapS&&t.wrapS!==this._data.wrapS||t.wrapT&&t.wrapT!==this._data.wrapT){let n,r;t.wrap?n=r=t.wrap:(r=t.wrapT||u,n=t.wrapS||u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[n]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[r])}else this._data.wrap||this._data.wrapS||this._data.wrapT||(this._data.wrap=this._data.wrapT=this._data.wrapS=u,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[this._data.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[this._data.wrap]));return t.magFilter&&t.magFilter!==this._data.magFilter?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[t.magFilter]):this._data.magFilter||(this._data.magFilter=c,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[this._data.magFilter])),t.minFilter&&t.minFilter!==this._data.minFilter?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[t.minFilter]):this._data.minFilter||(this._data.minFilter=s,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[this._data.minFilter])),t.asset&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.asset),void 0!==t.data&&e.texImage2D(e.TEXTURE_2D,0,"FLOAT"===t.type&&this._painter.isWebGL2?e.RGBA32F:e.RGBA,t.width,t.height,0,e.RGBA,e[t.type||"UNSIGNED_BYTE"],t.data),null!=t.flipY&&t.flipY!==this._data.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),t.minFilter&&t.minFilter.indexOf("MIPMAP")>0&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),Object.assign(this._data,t),this}destroy(){this._painter.gl.deleteTexture(this._texture),this._data={},this._texture=null}}let D=1;class U{constructor(t,e="Form"+D++){this._painter=t,this.id=e,this.width=0,this.height=0,this.antialias=!1,this.frameBuffer=null,this.antiAliasFrameBuffer=null,this.antiAliasRenderBuffer=null,this.textures=[],this.depthBuffer=null,this.bufferStructure=[],this._data={}}update(t){var e;const n=this._painter.gl,r=t.width||this.width,i=t.height||this.height;if(!r||!i)return this;if(r===this.width&&i===this.height){if(!t.bufferStructure)return this;if(t.bufferStructure.length===this.bufferStructure.length&&this.bufferStructure.every((e,n)=>Object(w.b)(e,t.bufferStructure[n])))return this}null==this.frameBuffer&&(this.frameBuffer=n.createFramebuffer()),null==this.depthBuffer&&(this.depthBuffer=n.createRenderbuffer()),t.bufferStructure&&t.bufferStructure.length&&(this.bufferStructure=t.bufferStructure,this.bufferStructure.some(t=>"FLOAT"===t.type)&&(this._painter.isWebGL2?n.getExtension("EXT_color_buffer_float"):n.getExtension("OES_texture_float")));const a=this.bufferStructure.length||1,o=[n.COLOR_ATTACHMENT0];if(n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer),a>1){let t;this._painter.isWebGL2||(t=n.getExtension("WEBGL_draw_buffers"));const e=this._painter.isWebGL2?n.COLOR_ATTACHMENT0:t.COLOR_ATTACHMENT0_WEBGL;for(let t=0;t<a;t++)o[t]=e+t;this._painter.isWebGL2?n.drawBuffers(o):t.drawBuffersWEBGL(o)}if(this.antialias=1===a&&this._painter.isWebGL2&&(t.antialias||(null===(e=this._data)||void 0===e?void 0:e.antialias)),this.antialias){const t=n;null==this.antiAliasFrameBuffer&&(this.antiAliasFrameBuffer=n.createFramebuffer()),null==this.antiAliasRenderBuffer&&(this.antiAliasRenderBuffer=n.createRenderbuffer()),n.bindFramebuffer(n.FRAMEBUFFER,this.antiAliasFrameBuffer),n.bindRenderbuffer(n.RENDERBUFFER,this.antiAliasRenderBuffer),t.renderbufferStorageMultisample(n.RENDERBUFFER,Math.min(4,n.getParameter(t.MAX_SAMPLES)),t.RGBA8,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,this.antiAliasRenderBuffer),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),t.renderbufferStorageMultisample(n.RENDERBUFFER,Math.min(4,n.getParameter(t.MAX_SAMPLES)),n.DEPTH_COMPONENT16,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer),n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer)}else n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer);for(let t=0;t<a;t++){this.textures[t]||(this.textures[t]=new I(this._painter,this.id+"_Texture"+t));const e=this.textures[t];e.update(Object.assign(Object.assign({minFilter:"NEAREST",magFilter:"NEAREST"},this.bufferStructure[t]),{data:null,width:r,height:i})),n.framebufferTexture2D(n.FRAMEBUFFER,o[t],n.TEXTURE_2D,e._texture,0)}if(this.antialias){n.bindFramebuffer(n.FRAMEBUFFER,this.antiAliasFrameBuffer);const e=n.checkFramebufferStatus(n.FRAMEBUFFER);e!==n.FRAMEBUFFER_COMPLETE&&console.error("antialias framebuffer error",e,t),n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer)}const u=n.checkFramebufferStatus(n.FRAMEBUFFER);return u!==n.FRAMEBUFFER_COMPLETE&&console.error("framebuffer error",u,t),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),Object.assign(this._data,t),this.width=r,this.height=i,this}destroy(){const t=this._painter.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteRenderbuffer(this.depthBuffer);for(const e of this.textures)t.deleteTexture(e);this.antiAliasFrameBuffer&&t.deleteFramebuffer(this.antiAliasFrameBuffer),this.antiAliasRenderBuffer&&t.deleteRenderbuffer(this.antiAliasRenderBuffer),this.textures=[],this.frameBuffer=null,this.depthBuffer=null,this._data={},this.bufferStructure=[],this.width=0,this.height=0}}let L=1;class P{constructor(t,e="Frame"+L++){this._painter=t,this.id=e,this.width=0,this.height=0,this.layers=[],this._data={},this._targets=[],this._textures=[]}image(t=0){return this._targets.length&&this._targets[this._targets.length-1].textures[t]||this._textures[t]}update(t={}){var e,n,r,i;const a=this._painter.gl,o=Array.isArray(t.layers)?t.layers:t.layers?[t.layers]:this.layers,u=t.selfReferencing||this._data.selfReferencing,s=o.reduce((t,e)=>t+(e._uniforms.length||1),0),c=u||s>1?2:s,f=t.width||(null===(e=t.texture)||void 0===e?void 0:e.width)||this._data.width||(null===(n=this._data.texture)||void 0===n?void 0:n.width)||a.drawingBufferWidth,d=t.height||(null===(r=t.texture)||void 0===r?void 0:r.height)||this._data.height||(null===(i=this._data.texture)||void 0===i?void 0:i.height)||a.drawingBufferHeight,l=t.antialias||this._data.antialias||!0;c!==this._targets.length&&this._destroyTargets();const h=Object.assign(Object.assign({},t),{width:f,height:d,antialias:l});return!this._targets.length&&c>0?this._targets=Object(j.h)(t=>new U(this._painter,this.id+"_target"+(t+1)).update(h),c):this._targets.length&&this._targets.forEach(t=>{t.update(h)}),t.texture&&(this._textures[0]||(this._textures[0]=new I(this._painter,this.id+"_Texture0")),t.texture.width=f,t.texture.height=d,this._textures[0].update(t.texture)),Object.assign(this._data,t),this.layers=o,this.width=f,this.height=d,this}destroy(){this._destroyTargets(),this._textures.forEach(t=>t.destroy()),this._textures=[],this._data={},this.layers=[],this.width=0,this.height=0}_destroyTargets(){this._targets.forEach(t=>t.destroy()),this._targets=[]}_swapTargets(){if(this._targets.length>1){const t=this._targets[0];this._targets[0]=this._targets[1],this._targets[1]=t}}}let x=1;class B{constructor(t="DrawingLayer"+x++){this.id=t,this.sketches=[],this._data={},this._uniforms=[]}update(t){if(t.sketches&&(this.sketches=Array.isArray(t.sketches)?t.sketches:[t.sketches]),t.frag){const e=this.sketches&&this.sketches[0];e&&e.shade.update({frag:t.frag})}return t.uniforms&&(this._uniforms=Array.isArray(t.uniforms)?t.uniforms:[t.uniforms]),Object.assign(this._data,t),this}destroy(){for(const t of this.sketches)t.destroy();this._data.sketches=[],this._data={},this._uniforms=[]}}let C=1;class z{constructor(t,e="Shade"+C++){this._painter=t,this.id=e}update(t){const e=this._painter.gl,n=t.frag&&t.frag.trim()||this.fragSource,r=t.vert&&t.vert.trim()||this.vertSource;if(!n||!r||n===this.fragSource&&r===this.vertSource)return this;this.destroy(),n.indexOf("GL_EXT_draw_buffers")>=0&&e.getExtension("WEBGL_draw_buffers");const i=e.createProgram(),a=e.createShader(e.FRAGMENT_SHADER),o=e.createShader(e.VERTEX_SHADER);if(i&&o&&a){if(this._program=i,this._frag=a,this._vert=o,e.attachShader(i,o),e.attachShader(i,a),e.shaderSource(o,r),e.shaderSource(a,n),e.compileShader(o),e.compileShader(a),e.getShaderParameter(o,e.COMPILE_STATUS)||console.error("Error Compiling Vertex Shader!\n",e.getShaderInfoLog(o),G(r)),e.getShaderParameter(a,e.COMPILE_STATUS)||console.error("Error Compiling Fragment Shader!\n",e.getShaderInfoLog(a),G(n)),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);console.error("Error in program linking:",t)}return this._uniformSetters=function(t,e){let n=0;function r(e,r){const i=t.getUniformLocation(e,r.name),a=r.size>1&&"[0]"===r.name.substr(-3),o=r.type,u=E[o];if(!u)throw new Error("unknown type: 0x"+o.toString(16));if(null==i)return;let s;if(null===u.Type){const e=n;n+=r.size,s=a?u.arraySetter(t,o,e,i,r.size):u.setter(t,o,e,i)}else s=u.arraySetter&&a?u.arraySetter(t,i):u.setter(t,i);return{setter:s,location:i}}const i={},a=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<a;++n){const a=t.getActiveUniform(e,n);if(!a)continue;let o=a.name;if("[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3)),e){const t=r(e,a);t&&(i[o]=t)}}return i}(e,i),this._attributeSetters=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i);if(!r)break;const a=t.getAttribLocation(e,r.name),o=O[r.type],u=o.setter(t,a,o);n[r.name]={setter:u,location:a}}return n}(e,i),this.fragSource=n,this.vertSource=r,this}}destroy(){const t=this._painter.gl;t.deleteProgram(this._program),t.deleteShader(this._frag),t.deleteShader(this._vert),this.vertSource=void 0,this.fragSource=void 0,this._attributeSetters={},this._uniformSetters={}}}function G(t){return t.trim().split("\n").map((t,e)=>e+1+": "+t).join("\n")}let k=1;class X{constructor(t="Sketch"+k++){this.id=t,this._uniforms=[]}update(t){return t.drawSettings&&(this._drawSettings=t.drawSettings),t.form&&(this.form=t.form),t.shade&&(this.shade=t.shade),t.uniforms&&(this._uniforms=Array.isArray(t.uniforms)?t.uniforms:[t.uniforms]),this}destroy(){this.form&&this.form.destroy(),this.shade&&this.shade.destroy(),this._drawSettings=void 0,this._uniforms=[]}}var V=n(13);class ${constructor(t,e={}){this.canvas=t,this.isWebGL2=!0,this.maxBufferSamples=0;let n=null;if(e.useWebGL1||(n=t.getContext("webgl2",e)||t.getContext("experimental-webgl2",e)),null==n&&(this.isWebGL2=!1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)),null==n)throw Error("Cannot initialize WebGL.");this.gl=n,this.sizeMultiplier=e.sizeMultiplier||1,this.isWebGL2&&(this.maxBufferSamples=n.getParameter(n.MAX_SAMPLES)),this.resize(),A(n,function(t){return{clearColor:[0,0,0,1],blendFunc:[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA]}}(n)),this._renderQuad=this.createForm().update(f.renderQuad),this._staticSketch=this.createFlatSketch()}resize(){return Object(V.b)(this.gl.canvas,this.sizeMultiplier),this}destroy(){this._staticSketch.destroy(),this._renderQuad.destroy()}updateDrawSettings(t){return A(this.gl,Object.assign({},t)),this}createForm(t){return new F(this,t)}createShade(t){return new z(this,t)}createSketch(t){return new X(t)}createFlatSketch(t){const e=this.createSketch(t);return e.update({form:this._renderQuad,shade:this.createShade(e.id+"_defaultShade").update(d.basicEffect)})}createFrame(t){return new P(this,t)}createLayer(t){return new B(t)}createEffect(t){const e=this.createLayer(t);return e.update({sketches:this.createFlatSketch(e.id+"_effectSketch")})}draw(t,e){const n=this.gl;return n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),Y(n,t,e),this}compose(...t){for(const e of t)K(this.gl,e);return this}display(t,e=0){return this.draw(this._staticSketch,{source:t.image(e)})}}function Y(t,e,n,r){const{shade:i,form:a,_drawSettings:o,_uniforms:u}=e;if(!i||!a)throw Error("cannot draw, shader or geometry are not set");t.useProgram(i._program),function(t,e){for(const n in e._attribs){const r=t._attributeSetters[n];r&&r.setter(e._attribs[n])}}(i,a),n&&q(i,n,r),o&&A(t,o);for(let n=0;n<(u.length||1);n++)H(t,e,u[n],r);o&&S(t,o)}function H(t,e,n,r){n&&q(e.shade,n,r),e.form._elements&&null!=e.form._elements.glType?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.form._elements.buffer),t.drawElements(e.form._drawType,e.form._itemCount,e.form._elements.glType,0)):t.drawArrays(e.form._drawType,0,e.form._itemCount)}function q(t,e,n){for(const r in e){const i=t._uniformSetters[r];if(i){let t=e[r];"function"==typeof t&&(t=t()),"string"==typeof t&&n?i.setter(n[t]):i.setter(t)}}}function W(t,e,n,r,i){r?(t.bindFramebuffer(t.FRAMEBUFFER,r.antialias?r.antiAliasFrameBuffer:r.frameBuffer),t.viewport(0,0,r.width,r.height)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),e._data.drawSettings&&A(t,e._data.drawSettings);for(const r of e.sketches)Y(t,r,n,i);if(r&&r.antialias){const e=t;t.bindFramebuffer(e.READ_FRAMEBUFFER,r.antiAliasFrameBuffer),t.bindFramebuffer(e.DRAW_FRAMEBUFFER,r.frameBuffer),e.clearBufferfv(e.COLOR,0,[1,1,1,1]),e.blitFramebuffer(0,0,r.width,r.height,0,0,r.width,r.height,t.COLOR_BUFFER_BIT,t.LINEAR)}e._data.drawSettings&&S(t,e._data.drawSettings)}function K(t,e){for(let n=0;n<e.layers.length;n++){const r=e.layers[n],i=r._uniforms.length||1;for(let a=0;a<i;a++){const i=e._targets[0],o=n+a===0&&e._textures.length?e._textures:e._targets[1]&&e._targets[1].textures;W(t,r,r._uniforms[a],i,o),e._swapTargets()}}}var Q=n(9);let Z,J;function tt(t,e){return function(t,e){t!==Z&&(Z=t,J=new $(t,e),ht.device.canvas=t,yt&&yt(),Tt&&Tt(),Mt&&Mt(),yt=i(()=>Object(r.a)(()=>{J.sizeMultiplier=ht.device.sizeMultiplier,J.resize(),vt(Et.RESIZE)},"resize")),Tt=Object(Q.b)({element:t,enableRightButton:!0,holdRadius:7,holdDelay:250},t=>ht.device.pointer=t),Mt=Object(a.b)(t=>ht.device.keys=t))}(t,e),J}const et={};function nt(t,e){return et[e]||(et[e]=t.createForm("Form_"+e))}const rt={};function it(t,e){return rt[e]||(rt[e]=t.createShade("Shade_"+e))}const at={};function ot(t,e){return at[e]||(at[e]=t.createSketch("Sketch_"+e))}const ut={};function st(t,e){return ut[e]||(ut[e]=t.createLayer("Layer_"+e))}const ct={};function ft(t,e){return ct[e]||(ct[e]=t.createFrame("Frame_"+e))}const dt={};function lt(t,e){return dt[e]||(dt[e]=t.createEffect("Effect_"+e))}const ht={device:{tpf:0,sizeMultiplier:1}};function bt(t){return ht[t]}function pt(t,e,n){const r=ht;if(r[t]){const i=n&&n.reset;!0!==i&&(e=function t(e,n,r){const i=r&&r.ignore;if("object"==typeof e&&"object"==typeof n&&!Array.isArray(e)&&!Array.isArray(n)&&e!==n){for(const r in e)if(e.hasOwnProperty(r)&&(!i||!(r in i)||!0!==i[r])){const a=e[r],o=n[r];void 0!==o&&(e[r]=t(a,o,{ignore:i&&i[r]}))}return e}return n}(e,r[t],{ignore:i}))}r[t]=e}function _t(){return ht}window.state=ht;const gt={};function mt(t,e){gt[t]=e}function vt(t){for(const e in gt)gt[e](t,ht)}const Et={FRAME:"frame",RESIZE:"resize"};let yt,Tt,Mt},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i}));var r={};n.r(r),n.d(r,"create",(function(){return c})),n.d(r,"clone",(function(){return f})),n.d(r,"copy",(function(){return d})),n.d(r,"fromValues",(function(){return l})),n.d(r,"set",(function(){return h})),n.d(r,"identity",(function(){return b})),n.d(r,"transpose",(function(){return p})),n.d(r,"invert",(function(){return _})),n.d(r,"adjoint",(function(){return g})),n.d(r,"determinant",(function(){return m})),n.d(r,"multiply",(function(){return v})),n.d(r,"translate",(function(){return E})),n.d(r,"scale",(function(){return y})),n.d(r,"rotate",(function(){return T})),n.d(r,"rotateX",(function(){return M})),n.d(r,"rotateY",(function(){return O})),n.d(r,"rotateZ",(function(){return A})),n.d(r,"fromTranslation",(function(){return S})),n.d(r,"fromScaling",(function(){return R})),n.d(r,"fromRotation",(function(){return F})),n.d(r,"fromXRotation",(function(){return j})),n.d(r,"fromYRotation",(function(){return w})),n.d(r,"fromZRotation",(function(){return N})),n.d(r,"fromRotationTranslation",(function(){return I})),n.d(r,"fromQuat2",(function(){return D})),n.d(r,"getTranslation",(function(){return U})),n.d(r,"getScaling",(function(){return L})),n.d(r,"getRotation",(function(){return P})),n.d(r,"fromRotationTranslationScale",(function(){return x})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return B})),n.d(r,"fromQuat",(function(){return C})),n.d(r,"frustum",(function(){return z})),n.d(r,"perspective",(function(){return G})),n.d(r,"perspectiveFromFieldOfView",(function(){return k})),n.d(r,"ortho",(function(){return X})),n.d(r,"lookAt",(function(){return V})),n.d(r,"targetTo",(function(){return $})),n.d(r,"str",(function(){return Y})),n.d(r,"frob",(function(){return H})),n.d(r,"add",(function(){return q})),n.d(r,"subtract",(function(){return W})),n.d(r,"multiplyScalar",(function(){return K})),n.d(r,"multiplyScalarAndAdd",(function(){return Q})),n.d(r,"exactEquals",(function(){return Z})),n.d(r,"equals",(function(){return J})),n.d(r,"mul",(function(){return tt})),n.d(r,"sub",(function(){return et}));var i={};n.r(i),n.d(i,"create",(function(){return nt})),n.d(i,"clone",(function(){return rt})),n.d(i,"length",(function(){return it})),n.d(i,"fromValues",(function(){return at})),n.d(i,"copy",(function(){return ot})),n.d(i,"set",(function(){return ut})),n.d(i,"add",(function(){return st})),n.d(i,"subtract",(function(){return ct})),n.d(i,"multiply",(function(){return ft})),n.d(i,"divide",(function(){return dt})),n.d(i,"ceil",(function(){return lt})),n.d(i,"floor",(function(){return ht})),n.d(i,"min",(function(){return bt})),n.d(i,"max",(function(){return pt})),n.d(i,"round",(function(){return _t})),n.d(i,"scale",(function(){return gt})),n.d(i,"scaleAndAdd",(function(){return mt})),n.d(i,"distance",(function(){return vt})),n.d(i,"squaredDistance",(function(){return Et})),n.d(i,"squaredLength",(function(){return yt})),n.d(i,"negate",(function(){return Tt})),n.d(i,"inverse",(function(){return Mt})),n.d(i,"normalize",(function(){return Ot})),n.d(i,"dot",(function(){return At})),n.d(i,"cross",(function(){return St})),n.d(i,"lerp",(function(){return Rt})),n.d(i,"hermite",(function(){return Ft})),n.d(i,"bezier",(function(){return jt})),n.d(i,"random",(function(){return wt})),n.d(i,"transformMat4",(function(){return Nt})),n.d(i,"transformMat3",(function(){return It})),n.d(i,"transformQuat",(function(){return Dt})),n.d(i,"rotateX",(function(){return Ut})),n.d(i,"rotateY",(function(){return Lt})),n.d(i,"rotateZ",(function(){return Pt})),n.d(i,"angle",(function(){return xt})),n.d(i,"zero",(function(){return Bt})),n.d(i,"str",(function(){return Ct})),n.d(i,"exactEquals",(function(){return zt})),n.d(i,"equals",(function(){return Gt})),n.d(i,"sub",(function(){return Xt})),n.d(i,"mul",(function(){return Vt})),n.d(i,"div",(function(){return $t})),n.d(i,"dist",(function(){return Yt})),n.d(i,"sqrDist",(function(){return Ht})),n.d(i,"len",(function(){return qt})),n.d(i,"sqrLen",(function(){return Wt})),n.d(i,"forEach",(function(){return Kt}));var a={};n.r(a),n.d(a,"create",(function(){return Jt})),n.d(a,"identity",(function(){return te})),n.d(a,"setAxisAngle",(function(){return ee})),n.d(a,"getAxisAngle",(function(){return ne})),n.d(a,"getAngle",(function(){return re})),n.d(a,"multiply",(function(){return ie})),n.d(a,"rotateX",(function(){return ae})),n.d(a,"rotateY",(function(){return oe})),n.d(a,"rotateZ",(function(){return ue})),n.d(a,"calculateW",(function(){return se})),n.d(a,"exp",(function(){return ce})),n.d(a,"ln",(function(){return fe})),n.d(a,"pow",(function(){return de})),n.d(a,"slerp",(function(){return le})),n.d(a,"random",(function(){return he})),n.d(a,"invert",(function(){return be})),n.d(a,"conjugate",(function(){return pe})),n.d(a,"fromMat3",(function(){return _e})),n.d(a,"fromEuler",(function(){return ge})),n.d(a,"str",(function(){return me})),n.d(a,"clone",(function(){return Se})),n.d(a,"fromValues",(function(){return Re})),n.d(a,"copy",(function(){return Fe})),n.d(a,"set",(function(){return je})),n.d(a,"add",(function(){return we})),n.d(a,"mul",(function(){return Ne})),n.d(a,"scale",(function(){return Ie})),n.d(a,"dot",(function(){return De})),n.d(a,"lerp",(function(){return Ue})),n.d(a,"length",(function(){return Le})),n.d(a,"len",(function(){return Pe})),n.d(a,"squaredLength",(function(){return xe})),n.d(a,"sqrLen",(function(){return Be})),n.d(a,"normalize",(function(){return Ce})),n.d(a,"exactEquals",(function(){return ze})),n.d(a,"equals",(function(){return Ge})),n.d(a,"rotationTo",(function(){return ke})),n.d(a,"sqlerp",(function(){return Xe})),n.d(a,"setAxes",(function(){return Ve}));var o=1e-6,u="undefined"!=typeof Float32Array?Float32Array:Array,s=Math.random;Math.PI;function c(){var t=new u(16);return u!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function f(t){var e=new u(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function d(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,r,i,a,o,s,c,f,d,l,h,b,p,_){var g=new u(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=c,g[9]=f,g[10]=d,g[11]=l,g[12]=h,g[13]=b,g[14]=p,g[15]=_,g}function h(t,e,n,r,i,a,o,u,s,c,f,d,l,h,b,p,_){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=d,t[11]=l,t[12]=h,t[13]=b,t[14]=p,t[15]=_,t}function b(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function _(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],c=e[7],f=e[8],d=e[9],l=e[10],h=e[11],b=e[12],p=e[13],_=e[14],g=e[15],m=n*u-r*o,v=n*s-i*o,E=n*c-a*o,y=r*s-i*u,T=r*c-a*u,M=i*c-a*s,O=f*p-d*b,A=f*_-l*b,S=f*g-h*b,R=d*_-l*p,F=d*g-h*p,j=l*g-h*_,w=m*j-v*F+E*R+y*S-T*A+M*O;return w?(w=1/w,t[0]=(u*j-s*F+c*R)*w,t[1]=(i*F-r*j-a*R)*w,t[2]=(p*M-_*T+g*y)*w,t[3]=(l*T-d*M-h*y)*w,t[4]=(s*S-o*j-c*A)*w,t[5]=(n*j-i*S+a*A)*w,t[6]=(_*E-b*M-g*v)*w,t[7]=(f*M-l*E+h*v)*w,t[8]=(o*F-u*S+c*O)*w,t[9]=(r*S-n*F-a*O)*w,t[10]=(b*T-p*E+g*m)*w,t[11]=(d*E-f*T-h*m)*w,t[12]=(u*A-o*R-s*O)*w,t[13]=(n*R-r*A+i*O)*w,t[14]=(p*v-b*y-_*m)*w,t[15]=(f*y-d*v+l*m)*w,t):null}function g(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],c=e[7],f=e[8],d=e[9],l=e[10],h=e[11],b=e[12],p=e[13],_=e[14],g=e[15];return t[0]=u*(l*g-h*_)-d*(s*g-c*_)+p*(s*h-c*l),t[1]=-(r*(l*g-h*_)-d*(i*g-a*_)+p*(i*h-a*l)),t[2]=r*(s*g-c*_)-u*(i*g-a*_)+p*(i*c-a*s),t[3]=-(r*(s*h-c*l)-u*(i*h-a*l)+d*(i*c-a*s)),t[4]=-(o*(l*g-h*_)-f*(s*g-c*_)+b*(s*h-c*l)),t[5]=n*(l*g-h*_)-f*(i*g-a*_)+b*(i*h-a*l),t[6]=-(n*(s*g-c*_)-o*(i*g-a*_)+b*(i*c-a*s)),t[7]=n*(s*h-c*l)-o*(i*h-a*l)+f*(i*c-a*s),t[8]=o*(d*g-h*p)-f*(u*g-c*p)+b*(u*h-c*d),t[9]=-(n*(d*g-h*p)-f*(r*g-a*p)+b*(r*h-a*d)),t[10]=n*(u*g-c*p)-o*(r*g-a*p)+b*(r*c-a*u),t[11]=-(n*(u*h-c*d)-o*(r*h-a*d)+f*(r*c-a*u)),t[12]=-(o*(d*_-l*p)-f*(u*_-s*p)+b*(u*l-s*d)),t[13]=n*(d*_-l*p)-f*(r*_-i*p)+b*(r*l-i*d),t[14]=-(n*(u*_-s*p)-o*(r*_-i*p)+b*(r*s-i*u)),t[15]=n*(u*l-s*d)-o*(r*l-i*d)+f*(r*s-i*u),t}function m(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],c=t[8],f=t[9],d=t[10],l=t[11],h=t[12],b=t[13],p=t[14],_=t[15];return(e*o-n*a)*(d*_-l*p)-(e*u-r*a)*(f*_-l*b)+(e*s-i*a)*(f*p-d*b)+(n*u-r*o)*(c*_-l*h)-(n*s-i*o)*(c*p-d*h)+(r*s-i*u)*(c*b-f*h)}function v(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],c=e[6],f=e[7],d=e[8],l=e[9],h=e[10],b=e[11],p=e[12],_=e[13],g=e[14],m=e[15],v=n[0],E=n[1],y=n[2],T=n[3];return t[0]=v*r+E*u+y*d+T*p,t[1]=v*i+E*s+y*l+T*_,t[2]=v*a+E*c+y*h+T*g,t[3]=v*o+E*f+y*b+T*m,v=n[4],E=n[5],y=n[6],T=n[7],t[4]=v*r+E*u+y*d+T*p,t[5]=v*i+E*s+y*l+T*_,t[6]=v*a+E*c+y*h+T*g,t[7]=v*o+E*f+y*b+T*m,v=n[8],E=n[9],y=n[10],T=n[11],t[8]=v*r+E*u+y*d+T*p,t[9]=v*i+E*s+y*l+T*_,t[10]=v*a+E*c+y*h+T*g,t[11]=v*o+E*f+y*b+T*m,v=n[12],E=n[13],y=n[14],T=n[15],t[12]=v*r+E*u+y*d+T*p,t[13]=v*i+E*s+y*l+T*_,t[14]=v*a+E*c+y*h+T*g,t[15]=v*o+E*f+y*b+T*m,t}function E(t,e,n){var r,i,a,o,u,s,c,f,d,l,h,b,p=n[0],_=n[1],g=n[2];return e===t?(t[12]=e[0]*p+e[4]*_+e[8]*g+e[12],t[13]=e[1]*p+e[5]*_+e[9]*g+e[13],t[14]=e[2]*p+e[6]*_+e[10]*g+e[14],t[15]=e[3]*p+e[7]*_+e[11]*g+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],c=e[6],f=e[7],d=e[8],l=e[9],h=e[10],b=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=u,t[5]=s,t[6]=c,t[7]=f,t[8]=d,t[9]=l,t[10]=h,t[11]=b,t[12]=r*p+u*_+d*g+e[12],t[13]=i*p+s*_+l*g+e[13],t[14]=a*p+c*_+h*g+e[14],t[15]=o*p+f*_+b*g+e[15]),t}function y(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function T(t,e,n,r){var i,a,u,s,c,f,d,l,h,b,p,_,g,m,v,E,y,T,M,O,A,S,R,F,j=r[0],w=r[1],N=r[2],I=Math.hypot(j,w,N);return I<o?null:(j*=I=1/I,w*=I,N*=I,i=Math.sin(n),u=1-(a=Math.cos(n)),s=e[0],c=e[1],f=e[2],d=e[3],l=e[4],h=e[5],b=e[6],p=e[7],_=e[8],g=e[9],m=e[10],v=e[11],E=j*j*u+a,y=w*j*u+N*i,T=N*j*u-w*i,M=j*w*u-N*i,O=w*w*u+a,A=N*w*u+j*i,S=j*N*u+w*i,R=w*N*u-j*i,F=N*N*u+a,t[0]=s*E+l*y+_*T,t[1]=c*E+h*y+g*T,t[2]=f*E+b*y+m*T,t[3]=d*E+p*y+v*T,t[4]=s*M+l*O+_*A,t[5]=c*M+h*O+g*A,t[6]=f*M+b*O+m*A,t[7]=d*M+p*O+v*A,t[8]=s*S+l*R+_*F,t[9]=c*S+h*R+g*F,t[10]=f*S+b*R+m*F,t[11]=d*S+p*R+v*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function M(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],u=e[6],s=e[7],c=e[8],f=e[9],d=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+f*r,t[6]=u*i+d*r,t[7]=s*i+l*r,t[8]=c*i-a*r,t[9]=f*i-o*r,t[10]=d*i-u*r,t[11]=l*i-s*r,t}function O(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],u=e[2],s=e[3],c=e[8],f=e[9],d=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-f*r,t[2]=u*i-d*r,t[3]=s*i-l*r,t[8]=a*r+c*i,t[9]=o*r+f*i,t[10]=u*r+d*i,t[11]=s*r+l*i,t}function A(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],u=e[2],s=e[3],c=e[4],f=e[5],d=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+f*r,t[2]=u*i+d*r,t[3]=s*i+l*r,t[4]=c*i-a*r,t[5]=f*i-o*r,t[6]=d*i-u*r,t[7]=l*i-s*r,t}function S(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function R(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function F(t,e,n){var r,i,a,u=n[0],s=n[1],c=n[2],f=Math.hypot(u,s,c);return f<o?null:(u*=f=1/f,s*=f,c*=f,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=u*u*a+i,t[1]=s*u*a+c*r,t[2]=c*u*a-s*r,t[3]=0,t[4]=u*s*a-c*r,t[5]=s*s*a+i,t[6]=c*s*a+u*r,t[7]=0,t[8]=u*c*a+s*r,t[9]=s*c*a-u*r,t[10]=c*c*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function j(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],u=r+r,s=i+i,c=a+a,f=r*u,d=r*s,l=r*c,h=i*s,b=i*c,p=a*c,_=o*u,g=o*s,m=o*c;return t[0]=1-(h+p),t[1]=d+m,t[2]=l-g,t[3]=0,t[4]=d-m,t[5]=1-(f+p),t[6]=b+_,t[7]=0,t[8]=l+g,t[9]=b-_,t[10]=1-(f+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function D(t,e){var n=new u(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],c=e[5],f=e[6],d=e[7],l=r*r+i*i+a*a+o*o;return l>0?(n[0]=2*(s*o+d*r+c*a-f*i)/l,n[1]=2*(c*o+d*i+f*r-s*a)/l,n[2]=2*(f*o+d*a+s*i-c*r)/l):(n[0]=2*(s*o+d*r+c*a-f*i),n[1]=2*(c*o+d*i+f*r-s*a),n[2]=2*(f*o+d*a+s*i-c*r)),I(t,e,n),t}function U(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function L(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],u=e[6],s=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,u),t[2]=Math.hypot(s,c,f),t}function P(t,e){var n=new u(3);L(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,c=e[2]*a,f=e[4]*r,d=e[5]*i,l=e[6]*a,h=e[8]*r,b=e[9]*i,p=e[10]*a,_=o+d+p,g=0;return _>0?(g=2*Math.sqrt(_+1),t[3]=.25*g,t[0]=(l-b)/g,t[1]=(h-c)/g,t[2]=(s-f)/g):o>d&&o>p?(g=2*Math.sqrt(1+o-d-p),t[3]=(l-b)/g,t[0]=.25*g,t[1]=(s+f)/g,t[2]=(h+c)/g):d>p?(g=2*Math.sqrt(1+d-o-p),t[3]=(h-c)/g,t[0]=(s+f)/g,t[1]=.25*g,t[2]=(l+b)/g):(g=2*Math.sqrt(1+p-o-d),t[3]=(s-f)/g,t[0]=(h+c)/g,t[1]=(l+b)/g,t[2]=.25*g),t}function x(t,e,n,r){var i=e[0],a=e[1],o=e[2],u=e[3],s=i+i,c=a+a,f=o+o,d=i*s,l=i*c,h=i*f,b=a*c,p=a*f,_=o*f,g=u*s,m=u*c,v=u*f,E=r[0],y=r[1],T=r[2];return t[0]=(1-(b+_))*E,t[1]=(l+v)*E,t[2]=(h-m)*E,t[3]=0,t[4]=(l-v)*y,t[5]=(1-(d+_))*y,t[6]=(p+g)*y,t[7]=0,t[8]=(h+m)*T,t[9]=(p-g)*T,t[10]=(1-(d+b))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function B(t,e,n,r,i){var a=e[0],o=e[1],u=e[2],s=e[3],c=a+a,f=o+o,d=u+u,l=a*c,h=a*f,b=a*d,p=o*f,_=o*d,g=u*d,m=s*c,v=s*f,E=s*d,y=r[0],T=r[1],M=r[2],O=i[0],A=i[1],S=i[2],R=(1-(p+g))*y,F=(h+E)*y,j=(b-v)*y,w=(h-E)*T,N=(1-(l+g))*T,I=(_+m)*T,D=(b+v)*M,U=(_-m)*M,L=(1-(l+p))*M;return t[0]=R,t[1]=F,t[2]=j,t[3]=0,t[4]=w,t[5]=N,t[6]=I,t[7]=0,t[8]=D,t[9]=U,t[10]=L,t[11]=0,t[12]=n[0]+O-(R*O+w*A+D*S),t[13]=n[1]+A-(F*O+N*A+U*S),t[14]=n[2]+S-(j*O+I*A+L*S),t[15]=1,t}function C(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,u=r+r,s=i+i,c=n*o,f=r*o,d=r*u,l=i*o,h=i*u,b=i*s,p=a*o,_=a*u,g=a*s;return t[0]=1-d-b,t[1]=f+g,t[2]=l-_,t[3]=0,t[4]=f-g,t[5]=1-c-b,t[6]=h+p,t[7]=0,t[8]=l+_,t[9]=h-p,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function z(t,e,n,r,i,a,o){var u=1/(n-e),s=1/(i-r),c=1/(a-o);return t[0]=2*a*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*s,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function G(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function k(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(o+u),c=2/(i+a);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-u)*s*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function X(t,e,n,r,i,a,o){var u=1/(e-n),s=1/(r-i),c=1/(a-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=(o+a)*c,t[15]=1,t}function V(t,e,n,r){var i,a,u,s,c,f,d,l,h,p,_=e[0],g=e[1],m=e[2],v=r[0],E=r[1],y=r[2],T=n[0],M=n[1],O=n[2];return Math.abs(_-T)<o&&Math.abs(g-M)<o&&Math.abs(m-O)<o?b(t):(d=_-T,l=g-M,h=m-O,i=E*(h*=p=1/Math.hypot(d,l,h))-y*(l*=p),a=y*(d*=p)-v*h,u=v*l-E*d,(p=Math.hypot(i,a,u))?(i*=p=1/p,a*=p,u*=p):(i=0,a=0,u=0),s=l*u-h*a,c=h*i-d*u,f=d*a-l*i,(p=Math.hypot(s,c,f))?(s*=p=1/p,c*=p,f*=p):(s=0,c=0,f=0),t[0]=i,t[1]=s,t[2]=d,t[3]=0,t[4]=a,t[5]=c,t[6]=l,t[7]=0,t[8]=u,t[9]=f,t[10]=h,t[11]=0,t[12]=-(i*_+a*g+u*m),t[13]=-(s*_+c*g+f*m),t[14]=-(d*_+l*g+h*m),t[15]=1,t)}function $(t,e,n,r){var i=e[0],a=e[1],o=e[2],u=r[0],s=r[1],c=r[2],f=i-n[0],d=a-n[1],l=o-n[2],h=f*f+d*d+l*l;h>0&&(f*=h=1/Math.sqrt(h),d*=h,l*=h);var b=s*l-c*d,p=c*f-u*l,_=u*d-s*f;return(h=b*b+p*p+_*_)>0&&(b*=h=1/Math.sqrt(h),p*=h,_*=h),t[0]=b,t[1]=p,t[2]=_,t[3]=0,t[4]=d*_-l*p,t[5]=l*b-f*_,t[6]=f*p-d*b,t[7]=0,t[8]=f,t[9]=d,t[10]=l,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function Y(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function H(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function q(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function W(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function K(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Q(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Z(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function J(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],d=t[8],l=t[9],h=t[10],b=t[11],p=t[12],_=t[13],g=t[14],m=t[15],v=e[0],E=e[1],y=e[2],T=e[3],M=e[4],O=e[5],A=e[6],S=e[7],R=e[8],F=e[9],j=e[10],w=e[11],N=e[12],I=e[13],D=e[14],U=e[15];return Math.abs(n-v)<=o*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-E)<=o*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(i-y)<=o*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-T)<=o*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(u-M)<=o*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(s-O)<=o*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(c-A)<=o*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-S)<=o*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(d-R)<=o*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(l-F)<=o*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(h-j)<=o*Math.max(1,Math.abs(h),Math.abs(j))&&Math.abs(b-w)<=o*Math.max(1,Math.abs(b),Math.abs(w))&&Math.abs(p-N)<=o*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(_-I)<=o*Math.max(1,Math.abs(_),Math.abs(I))&&Math.abs(g-D)<=o*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(m-U)<=o*Math.max(1,Math.abs(m),Math.abs(U))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var tt=v,et=W;function nt(){var t=new u(3);return u!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function rt(t){var e=new u(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function it(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function at(t,e,n){var r=new u(3);return r[0]=t,r[1]=e,r[2]=n,r}function ot(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ut(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function st(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function ct(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ft(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function dt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function lt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function ht(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function bt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function pt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function _t(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function gt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function mt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function vt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Et(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function yt(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Tt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Mt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Ot(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function At(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function St(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],u=n[1],s=n[2];return t[0]=i*s-a*u,t[1]=a*o-r*s,t[2]=r*u-i*o,t}function Rt(t,e,n,r){var i=e[0],a=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t}function Ft(t,e,n,r,i,a){var o=a*a,u=o*(2*a-3)+1,s=o*(a-2)+a,c=o*(a-1),f=o*(3-2*a);return t[0]=e[0]*u+n[0]*s+r[0]*c+i[0]*f,t[1]=e[1]*u+n[1]*s+r[1]*c+i[1]*f,t[2]=e[2]*u+n[2]*s+r[2]*c+i[2]*f,t}function jt(t,e,n,r,i,a){var o=1-a,u=o*o,s=a*a,c=u*o,f=3*a*u,d=3*s*o,l=s*a;return t[0]=e[0]*c+n[0]*f+r[0]*d+i[0]*l,t[1]=e[1]*c+n[1]*f+r[1]*d+i[1]*l,t[2]=e[2]*c+n[2]*f+r[2]*d+i[2]*l,t}function wt(t,e){e=e||1;var n=2*s()*Math.PI,r=2*s()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Nt(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function It(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function Dt(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],u=e[0],s=e[1],c=e[2],f=i*c-a*s,d=a*u-r*c,l=r*s-i*u,h=i*l-a*d,b=a*f-r*l,p=r*d-i*f,_=2*o;return f*=_,d*=_,l*=_,h*=2,b*=2,p*=2,t[0]=u+f+h,t[1]=s+d+b,t[2]=c+l+p,t}function Ut(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Lt(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Pt(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function xt(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],u=e[2],s=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(a*a+o*o+u*u),c=s&&At(t,e)/s;return Math.acos(Math.min(Math.max(c,-1),1))}function Bt(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ct(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function zt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Gt(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],u=e[1],s=e[2];return Math.abs(n-a)<=o*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=o*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=o*Math.max(1,Math.abs(i),Math.abs(s))}var kt,Xt=ct,Vt=ft,$t=dt,Yt=vt,Ht=Et,qt=it,Wt=yt,Kt=(kt=nt(),function(t,e,n,r,i,a){var o,u;for(e||(e=3),n||(n=0),u=r?Math.min(r*e+n,t.length):t.length,o=n;o<u;o+=e)kt[0]=t[o],kt[1]=t[o+1],kt[2]=t[o+2],i(kt,kt,a),t[o]=kt[0],t[o+1]=kt[1],t[o+2]=kt[2];return t});function Qt(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function Zt(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}!function(){var t,e=(t=new u(4),u!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function Jt(){var t=new u(4);return u!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function te(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ee(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ne(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>o?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function re(t,e){var n=De(t,e);return Math.acos(2*n*n-1)}function ie(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],u=n[0],s=n[1],c=n[2],f=n[3];return t[0]=r*f+o*u+i*c-a*s,t[1]=i*f+o*s+a*u-r*c,t[2]=a*f+o*c+r*s-i*u,t[3]=o*f-r*u-i*s-a*c,t}function ae(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=a*s-i*u,t[3]=o*s-r*u,t}function oe(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s-a*u,t[1]=i*s+o*u,t[2]=a*s+r*u,t[3]=o*s-i*u,t}function ue(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=a*s+o*u,t[3]=o*s-a*u,t}function se(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function ce(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),u=Math.exp(a),s=o>0?u*Math.sin(o)/o:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=u*Math.cos(o),t}function fe(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),u=o>0?Math.atan2(o,a)/o:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=.5*Math.log(n*n+r*r+i*i+a*a),t}function de(t,e,n){return fe(t,e),Ie(t,t,n),ce(t,t),t}function le(t,e,n,r){var i,a,u,s,c,f=e[0],d=e[1],l=e[2],h=e[3],b=n[0],p=n[1],_=n[2],g=n[3];return(a=f*b+d*p+l*_+h*g)<0&&(a=-a,b=-b,p=-p,_=-_,g=-g),1-a>o?(i=Math.acos(a),u=Math.sin(i),s=Math.sin((1-r)*i)/u,c=Math.sin(r*i)/u):(s=1-r,c=r),t[0]=s*f+c*b,t[1]=s*d+c*p,t[2]=s*l+c*_,t[3]=s*h+c*g,t}function he(t){var e=s(),n=s(),r=s(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function be(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a,u=o?1/o:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=a*u,t}function pe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function _e(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}function ge(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),u=Math.sin(n),s=Math.cos(n),c=Math.sin(r),f=Math.cos(r);return t[0]=a*s*f-o*u*c,t[1]=o*u*f+a*s*c,t[2]=o*s*c-a*u*f,t[3]=o*s*f+a*u*c,t}function me(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var ve,Ee,ye,Te,Me,Oe,Ae,Se=function(t){var e=new u(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Re=function(t,e,n,r){var i=new u(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},Fe=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},je=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},we=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Ne=ie,Ie=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},De=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Ue=function(t,e,n,r){var i=e[0],a=e[1],o=e[2],u=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=u+r*(n[3]-u),t},Le=Qt,Pe=Le,xe=Zt,Be=xe,Ce=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t},ze=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Ge=function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],u=e[0],s=e[1],c=e[2],f=e[3];return Math.abs(n-u)<=o*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=o*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-f)<=o*Math.max(1,Math.abs(a),Math.abs(f))},ke=(ve=nt(),Ee=at(1,0,0),ye=at(0,1,0),function(t,e,n){var r=At(e,n);return r<-.999999?(St(ve,Ee,e),qt(ve)<1e-6&&St(ve,ye,e),Ot(ve,ve),ee(t,ve,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(St(ve,e,n),t[0]=ve[0],t[1]=ve[1],t[2]=ve[2],t[3]=1+r,Ce(t,t))}),Xe=(Te=Jt(),Me=Jt(),function(t,e,n,r,i,a){return le(Te,e,i,a),le(Me,n,r,a),le(t,Te,Me,2*a*(1-a)),t}),Ve=(Oe=new u(9),u!=Float32Array&&(Oe[1]=0,Oe[2]=0,Oe[3]=0,Oe[5]=0,Oe[6]=0,Oe[7]=0),Oe[0]=1,Oe[4]=1,Oe[8]=1,Ae=Oe,function(t,e,n,r){return Ae[0]=n[0],Ae[3]=n[1],Ae[6]=n[2],Ae[1]=r[0],Ae[4]=r[1],Ae[7]=r[2],Ae[2]=-e[0],Ae[5]=-e[1],Ae[8]=-e[2],Ce(t,_e(t,Ae))})},function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"b",(function(){return l}));var r=n(7);function i(t){return t[Object(r.b)(t.length)]}function a(t,e){for(let n=0;n<e;n++)t(n)}function o(t,e,n=[]){for(let r=0;r<e;r++)n[r]=t(r);return n}function u(t,e,n,r=[]){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++)r[a]=t(e[a],n[a]);return r}function s(t,e=[]){for(const n of t){const t=e.length;for(let r=0;r<n.length;r++)e[r+t]=n[r]}return e}function c(t,e,n=[]){return s(d(t,e,n))}const f=c;function d(t,e,n){if(Array.isArray(e))return e.map(t);if(Symbol.iterator in e){const r=n||[];for(let n=0;n<e.length;n++)r[n]=t(e[n],n);return r}{const r=n||{};for(const n in e)r[n]=t(e[n],n);return r}}function l(t,e){for(const n in e)t(e[n],n)}},function(t,e,n){"use strict";var r;function i(t,e){const n=e||t,{element:r=window}=t,i={};function a(t){i[t.keyCode]=Date.now(),n(i)}function o(t){delete i[t.keyCode],n(i)}return r.addEventListener("keyup",o,!1),r.addEventListener("keydown",a,!1),n(i),function(){r.removeEventListener("keyup",o),r.removeEventListener("keydown",a)}}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),function(t){t[t.CANCEL=3]="CANCEL",t[t.HELP=6]="HELP",t[t.BACK_SPACE=8]="BACK_SPACE",t[t.TAB=9]="TAB",t[t.CLEAR=12]="CLEAR",t[t.RETURN=13]="RETURN",t[t.ENTER=14]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CONTROL=17]="CONTROL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESCAPE=27]="ESCAPE",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PRINTSCREEN=44]="PRINTSCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_1=49]="DIGIT_1",t[t.DIGIT_2=50]="DIGIT_2",t[t.DIGIT_3=51]="DIGIT_3",t[t.DIGIT_4=52]="DIGIT_4",t[t.DIGIT_5=53]="DIGIT_5",t[t.DIGIT_6=54]="DIGIT_6",t[t.DIGIT_7=55]="DIGIT_7",t[t.DIGIT_8=56]="DIGIT_8",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.EQUALS=61]="EQUALS",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUMPAD0=96]="NUMPAD0",t[t.NUMPAD1=97]="NUMPAD1",t[t.NUMPAD2=98]="NUMPAD2",t[t.NUMPAD3=99]="NUMPAD3",t[t.NUMPAD4=100]="NUMPAD4",t[t.NUMPAD5=101]="NUMPAD5",t[t.NUMPAD6=102]="NUMPAD6",t[t.NUMPAD7=103]="NUMPAD7",t[t.NUMPAD8=104]="NUMPAD8",t[t.NUMPAD9=105]="NUMPAD9",t[t.MULTIPLY=106]="MULTIPLY",t[t.ADD=107]="ADD",t[t.SEPARATOR=108]="SEPARATOR",t[t.SUBTRACT=109]="SUBTRACT",t[t.DECIMAL=110]="DECIMAL",t[t.DIVIDE=111]="DIVIDE",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.F13=124]="F13",t[t.F14=125]="F14",t[t.F15=126]="F15",t[t.F16=127]="F16",t[t.F17=128]="F17",t[t.F18=129]="F18",t[t.F19=130]="F19",t[t.F20=131]="F20",t[t.F21=132]="F21",t[t.F22=133]="F22",t[t.F23=134]="F23",t[t.F24=135]="F24",t[t.NUM_LOCK=144]="NUM_LOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.BACK_QUOTE=192]="BACK_QUOTE",t[t.OPEN_BRACKET=219]="OPEN_BRACKET",t[t.BACK_SLASH=220]="BACK_SLASH",t[t.CLOSE_BRACKET=221]="CLOSE_BRACKET",t[t.QUOTE=222]="QUOTE",t[t.META=224]="META"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return l}));var r=n(35),i=n(29),a=n(25),o=n(17),u=n(43);const s=t=>{const[e,n,r]=Object(i.a)(t)?[t]:t;return{tag:"arg",type:e,id:n||Object(a.a)(),opts:Object.assign({q:"in"},r)}};function c(t,e,n,a){const c=n.map(s),f=a(...c.map(t=>Object(u.c)(t.type,t.id,t.opts))).filter(t=>null!=t),d=Object(o.f)((n,i)=>("ret"===i.tag&&(Object(r.a)(i.type===t,`wrong return type for function '${e}', expected ${t}, got ${i.type}`),n++),n),o.e,0,f);if("void"!==t&&!d)throw new Error(`function '${e}' must return a value of type ${t}`);const l=Object(o.f)((t,e)=>("call"===e.tag&&e.fn&&t.push(e.fn),t),o.a,[],f),h=(...t)=>function(t,...e){return Object(i.a)(t)?{tag:"call",type:e[0],id:t,args:e.slice(1)}:{tag:"call",type:t.type,id:t.id,args:e,fn:t}}(h,...t);return Object.assign(h,{tag:"fn",type:t,id:e,args:c,deps:l,scope:Object(o.d)(f)})}const f=t=>c("void","main",[],t);function d(t){return{tag:"ret",type:t?t.type:"void",val:t}}const l=(t,e,...n)=>({tag:"call_i",type:e,id:t,args:n})},function(t,e,n){"use strict";function r(t,e,n=[]){for(let r=0;r<t.length;r++)n[r]=t[r]+e[r];return n}function i(t,e,n=[]){for(let r=0;r<t.length;r++)n[r]=t[r]-e[r];return n}function a(t,e,n=[]){for(let r=0;r<e.length;r++)n[r]=e[r]*t;return n}function o(t,e,n=[]){for(let r=0;r<e.length;r++)n[r]=e[r]/t;return n}function u(t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];e+=r*r}return Math.sqrt(e)}function s(t,e=[]){return o(u(t),t,e)}function c(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n}function f(t,e,n=[]){return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=t[2]*e[0]-t[0]*e[2],n[2]=t[0]*e[1]-t[1]*e[0],n}function d(t,e){return t[0]*e[1]-t[1]*e[0]}n.d(e,"a",(function(){return r})),n.d(e,"i",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return s})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d}));n(11).a},function(t,e,n){"use strict";function r(t){return Math.floor(Math.random()*t)}function i(t,e){return r(e-t)+t}function a(){return(Math.random()+Math.random()+Math.random())/3}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d}));let r=null;const i={};let a=!1,o=0,u=0;function s(t){const e=u?t-u:u;if(u=t,r){for(const t in r)r[t](e);r=null}let n=0;for(const t in i)n++,i[t](e);n?requestAnimationFrame(s):(a=!1,u=0)}function c(t,e){e=e||t.name||o++,r=r||{},r[e]=t,a||(requestAnimationFrame(s),a=!0)}function f(t,e){return e=e||t.name||o++,i[e]=t,a||(requestAnimationFrame(s),a=!0),e}function d(t){"function"==typeof t&&(t=t.name),delete i[t]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));const r={LEFT:0,MIDDLE:1,RIGHT:2};function i(t,e){const n=e||t,{element:i=document,enableRightButton:a,holdDelay:o=400,holdRadius:u=5}=t,s={pressed:{},drag:{x:0,y:0,dX:0,dY:0,xMax:0,yMax:0},dragging:!1,holding:!1};let c=0,f=0,d=0,l=0,h=null;function b(t){t.isPrimary?(s.pressed[t.button]=t,c=d=t.clientX,f=l=t.clientY,s.dragging=!0,null!=h&&clearTimeout(h),h=setTimeout(()=>{s.drag.xMax<u&&s.drag.yMax<u&&(s.holding=!0,n(s))},o)):s.pressed[r.RIGHT]=t,n(s)}function p(t){s.pressed={},delete s.drag.event,s.drag.x=0,s.drag.y=0,s.drag.dX=0,s.drag.dY=0,s.drag.xMax=0,s.drag.yMax=0,s.dragging=!1,s.holding=!1,null!=h&&clearTimeout(h),h=null,n(s)}function _(t){s.dragging&&t.isPrimary&&(s.drag.event=t,s.drag.x=c-t.clientX,s.drag.y=f-t.clientY,s.drag.dX=d-t.clientX,s.drag.dY=l-t.clientY,s.drag.xMax=Math.max(Math.abs(s.drag.x),s.drag.xMax),s.drag.yMax=Math.max(Math.abs(s.drag.y),s.drag.yMax),d=t.clientX,l=t.clientY,n(s))}function g(t){t.preventDefault()}return i.addEventListener("pointerdown",b),document.addEventListener("pointermove",_),document.addEventListener("pointerup",p),document.addEventListener("pointerleave",p),document.addEventListener("pointercancel",p),a&&i.addEventListener("contextmenu",g),n(s),function(){i.removeEventListener("pointerdown",b),document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",p),document.removeEventListener("pointerleave",p),document.removeEventListener("pointercancel",p),a&&i.removeEventListener("contextmenu",g)}}},function(t,e,n){"use strict";n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return c})),n.d(e,"k",(function(){return f})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return v})),n.d(e,"b",(function(){return E})),n.d(e,"e",(function(){return y})),n.d(e,"f",(function(){return M})),n.d(e,"l",(function(){return w})),n.d(e,"m",(function(){return N})),n.d(e,"n",(function(){return I})),n.d(e,"j",(function(){return D}));var r=n(18),i=n(40),a=n(12);const o=(t,e,n)=>({tag:"lit",type:t,info:n,val:e}),u=t=>o("bool",Object(r.a)(t)?!!t:t),s=t=>o("float",Object(i.a)(t)?1&t:t),c=t=>o("int",Object(i.a)(t)?1&t:Object(r.a)(t)?0|t:t),f=t=>o("uint",Object(i.a)(t)?1&t:Object(r.a)(t)?t>>>0:t),d=(t,e)=>n=>Object(r.a)(n)?e(n):void 0===n||Object(a.b)(n)||n.type===t?n:e(n),l=d("float",s),h=d("int",c),b=d("uint",f),p=d("bool",u),_=(o("bool",!0),o("bool",!1)),g=s(0),m=s(1),v=s(2),E=s(.5),y=c(0),T=(c(1),f(0)),M=(f(1),s(Math.PI),s(2*Math.PI),s(Math.PI/2),s(Math.SQRT2)),O=(t,e)=>n=>[void 0===n[0]?e:t(n[0]),...n.slice(1).map(t)],A=O(l,g),S=(O(h,y),O(b,T),O(p,_),(t,e,n)=>o(t,n=e(n),["n","n"][n.length])),R=(t,e,n)=>o(t,n=e(n),["n","n","vn"][n.length]),F=(t,e,n)=>o(t,n=e(n),2===n.length?Object(a.b)(n[1])?"vv":"vn":["n","n",,"vnn"][n.length]),j=(t,e,n)=>o(t,n=A(n),e[n.length]);function w(...t){return S("vec2",A,t)}function N(...t){return R("vec3",A,t)}function I(...t){return F("vec4",A,t)}function D(...t){return j("mat2",["n","n","vv"],t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));function r(t,e){if(t===e)return!0;if(!e||!t)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function i(t,e){if(t===e)return!0;if(!e)return!1;const n=Object.keys(t);if(!r(n,Object.keys(e)))return!1;for(const r of n)if(t[r]!==e[r])return!1;return!0}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o}));const r=/^[iub]?vec[234]$/,i=/^mat[234]$/,a=t=>r.test(t.type),o=t=>i.test(t.type)},function(t,e,n){"use strict";function r(t,...e){return e.reduce((e,n)=>e|t[n.toUpperCase()+"_BUFFER_BIT"],0)}function i(t,e=1){let n=t.width,r=t.height;return"clientWidth"in t&&"clientHeight"in t&&(n=t.clientWidth*e|0,r=t.clientHeight*e|0),(t.width!==n||t.height!==r)&&(t.width=n,t.height=r,!0)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},,function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return f}));var r=n(22),i=n(23),a=n(6),o=n(3);const u=Object(r.a)((function(t,e,n,i){return Object(o.i)(Object(r.a)(t,e),n,i)}),i.b);function s(t,e){return e.map(e=>Object(a.a)(t,e))}function c(t){return function(t){return t.unshift(t.pop()),t}(t.concat())}function f(t){return Object(a.h)(Object(a.b)(Object(a.i)(t[0],t[1]),Object(a.i)(t[2],t[1])))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return s}));var r=n(2),i=n(4),a=n(9);class o extends class{constructor(t){this.position=[0,0,0],this.rotationX=0,this.rotationY=0,this.rotationXMat=r.a.create(),this.rotationYMat=r.a.create(),this.projectionMat=r.a.create(),this.viewMat=r.a.create(),this.needsUpdateView=!0,Object.assign(this,t),this.updateRotationX(),this.updateRotationY()}updateRotationX(t=0){this.rotationX+=t,r.a.fromXRotation(this.rotationXMat,this.rotationX),this.needsUpdateView=!0}updateRotationY(t=0){this.rotationY+=t,r.a.fromYRotation(this.rotationYMat,this.rotationY),this.needsUpdateView=!0}moveForward(t){const e=r.c.fromValues(this.rotationYMat[8],this.rotationYMat[9],this.rotationYMat[10]);r.c.add(this.position,this.position,r.c.scale(e,e,-t)),this.needsUpdateView=!0}moveLeft(t){const e=r.c.fromValues(this.rotationYMat[0],this.rotationYMat[1],this.rotationYMat[2]);r.c.add(this.position,this.position,r.c.scale(e,e,-t)),this.needsUpdateView=!0}moveUp(t){const e=r.c.fromValues(this.rotationYMat[4],this.rotationYMat[5],this.rotationYMat[6]);r.c.add(this.position,this.position,r.c.scale(e,e,t)),this.needsUpdateView=!0}update(){this.needsUpdateView&&(r.a.fromTranslation(this.viewMat,this.position),r.a.multiply(this.viewMat,this.viewMat,this.rotationYMat),r.a.multiply(this.viewMat,this.viewMat,this.rotationXMat),r.a.invert(this.viewMat,this.viewMat),this.needsUpdateView=!1)}}{constructor(t){super(t),this.fovy=.6*Math.PI,this.aspect=1,this.near=.1,this.far=1e3,this.needsUpdateProjection=!0,Object.assign(this,t),this.update()}update(){super.update(),this.needsUpdateProjection&&(r.a.perspective(this.projectionMat,this.fovy,this.aspect,this.near,this.far),this.needsUpdateProjection=!1)}}function u(t){return class extends t{updatePosFromInput(t,e,n){(e||n)&&(((null==e?void 0:e[i.a.UP])||(null==e?void 0:e[i.a.W])||(null==n?void 0:n.holding)&&!n.pressed[a.a.RIGHT])&&this.moveForward(t),((null==e?void 0:e[i.a.DOWN])||(null==e?void 0:e[i.a.S])||(null==n?void 0:n.pressed[a.a.RIGHT]))&&this.moveForward(-t),((null==e?void 0:e[i.a.LEFT])||(null==e?void 0:e[i.a.A]))&&this.moveLeft(t),((null==e?void 0:e[i.a.RIGHT])||(null==e?void 0:e[i.a.D]))&&this.moveLeft(-t))}}}function s(t){return class extends t{constructor(){super(...arguments),this._oldMouse={x:0,y:0}}updateRotFromPointer(t,e){if(e.dragging){const n=this._oldMouse.x-e.drag.x,r=this._oldMouse.y-e.drag.y;this._oldMouse.x=e.drag.x,this._oldMouse.y=e.drag.y,r&&this.updateRotationX(r*t),n&&this.updateRotationY(n*t)}else this._oldMouse.x&&(this._oldMouse.x=0),this._oldMouse.y&&(this._oldMouse.y=0)}}}},function(t,e,n){"use strict";n.d(e,"e",(function(){return K})),n.d(e,"a",(function(){return Q})),n.d(e,"f",(function(){return Z})),n.d(e,"b",(function(){return tt})),n.d(e,"d",(function(){return et})),n.d(e,"c",(function(){return nt}));const r=Array.isArray;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function i(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}var a=n(44);Object.getPrototypeOf;const o=Object.getPrototypeOf({}),u="function",s=(t,e)=>{let n;return t===e||(null==t?t==e:typeof t.equiv===u?t.equiv(e):null==e?t==e:typeof e.equiv===u?e.equiv(t):"string"!=typeof t&&"string"!=typeof e&&(n=Object.getPrototypeOf(t),null!=n&&n!==o||(n=Object.getPrototypeOf(e),null!=n&&n!==o)?typeof t!==u&&void 0!==t.length&&typeof e!==u&&void 0!==e.length?c(t,e):t instanceof Set&&e instanceof Set?f(t,e):t instanceof Map&&e instanceof Map?d(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!=t&&e!=e:l(t,e)))},c=(t,e,n=s)=>{let r=t.length;if(r===e.length)for(;--r>=0&&n(t[r],e[r]););return r<0},f=(t,e,n=s)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),d=(t,e,n=s)=>t.size===e.size&&n([...t].sort(),[...e].sort()),l=(t,e,n=s)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!e.hasOwnProperty(r)||!n(t[r],e[r]))return!1;return!0};function h(t,e){for(let n of e)t.delete(n);return t}var b=n(57);const p=(t,e)=>[t[0],t[1],e],_=(t,e)=>null!=t&&"function"==typeof t[e],g=t=>_(t,"xform")?t.xform():t;class m{constructor(t){this.value=t}deref(){return this.value}}const v=t=>t instanceof m,E=t=>t instanceof m?t.deref():t;var y=n(24);const T=Object(y.a)(()=>"illegal arity"),M=t=>2===t.length?[void 0,t[1]]:3===t.length?[t[1],t[2]]:(t=>{throw new T(t)})(t.length);function O(...t){const e=t[0],n=e[0],r=e[1],i=e[2],a=null==(t=M(t))[0]?n():t[0],o=t[1];return E(r(_(o,"$reduce")?o.$reduce(i,a):null!=(u=o)&&"function"!=typeof u&&void 0!==u.length?A(i,a,o):S(i,a,o)));var u}const A=(t,e,n)=>{for(let r=0,i=n.length;r<i;r++)if(e=t(e,n[r]),v(e)){e=e.deref();break}return e},S=(t,e,n)=>{for(let r of n)if(e=t(e,r),v(e)){e=e.deref();break}return e},R=(t,e)=>[t,t=>t,e];function*F(t,e){const n=g(t)([a.a,a.a,(t,e)=>e])[2];for(let t of e){let e=n(a.b,t);if(v(e))return e=E(e.deref()),void(e!==a.b&&(yield e));e!==a.b&&(yield e)}}function j(t,e){return e?F(j(t),e):e=>{const n=e[2];return p(e,(e,r)=>n(e,t(r)))}}const w=Object(b.a)()?n(48).inspect:null,N=(t,e)=>[...j(t=>w(t,e),t)].join(", "),I=(t,e)=>[...j(([t,n])=>`${w(t,e)} => ${w(n,e)}`,t)].join(", "),D=((t,e={})=>{const n=Reflect.ownKeys(t),r=Reflect.ownKeys(e),i=Symbol("isa");function a(e){for(let r of n){const n=Object.getOwnPropertyDescriptor(e.prototype,r);!n||n.configurable?Object.defineProperty(e.prototype,r,{value:t[r],writable:!0}):console.log(`not patching: ${e.name}.${r.toString()}`)}return Object.defineProperty(e.prototype,i,{value:!0}),e}for(let t of r)Object.defineProperty(a,t,{value:e[t],enumerable:e.propertyIsEnumerable(t)});return Object.defineProperty(a,Symbol.hasInstance,{value:t=>!!t[i]}),a})({[Symbol.for("nodejs.util.inspect.custom")](t,e){const n=this[Symbol.toStringTag],r=Object.assign(Object.assign({},e),{depth:null===e.depth?null:e.depth-1});return t>=0?[`${n}(${this.size||0}) {`,w?this instanceof Set?N(this,r):this instanceof Map?I(this,r):"":"","}"].join(" "):e.stylize(`[${n}]`,"special")}}),U=t=>t instanceof Map;function L(t,e){if(U(t))for(let n of e)t.set(n[0],n[1]);else for(let n of e)t.add(n);return t}var P;const x=new WeakMap,B=t=>x.get(t).vals;let C=P=class extends Set{constructor(t,e={}){super(),x.set(this,{equiv:e.equiv||s,vals:[]}),t&&this.into(t)}*[Symbol.iterator](){yield*B(this)}get[Symbol.species](){return P}get[Symbol.toStringTag](){return"ArraySet"}get size(){return B(this).length}copy(){const t=x.get(this),e=new P(null,{equiv:t.equiv});return x.get(e).vals=t.vals.slice(),e}empty(){return new P(null,this.opts())}clear(){B(this).length=0}first(){if(this.size)return B(this)[0]}add(t){return!this.has(t)&&B(this).push(t),this}into(t){return L(this,t)}has(t){return this.get(t,a.b)!==a.b}get(t,e){const n=x.get(this),r=n.equiv,i=n.vals;for(let e=i.length;--e>=0;)if(r(i[e],t))return i[e];return e}delete(t){const e=x.get(this),n=e.equiv,r=e.vals;for(let e=r.length;--e>=0;)if(n(r[e],t))return r.splice(e,1),!0;return!1}disj(t){return h(this,t)}equiv(t){return((t,e)=>{if(t===e)return!0;if(!(e instanceof Set)||t.size!==e.size)return!1;for(let n of t.keys())if(!e.has(n))return!1;return!0})(this,t)}forEach(t,e){const n=B(this);for(let r=n.length;--r>=0;){const i=n[r];t.call(e,i,i,this)}}*entries(){for(let t of B(this))yield[t,t]}*keys(){yield*B(this)}*values(){yield*B(this)}opts(){return{equiv:x.get(this).equiv}}};C=P=i([D],C);var z;const G=new WeakMap,k=t=>G.get(t).map;let X=z=class extends Map{constructor(t,e){super();const n=Object.assign({equiv:s,keys:C},e);G.set(this,{keys:new n.keys(null,{equiv:n.equiv}),map:new Map,opts:n}),t&&this.into(t)}[Symbol.iterator](){return this.entries()}get[Symbol.species](){return z}get[Symbol.toStringTag](){return"EquivMap"}get size(){return G.get(this).keys.size}clear(){const t=G.get(this);t.keys.clear(),t.map.clear()}empty(){return new z(null,G.get(this).opts)}copy(){const t=G.get(this),e=new z;return G.set(e,{keys:t.keys.copy(),map:new Map(t.map),opts:t.opts}),e}equiv(t){return((t,e)=>{if(t===e)return!0;if(!(e instanceof Map)||t.size!==e.size)return!1;for(let n of t.entries())if(!s(e.get(n[0]),n[1]))return!1;return!0})(this,t)}delete(t){const e=G.get(this);return(t=e.keys.get(t,a.b))!==a.b&&(e.map.delete(t),e.keys.delete(t),!0)}dissoc(t){return h(this,t)}forEach(t,e){for(let n of k(this))t.call(e,n[1],n[0],this)}get(t,e){const n=G.get(this);return(t=n.keys.get(t,a.b))!==a.b?n.map.get(t):e}has(t){return G.get(this).keys.has(t)}set(t,e){const n=G.get(this),r=n.keys.get(t,a.b);return r!==a.b?n.map.set(r,e):(n.keys.add(t),n.map.set(t,e)),this}into(t){return L(this,t)}entries(){return k(this).entries()}keys(){return k(this).keys()}values(){return k(this).values()}opts(){return G.get(this).opts}};X=z=i([D],X);const V=(t,e,n)=>{if(t.size<e.size){const n=t;t=e,e=n}var r,i;return n=n?L(n,t):(r=t,i=Set,_(r,"copy")?r.copy():new(r[Symbol.species]||i)(r)),t===e?n:L(n,e)};var $=n(47);function Y(t,e){return e?F(Y(t),e):e=>{const n=e[2];return p(e,(e,r)=>t(r)?n(e,r):e)}}class H{constructor(t){if(this.dependencies=new X,this.dependents=new X,t)for(let[e,n]of t)this.addDependency(e,n)}*[Symbol.iterator](){yield*this.sort()}get[Symbol.species](){return H}copy(){const t=new H;for(let e of this.dependencies)t.dependencies.set(e[0],e[1].copy());for(let e of this.dependents)t.dependents.set(e[0],e[1].copy());return t}addNode(t){return!this.dependencies.has(t)&&this.dependencies.set(t,new C),this}addDependency(t,e){(s(t,e)||this.depends(e,t))&&Object($.a)(`Circular dependency between: ${t} & ${e}`);let n=this.dependencies.get(t);return this.dependencies.set(t,n?n.add(e):new C([e])),n=this.dependents.get(e),this.dependents.set(e,n?n.add(t):new C([t])),this}addDependencies(t,e){for(let n of e)this.addDependency(t,n)}removeEdge(t,e){let n=this.dependencies.get(t);return n&&n.delete(e),n=this.dependents.get(e),n&&n.delete(t),this}removeNode(t){return this.dependencies.delete(t),this}depends(t,e){return this.transitiveDependencies(t).has(e)}dependent(t,e){return this.transitiveDependents(t).has(e)}immediateDependencies(t){return this.dependencies.get(t)||new C}immediateDependents(t){return this.dependents.get(t)||new C}isLeaf(t){return 0===this.immediateDependents(t).size}isRoot(t){return 0===this.immediateDependencies(t).size}nodes(){return V(new C(this.dependencies.keys()),new C(this.dependents.keys()))}leaves(){return Y(t=>this.isLeaf(t),this.nodes())}roots(){return Y(t=>this.isRoot(t),this.nodes())}transitiveDependencies(t){return q(this.dependencies,t)}transitiveDependents(t){return q(this.dependents,t)}sort(){const t=[],e=this.copy();let n=new C(e.leaves());for(;;){if(!n.size)return t.reverse();const r=n.first();n.delete(r);for(let t of[...e.immediateDependencies(r)])e.removeEdge(r,t),e.isLeaf(t)&&n.add(t);t.push(r),e.removeNode(r)}}}const q=(t,e)=>{const n=t.get(e);return n?O(R(null,(e,n)=>V(e,q(t,n))),n,n):new C};var W=n(12);const K=t=>"fn"===t.tag||"for"===t.tag||"while"==t.tag?t.scope.body:"if"===t.tag?t.f?t.t.body.concat(t.f.body):t.t.body:void 0,Q=t=>K(t)||("scope"===t.tag?t.body:"ternary"===t.tag?[t.t,t.f]:"ret"===t.tag?[t.val]:"call"===t.tag||"call_i"===t.tag?t.args:"sym"===t.tag&&t.init?[t.init]:"decl"===t.tag?[t.id]:"op1"===t.tag||"swizzle"===t.tag?[t.val]:"op2"===t.tag?[t.l,t.r]:"assign"===t.tag?[t.r]:Object(W.b)(t)||Object(W.a)(t)?t.val:void 0),Z=(t,e,n,i,a=!0)=>{if(r(i))i.forEach(r=>n=Z(t,e,n,r,a));else{a&&(n=t(n,i));const r=e(i);r&&(n=Z(t,e,n,r,a)),!a&&(n=t(n,i))}return n},J=(t,e=new H)=>t.deps&&t.deps.length?t.deps.reduce((e,n)=>J(n,e.addDependency(t,n)),e):e.addNode(t),tt=t=>({tag:"decl",type:t.type,id:t}),et=(t,e=!1)=>({tag:"scope",type:"void",body:t.filter(t=>null!=t).map(t=>"sym"===t.tag?tt(t):t),global:e}),nt=t=>{const e=t.filter(t=>"fn"!==t.tag),n=t.reduce((t,e)=>"fn"===e.tag?J(e,t):t,new H);return et(e.concat(n.sort()),!0)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>"number"==typeof t},function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"g",(function(){return l}));var r=n(3),i=n(15);function a(t){return[t[1],t[2]]}function o(t,e){return t.concat(Object(i.c)(e))}function u(t,e){return Object(i.c)(function(t,e){return o(Object(i.d)(t,e),e)}(t,e))}function s(t,e){return o(e,Object(i.d)(t,e))}function c(t,e,[n,r,a,o]){const u=Object(i.a)(t,n,o),s=Object(i.a)(e,r,a);return[[n,r,s,u],[u,s,a,o]]}function f(t,e,[n,r,a,o]){const u=Object(i.a)(t,n,r),s=Object(i.a)(e,o,a);return[[n,u,s,o],[u,r,a,s]]}const d=[[0,2,1],[0,3,2]];function l(t){return Object(r.d)(Object(r.h)(t=>d.map(e=>e.map(e=>4*t+e)),t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(10);const i=t=>t.replace("[]",""),a=(t,e)=>{const n=t.type[0];return"i"===n?Object(r.i)(e):"u"===n?Object(r.k)(e):"b"===n?Object(r.g)(e):Object(r.h)(e)},o=(t,e)=>{const n={vec2:r.l,vec3:r.m,vec4:r.n}[t.type];return n?n(e):e},u=t=>({float:"bool",int:"bool",uint:"bool",vec2:"bvec2",ivec2:"bvec2",uvec2:"bvec2",vec3:"bvec3",ivec3:"bvec3",uvec3:"bvec3",vec4:"bvec4",ivec4:"bvec4",uvec4:"bvec4"}[t.type])},,function(t,e,n){"use strict";function r(t,...e){return t.bind(null,...e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){return t>0?1:t<0?-1:0}function i(t,e,n){return e+t*(n-e)}function a(t,e,n){return Math.max(t,Math.min(n,e))}n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));Math.PI},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=(t,e=(t=>void 0!==t?": "+t:""))=>class extends Error{constructor(n){super(t(n)+e(n))}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));let r=0;const i=()=>`_s${(r++).toString(36)}`},,function(t,e,n){"use strict";n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"g",(function(){return h})),n.d(e,"b",(function(){return b})),n.d(e,"f",(function(){return p})),n.d(e,"h",(function(){return g})),n.d(e,"e",(function(){return m})),n.d(e,"c",(function(){return v}));var r=n(18),i=n(12),a=n(20),o=n(10);const u=(t,e,n=!1)=>({tag:"op1",type:e.type,op:t,val:e,post:n}),s={mave:"mv",vema:"vm",vefl:"vn",mafl:"vn",flve:"nv",flma:"nv",ivin:"vn",iniv:"nv",uvui:"vn",uiuv:"nv"},c=(t,e,n,u,c)=>{const f=Object(r.a)(e),d=Object(r.a)(n);let l,h,b;return f?d?(h=Object(o.h)(e),b=Object(o.h)(n),l="float"):(b=n,h=Object(a.d)(b,e),l=b.type):d?(h=e,b=Object(a.d)(h,n),l=h.type):(h=e,b=n,l=u||(Object(i.b)(h)?h.type:Object(i.b)(b)||Object(i.a)(b)?b.type:h.type)),{tag:"op2",type:u||l,info:c||s[h.type.substr(0,2)+b.type.substr(0,2)],op:t,l:h,r:b}},f=t=>u("++",t,!0);function d(t,e){return c("+",t,e)}function l(t,e){return c("-",t,e)}function h(t,e){return c("*",t,e,!Object(r.a)(t)&&!Object(r.a)(e)&&Object(i.a)(t)&&Object(i.b)(e)?e.type:void 0)}function b(t,e){return c("/",t,e)}const p=(t,e,n)=>d(h(t,e),n),_=t=>(e,n)=>c(t,e,n,"bool"),g=(_("=="),_("!=")),m=(_("<"),_("<=")),v=_(">");_(">=")},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(16);class a{constructor(){this.moveSpeed=2,this.lookSpeed=2,this.camera=new(Object(i.b)(Object(i.c)(i.a)))({fovy:.3*Math.PI,position:[0,0,5]})}}function o({lookSpeed:t,moveSpeed:e,position:n,rotationY:i,rotationX:o,fovy:u}={}){const s=new a;t&&(s.lookSpeed=t),e&&(s.moveSpeed=e),u&&(s.camera.fovy=u,s.camera.needsUpdateProjection=!0),n&&(s.camera.position=n,s.camera.needsUpdateView=!0),o&&(s.camera.rotationX=o,s.camera.updateRotationX()),i&&(s.camera.rotationY=i,s.camera.updateRotationY()),Object(r.m)("viewPort",s,{reset:{moveSpeed:!0,lookSpeed:!0}})}Object(r.a)("viewPort",(t,e)=>{const n=e.viewPort;switch(t){case r.b.FRAME:const t=e.device,i=t.tpf/1e3;n.camera.updatePosFromInput(n.moveSpeed*i,e.device.keys,e.device.pointer);const a=t.pointer,o={dragging:a.dragging,drag:{x:t.sizeMultiplier*a.drag.x/t.canvas.width,y:t.sizeMultiplier*a.drag.y/t.canvas.height}};return n.camera.updateRotFromPointer(n.lookSpeed,o),void n.camera.update();case r.b.RESIZE:n.camera.aspect=e.device.canvas.width/e.device.canvas.height,n.camera.needsUpdateProjection=!0}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>"string"==typeof t},function(t,e,n){"use strict";n.d(e,"b",(function(){return T})),n.d(e,"a",(function(){return M}));var r=n(40),i=n(18),a=n(24);const o=Object(a.a)(()=>"unsupported operation"),u=t=>{throw new o(t)};var s,c=n(20);!function(t){t[t.FINE=0]="FINE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.SEVERE=4]="SEVERE",t[t.NONE=5]="NONE"}(s||(s={}));const f=Object.freeze({level:s.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});const d=Symbol();let l=f;const h=(t,e,n)=>{const r=e[n];if(r)for(let n of r){let r=t[n]||h(t,e,n);if(r)return r}},b=(t,e,n)=>{const r=e[n];if(r)for(let n of r)t.push(n),b(t,e,n);return t},p=t=>{const e={};for(let n in t){const r=t[n];e[n]=r instanceof Set?r:new Set(r)}return e},_=t=>{const e=function(t,e){const n={},r=e?p(e):{},i=(...e)=>{const i=t(...e),a=n[i]||h(n,r,i)||n[d];return a?a(...e):u(`missing implementation for: "${i.toString()}"`)};return i.add=(t,e)=>(n[t]&&l.warn(`overwriting '${t.toString()}' impl`),n[t]=e,!0),i.addAll=t=>{let e=!0;for(let n in t)e=i.add(n,t[n])&&e;return e},i.remove=t=>!!n[t]&&(delete n[t],!0),i.callable=(...e)=>{const i=t(...e);return!!(n[i]||h(n,r,i)||n[d])},i.isa=(t,e)=>{let n=r[t];!n&&(r[t]=n=new Set),n.add(e)},i.impls=()=>{const t=new Set(Object.keys(n));for(let e in r)h(n,r,e)&&t.add(e);return n[d]&&t.add(d),t},i.rels=()=>r,i.parents=t=>r[t],i.ancestors=t=>new Set(b([],r,t)),i}(t=>t.tag);return e.add(d,t=>u(`no impl for AST node type: '${t.tag}'`)),e.addAll(t),e};var g,m=n(12),v=n(43);!function(t){t.GLES_100="100",t.GLES_300="300 es"}(g||(g={}));const E=/[};]$/,y=t=>{const e=Object.assign({type:"fs",version:g.GLES_300,versionPragma:!0,prelude:""},t),n="vs"===e.type,a=(t,e=", ")=>t.map(f).join(e),o=t=>`${t.id}(${a(t.args)})`,s=(t,r=!1)=>{const{id:i,type:a,opts:o,init:s}=t,d=[];if(o.type){let t;e.version<g.GLES_300?n?t={in:"attribute",out:"varying",uni:"uniform"}[o.type]:(t={in:"varying",out:null,uni:"uniform"}[o.type],!t&&u("GLSL 100 doesn't support fragment shader output variables")):(null!=o.loc&&d.push(`layout(location=${o.loc}) `),t="uni"===o.type?"uniform":o.type),d.push(t+" ")}else o.const&&d.push("const "),r&&o.q&&d.push(o.q+" ");return o.prec&&d.push(o.prec+" "),d.push(Object(c.a)(a)," ",i),o.num&&d.push(`[${o.num}]`),s&&d.push(" = ",f(s)),d.join("")},f=_({arg:t=>s(t,!0),array_init:t=>e.version>=g.GLES_300?`${t.type}(${a(t.init)})`:u(`array initializers not available in GLSL ${e.version}`),assign:t=>f(t.l)+" = "+f(t.r),ctrl:t=>t.id,call:o,call_i:t=>"texture"===t.id&&e.version<g.GLES_300?`${t.id}${t.args[0].type.substr(7)}(${a(t.args)})`:o(t),decl:t=>s(t.id),fn:t=>`${t.type} ${t.id}(${a(t.args)}) ${f(t.scope)}`,for:t=>`for(${t.init?f(t.init):""}; ${f(t.test)}; ${t.iter?f(t.iter):""}) ${f(t.scope)}`,idx:t=>`${f(t.val)}[${f(t.id)}]`,if:t=>{const e=`if (${f(t.test)}) `+f(t.t);return t.f?e+" else "+f(t.f):e},lit:t=>{const e=t.val;switch(t.type){case"bool":return Object(r.a)(e)?String(e):`bool(${f(e)})`;case"float":return Object(i.a)(e)?e===Math.trunc(e)?e+".0":String(e):`float(${f(e)})`;case"int":case"uint":return Object(i.a)(e)?String(e):`${t.type}(${f(e)})`;default:return Object(m.b)(t)||Object(m.a)(t)?`${t.type}(${a(e)})`:u(`unknown type: ${t.type}`)}},op1:t=>t.post?`(${f(t.val)}${t.op})`:`(${t.op}${f(t.val)})`,op2:t=>`(${f(t.l)} ${t.op} ${f(t.r)})`,ret:t=>"return"+(t.val?" "+f(t.val):""),scope:t=>{let n=t.body.map(f).reduce((t,e)=>(t.push(E.test(e)?e:e+";"),t),[]).join("\n");return n+=t.body.length&&!E.test(n)?";":"",t.global?(e.prelude&&(n=e.prelude+"\n"+n),e.versionPragma&&(n=`#version ${e.version}\n`+n),n):`{\n${n}\n}`},swizzle:t=>`${f(t.val)}.${t.id}`,sym:t=>t.id,ternary:t=>`(${f(t.test)} ? ${f(t.t)} : ${f(t.f)})`,while:t=>`while (${f(t.test)}) ${f(t.scope)}`});return Object.assign(f,{gl_FragColor:Object(v.c)("vec4","gl_FragColor"),gl_FragCoord:Object(v.c)("vec4","gl_FragCoord",{const:!0}),gl_FragData:Object(v.c)("vec4[]","gl_FragData",{num:1}),gl_FrontFacing:Object(v.c)("bool","gl_FrontFacing",{const:!0}),gl_PointCoord:Object(v.c)("vec2","gl_PointCoord",{const:!0}),gl_PointSize:Object(v.c)("float","gl_PointSize"),gl_Position:Object(v.c)("vec4","gl_Position")}),f},T=()=>y({version:g.GLES_100,type:"vs"}),M=(t="precision mediump float;")=>y({version:g.GLES_100,type:"fs",prelude:t})},,,,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n(44);const i=void 0===t||"1"===t.env.UMBRELLA_ASSERTS?(t,e="assertion failed")=>{if("function"==typeof t&&!t()||!t)throw new Error("function"==typeof e?e():e)}:r.a}).call(this,n(42))},,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(3),i=n(0);function a(t){const e={drawType:"TRIANGLES",attribs:{},itemCount:0};for(const n in t){const a=t[n];if("cells"===n){const t=new(a.length>65535?Uint32Array:Uint16Array)(Object(r.d)(a));Object.assign(e,{elements:{buffer:t},itemCount:t.length})}else"positions"===n?e.attribs[i.b]={buffer:new Float32Array(Object(r.d)(a))}:"normals"===n?e.attribs[i.a]={buffer:new Float32Array(Object(r.d)(a))}:"uvs"===n?e.attribs[i.c]={buffer:new Float32Array(Object(r.d)(a))}:e.attribs[n]={buffer:new Float32Array(Object(r.d)(a))}}return e}},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>"boolean"==typeof t},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1);function i(t,e,{strength:n,size:i,layerOpts:a,startFrame:o,strengthOffset:u=0,blurRatioVertical:s=1,scaleFactor:c=.6}){const f=[];for(;n>=1/s;)f.push({strength:n,direction:0,source:"0"}),f.push({strength:n*s,direction:1,source:"0"}),n*=c;return o&&(f[0].source=()=>o.image()),Object(r.e)(t,e).update(Object.assign(Object.assign({},a),{frag:"precision mediump float;\n#define GLSLIFY 1\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nuniform sampler2D source;\nuniform vec2 size;\nuniform float direction;\nuniform float strength;\nuniform float strengthOffset;\n\nvarying vec2 coords;\n\nvoid main() {\n\tvec2 uv = coords;\n\tvec4 refl = texture2D(source, uv);\n\tfloat dist = refl.a * strength + strengthOffset;\n\n\tif (direction == 0.0) {\n\t\tgl_FragColor = blur9(source, uv, size, vec2(dist, 0));\n\t} else {\n\t\tgl_FragColor = blur9(source, uv, size, vec2(0, dist));\n\t}\n}\n",drawSettings:{disable:[t.gl.DEPTH_TEST]},uniforms:f.map(e=>Object.assign(Object.assign({},e),{blurRatioVertical:s,strengthOffset:u,size:i||(()=>[t.gl.canvas.width,t.gl.canvas.height])}))}))}},function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var s,c=[],f=!1,d=-1;function l(){f&&s&&(f=!1,s.length?c=s.concat(c):d=-1,c.length&&h())}function h(){if(!f){var t=u(l);f=!0;for(var e=c.length;e;){for(s=c,c=[];++d<e;)s&&s[d].run();d=-1,e=c.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function b(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new b(t,e)),1!==c.length||f||u(h)},b.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return c}));n(35);var r=n(29),i=n(47),a=n(25);function o(t,...e){let n,o,u;switch(e.length){case 0:Object(r.a)(t)||(u=t,t=u.type);break;case 1:Object(r.a)(e[0])?n=e[0]:e[0].tag?u=e[0]:o=e[0];break;case 2:Object(r.a)(e[0])?[n,o]=e:[o,u]=e;break;case 3:[n,o,u]=e;break;default:Object(i.a)()}return{tag:"sym",type:t,id:n||Object(a.a)(),opts:o||{},init:u}}const u=(t,e,n)=>o(t,e,Object.assign({q:"in",type:"in"},n)),s=(t,e,n)=>o(t,e,Object.assign({q:"out",type:"out"},n)),c=(t,e,n)=>o(t,e,Object.assign({q:"in",type:"uni"},n))},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));const r=Symbol(),i=()=>{}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var r=n(22),i=n(19),a=n(3),o=n(37);const u=Object(r.a)(i.b,.5,.5),s=Object(r.a)(i.a,.5,.5);function c(t=1,e){for(let n=0;n<t;n++)e=Object(a.d)(e.map(t=>Object(a.d)(u(t).map(s))));return e}const f=[[0,0],[1,0],[1,1],[0,1]];function d(t,e,n){const r=c(n,[t]),u=Object(a.d)(r);return Object(o.a)({position:u,normal:u.map(()=>e),uv:Object(a.d)(c(n,[f])),cells:Object(i.g)(r.length)})}function l(t,e){const n=Object(i.c)([0,2*-t,0],[[-t,t,0],[t,t,0]]),r=d(n,[0,0,-1],e);return console.log(r,n),r}function h(t,e){return d(Object(i.c)([0,0,2*-t],[[-t,0,t],[t,0,t]]),[0,1,0],e)}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(24);const i=Object(r.a)(()=>"illegal argument(s)"),a=t=>{throw new i(t)}},function(t,e){},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return G}));var r=n(1),i=n(2),a=n(41),o=n(45),u=n(30),s=n(17),c=n(43),f=n(5),d=n(58),l=n(27),h=n(10),b=n(52),p=n(59),_=n(66);const g=Object(u.a)(),m=Object(u.b)();let v,E,y,T,M,O,A,S,R;const F=m(Object(s.c)([T=Object(c.a)("vec3","position"),M=Object(c.a)("vec3","normal"),O=Object(c.a)("vec2","uv"),A=Object(c.d)("mat4","transform"),S=Object(c.d)("mat4","projection"),R=Object(c.d)("mat4","view"),v=Object(c.b)("vec3","vNormal"),E=Object(c.b)("vec3","vPos"),y=Object(c.b)("vec2","vUv"),Object(f.b)(()=>[Object(d.a)(v,M),Object(d.a)(y,O),Object(d.a)(E,T),Object(d.a)(m.gl_Position,Object(l.g)(Object(l.g)(Object(l.g)(S,R),A),Object(h.n)(T,1)))])]));let j,w,N,I;const D=Object(f.c)("vec4","groundColor",["vec4","float","vec2"],(t,e,n)=>[j=Object(c.c)(Object(h.m)(Object(b.i)(Object(b.f)(Object(h.h)(0),Object(l.i)(1,Object(l.b)(e,90))),Object(h.h)(.8)),Object(b.i)(Object(b.f)(Object(h.h)(0),Object(l.i)(1,Object(l.b)(e,95))),Object(h.h)(.8)),Object(b.i)(Object(b.f)(Object(h.h)(0),Object(l.i)(1,Object(l.b)(e,100))),Object(h.h)(.8)))),w=Object(c.c)(Object(l.g)(Object(b.d)(Object(l.g)(n,40)),.02)),N=Object(c.c)(Object(l.g)(Object(b.c)(Object(l.a)(Object(b.d)(Object(l.g)(n,40)),.03)),.04)),I=Object(c.c)(Object(b.f)(Object(p.c)(N),Object(p.f)(N))),Object(f.d)(Object(h.n)(Object(l.g)(Object(l.b)(Object(l.a)(Object(l.g)(Object(p.e)(t),Object(l.i)(Object(l.i)(1,Object(l.g)(I,2)),Object(l.g)(Object(p.b)(t),.7))),Object(l.i)(Object(h.m)(Object(l.a)(.5,Object(l.a)(Object(p.c)(w),Object(p.f)(w)))),Object(h.m)(I,I,Object(l.b)(I,2)))),1.6),j),1))]);let U,L,P,x,B;const C=(t=D)=>g(Object(s.c)([U=Object(c.d)("sampler2D","reflection"),L=Object(c.d)("float","reflectionStrength"),P=Object(c.d)("vec2","size"),v=Object(c.a)("vec3","vNormal"),E=Object(c.a)("vec3","vPos"),y=Object(c.a)("vec2","vUv"),Object(f.b)(()=>[x=Object(c.c)(Object(_.a)(U,Object(l.b)(Object(p.d)(g.gl_FragCoord),P))),Object(d.a)(x,Object(l.g)(x,L)),B=Object(c.c)(Object(b.e)(Object(p.a)(E,"xz"))),Object(d.a)(g.gl_FragColor,t(x,B,y))])]));const z="mirror-scene-ground";function G(t,e,n,u={}){const{width:s,height:c,scale:f=1,renderWithDistanceAlphaUniformName:d="withDistance",groundShaderColorFn:l,blurStrengh:h=20,blurRatioVertical:b=2,blurStrenghOffset:p=.3,reflectionStrength:_=1}=u,g=Object(r.f)(t,z).update(Object(o.b)(100,3)),m=i.a.create();i.a.scale(m,m,[f,f,f]);const v=i.a.create(),E=i.a.fromValues(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1),y=Object(r.j)(t,z).update({vert:F,frag:C(l)}),T=Object(r.k)(t,z).update({form:g,shade:y,uniforms:{transform:m,reflection:"0",size:()=>[s||t.canvas.width,c||t.canvas.height],reflectionStrength:_}}),M=Object(r.h)(t,z).update({sketches:n,uniforms:{view:()=>i.a.multiply(v,e.viewPort.camera.viewMat,E),projection:()=>e.viewPort.camera.projectionMat,[d]:1},drawSettings:{clearBits:t.gl.DEPTH_BUFFER_BIT|t.gl.COLOR_BUFFER_BIT}}),O=Object(r.h)(t,"scene").update({sketches:[T].concat(n),uniforms:{view:()=>e.viewPort.camera.viewMat,projection:()=>e.viewPort.camera.projectionMat,[d]:0},drawSettings:{clearBits:t.gl.DEPTH_BUFFER_BIT|t.gl.COLOR_BUFFER_BIT}}),A=Object(a.a)(t,"blur",{strength:h,strengthOffset:p,blurRatioVertical:b}),S=Object(r.g)(t,"main").update({layers:[M,A,O],width:s,height:c});return s||c||Object(r.a)(z,(t,e)=>{t===r.b.RESIZE&&S.update()}),S}},function(t,e,n){"use strict";n.d(e,"h",(function(){return u})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return f})),n.d(e,"k",(function(){return d})),n.d(e,"j",(function(){return l})),n.d(e,"i",(function(){return h})),n.d(e,"l",(function(){return b})),n.d(e,"a",(function(){return p})),n.d(e,"c",(function(){return _})),n.d(e,"d",(function(){return g})),n.d(e,"g",(function(){return m}));var r=n(5);n(20);const i=t=>e=>Object(r.a)(t,e.type,e),a=t=>(e,n)=>Object(r.a)(t,e.type,e,n),o=t=>(e,n,i)=>Object(r.a)(t,e.type,e,n,i),u=t=>Object(r.a)("normalize",t.type,t),s=t=>Object(r.a)("length","float",t),c=(t,e)=>Object(r.a)("dot","float",t,e),f=(a("min"),a("max")),d=(o("clamp"),a("step"),o("smoothstep")),l=(i("radians"),i("degrees"),i("cos"),i("sin"));i("tan"),i("acos"),i("asin");const h=a("pow"),b=(i("exp"),i("log"),i("exp2"),i("log2"),i("sqrt")),p=(i("inversesqrt"),i("abs")),_=(i("sign"),i("floor")),g=(i("ceil"),i("fract"));function m(t,e,n){const i=Object(r.a)("mix",t.type,t,e,n);return"float"===n.type&&(i.info="n"),i}},,,,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r}));const r=()=>"object"==typeof t&&"object"==typeof t.versions&&void 0!==t.versions.node}).call(this,n(42))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(35);const i=(t,e)=>(Object(r.a)("swizzle"!==t.tag||"sym"===t.val.tag,"can't assign to non-symbol swizzle"),{tag:"assign",type:t.type,l:t,r:e})},function(t,e,n){"use strict";function r(t,e){const n=t.type[0],r=(t,n)=>1===e.length?t:n+e.length;return{tag:"swizzle",type:"i"===n?r("int","ivec"):"u"===n?r("uint","uvec"):"b"===n?r("bool","bvec"):r("float","vec"),val:t,id:e}}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return c}));const i=t=>r(t,"x"),a=t=>r(t,"y"),o=t=>r(t,"z"),u=t=>r(t,"w");function s(t){return r(t,"xy")}function c(t){return r(t,"xyz")}},,,,,,function(t,e,n){t.exports=n(81)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(47),i=n(12),a=n(5),o=n(10);const u=t=>{const e=t.type[0],n=t.type.indexOf("Shadow")>0;return"s"===e?n?"float":"vec4":"i"===e?n?"int":"ivec4":"u"===e?n?"uint":"uvec4":Object(r.a)(`unknown sampler type ${t.type}`)},s=(t,e,n,r)=>{const s=Object(a.a)(t,u(e),e,n,r||o.a);return!Object(i.b)(s)&&(s.info="n"),s};function c(t,e,n){return s("texture",t,e,n)}},,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(8);const a=document.getElementById("canvas"),o=Object(r.i)(a),u=o.gl,s=Object(r.l)(),c=Object.assign({},r.b);var f=n(22),d=n(15),l=n(19),h=n(7),b=n(3),p=n(37);const _=Object(f.a)(l.b,.5,.5),g=Object(f.a)(l.a,.5,.5);const m=Object(b.h)((function(){return[Object(h.a)(),Object(h.a)(),Object(h.a)()]}),40),v=Object(l.c)([0,-9,0],[[-10,10,-10],[10,10,-10]]);function E(t,e){return function(t,e){const n=[];let r=t;for(let t=e;t>1;t--){const e=1/t+.5*(2*Math.random()-1)/t,i=1/t+.5*(2*Math.random()-1)/t,[a,o]=Object(l.b)(e,i,r);n.push(a),r=o}return n.push(r),n}(t,e).map(t=>Object(b.d)(function(t,e=1){for(let n=0;n<e;n++)t=Object(b.d)(t.map(t=>Object(b.d)(_(t).map(g))));return t}(g(t))))}const y=(()=>{const t=v,e=Object(l.d)([0,0,20],Object(l.f)(t)),n=Object(l.d)([-20,0,0],Object(l.f)(e)),r=Object(l.d)([0,0,-20],Object(l.f)(n));return[E(t,10),E(e,10),E(n,10),E(r,10)]})(),T=y.map(t=>Object(d.b)(t[1])),M=Object(r.f)(o,"wallsForm").update(Object(p.a)({position:Object(b.d)(Object(b.d)(y)),color:Object(b.d)(y.map((t,e)=>Object(b.d)(t.map((t,n)=>t.map(()=>m[10*e+n]))))),normal:Object(b.d)(y.map((t,e)=>Object(b.d)(t).map(()=>T[e]))),cells:Object(l.g)(320)}));var O=n(2);let A=0;const S=O.a.create(),R=O.b.create();Object(r.a)("state",(t,e)=>{t===c.FRAME&&(A+=e.device.tpf,O.b.fromEuler(R,1.1*Math.sin(7e-4*A),.001*A,1.1*Math.sin(8e-4*A)),O.a.fromRotationTranslationScaleOrigin(S,R,[0,-8,0],[.8,.8,.8],[0,60,0]))});var F=n(28),j=n(51);Object(F.a)({position:[0,3.4,25],fovy:.4*Math.PI,lookSpeed:2}),o.updateDrawSettings({enable:[u.DEPTH_TEST]});const w=Object(r.j)(o,"walls").update({vert:"#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\n\nuniform mat4 transform;\nuniform mat4 projection;\nuniform mat4 view;\n\nvarying vec3 vColor;\nvarying vec3 vNormal;\nvarying float vHeight;\n\nvoid main() {\n\tvNormal = normal;\n\tvec4 pos = transform * vec4(position, 1.0);\n\tvColor = color;\n\tvHeight = pos.y / 25.0;\n\tgl_Position = projection * view * pos;\n}\n",frag:"precision mediump float;\n#define GLSLIFY 1\n\nuniform float withDistance;\n\nvarying vec3 vColor;\nvarying vec3 vNormal;\nvarying float vHeight;\n\nvoid main() {\n\tif (withDistance > 0.0) {\n\t\tgl_FragColor = vec4(vColor, vHeight);\n\t} else {\n\t\tgl_FragColor = vec4(vColor, 1.0);\n\t}\n}\n"}),N=Object(r.k)(o,"walls").update({form:M,shade:w,uniforms:{transform:S}}),I=Object(j.a)(o,s,[N],{scale:.4,blurRatioVertical:2.5,blurStrenghOffset:2.5});Object(i.b)(t=>{Object(r.d)("device").tpf=t,Object(r.c)(c.FRAME),o.compose(I).display(I)},"loop")}]);
//# sourceMappingURL=main.js.map