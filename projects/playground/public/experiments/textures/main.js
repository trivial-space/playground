!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=43)}({0:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return a})),r.d(t,"d",(function(){return u}));const n="position",i="normal",s="uv",o="source",a="coords",u={FLOAT:5126,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FLOAT_MAT2X3:35685,FLOAT_MAT2X4:35686,FLOAT_MAT3X2:35687,FLOAT_MAT3X4:35688,FLOAT_MAT4X2:35689,FLOAT_MAT4X3:35690,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT:5125,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_3D:32879,TEXTURE_2D_ARRAY:35866,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042},f=6403,c=33319,l=6407,d=6408,h=6402,_=33321,p=33323,E=32849,g=32856,T=33325,y=33327,m=34843,A=34842,S=33332,b=33338,R=36215,F=36214,v=33334,N=33340,D=36209,I=36208,U=33189,L=33190,O=36012;u.UNSIGNED_BYTE,u.UNSIGNED_SHORT,u.UNSIGNED_INT,u.FLOAT},1:function(e,t,r){"use strict";r.d(t,"i",(function(){return ee})),r.d(t,"f",(function(){return re})),r.d(t,"j",(function(){return ie})),r.d(t,"k",(function(){return oe})),r.d(t,"h",(function(){return ue})),r.d(t,"g",(function(){return ce})),r.d(t,"e",(function(){return de})),r.d(t,"d",(function(){return _e})),r.d(t,"m",(function(){return pe})),r.d(t,"l",(function(){return Ee})),r.d(t,"a",(function(){return Te})),r.d(t,"c",(function(){return ye})),r.d(t,"b",(function(){return me}));var n=r(7);function i(e){function t(){e({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",t),t(),function(){window.removeEventListener("resize",t)}}var s=r(4);var o=r(0);const a="CLAMP_TO_EDGE",u="LINEAR",f="NEAREST";const c={renderQuad:{attribs:{[o.b]:{buffer:new Float32Array([-1,1,-1,-1,1,1,1,-1]),storeType:"STATIC"},[o.c]:{buffer:new Float32Array([0,1,0,0,1,1,1,0]),storeType:"STATIC"}},drawType:"TRIANGLE_STRIP",itemCount:4}},l={basicEffect:{vert:`\nattribute vec2 ${o.b};\nattribute vec2 ${o.c};\nvarying vec2 ${o.f};\nvoid main() {\n\t${o.f} = ${o.c};\n\tgl_Position = vec4(${o.b}, 0.0, 1.0);\n}`,frag:`precision mediump float;\nuniform sampler2D ${o.e};\nvarying vec2 ${o.f};\nvoid main() {\n\tgl_FragColor = texture2D(${o.e}, ${o.f});\n}`}};function d(e){return m[e].bindPoint}function h(e,t){return r=>{e.uniform1i(t,r)}}function _(e,t){return r=>{e.uniform1iv(t,r)}}function p(e,t){return r=>{e.uniform2iv(t,r)}}function E(e,t){return r=>{e.uniform3iv(t,r)}}function g(e,t){return r=>{e.uniform4iv(t,r)}}function T(e,t,r,n){const i=d(t);return t=>{e.uniform1i(n,r),e.activeTexture(e.TEXTURE0+r),e.bindTexture(i,t._texture)}}function y(e,t,r,n,i){const s=d(t),o=new Int32Array(i);for(let e=0;e<i;++e)o[e]=r+e;return t=>{e.uniform1iv(n,o);for(const r in t)e.activeTexture(e.TEXTURE0+o[r]),e.bindTexture(s,t[r]._texture)}}const m={[o.d.FLOAT]:{Type:Float32Array,size:4,setter:function(e,t){return r=>{e.uniform1f(t,r)}},arraySetter:function(e,t){return r=>{e.uniform1fv(t,r)}}},[o.d.FLOAT_VEC2]:{Type:Float32Array,size:8,setter:function(e,t){return r=>{e.uniform2fv(t,r)}}},[o.d.FLOAT_VEC3]:{Type:Float32Array,size:12,setter:function(e,t){return r=>{e.uniform3fv(t,r)}}},[o.d.FLOAT_VEC4]:{Type:Float32Array,size:16,setter:function(e,t){return r=>{e.uniform4fv(t,r)}}},[o.d.INT]:{Type:Int32Array,size:4,setter:h,arraySetter:_},[o.d.INT_VEC2]:{Type:Int32Array,size:8,setter:p},[o.d.INT_VEC3]:{Type:Int32Array,size:12,setter:E},[o.d.INT_VEC4]:{Type:Int32Array,size:16,setter:g},[o.d.UNSIGNED_INT]:{Type:Uint32Array,size:4,setter:function(e,t){return r=>{e.uniform1ui(t,r)}},arraySetter:function(e,t){return r=>{e.uniform1uiv(t,r)}}},[o.d.UNSIGNED_INT_VEC2]:{Type:Uint32Array,size:8,setter:function(e,t){return r=>{e.uniform2uiv(t,r)}}},[o.d.UNSIGNED_INT_VEC3]:{Type:Uint32Array,size:12,setter:function(e,t){return r=>{e.uniform3uiv(t,r)}}},[o.d.UNSIGNED_INT_VEC4]:{Type:Uint32Array,size:16,setter:function(e,t){return r=>{e.uniform4uiv(t,r)}}},[o.d.BOOL]:{Type:Uint32Array,size:4,setter:h,arraySetter:_},[o.d.BOOL_VEC2]:{Type:Uint32Array,size:8,setter:p},[o.d.BOOL_VEC3]:{Type:Uint32Array,size:12,setter:E},[o.d.BOOL_VEC4]:{Type:Uint32Array,size:16,setter:g},[o.d.FLOAT_MAT2]:{Type:Float32Array,size:16,setter:function(e,t){return r=>{e.uniformMatrix2fv(t,!1,r)}}},[o.d.FLOAT_MAT3]:{Type:Float32Array,size:36,setter:function(e,t){return r=>{e.uniformMatrix3fv(t,!1,r)}}},[o.d.FLOAT_MAT4]:{Type:Float32Array,size:64,setter:function(e,t){return r=>{e.uniformMatrix4fv(t,!1,r)}}},[o.d.FLOAT_MAT2X3]:{Type:Float32Array,size:24,setter:function(e,t){return r=>{e.uniformMatrix2x3fv(t,!1,r)}}},[o.d.FLOAT_MAT2X4]:{Type:Float32Array,size:32,setter:function(e,t){return r=>{e.uniformMatrix2x4fv(t,!1,r)}}},[o.d.FLOAT_MAT3X2]:{Type:Float32Array,size:24,setter:function(e,t){return r=>{e.uniformMatrix3x2fv(t,!1,r)}}},[o.d.FLOAT_MAT3X4]:{Type:Float32Array,size:48,setter:function(e,t){return r=>{e.uniformMatrix3x4fv(t,!1,r)}}},[o.d.FLOAT_MAT4X2]:{Type:Float32Array,size:32,setter:function(e,t){return r=>{e.uniformMatrix4x2fv(t,!1,r)}}},[o.d.FLOAT_MAT4X3]:{Type:Float32Array,size:48,setter:function(e,t){return r=>{e.uniformMatrix4x3fv(t,!1,r)}}},[o.d.SAMPLER_2D]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D},[o.d.SAMPLER_CUBE]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.SAMPLER_3D]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_3D},[o.d.SAMPLER_2D_SHADOW]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D},[o.d.SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.SAMPLER_2D_ARRAY_SHADOW]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.SAMPLER_CUBE_SHADOW]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.INT_SAMPLER_2D]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D},[o.d.INT_SAMPLER_3D]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_3D},[o.d.INT_SAMPLER_CUBE]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.INT_SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.UNSIGNED_INT_SAMPLER_2D]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D},[o.d.UNSIGNED_INT_SAMPLER_3D]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_3D},[o.d.UNSIGNED_INT_SAMPLER_CUBE]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.UNSIGNED_INT_SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:T,arraySetter:y,bindPoint:o.d.TEXTURE_2D_ARRAY}};function A(e,t,r){return n=>{e.bindBuffer(e.ARRAY_BUFFER,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.itemSize,o.d.FLOAT,n.normalize||!1,n.stride||0,n.offset||0)}}function S(e,t,r){return n=>{e.bindBuffer(e.ARRAY_BUFFER,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.itemSize,o.d.INT,n.stride||0,n.offset||0)}}function b(e,t,r){const n=r.size,i=r.count;return r=>{e.bindBuffer(e.ARRAY_BUFFER,r.buffer);const s=n,a=s/i,u=m[o.d.FLOAT].size*s,f=r.normalize||!1,c=r.offset||0,l=u/i;for(let r=0;r<i;++r)e.enableVertexAttribArray(t+r),e.vertexAttribPointer(t+r,a,o.d.FLOAT,f,u,c+l*r)}}const R={[o.d.FLOAT]:{size:4,setter:A,itemSize:1},[o.d.FLOAT_VEC2]:{size:8,setter:A,itemSize:2},[o.d.FLOAT_VEC3]:{size:12,setter:A,itemSize:3},[o.d.FLOAT_VEC4]:{size:16,setter:A,itemSize:4},[o.d.INT]:{size:4,setter:S,itemSize:1},[o.d.INT_VEC2]:{size:8,setter:S,itemSize:2},[o.d.INT_VEC3]:{size:12,setter:S,itemSize:3},[o.d.INT_VEC4]:{size:16,setter:S,itemSize:4},[o.d.UNSIGNED_INT]:{size:4,setter:S,itemSize:1},[o.d.UNSIGNED_INT_VEC2]:{size:8,setter:S,itemSize:2},[o.d.UNSIGNED_INT_VEC3]:{size:12,setter:S,itemSize:3},[o.d.UNSIGNED_INT_VEC4]:{size:16,setter:S,itemSize:4},[o.d.BOOL]:{size:4,setter:S,itemSize:1},[o.d.BOOL_VEC2]:{size:8,setter:S,itemSize:2},[o.d.BOOL_VEC3]:{size:12,setter:S,itemSize:3},[o.d.BOOL_VEC4]:{size:16,setter:S,itemSize:4},[o.d.FLOAT_MAT2]:{size:4,setter:b,count:2},[o.d.FLOAT_MAT3]:{size:9,setter:b,count:3},[o.d.FLOAT_MAT4]:{size:16,setter:b,count:4}};o.d.BYTE,Int8Array,o.d.UNSIGNED_BYTE,Uint8Array,o.d.SHORT,Int16Array,o.d.UNSIGNED_SHORT,Uint16Array,o.d.INT,Int32Array,o.d.UNSIGNED_INT,Uint32Array,o.d.FLOAT,Float32Array,o.d.UNSIGNED_SHORT_4_4_4_4,Uint16Array,o.d.UNSIGNED_SHORT_5_5_5_1,Uint16Array,o.d.UNSIGNED_SHORT_5_6_5,Uint16Array,o.d.HALF_FLOAT,Uint16Array,o.d.UNSIGNED_INT_2_10_10_10_REV,Uint32Array,o.d.UNSIGNED_INT_10F_11F_11F_REV,Uint32Array,o.d.UNSIGNED_INT_5_9_9_9_REV,Uint32Array,o.d.FLOAT_32_UNSIGNED_INT_24_8_REV,Uint32Array,o.d.UNSIGNED_INT_24_8,Uint32Array;function F(e,t){if(t.enable)for(const r of t.enable)e.enable(r);if(t.disable)for(const r of t.disable)e.disable(r);t.blendFunc&&e.blendFunc.apply(e,t.blendFunc),null!=t.depthFunc&&e.depthFunc(t.depthFunc),null!=t.cullFace&&e.cullFace(t.cullFace),null!=t.frontFace&&e.frontFace(t.frontFace),null!=t.lineWidth&&e.lineWidth(t.lineWidth),t.colorMask&&e.colorMask.apply(e,t.colorMask),null!=t.depthMask&&e.depthMask(t.depthMask),t.clearColor&&e.clearColor.apply(e,t.clearColor),null!=t.clearDepth&&e.clearDepth(t.clearDepth),null!=t.clearBits&&e.clear(t.clearBits)}function v(e,t){if(t.enable)for(const r of t.enable)e.disable(r);if(t.disable)for(const r of t.disable)e.enable(r)}let N=1;class D{constructor(e,t="Form"+N++){this._painter=e,this.id=t}update(e){const t=this._painter.gl;e.drawType&&(this._drawType=t[e.drawType]),e.itemCount&&(this._itemCount=e.itemCount),this._attribs=this._attribs||{};for(const r in e.attribs){const n=e.attribs[r];null==this._attribs[r]&&(this._attribs[r]={buffer:t.createBuffer()}),t.bindBuffer(t.ARRAY_BUFFER,this._attribs[r].buffer),t.bufferData(t.ARRAY_BUFFER,n.buffer,t[(n.storeType||"STATIC")+"_DRAW"])}if(e.elements){const r=e.elements.buffer;null==this._elements&&(this._elements={buffer:t.createBuffer(),glType:null}),this._elements.glType=function(e){if(e instanceof Int8Array)return o.d.BYTE;if(e instanceof Uint8Array)return o.d.UNSIGNED_BYTE;if(e instanceof Uint8ClampedArray)return o.d.UNSIGNED_BYTE;if(e instanceof Int16Array)return o.d.SHORT;if(e instanceof Uint16Array)return o.d.UNSIGNED_SHORT;if(e instanceof Int32Array)return o.d.INT;if(e instanceof Uint32Array)return o.d.UNSIGNED_INT;if(e instanceof Float32Array)return o.d.FLOAT;throw new Error("unsupported typed array type")}(r),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._elements.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t[(e.elements.storeType||"STATIC")+"_DRAW"])}return this}destroy(){const e=this._painter.gl;for(const t in this._attribs)e.deleteBuffer(this._attribs[t].buffer);this._attribs={},this._elements&&(e.deleteBuffer(this._elements.buffer),this._elements=void 0)}}var I=r(3),U=r(9);let L=1;class O{constructor(e,t="Texture"+L++){this._painter=e,this.id=t,this._texture=null,this._data={}}update(e){const t=this._painter.gl;if(null==this._texture&&(this._texture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,this._texture),e.wrap&&e.wrap!==this._data.wrap||e.wrapS&&e.wrapS!==this._data.wrapS||e.wrapT&&e.wrapT!==this._data.wrapT){let r,n;e.wrap?r=n=e.wrap:(n=e.wrapT||a,r=e.wrapS||a),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[r]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[n])}else this._data.wrap||this._data.wrapS||this._data.wrapT||(this._data.wrap=this._data.wrapT=this._data.wrapS=a,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this._data.wrap]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this._data.wrap]));return e.magFilter&&e.magFilter!==this._data.magFilter?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[e.magFilter]):this._data.magFilter||(this._data.magFilter=f,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this._data.magFilter])),e.minFilter&&e.minFilter!==this._data.minFilter?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[e.minFilter]):this._data.minFilter||(this._data.minFilter=u,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this._data.minFilter])),e.asset&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.asset),void 0!==e.data&&t.texImage2D(t.TEXTURE_2D,0,"FLOAT"===e.type&&this._painter.isWebGL2?t.RGBA32F:t.RGBA,e.width,e.height,0,t.RGBA,t[e.type||"UNSIGNED_BYTE"],e.data),null!=e.flipY&&e.flipY!==this._data.flipY&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),e.minFilter&&e.minFilter.indexOf("MIPMAP")>0&&t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null),Object.assign(this._data,e),this}destroy(){this._painter.gl.deleteTexture(this._texture),this._data={},this._texture=null}}let M=1;class w{constructor(e,t="Form"+M++){this._painter=e,this.id=t,this.width=0,this.height=0,this.antialias=!1,this.frameBuffer=null,this.antiAliasFrameBuffer=null,this.antiAliasRenderBuffer=null,this.textures=[],this.depthBuffer=null,this.bufferStructure=[],this._data={}}update(e){var t;const r=this._painter.gl,n=e.width||this.width,i=e.height||this.height;if(!n||!i)return this;if(n===this.width&&i===this.height){if(!e.bufferStructure)return this;if(e.bufferStructure.length===this.bufferStructure.length&&this.bufferStructure.every((t,r)=>Object(U.b)(t,e.bufferStructure[r])))return this}null==this.frameBuffer&&(this.frameBuffer=r.createFramebuffer()),null==this.depthBuffer&&(this.depthBuffer=r.createRenderbuffer()),e.bufferStructure&&e.bufferStructure.length&&(this.bufferStructure=e.bufferStructure,this.bufferStructure.some(e=>"FLOAT"===e.type)&&(this._painter.isWebGL2?r.getExtension("EXT_color_buffer_float"):r.getExtension("OES_texture_float")));const s=this.bufferStructure.length||1,o=[r.COLOR_ATTACHMENT0];if(r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),s>1){let e;this._painter.isWebGL2||(e=r.getExtension("WEBGL_draw_buffers"));const t=this._painter.isWebGL2?r.COLOR_ATTACHMENT0:e.COLOR_ATTACHMENT0_WEBGL;for(let e=0;e<s;e++)o[e]=t+e;this._painter.isWebGL2?r.drawBuffers(o):e.drawBuffersWEBGL(o)}if(this.antialias=1===s&&this._painter.isWebGL2&&(e.antialias||(null===(t=this._data)||void 0===t?void 0:t.antialias)),this.antialias){const e=r;null==this.antiAliasFrameBuffer&&(this.antiAliasFrameBuffer=r.createFramebuffer()),null==this.antiAliasRenderBuffer&&(this.antiAliasRenderBuffer=r.createRenderbuffer()),r.bindFramebuffer(r.FRAMEBUFFER,this.antiAliasFrameBuffer),r.bindRenderbuffer(r.RENDERBUFFER,this.antiAliasRenderBuffer),e.renderbufferStorageMultisample(r.RENDERBUFFER,Math.min(4,r.getParameter(e.MAX_SAMPLES)),e.RGBA8,n,i),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,this.antiAliasRenderBuffer),r.bindRenderbuffer(r.RENDERBUFFER,this.depthBuffer),e.renderbufferStorageMultisample(r.RENDERBUFFER,Math.min(4,r.getParameter(e.MAX_SAMPLES)),r.DEPTH_COMPONENT16,n,i),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.depthBuffer),r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer)}else r.bindRenderbuffer(r.RENDERBUFFER,this.depthBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,n,i),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.depthBuffer);for(let e=0;e<s;e++){this.textures[e]||(this.textures[e]=new O(this._painter,this.id+"_Texture"+e));const t=this.textures[e];t.update(Object.assign(Object.assign({minFilter:"NEAREST",magFilter:"NEAREST"},this.bufferStructure[e]),{data:null,width:n,height:i})),r.framebufferTexture2D(r.FRAMEBUFFER,o[e],r.TEXTURE_2D,t._texture,0)}if(this.antialias){r.bindFramebuffer(r.FRAMEBUFFER,this.antiAliasFrameBuffer);const t=r.checkFramebufferStatus(r.FRAMEBUFFER);t!==r.FRAMEBUFFER_COMPLETE&&console.error("antialias framebuffer error",t,e),r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer)}const a=r.checkFramebufferStatus(r.FRAMEBUFFER);return a!==r.FRAMEBUFFER_COMPLETE&&console.error("framebuffer error",a,e),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),Object.assign(this._data,e),this.width=n,this.height=i,this}destroy(){const e=this._painter.gl;e.deleteFramebuffer(this.frameBuffer),e.deleteRenderbuffer(this.depthBuffer);for(const t of this.textures)e.deleteTexture(t);this.antiAliasFrameBuffer&&e.deleteFramebuffer(this.antiAliasFrameBuffer),this.antiAliasRenderBuffer&&e.deleteRenderbuffer(this.antiAliasRenderBuffer),this.textures=[],this.frameBuffer=null,this.depthBuffer=null,this._data={},this.bufferStructure=[],this.width=0,this.height=0}}let P=1;class B{constructor(e,t="Frame"+P++){this._painter=e,this.id=t,this.width=0,this.height=0,this.layers=[],this._data={},this._targets=[],this._textures=[]}image(e=0){return this._targets.length&&this._targets[this._targets.length-1].textures[e]||this._textures[e]}update(e={}){const t=this._painter.gl,r=Array.isArray(e.layers)?e.layers:e.layers?[e.layers]:this.layers,n=e.selfReferencing||this._data.selfReferencing,i=r.reduce((e,t)=>e+(t._uniforms.length||1),0),s=n||i>1?2:i,o=e.width||this._data.width||t.drawingBufferWidth,a=e.height||this._data.height||t.drawingBufferHeight,u=e.antialias||this._data.antialias||!0;s!==this._targets.length&&this._destroyTargets();const f=Object.assign(Object.assign({},e),{width:o,height:a,antialias:u});return!this._targets.length&&s>0?this._targets=Object(I.g)(e=>new w(this._painter,this.id+"_target"+(e+1)).update(f),s):this._targets.length&&this._targets.forEach(e=>{e.update(f)}),e.texture&&(this._textures[0]||(this._textures[0]=new O(this._painter,this.id+"_Texture0")),e.texture.width=e.texture.width||o,e.texture.height=e.texture.height||a,this._textures[0].update(e.texture)),Object.assign(this._data,e),this.layers=r,this.width=o,this.height=a,this}destroy(){this._destroyTargets(),this._textures.forEach(e=>e.destroy()),this._textures=[],this._data={},this.layers=[],this.width=0,this.height=0}_destroyTargets(){this._targets.forEach(e=>e.destroy()),this._targets=[]}_swapTargets(){if(this._targets.length>1){const e=this._targets[0];this._targets[0]=this._targets[1],this._targets[1]=e}}}let C=1;class x{constructor(e="DrawingLayer"+C++){this.id=e,this.sketches=[],this._data={},this._uniforms=[]}update(e){if(e.sketches&&(this.sketches=Array.isArray(e.sketches)?e.sketches:[e.sketches]),e.frag){const t=this.sketches&&this.sketches[0];t&&t.shade.update({frag:e.frag})}return e.uniforms&&(this._uniforms=Array.isArray(e.uniforms)?e.uniforms:[e.uniforms]),Object.assign(this._data,e),this}destroy(){for(const e of this.sketches)e.destroy();this._data.sketches=[],this._data={},this._uniforms=[]}}let z=1;class G{constructor(e,t="Shade"+z++){this._painter=e,this.id=t}update(e){const t=this._painter.gl,r=e.frag&&e.frag.trim()||this.fragSource,n=e.vert&&e.vert.trim()||this.vertSource;if(!r||!n||r===this.fragSource&&n===this.vertSource)return this;this.destroy(),r.indexOf("GL_EXT_draw_buffers")>=0&&t.getExtension("WEBGL_draw_buffers");const i=t.createProgram(),s=t.createShader(t.FRAGMENT_SHADER),o=t.createShader(t.VERTEX_SHADER);if(i&&o&&s){if(this._program=i,this._frag=s,this._vert=o,t.attachShader(i,o),t.attachShader(i,s),t.shaderSource(o,n),t.shaderSource(s,r),t.compileShader(o),t.compileShader(s),t.getShaderParameter(o,t.COMPILE_STATUS)||console.error("Error Compiling Vertex Shader!\n",t.getShaderInfoLog(o),k(n)),t.getShaderParameter(s,t.COMPILE_STATUS)||console.error("Error Compiling Fragment Shader!\n",t.getShaderInfoLog(s),k(r)),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){const e=t.getProgramInfoLog(i);console.error("Error in program linking:",e)}return this._uniformSetters=function(e,t){let r=0;function n(t,n){const i=e.getUniformLocation(t,n.name),s=n.size>1&&"[0]"===n.name.substr(-3),o=n.type,a=m[o];if(!a)throw new Error("unknown type: 0x"+o.toString(16));if(null==i)return;let u;if(null===a.Type){const t=r;r+=n.size,u=s?a.arraySetter(e,o,t,i,n.size):a.setter(e,o,t,i)}else u=a.arraySetter&&s?a.arraySetter(e,i):a.setter(e,i);return{setter:u,location:i}}const i={},s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<s;++r){const s=e.getActiveUniform(t,r);if(!s)continue;let o=s.name;if("[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3)),t){const e=n(t,s);e&&(i[o]=e)}}return i}(t,i),this._attributeSetters=function(e,t){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const n=e.getActiveAttrib(t,i);if(!n)break;const s=e.getAttribLocation(t,n.name),o=R[n.type],a=o.setter(e,s,o);r[n.name]={setter:a,location:s}}return r}(t,i),this.fragSource=r,this.vertSource=n,this}}destroy(){const e=this._painter.gl;e.deleteProgram(this._program),e.deleteShader(this._frag),e.deleteShader(this._vert),this.vertSource=void 0,this.fragSource=void 0,this._attributeSetters={},this._uniformSetters={}}}function k(e){return e.trim().split("\n").map((e,t)=>t+1+": "+e).join("\n")}let $=1;class j{constructor(e="Sketch"+$++){this.id=e,this._uniforms=[]}update(e){return e.drawSettings&&(this._drawSettings=e.drawSettings),e.form&&(this.form=e.form),e.shade&&(this.shade=e.shade),e.uniforms&&(this._uniforms=Array.isArray(e.uniforms)?e.uniforms:[e.uniforms]),this}destroy(){this.form&&this.form.destroy(),this.shade&&this.shade.destroy(),this._drawSettings=void 0,this._uniforms=[]}}var X=r(10);class V{constructor(e,t={}){this.canvas=e,this.isWebGL2=!0,this.maxBufferSamples=0;let r=null;if(t.useWebGL1||(r=e.getContext("webgl2",t)||e.getContext("experimental-webgl2",t)),null==r&&(this.isWebGL2=!1,r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)),null==r)throw Error("Cannot initialize WebGL.");this.gl=r,this.sizeMultiplier=t.sizeMultiplier||1,this.isWebGL2&&(this.maxBufferSamples=r.getParameter(r.MAX_SAMPLES)),this.resize(),F(r,function(e){return{clearColor:[0,0,0,1],blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA]}}(r)),this._renderQuad=this.createForm().update(c.renderQuad),this._staticSketch=this.createFlatSketch()}resize(){return Object(X.b)(this.gl.canvas,this.sizeMultiplier),this}destroy(){this._staticSketch.destroy(),this._renderQuad.destroy()}updateDrawSettings(e){return F(this.gl,Object.assign({},e)),this}createForm(e){return new D(this,e)}createShade(e){return new G(this,e)}createSketch(e){return new j(e)}createFlatSketch(e){const t=this.createSketch(e);return t.update({form:this._renderQuad,shade:this.createShade(t.id+"_defaultShade").update(l.basicEffect)})}createFrame(e){return new B(this,e)}createLayer(e){return new x(e)}createEffect(e){const t=this.createLayer(e);return t.update({sketches:this.createFlatSketch(t.id+"_effectSketch")})}draw(e,t){const r=this.gl;return r.bindFramebuffer(r.FRAMEBUFFER,null),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),H(r,e,t),this}compose(...e){for(const t of e)K(this.gl,t);return this}display(e,t=0){return this.draw(this._staticSketch,{source:e.image(t)})}}function H(e,t,r,n){const{shade:i,form:s,_drawSettings:o,_uniforms:a}=t;if(!i||!s)throw Error("cannot draw, shader or geometry are not set");e.useProgram(i._program),function(e,t){for(const r in t._attribs){const n=e._attributeSetters[r];n&&n.setter(t._attribs[r])}}(i,s),r&&Y(i,r,n),o&&F(e,o);for(let r=0;r<(a.length||1);r++)W(e,t,a[r],n);o&&v(e,o)}function W(e,t,r,n){r&&Y(t.shade,r,n),t.form._elements&&null!=t.form._elements.glType?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.form._elements.buffer),e.drawElements(t.form._drawType,t.form._itemCount,t.form._elements.glType,0)):e.drawArrays(t.form._drawType,0,t.form._itemCount)}function Y(e,t,r){for(const n in t){const i=e._uniformSetters[n];if(i){let e=t[n];"function"==typeof e&&(e=e()),"string"==typeof e&&r?i.setter(r[e]):i.setter(e)}}}function q(e,t,r,n,i){n?(e.bindFramebuffer(e.FRAMEBUFFER,n.antialias?n.antiAliasFrameBuffer:n.frameBuffer),e.viewport(0,0,n.width,n.height)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight)),t._data.drawSettings&&F(e,t._data.drawSettings);for(const n of t.sketches)H(e,n,r,i);if(n&&n.antialias){const t=e;e.bindFramebuffer(t.READ_FRAMEBUFFER,n.antiAliasFrameBuffer),e.bindFramebuffer(t.DRAW_FRAMEBUFFER,n.frameBuffer),t.clearBufferfv(t.COLOR,0,[1,1,1,1]),t.blitFramebuffer(0,0,n.width,n.height,0,0,n.width,n.height,e.COLOR_BUFFER_BIT,e.LINEAR)}t._data.drawSettings&&v(e,t._data.drawSettings)}function K(e,t){for(let r=0;r<t.layers.length;r++){const n=t.layers[r],i=n._uniforms.length||1;for(let s=0;s<i;s++){const i=t._targets[0],o=r+s===0&&t._textures.length?t._textures:t._targets[1]&&t._targets[1].textures;q(e,n,n._uniforms[s],i,o),t._swapTargets()}}}var Q=r(8);let Z,J;function ee(e,t){return function(e,t){e!==Z&&(Z=e,J=new V(e,t),he.device.canvas=e,Ae&&Ae(),Se&&Se(),be&&be(),Ae=i(()=>Object(n.a)(()=>{J.sizeMultiplier=he.device.sizeMultiplier,J.resize(),ye(me.RESIZE)},"resize")),Se=Object(Q.b)({element:e,enableRightButton:!0,holdRadius:7,holdDelay:200},e=>he.device.pointer=e),be=Object(s.b)(e=>he.device.keys=e))}(e,t),J}const te={};function re(e,t){return te[t]||(te[t]=e.createForm("Form_"+t))}const ne={};function ie(e,t){return ne[t]||(ne[t]=e.createShade("Shade_"+t))}const se={};function oe(e,t){return se[t]||(se[t]=e.createSketch("Sketch_"+t))}const ae={};function ue(e,t){return ae[t]||(ae[t]=e.createLayer("Layer_"+t))}const fe={};function ce(e,t){return fe[t]||(fe[t]=e.createFrame("Frame_"+t))}const le={};function de(e,t){return le[t]||(le[t]=e.createEffect("Effect_"+t))}const he={device:{tpf:0,sizeMultiplier:1}};function _e(e){return he[e]}function pe(e,t,r){const n=he;if(n[e]){const i=r&&r.reset;!0!==i&&(t=function e(t,r,n){const i=n&&n.ignore;if("object"==typeof t&&"object"==typeof r&&!Array.isArray(t)&&!Array.isArray(r)&&t!==r){for(const n in t)if(t.hasOwnProperty(n)&&(!i||!(n in i)||!0!==i[n])){const s=t[n],o=r[n];void 0!==o&&(t[n]=e(s,o,{ignore:i&&i[n]}))}return t}return r}(t,n[e],{ignore:i}))}n[e]=t}function Ee(){return he}window.state=he;const ge={};function Te(e,t){ge[e]=t}function ye(e){for(const t in ge)ge[t](e,he)}const me={FRAME:"frame",RESIZE:"resize"};let Ae,Se,be},10:function(e,t,r){"use strict";function n(e,...t){return t.reduce((t,r)=>t|e[r.toUpperCase()+"_BUFFER_BIT"],0)}function i(e,t=1){let r=e.width,n=e.height;return"clientWidth"in e&&"clientHeight"in e&&(r=e.clientWidth*t|0,n=e.clientHeight*t|0),(e.width!==r||e.height!==n)&&(e.width=r,e.height=n,!0)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},3:function(e,t,r){"use strict";r.d(t,"f",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"g",(function(){return o})),r.d(t,"h",(function(){return a})),r.d(t,"c",(function(){return u})),r.d(t,"e",(function(){return f})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r(6);function i(e){return e[Object(n.b)(e.length)]}function s(e,t){for(let r=0;r<t;r++)e(r)}function o(e,t,r=[]){for(let n=0;n<t;n++)r[n]=e(n);return r}function a(e,t,r,n=[]){const i=Math.min(t.length,r.length);for(let s=0;s<i;s++)n[s]=e(t[s],r[s]);return n}function u(e,t=[]){for(const r of e){const e=t.length;for(let n=0;n<r.length;n++)t[n+e]=r[n]}return t}function f(e,t,r=[]){return u(t.map(e),r)}function c(e,t){if(Array.isArray(t))return t.map(e);{const r={};for(const n in t)r[n]=e(t[n],n);return r}}function l(e,t){for(const r in t)e(t[r],r)}},31:function(e,t){var r,n,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,f=[],c=!1,l=-1;function d(){c&&u&&(c=!1,u.length?f=u.concat(f):l=-1,f.length&&h())}function h(){if(!c){var e=a(d);c=!0;for(var t=f.length;t;){for(u=f,f=[];++l<t;)u&&u[l].run();l=-1,t=f.length}u=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new _(e,t)),1!==f.length||c||a(h)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},33:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i}));const n=Symbol(),i=()=>{}},4:function(e,t,r){"use strict";var n;function i(e,t){const r=t||e,{element:n=window}=e,i={};function s(e){i[e.keyCode]=Date.now(),r(i)}function o(e){delete i[e.keyCode],r(i)}return n.addEventListener("keyup",o,!1),n.addEventListener("keydown",s,!1),r(i),function(){n.removeEventListener("keyup",o),n.removeEventListener("keydown",s)}}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),function(e){e[e.CANCEL=3]="CANCEL",e[e.HELP=6]="HELP",e[e.BACK_SPACE=8]="BACK_SPACE",e[e.TAB=9]="TAB",e[e.CLEAR=12]="CLEAR",e[e.RETURN=13]="RETURN",e[e.ENTER=14]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CONTROL=17]="CONTROL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PRINTSCREEN=44]="PRINTSCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_1=49]="DIGIT_1",e[e.DIGIT_2=50]="DIGIT_2",e[e.DIGIT_3=51]="DIGIT_3",e[e.DIGIT_4=52]="DIGIT_4",e[e.DIGIT_5=53]="DIGIT_5",e[e.DIGIT_6=54]="DIGIT_6",e[e.DIGIT_7=55]="DIGIT_7",e[e.DIGIT_8=56]="DIGIT_8",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.EQUALS=61]="EQUALS",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUMPAD0=96]="NUMPAD0",e[e.NUMPAD1=97]="NUMPAD1",e[e.NUMPAD2=98]="NUMPAD2",e[e.NUMPAD3=99]="NUMPAD3",e[e.NUMPAD4=100]="NUMPAD4",e[e.NUMPAD5=101]="NUMPAD5",e[e.NUMPAD6=102]="NUMPAD6",e[e.NUMPAD7=103]="NUMPAD7",e[e.NUMPAD8=104]="NUMPAD8",e[e.NUMPAD9=105]="NUMPAD9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SEPARATOR=108]="SEPARATOR",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.F13=124]="F13",e[e.F14=125]="F14",e[e.F15=126]="F15",e[e.F16=127]="F16",e[e.F17=128]="F17",e[e.F18=129]="F18",e[e.F19=130]="F19",e[e.F20=131]="F20",e[e.F21=132]="F21",e[e.F22=133]="F22",e[e.F23=134]="F23",e[e.F24=135]="F24",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.BACK_QUOTE=192]="BACK_QUOTE",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.QUOTE=222]="QUOTE",e[e.META=224]="META"}(n||(n={}))},43:function(e,t,r){e.exports=r(47)},44:function(e,t){},47:function(e,t,r){"use strict";r.r(t),r.d(t,"noise",(function(){return Yt})),r.d(t,"toNormal",(function(){return qt}));var n=r(1);const i=document.getElementById("canvas"),s=Object(n.i)(i),o=(s.gl,Object.assign({},n.b));var a=r(61);const u=e=>"string"==typeof e;let f=0;const c=()=>`_s${(f++).toString(36)}`,l=Array.isArray;function d(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}var h=r(33);Object.getPrototypeOf;const _=Object.getPrototypeOf({}),p="function",E=(e,t)=>{let r;return e===t||(null==e?e==t:typeof e.equiv===p?e.equiv(t):null==t?e==t:typeof t.equiv===p?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(r=Object.getPrototypeOf(e),null!=r&&r!==_||(r=Object.getPrototypeOf(t),null!=r&&r!==_)?typeof e!==p&&void 0!==e.length&&typeof t!==p&&void 0!==t.length?g(e,t):e instanceof Set&&t instanceof Set?T(e,t):e instanceof Map&&t instanceof Map?y(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:m(e,t)))},g=(e,t,r=E)=>{let n=e.length;if(n===t.length)for(;--n>=0&&r(e[n],t[n]););return n<0},T=(e,t,r=E)=>e.size===t.size&&r([...e.keys()].sort(),[...t.keys()].sort()),y=(e,t,r=E)=>e.size===t.size&&r([...e].sort(),[...t].sort()),m=(e,t,r=E)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!t.hasOwnProperty(n)||!r(e[n],t[n]))return!1;return!0};function A(e,t){for(let r of t)e.delete(r);return e}var S=r(62);const b=(e,t)=>[e[0],e[1],t],R=(e,t)=>null!=e&&"function"==typeof e[t],F=e=>R(e,"xform")?e.xform():e;class v{constructor(e){this.value=e}deref(){return this.value}}const N=e=>e instanceof v,D=e=>e instanceof v?e.deref():e,I=(e,t=(e=>void 0!==e?": "+e:""))=>class extends Error{constructor(r){super(e(r)+t(r))}},U=I(()=>"illegal arity"),L=e=>2===e.length?[void 0,e[1]]:3===e.length?[e[1],e[2]]:(e=>{throw new U(e)})(e.length);function O(...e){const t=e[0],r=t[0],n=t[1],i=t[2],s=null==(e=L(e))[0]?r():e[0],o=e[1];return D(n(R(o,"$reduce")?o.$reduce(i,s):null!=(a=o)&&"function"!=typeof a&&void 0!==a.length?M(i,s,o):w(i,s,o)));var a}const M=(e,t,r)=>{for(let n=0,i=r.length;n<i;n++)if(t=e(t,r[n]),N(t)){t=t.deref();break}return t},w=(e,t,r)=>{for(let n of r)if(t=e(t,n),N(t)){t=t.deref();break}return t},P=(e,t)=>[e,e=>e,t];function*B(e,t){const r=F(e)([h.a,h.a,(e,t)=>t])[2];for(let e of t){let t=r(h.b,e);if(N(t))return t=D(t.deref()),void(t!==h.b&&(yield t));t!==h.b&&(yield t)}}function C(e,t){return t?B(C(e),t):t=>{const r=t[2];return b(t,(t,n)=>r(t,e(n)))}}const x=Object(S.a)()?r(44).inspect:null,z=(e,t)=>[...C(e=>x(e,t),e)].join(", "),G=(e,t)=>[...C(([e,r])=>`${x(e,t)} => ${x(r,t)}`,e)].join(", "),k=((e,t={})=>{const r=Reflect.ownKeys(e),n=Reflect.ownKeys(t),i=Symbol("isa");function s(t){for(let n of r){const r=Object.getOwnPropertyDescriptor(t.prototype,n);!r||r.configurable?Object.defineProperty(t.prototype,n,{value:e[n],writable:!0}):console.log(`not patching: ${t.name}.${n.toString()}`)}return Object.defineProperty(t.prototype,i,{value:!0}),t}for(let e of n)Object.defineProperty(s,e,{value:t[e],enumerable:t.propertyIsEnumerable(e)});return Object.defineProperty(s,Symbol.hasInstance,{value:e=>!!e[i]}),s})({[Symbol.for("nodejs.util.inspect.custom")](e,t){const r=this[Symbol.toStringTag],n=Object.assign(Object.assign({},t),{depth:null===t.depth?null:t.depth-1});return e>=0?[`${r}(${this.size||0}) {`,x?this instanceof Set?z(this,n):this instanceof Map?G(this,n):"":"","}"].join(" "):t.stylize(`[${r}]`,"special")}}),$=e=>e instanceof Map;function j(e,t){if($(e))for(let r of t)e.set(r[0],r[1]);else for(let r of t)e.add(r);return e}var X;const V=new WeakMap,H=e=>V.get(e).vals;let W=X=class extends Set{constructor(e,t={}){super(),V.set(this,{equiv:t.equiv||E,vals:[]}),e&&this.into(e)}*[Symbol.iterator](){yield*H(this)}get[Symbol.species](){return X}get[Symbol.toStringTag](){return"ArraySet"}get size(){return H(this).length}copy(){const e=V.get(this),t=new X(null,{equiv:e.equiv});return V.get(t).vals=e.vals.slice(),t}empty(){return new X(null,this.opts())}clear(){H(this).length=0}first(){if(this.size)return H(this)[0]}add(e){return!this.has(e)&&H(this).push(e),this}into(e){return j(this,e)}has(e){return this.get(e,h.b)!==h.b}get(e,t){const r=V.get(this),n=r.equiv,i=r.vals;for(let t=i.length;--t>=0;)if(n(i[t],e))return i[t];return t}delete(e){const t=V.get(this),r=t.equiv,n=t.vals;for(let t=n.length;--t>=0;)if(r(n[t],e))return n.splice(t,1),!0;return!1}disj(e){return A(this,e)}equiv(e){return((e,t)=>{if(e===t)return!0;if(!(t instanceof Set)||e.size!==t.size)return!1;for(let r of e.keys())if(!t.has(r))return!1;return!0})(this,e)}forEach(e,t){const r=H(this);for(let n=r.length;--n>=0;){const i=r[n];e.call(t,i,i,this)}}*entries(){for(let e of H(this))yield[e,e]}*keys(){yield*H(this)}*values(){yield*H(this)}opts(){return{equiv:V.get(this).equiv}}};W=X=d([k],W);var Y;const q=new WeakMap,K=e=>q.get(e).map;let Q=Y=class extends Map{constructor(e,t){super();const r=Object.assign({equiv:E,keys:W},t);q.set(this,{keys:new r.keys(null,{equiv:r.equiv}),map:new Map,opts:r}),e&&this.into(e)}[Symbol.iterator](){return this.entries()}get[Symbol.species](){return Y}get[Symbol.toStringTag](){return"EquivMap"}get size(){return q.get(this).keys.size}clear(){const e=q.get(this);e.keys.clear(),e.map.clear()}empty(){return new Y(null,q.get(this).opts)}copy(){const e=q.get(this),t=new Y;return q.set(t,{keys:e.keys.copy(),map:new Map(e.map),opts:e.opts}),t}equiv(e){return((e,t)=>{if(e===t)return!0;if(!(t instanceof Map)||e.size!==t.size)return!1;for(let r of e.entries())if(!E(t.get(r[0]),r[1]))return!1;return!0})(this,e)}delete(e){const t=q.get(this);return(e=t.keys.get(e,h.b))!==h.b&&(t.map.delete(e),t.keys.delete(e),!0)}dissoc(e){return A(this,e)}forEach(e,t){for(let r of K(this))e.call(t,r[1],r[0],this)}get(e,t){const r=q.get(this);return(e=r.keys.get(e,h.b))!==h.b?r.map.get(e):t}has(e){return q.get(this).keys.has(e)}set(e,t){const r=q.get(this),n=r.keys.get(e,h.b);return n!==h.b?r.map.set(n,t):(r.keys.add(e),r.map.set(e,t)),this}into(e){return j(this,e)}entries(){return K(this).entries()}keys(){return K(this).keys()}values(){return K(this).values()}opts(){return q.get(this).opts}};Q=Y=d([k],Q);const Z=(e,t,r)=>{if(e.size<t.size){const r=e;e=t,t=r}var n,i;return r=r?j(r,e):(n=e,i=Set,R(n,"copy")?n.copy():new(n[Symbol.species]||i)(n)),e===t?r:j(r,t)};const J=I(()=>"illegal argument(s)"),ee=e=>{throw new J(e)};function te(e,t){return t?B(te(e),t):t=>{const r=t[2];return b(t,(t,n)=>e(n)?r(t,n):t)}}class re{constructor(e){if(this.dependencies=new Q,this.dependents=new Q,e)for(let[t,r]of e)this.addDependency(t,r)}*[Symbol.iterator](){yield*this.sort()}get[Symbol.species](){return re}copy(){const e=new re;for(let t of this.dependencies)e.dependencies.set(t[0],t[1].copy());for(let t of this.dependents)e.dependents.set(t[0],t[1].copy());return e}addNode(e){return!this.dependencies.has(e)&&this.dependencies.set(e,new W),this}addDependency(e,t){(E(e,t)||this.depends(t,e))&&ee(`Circular dependency between: ${e} & ${t}`);let r=this.dependencies.get(e);return this.dependencies.set(e,r?r.add(t):new W([t])),r=this.dependents.get(t),this.dependents.set(t,r?r.add(e):new W([e])),this}addDependencies(e,t){for(let r of t)this.addDependency(e,r)}removeEdge(e,t){let r=this.dependencies.get(e);return r&&r.delete(t),r=this.dependents.get(t),r&&r.delete(e),this}removeNode(e){return this.dependencies.delete(e),this}depends(e,t){return this.transitiveDependencies(e).has(t)}dependent(e,t){return this.transitiveDependents(e).has(t)}immediateDependencies(e){return this.dependencies.get(e)||new W}immediateDependents(e){return this.dependents.get(e)||new W}isLeaf(e){return 0===this.immediateDependents(e).size}isRoot(e){return 0===this.immediateDependencies(e).size}nodes(){return Z(new W(this.dependencies.keys()),new W(this.dependents.keys()))}leaves(){return te(e=>this.isLeaf(e),this.nodes())}roots(){return te(e=>this.isRoot(e),this.nodes())}transitiveDependencies(e){return ne(this.dependencies,e)}transitiveDependents(e){return ne(this.dependents,e)}sort(){const e=[],t=this.copy();let r=new W(t.leaves());for(;;){if(!r.size)return e.reverse();const n=r.first();r.delete(n);for(let e of[...t.immediateDependencies(n)])t.removeEdge(n,e),t.isLeaf(e)&&r.add(e);e.push(n),t.removeNode(n)}}}const ne=(e,t)=>{const r=e.get(t);return r?O(P(null,(t,r)=>Z(t,ne(e,r))),r,r):new W},ie=/^[iub]?vec[234]$/,se=/^mat[234]$/,oe=e=>ie.test(e.type),ae=e=>se.test(e.type),ue=e=>"fn"===e.tag||"for"===e.tag||"while"==e.tag?e.scope.body:"if"===e.tag?e.f?e.t.body.concat(e.f.body):e.t.body:void 0,fe=e=>ue(e)||("scope"===e.tag?e.body:"ternary"===e.tag?[e.t,e.f]:"ret"===e.tag?[e.val]:"call"===e.tag||"call_i"===e.tag?e.args:"sym"===e.tag&&e.init?[e.init]:"decl"===e.tag?[e.id]:"op1"===e.tag||"swizzle"===e.tag?[e.val]:"op2"===e.tag?[e.l,e.r]:"assign"===e.tag?[e.r]:oe(e)||ae(e)?e.val:void 0),ce=(e,t,r,n,i=!0)=>{if(l(n))n.forEach(n=>r=ce(e,t,r,n,i));else{i&&(r=e(r,n));const s=t(n);s&&(r=ce(e,t,r,s,i)),!i&&(r=e(r,n))}return r},le=(e,t=new re)=>e.deps&&e.deps.length?e.deps.reduce((t,r)=>le(r,t.addDependency(e,r)),t):t.addNode(e),de=e=>({tag:"decl",type:e.type,id:e}),he=(e,t=!1)=>({tag:"scope",type:"void",body:e.filter(e=>null!=e).map(e=>"sym"===e.tag?de(e):e),global:t});function _e(e,...t){let r,n,i;switch(t.length){case 0:u(e)||(i=e,e=i.type);break;case 1:u(t[0])?r=t[0]:t[0].tag?i=t[0]:n=t[0];break;case 2:u(t[0])?[r,n]=t:[n,i]=t;break;case 3:[r,n,i]=t;break;default:ee()}return{tag:"sym",type:e,id:r||c(),opts:n||{},init:i}}const pe=(e,t,r)=>_e(e,t,Object.assign({q:"in",type:"uni"},r)),Ee=e=>{const[t,r,n]=u(e)?[e]:e;return{tag:"arg",type:t,id:r||c(),opts:Object.assign({q:"in"},n)}};function ge(e,t,r,n){const i=r.map(Ee),s=n(...i.map(e=>_e(e.type,e.id,e.opts))).filter(e=>null!=e),o=ce((r,n)=>("ret"===n.tag&&(Object(a.a)(n.type===e,`wrong return type for function '${t}', expected ${e}, got ${n.type}`),r++),r),ue,0,s);if("void"!==e&&!o)throw new Error(`function '${t}' must return a value of type ${e}`);const f=ce((e,t)=>("call"===t.tag&&t.fn&&e.push(t.fn),e),fe,[],s),c=(...e)=>function(e,...t){return u(e)?{tag:"call",type:t[0],id:e,args:t.slice(1)}:{tag:"call",type:e.type,id:e.id,args:t,fn:e}}(c,...e);return Object.assign(c,{tag:"fn",type:e,id:t,args:i,deps:f,scope:he(s)})}function Te(e){return{tag:"ret",type:e?e.type:"void",val:e}}const ye=(e,t,...r)=>({tag:"call_i",type:t,id:e,args:r}),me=e=>"number"==typeof e,Ae=e=>"boolean"==typeof e,Se=(e,t,r)=>({tag:"lit",type:e,info:r,val:t}),be=e=>Se("bool",me(e)?!!e:e),Re=e=>Se("float",Ae(e)?1&e:e),Fe=e=>Se("int",Ae(e)?1&e:me(e)?0|e:e),ve=e=>Se("uint",Ae(e)?1&e:me(e)?e>>>0:e),Ne=(e,t)=>r=>me(r)?t(r):void 0===r||oe(r)||r.type===e?r:t(r),De=Ne("float",Re),Ie=Ne("int",Fe),Ue=Ne("uint",ve),Le=Ne("bool",be),Oe=(Se("bool",!0),Se("bool",!1)),Me=Re(0),we=Re(1),Pe=Re(2),Be=Re(.5),Ce=Fe(0),xe=(Fe(1),ve(0)),ze=(ve(1),Re(Math.PI),Re(2*Math.PI),Re(Math.PI/2),Re(Math.SQRT2),(e,t)=>r=>[void 0===r[0]?t:e(r[0]),...r.slice(1).map(e)]),Ge=ze(De,Me),ke=(ze(Ie,Ce),ze(Ue,xe),ze(Le,Oe),(e,t,r)=>Se(e,r=t(r),["n","n"][r.length])),$e=(e,t,r)=>Se(e,r=t(r),["n","n","vn"][r.length]),je=(e,t,r)=>Se(e,r=t(r),2===r.length?oe(r[1])?"vv":"vn":["n","n",,"vnn"][r.length]);function Xe(...e){return ke("vec2",Ge,e)}function Ve(...e){return $e("vec3",Ge,e)}function He(...e){return je("vec4",Ge,e)}const We=(e,t)=>{const r=e.type[0];return"i"===r?Fe(t):"u"===r?ve(t):"b"===r?be(t):Re(t)},Ye=(e,t,r=!1)=>({tag:"op1",type:t.type,op:e,val:t,post:r}),qe={mave:"mv",vema:"vm",vefl:"vn",mafl:"vn",flve:"nv",flma:"nv",ivin:"vn",iniv:"nv",uvui:"vn",uiuv:"nv"},Ke=(e,t,r,n,i)=>{const s=me(t),o=me(r);let a,u,f;return s?o?(u=Re(t),f=Re(r),a="float"):(f=r,u=We(f,t),a=f.type):o?(u=t,f=We(u,r),a=u.type):(u=t,f=r,a=n||(oe(u)?u.type:oe(f)||ae(f)?f.type:u.type)),{tag:"op2",type:n||a,info:i||qe[u.type.substr(0,2)+f.type.substr(0,2)],op:e,l:u,r:f}},Qe=e=>Ye("++",e,!0);function Ze(e,t){return Ke("+",e,t)}function Je(e,t){return Ke("-",e,t)}function et(e,t){return Ke("*",e,t,!me(e)&&!me(t)&&ae(e)&&oe(t)?t.type:void 0)}function tt(e,t){return Ke("/",e,t)}const rt=e=>(t,r)=>Ke(e,t,r,"bool"),nt=(rt("=="),rt("!=")),it=rt("<"),st=(rt("<="),rt(">"));rt(">=");const ot=(e,t)=>(Object(a.a)("swizzle"!==e.tag||"sym"===e.val.tag,"can't assign to non-symbol swizzle"),{tag:"assign",type:e.type,l:e,r:t});function at(e,t){const r=e.type[0],n=(e,r)=>1===t.length?e:r+t.length;return{tag:"swizzle",type:"i"===r?n("int","ivec"):"u"===r?n("uint","uvec"):"b"===r?n("bool","bvec"):n("float","vec"),val:e,id:t}}const ut=e=>at(e,"x"),ft=e=>at(e,"y");function ct(e){return at(e,"xy")}const lt=(e,t,r)=>({tag:"ternary",type:t.type,test:e,t:t,f:r});function dt(...e){const[t,r,n,i]=2===e.length?[,e[0],,e[1]]:3===e.length?[e[0],e[1],,e[2]]:e;return{tag:"for",type:"void",init:t?de(t):void 0,test:r(t),iter:n?n(t):void 0,scope:he(i(t))}}const ht=e=>({tag:"ctrl",type:"void",id:e}),_t=(ht("break"),ht("continue"),ht("discard"),e=>t=>ye(e,t.type,t)),pt=e=>(t,r)=>ye(e,t.type,t,r),Et=e=>(t,r,n)=>ye(e,t.type,t,r,n),gt=(e,t)=>ye("dot","float",e,t),Tt=(pt("min"),pt("max"));Et("clamp"),pt("step"),Et("smoothstep"),_t("radians"),_t("degrees"),_t("cos"),_t("sin"),_t("tan"),_t("acos"),_t("asin");pt("pow"),_t("exp"),_t("log"),_t("exp2"),_t("log2"),_t("sqrt"),_t("inversesqrt");const yt=_t("abs"),mt=(_t("sign"),_t("floor")),At=(_t("ceil"),_t("fract"));function St(e,t){const r=ye("mod",e.type,e,t);return"float"===t.type&&(r.info="n"),r}ge("float","fitNorm1",["float","float","float"],(e,t,r)=>[Te(lt(nt(t,r),tt(Je(e,t),Je(r,t)),Me))]);const bt=ge("vec2","aspectCorrectedUV",["vec2","vec2"],(e,t)=>{let r;return[r=_e("vec2",(n=tt(e,t),Je(et(n,Pe),we))),ot(ut(r),et(ut(r),tt(ut(t),ft(t)))),Te(r)];var n}),Rt=(e,t,r=4,n="additive")=>ge("float",n,[[e],[e],"float"],(e,n,i)=>{let s,o;return[s=_e(Me),o=_e(Be),dt(_e("float",Re(0)),e=>it(e,Re(r)),Qe,r=>[ot(s,Ze(s,et(o,t(Ze(e,et(r,n)))))),ot(o,et(o,i)),ot(e,et(e,2))]),Te(s)]}),Ft=ge("float","magSq2",["vec2"],e=>[Te(gt(e,e))]),vt=(ge("float","magSq3",["vec3"],e=>[Te(gt(e,e))]),ge("float","magSq4",["vec4"],e=>[Te(gt(e,e))]),(e,t="")=>ge(e,`permute${t}`,[e],e=>[Te(St(et(e,Ze(et(e,Re(34)),we)),Re(289)))])),Nt=(vt("float"),vt("vec2","2"),vt("vec3","3")),Dt=(vt("vec4","4"),ge("float","snoise2",["vec2"],e=>{let t,r,n,i,s,o,a,u,f,c,l,d;return[t=_e(He(.211324865405187,.366025403784439,-.577350269189626,.024390243902439)),r=_e(mt(Ze(e,gt(e,at(t,"yy"))))),i=_e(Ze(Je(e,r),gt(r,at(t,"xx")))),n=_e(lt(st(ut(i),ft(i)),Xe(1,0),Xe(0,1))),s=_e(Je(Ze(at(i,"xyxy"),at(t,"xxzz")),He(n,0,0))),ot(r,St(r,Re(289))),o=_e(Nt(Ze(Nt(Ze(Ve(0,ft(n),1),ft(r))),Ze(Ve(0,ut(n),1),ut(r))))),a=_e(Tt(Je(Be,Ve(Ft(i),Ft(ct(s)),Ft(at(s,"zw")))),Ve())),ot(a,et(a,a)),ot(a,et(a,a)),u=_e(Je(et(2,At(et(o,at(t,"www")))),we)),f=_e(Je(yt(u),Be)),c=_e(mt(Ze(u,Be))),l=_e(Je(u,c)),ot(a,et(a,Je(1.79284291400159,et(.85373472095314,Ze(et(l,l),et(f,f)))))),d=_e(Ve(Ze(et(ut(l),ut(i)),et(ut(f),ft(i))))),ot(at(d,"yz"),Ze(et(at(l,"yz"),at(s,"xz")),et(at(f,"yz"),at(s,"yw")))),Te(et(130,gt(a,d)))]})),It=I(()=>"unsupported operation"),Ut=e=>{throw new It(e)};var Lt;!function(e){e[e.FINE=0]="FINE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.SEVERE=4]="SEVERE",e[e.NONE=5]="NONE"}(Lt||(Lt={}));const Ot=Object.freeze({level:Lt.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});const Mt=Symbol();let wt=Ot;const Pt=(e,t,r)=>{const n=t[r];if(n)for(let r of n){let n=e[r]||Pt(e,t,r);if(n)return n}},Bt=(e,t,r)=>{const n=t[r];if(n)for(let r of n)e.push(r),Bt(e,t,r);return e},Ct=e=>{const t={};for(let r in e){const n=e[r];t[r]=n instanceof Set?n:new Set(n)}return t},xt=e=>{const t=function(e,t){const r={},n=t?Ct(t):{},i=(...t)=>{const i=e(...t),s=r[i]||Pt(r,n,i)||r[Mt];return s?s(...t):Ut(`missing implementation for: "${i.toString()}"`)};return i.add=(e,t)=>(r[e]&&wt.warn(`overwriting '${e.toString()}' impl`),r[e]=t,!0),i.addAll=e=>{let t=!0;for(let r in e)t=i.add(r,e[r])&&t;return t},i.remove=e=>!!r[e]&&(delete r[e],!0),i.callable=(...t)=>{const i=e(...t);return!!(r[i]||Pt(r,n,i)||r[Mt])},i.isa=(e,t)=>{let r=n[e];!r&&(n[e]=r=new Set),r.add(t)},i.impls=()=>{const e=new Set(Object.keys(r));for(let t in n)Pt(r,n,t)&&e.add(t);return r[Mt]&&e.add(Mt),e},i.rels=()=>n,i.parents=e=>n[e],i.ancestors=e=>new Set(Bt([],n,e)),i}(e=>e.tag);return t.add(Mt,e=>Ut(`no impl for AST node type: '${e.tag}'`)),t.addAll(e),t};var zt;!function(e){e.GLES_100="100",e.GLES_300="300 es"}(zt||(zt={}));const Gt=/[};]$/,kt=(e=>{const t=Object.assign({type:"fs",version:zt.GLES_300,versionPragma:!0,prelude:""},e),r="vs"===t.type,n=(e,t=", ")=>e.map(o).join(t),i=e=>`${e.id}(${n(e.args)})`,s=(e,n=!1)=>{const{id:i,type:s,opts:a,init:u}=e,f=[];if(a.type){let e;t.version<zt.GLES_300?r?e={in:"attribute",out:"varying",uni:"uniform"}[a.type]:(e={in:"varying",out:null,uni:"uniform"}[a.type],!e&&Ut("GLSL 100 doesn't support fragment shader output variables")):(null!=a.loc&&f.push(`layout(location=${a.loc}) `),e="uni"===a.type?"uniform":a.type),f.push(e+" ")}else a.const&&f.push("const "),n&&a.q&&f.push(a.q+" ");return a.prec&&f.push(a.prec+" "),f.push((e=>e.replace("[]",""))(s)," ",i),a.num&&f.push(`[${a.num}]`),u&&f.push(" = ",o(u)),f.join("")},o=xt({arg:e=>s(e,!0),array_init:e=>t.version>=zt.GLES_300?`${e.type}(${n(e.init)})`:Ut(`array initializers not available in GLSL ${t.version}`),assign:e=>o(e.l)+" = "+o(e.r),ctrl:e=>e.id,call:i,call_i:e=>"texture"===e.id&&t.version<zt.GLES_300?`${e.id}${e.args[0].type.substr(7)}(${n(e.args)})`:i(e),decl:e=>s(e.id),fn:e=>`${e.type} ${e.id}(${n(e.args)}) ${o(e.scope)}`,for:e=>`for(${e.init?o(e.init):""}; ${o(e.test)}; ${e.iter?o(e.iter):""}) ${o(e.scope)}`,idx:e=>`${o(e.val)}[${o(e.id)}]`,if:e=>{const t=`if (${o(e.test)}) `+o(e.t);return e.f?t+" else "+o(e.f):t},lit:e=>{const t=e.val;switch(e.type){case"bool":return Ae(t)?String(t):`bool(${o(t)})`;case"float":return me(t)?t===Math.trunc(t)?t+".0":String(t):`float(${o(t)})`;case"int":case"uint":return me(t)?String(t):`${e.type}(${o(t)})`;default:return oe(e)||ae(e)?`${e.type}(${n(t)})`:Ut(`unknown type: ${e.type}`)}},op1:e=>e.post?`(${o(e.val)}${e.op})`:`(${e.op}${o(e.val)})`,op2:e=>`(${o(e.l)} ${e.op} ${o(e.r)})`,ret:e=>"return"+(e.val?" "+o(e.val):""),scope:e=>{let r=e.body.map(o).reduce((e,t)=>(e.push(Gt.test(t)?t:t+";"),e),[]).join("\n");return r+=e.body.length&&!Gt.test(r)?";":"",e.global?(t.prelude&&(r=t.prelude+"\n"+r),t.versionPragma&&(r=`#version ${t.version}\n`+r),r):`{\n${r}\n}`},swizzle:e=>`${o(e.val)}.${e.id}`,sym:e=>e.id,ternary:e=>`(${o(e.test)} ? ${o(e.t)} : ${o(e.f)})`,while:e=>`while (${o(e.test)}) ${o(e.scope)}`});return Object.assign(o,{gl_FragColor:_e("vec4","gl_FragColor"),gl_FragCoord:_e("vec4","gl_FragCoord",{const:!0}),gl_FragData:_e("vec4[]","gl_FragData",{num:1}),gl_FrontFacing:_e("bool","gl_FrontFacing",{const:!0}),gl_PointCoord:_e("vec2","gl_PointCoord",{const:!0}),gl_PointSize:_e("float","gl_PointSize"),gl_Position:_e("vec4","gl_Position")}),o})({version:zt.GLES_100,type:"fs",prelude:"precision mediump float;"});let $t,jt,Xt=ge("vec4","mainImage",["vec2","vec2","float"],(e,t,r)=>{let n,i;return[n=_e(bt(e,t)),i=_e(Rt("vec2",Dt,4)(Ze(n,r),Xe(2),Re(.5))),Te(He(Ve((s=i,Ze(et(s,Be),Be))),1))];var s});const Vt=kt((e=>{const t=e.filter(e=>"fn"!==e.tag),r=e.reduce((e,t)=>"fn"===t.tag?le(t,e):e,new re);return he(t.concat(r.sort()),!0)})([$t=pe("vec2","resolution"),jt=pe("float","time"),(Ht=()=>[ot(kt.gl_FragColor,Xt(ct(kt.gl_FragCoord),$t,jt))],ge("void","main",[],Ht))]));var Ht;console.log(Vt);var Wt=r(7);const Yt=Object(n.e)(s,"noise").update({frag:Vt}),qt=Object(n.e)(s,"toNormal"),Kt=Object(n.g)(s,"noise").update({layers:Yt});let Qt=0;Object(Wt.b)(e=>{const t=Object(n.d)("device");t.tpf=e,Qt+=e/1e4,Yt.update({uniforms:{resolution:[t.canvas.width,t.canvas.height],time:Qt}}),s.compose(Kt).display(Kt)},"loop"),Object(n.a)("index",(e,t)=>{e===o.RESIZE&&Kt.update()})},6:function(e,t,r){"use strict";function n(e){return Math.floor(Math.random()*e)}function i(e,t){return n(t-e)+e}function s(){return(Math.random()+Math.random()+Math.random())/3}r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return s}))},61:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i}));var n=r(33);const i=void 0===e||"1"===e.env.UMBRELLA_ASSERTS?(e,t="assertion failed")=>{if("function"==typeof e&&!e()||!e)throw new Error("function"==typeof t?t():t)}:n.a}).call(this,r(31))},62:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return n}));const n=()=>"object"==typeof e&&"object"==typeof e.versions&&void 0!==e.versions.node}).call(this,r(31))},7:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l}));let n=null;const i={};let s=!1,o=0,a=0;function u(e){const t=a?e-a:a;if(a=e,n){for(const e in n)n[e](t);n=null}let r=0;for(const e in i)r++,i[e](t);r?requestAnimationFrame(u):(s=!1,a=0)}function f(e,t){t=t||e.name||o++,n=n||{},n[t]=e,s||(requestAnimationFrame(u),s=!0)}function c(e,t){return t=t||e.name||o++,i[t]=e,s||(requestAnimationFrame(u),s=!0),t}function l(e){"function"==typeof e&&(e=e.name),delete i[e]}},8:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));const n={LEFT:0,MIDDLE:1,RIGHT:2};function i(e,t){const r=t||e,{element:i=document,enableRightButton:s,holdDelay:o=400,holdRadius:a=5}=e,u={pressed:{},drag:{x:0,y:0,dX:0,dY:0,xMax:0,yMax:0},dragging:!1,holding:!1};let f=0,c=0,l=0,d=0,h=null;function _(e){e.isPrimary?(u.pressed[e.button]=e,f=l=e.clientX,c=d=e.clientY,u.dragging=!0,null!=h&&clearTimeout(h),h=setTimeout(()=>{u.drag.xMax<a&&u.drag.yMax<a&&(u.holding=!0,r(u))},o)):u.pressed[n.RIGHT]=e,r(u)}function p(e){u.pressed={},delete u.drag.event,u.drag.x=0,u.drag.y=0,u.drag.dX=0,u.drag.dY=0,u.drag.xMax=0,u.drag.yMax=0,u.dragging=!1,u.holding=!1,null!=h&&clearTimeout(h),h=null,r(u)}function E(e){u.dragging&&(u.drag.event=e,u.drag.x=f-e.clientX,u.drag.y=c-e.clientY,u.drag.dX=l-e.clientX,u.drag.dY=d-e.clientY,u.drag.xMax=Math.max(Math.abs(u.drag.x),u.drag.xMax),u.drag.yMax=Math.max(Math.abs(u.drag.y),u.drag.yMax),l=e.clientX,d=e.clientY,r(u))}function g(e){e.preventDefault()}return i.addEventListener("pointerdown",_),document.addEventListener("pointermove",E),document.addEventListener("pointerup",p),document.addEventListener("pointerleave",p),document.addEventListener("pointercancel",p),s&&i.addEventListener("contextmenu",g),r(u),function(){i.removeEventListener("pointerdown",_),document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",p),document.removeEventListener("pointerleave",p),document.removeEventListener("pointercancel",p),s&&i.removeEventListener("contextmenu",g)}}},9:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));function n(e,t){if(e===t)return!0;if(!t||!e)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function i(e,t){if(e===t)return!0;if(!t)return!1;const r=Object.keys(e);if(!n(r,Object.keys(t)))return!1;for(const n of r)if(e[n]!==t[n])return!1;return!0}}});
//# sourceMappingURL=main.js.map