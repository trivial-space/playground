{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/contants.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/events/dom.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/events/mouse.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/asset-lib.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/render-utils.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/form.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/texture.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/render-target.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/frame.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/layer.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/shade.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/sketch.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/painter.js","webpack:///./shared-utils/painterState.ts","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/utils/object.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/utils/sequence.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/process/browser.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/api/constants.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/events/keyboard.js","webpack:///./experiments/textures/context.ts","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-string.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/idgen.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-array.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/tslib/tslib.es6.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-plain-object.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/equiv/index.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/dissoc.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/func/compr.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/implements-function.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/internal/ensure.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/reduced.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/errors/deferror.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/errors/illegal-arity.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/reduce.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-arraylike.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/iterator.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/xform/map.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/internal/inspect.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/api/mixin.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-map.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/into.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/array-set.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/internal/equiv.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/equiv-map.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-set.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/union.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/associative/utils.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/errors/illegal-arguments.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/transducers/xform/filter.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/dgraph/index.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/checks.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/scope.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/sym.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/function.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-number.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-boolean.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/lit.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/item.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/ops.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/assign.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/swizzle.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/ast/controlflow.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/builtin/math.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-stdlib/math/fit.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-stdlib/screen/uv.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-stdlib/math/additive.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-stdlib/math/magsq.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-stdlib/noise/permute.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-stdlib/noise/simplex2.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/errors/unsupported.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/api/api/logger.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/api/logger.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/defmulti/constants.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/defmulti/defmulti.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast/target.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-glsl/api.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/shader-ast-glsl/target.js","webpack:///./experiments/textures/shaders.ts","webpack:///./experiments/textures/index.ts","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/math/random.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/api/assert.js","webpack:////Users/trival/projects/personal/trivialspace/playground/node_modules/@thi.ng/checks/is-node.js","webpack:///./shared-utils/scheduler.ts","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/libs/dist/utils/predicates.js","webpack:////Users/trival/projects/personal/trivialspace/playground/projects/painter/dist/utils/context.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","GEOMETRY_PROP_POSITION","GEOMETRY_PROP_NORMAL","GEOMETRY_PROP_UV","UNIFORM_SOURCE_TEXTURE","VARYING_UV_COORDS","GL_TYPE","FLOAT","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","INT","INT_VEC2","INT_VEC3","INT_VEC4","BOOL","BOOL_VEC2","BOOL_VEC3","BOOL_VEC4","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","SAMPLER_2D","SAMPLER_CUBE","SAMPLER_3D","SAMPLER_2D_SHADOW","FLOAT_MAT2X3","FLOAT_MAT2X4","FLOAT_MAT3X2","FLOAT_MAT3X4","FLOAT_MAT4X2","FLOAT_MAT4X3","SAMPLER_2D_ARRAY","SAMPLER_2D_ARRAY_SHADOW","SAMPLER_CUBE_SHADOW","UNSIGNED_INT","UNSIGNED_INT_VEC2","UNSIGNED_INT_VEC3","UNSIGNED_INT_VEC4","INT_SAMPLER_2D","INT_SAMPLER_3D","INT_SAMPLER_CUBE","INT_SAMPLER_2D_ARRAY","UNSIGNED_INT_SAMPLER_2D","UNSIGNED_INT_SAMPLER_3D","UNSIGNED_INT_SAMPLER_CUBE","UNSIGNED_INT_SAMPLER_2D_ARRAY","TEXTURE_2D","TEXTURE_CUBE_MAP","TEXTURE_3D","TEXTURE_2D_ARRAY","BYTE","UNSIGNED_BYTE","SHORT","UNSIGNED_SHORT","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","HALF_FLOAT","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_5_9_9_9_REV","FLOAT_32_UNSIGNED_INT_24_8_REV","UNSIGNED_INT_24_8","TEXTURE_FORMAT","TEXTURE_FORMAT_INTERNAL","windowSize","callback","resize","width","window","innerWidth","height","innerHeight","addEventListener","removeEventListener","Buttons","LEFT","MIDDLE","RIGHT","mouse","opts","cb","element","document","enableRightButton","state","pressed","drag","x","y","dX","dY","dragging","oX","oY","onMouseDown","e","button","clientX","clientY","onMouseUp","event","onMouseMove","preventDefault","defaultTextureSettings","defaultForms","renderQuad","attribs","buffer","Float32Array","storeType","drawType","itemCount","defaultShaders","basicEffect","vert","frag","getBindPointForSamplerType","type","typeMap","bindPoint","intSetter","gl","location","v","uniform1i","intArraySetter","uniform1iv","intVec2Setter","uniform2iv","intVec3Setter","uniform3iv","intVec4Setter","uniform4iv","samplerSetter","unit","texture","activeTexture","TEXTURE0","bindTexture","_texture","samplerArraySetter","size","units","Int32Array","textures","index","Type","setter","uniform1f","arraySetter","uniform1fv","uniform2fv","uniform3fv","uniform4fv","Uint32Array","uniform1ui","uniform1uiv","uniform2uiv","uniform3uiv","uniform4uiv","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","uniformMatrix2x3fv","uniformMatrix2x4fv","uniformMatrix3x2fv","uniformMatrix3x4fv","uniformMatrix4x2fv","uniformMatrix4x3fv","floatAttribSetter","typeInfo","b","bindBuffer","ARRAY_BUFFER","enableVertexAttribArray","vertexAttribPointer","itemSize","normalize","stride","offset","intAttribSetter","vertexAttribIPointer","matAttribSetter","defaultSize","count","numComponents","rowOffset","attrTypeMap","Int8Array","Uint8Array","Int16Array","Uint16Array","applyDrawSettings","settings","enable","setting","disable","blendFunc","apply","depthFunc","cullFace","frontFace","lineWidth","colorMask","depthMask","clearColor","clearDepth","clearBits","clear","revertDrawSettings","formCounter","_painter","id","this","data","_drawType","_itemCount","_attribs","attribData","createBuffer","bufferData","elements","_elements","glType","typedArray","Uint8ClampedArray","Error","getGLTypeForTypedArray","ELEMENT_ARRAY_BUFFER","deleteBuffer","undefined","textureCount","_data","createTexture","wrap","wrapS","wrapT","texParameteri","TEXTURE_WRAP_S","TEXTURE_WRAP_T","magFilter","TEXTURE_MAG_FILTER","minFilter","TEXTURE_MIN_FILTER","asset","texImage2D","RGBA","isWebGL2","RGBA32F","flipY","pixelStorei","UNPACK_FLIP_Y_WEBGL","indexOf","generateMipmap","assign","deleteTexture","frameBuffer","depthBuffer","bufferStructure","length","every","buf","createFramebuffer","bindFramebuffer","FRAMEBUFFER","some","getExtension","texCount","bufferAttachments","COLOR_ATTACHMENT0","glx","attachment","COLOR_ATTACHMENT0_WEBGL","drawBuffers","drawBuffersWEBGL","update","framebufferTexture2D","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","err","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","console","error","deleteFramebuffer","deleteRenderbuffer","frameCount","layers","_targets","_textures","Array","isArray","selfReferencing","layerCount","reduce","layer","_uniforms","targetCount","drawingBufferWidth","drawingBufferHeight","_destroyTargets","targetData","forEach","tex","destroy","tmp","Layer","sketches","sketch","shade","uniforms","shadeCounter","fragSource","trim","vertSource","program","createProgram","createShader","FRAGMENT_SHADER","VERTEX_SHADER","_program","_frag","_vert","attachShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","addLineNumbers","linkProgram","getProgramParameter","LINK_STATUS","lastError","getProgramInfoLog","_uniformSetters","textureUnit","createUniformSetter","uniformInfo","getUniformLocation","substr","toString","uniformSetters","numUniforms","ACTIVE_UNIFORMS","getActiveUniform","createUniformSetters","_attributeSetters","attribSetters","numAttribs","ACTIVE_ATTRIBUTES","attribInfo","getActiveAttrib","getAttribLocation","createAttributeSetters","deleteProgram","deleteShader","src","split","map","line","join","sketchCounter","Sketch","drawSettings","_drawSettings","form","canvas","maxBufferSamples","useWebGL1","getContext","sizeMultiplier","getParameter","MAX_SAMPLES","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","getDefaultLayerSettings","_renderQuad","createForm","_staticSketch","createFlatSketch","createSketch","createShade","createLayer","globalUniforms","viewport","draw","frames","frame","renderFrame","idx","source","image","sources","useProgram","shadeForm","shadeUniforms","drawInstance","drawElements","drawArrays","renderLayer","target","layerPasses","j","_swapTargets","currentCanvas","painter","getPainter","device","cancelWindow","cancelMouse","cancelKeys","dispatch","baseEvents","RESIZE","keyboard","k","keys","init","getForm","shades","getShade","getSketch","getLayer","getFrame","createFrame","effects","getEffect","createEffect","tpf","prop","set","val","reset","deepOverride","obj1","obj2","opt","ignore","val1","val2","getState","systems","addSystem","FRAME","pickRandom","arr","doTimes","fn","times","res","zip","as","bs","Math","min","flatten","array","subarray","currentLength","mapcat","coll","obj","each","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","marker","runClearTimeout","Item","noop","nextTick","args","arguments","push","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","SEMAPHORE","NO_OP","Keys","onKeydown","keyCode","Date","now","onKeyup","getElementById","events","isString","symID","gensym","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","getPrototypeOf","FN","equiv","a","proto","equivArrayLike","Set","equivSet","Map","equivMap","getTime","RegExp","equivObject","_equiv","sort","dissoc","delete","compR","rfn","implementsFunction","ensureTransducer","xform","Reduced","isReduced","unreduced","deref","defError","prefix","suffix","msg","super","IllegalArityError","parseArgs","illegalArity","complete","acc","xs","$reduce","reduceArray","reduceIterable","reducer","iterator1","_","inspect","inspectSet","inspectMap","inspectable","behaviour","sharedBehaviour","instanceKeys","ownKeys","sharedKeys","typeTag","_mixin","clazz","existing","configurable","writable","log","propertyIsEnumerable","hasInstance","mixin","for","depth","childOpts","stylize","isMap","into","dest","add","ArraySet_1","__private","WeakMap","__vals","inst","vals","iterator","species","$this","slice","has","notFound","eq","splice","thisArg","EquivMap_1","__map","pairs","_opts","entries","copy","pair","values","union","out","ctor","IllegalArgumentError","illegalArgs","filter","pred","edges","dependencies","dependents","addDependency","g","node","dep","depends","deps","transitiveDependencies","transitiveDependents","immediateDependents","immediateDependencies","isLeaf","nodes","isRoot","transitive","sorted","leaves","reverse","first","removeEdge","removeNode","RE_VEC","RE_MAT","isVec","test","isMat","scopedChildren","tag","scope","body","f","allChildren","walk","visit","children","tree","pre","buildCallGraph","graph","addNode","decl","global","uniform","q","defArg","defn","_args","_body","returns","assert","$","funcall","ret","builtinCall","isNumber","isBoolean","lit","info","bool","uint","wrapFloat","wrapInt","wrapUint","wrapBool","FALSE","FLOAT0","FLOAT1","FLOAT2","FLOAT05","INT0","UINT0","$gvec","PI","SQRT2","$vec","$gvec2","$gvec3","$gvec4","vec2","vec3","vec4","numberWithMatchingType","op1","op","post","OP_INFO","mave","vema","vefl","mafl","flve","flma","ivin","iniv","uvui","uiuv","op2","_l","_r","rtype","nl","nr","inc","sub","mul","div","cmp","neq","lt","gt","$x","$y","$xy","ternary","forLoop","iter","ctrl","primOp1","primOp2","primOp3","dot","max","abs","floor","fract","mod","aspectCorrectedUV","pos","uv","additive","oct","shift","decay","amp","magSq2","__permute","permute3","snoise2","C","i1","x0","x12","h","ox","a0","UnsupportedOperationError","unsupported","LogLevel","NULL_LOGGER","freeze","level","NONE","DEFAULT","LOGGER","findImpl","impls","rels","parents","impl","findAncestors","makeRels","spec","defTarget","ancestors","warn","addAll","_impls","ok","remove","callable","isa","parent","defmulti","GLSLVersion","RE_SEMI","fs","GLES_300","versionPragma","prelude","isVS","$list","sep","$fn","$decl","sym","arg","in","uni","loc","const","prec","replace","itemType","num","array_init","call_i","if","String","trunc","swizzle","while","gl_FragColor","gl_FragCoord","gl_FragData","gl_FrontFacing","gl_PointCoord","gl_PointSize","gl_Position","targetGLSL","GLES_100","resolution","getImage","fragCoord","time","col","noiseShader","syms","noise","toNormal","noiseFrame","compose","display","randInt","int","random","randIntInRange","from","to","normalRand","UMBRELLA_ASSERTS","isNode","updateOnce","updateRepeat","willUpdate","uidCounter","oldTime","processUpdates","updates","requestAnimationFrame","repeat","stop","equalArray","arr1","arr2","equalObject","k1","makeClear","clearArray","item","toUpperCase","resizeCanvas","multiplier","clientWidth","clientHeight"],"mappings":"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","file":"experiments/textures/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 42);\n","export const GEOMETRY_PROP_POSITION = 'position';\nexport const GEOMETRY_PROP_NORMAL = 'normal';\nexport const GEOMETRY_PROP_UV = 'uv';\nexport const UNIFORM_SOURCE_TEXTURE = 'source';\nexport const VARYING_UV_COORDS = 'coords';\nexport const GL_TYPE = {\n    FLOAT: 0x1406,\n    FLOAT_VEC2: 0x8b50,\n    FLOAT_VEC3: 0x8b51,\n    FLOAT_VEC4: 0x8b52,\n    INT: 0x1404,\n    INT_VEC2: 0x8b53,\n    INT_VEC3: 0x8b54,\n    INT_VEC4: 0x8b55,\n    BOOL: 0x8b56,\n    BOOL_VEC2: 0x8b57,\n    BOOL_VEC3: 0x8b58,\n    BOOL_VEC4: 0x8b59,\n    FLOAT_MAT2: 0x8b5a,\n    FLOAT_MAT3: 0x8b5b,\n    FLOAT_MAT4: 0x8b5c,\n    SAMPLER_2D: 0x8b5e,\n    SAMPLER_CUBE: 0x8b60,\n    SAMPLER_3D: 0x8b5f,\n    SAMPLER_2D_SHADOW: 0x8b62,\n    FLOAT_MAT2X3: 0x8b65,\n    FLOAT_MAT2X4: 0x8b66,\n    FLOAT_MAT3X2: 0x8b67,\n    FLOAT_MAT3X4: 0x8b68,\n    FLOAT_MAT4X2: 0x8b69,\n    FLOAT_MAT4X3: 0x8b6a,\n    SAMPLER_2D_ARRAY: 0x8dc1,\n    SAMPLER_2D_ARRAY_SHADOW: 0x8dc4,\n    SAMPLER_CUBE_SHADOW: 0x8dc5,\n    UNSIGNED_INT: 0x1405,\n    UNSIGNED_INT_VEC2: 0x8dc6,\n    UNSIGNED_INT_VEC3: 0x8dc7,\n    UNSIGNED_INT_VEC4: 0x8dc8,\n    INT_SAMPLER_2D: 0x8dca,\n    INT_SAMPLER_3D: 0x8dcb,\n    INT_SAMPLER_CUBE: 0x8dcc,\n    INT_SAMPLER_2D_ARRAY: 0x8dcf,\n    UNSIGNED_INT_SAMPLER_2D: 0x8dd2,\n    UNSIGNED_INT_SAMPLER_3D: 0x8dd3,\n    UNSIGNED_INT_SAMPLER_CUBE: 0x8dd4,\n    UNSIGNED_INT_SAMPLER_2D_ARRAY: 0x8dd7,\n    TEXTURE_2D: 0x0de1,\n    TEXTURE_CUBE_MAP: 0x8513,\n    TEXTURE_3D: 0x806f,\n    TEXTURE_2D_ARRAY: 0x8c1a,\n    BYTE: 0x1400,\n    UNSIGNED_BYTE: 0x1401,\n    SHORT: 0x1402,\n    UNSIGNED_SHORT: 0x1403,\n    UNSIGNED_SHORT_4_4_4_4: 0x8033,\n    UNSIGNED_SHORT_5_5_5_1: 0x8034,\n    UNSIGNED_SHORT_5_6_5: 0x8363,\n    HALF_FLOAT: 0x140b,\n    UNSIGNED_INT_2_10_10_10_REV: 0x8368,\n    UNSIGNED_INT_10F_11F_11F_REV: 0x8c3b,\n    UNSIGNED_INT_5_9_9_9_REV: 0x8c3e,\n    FLOAT_32_UNSIGNED_INT_24_8_REV: 0x8dad,\n    UNSIGNED_INT_24_8: 0x84fa,\n};\nexport const TEXTURE_FORMAT = {\n    RED: 0x1903,\n    RG: 0x8227,\n    RGB: 0x1907,\n    RGBA: 0x1908,\n    RED_INTEGER: 0x8d94,\n    RG_INTEGER: 0x8228,\n    RGB_INTEGER: 0x8d98,\n    RGBA_INTEGER: 0x8d99,\n    DEPTH_COMPONENT: 0x1902,\n};\nexport const TEXTURE_FORMAT_INTERNAL = {\n    R8: 0x8229,\n    RG8: 0x822b,\n    RGB8: 0x8051,\n    RGBA8: 0x8058,\n    R16F: 0x822d,\n    RG16F: 0x822f,\n    RGB16F: 0x881b,\n    RGBA16F: 0x881a,\n    R32F: 0x822e,\n    RG32F: 0x8230,\n    RGB32F: 0x8815,\n    RGBA32F: 0x8814,\n    R8I: 0x8231,\n    RG8I: 0x8237,\n    RGB8I: 0x8d8f,\n    RGBA8I: 0x8d8e,\n    R8UI: 0x8232,\n    RG8UI: 0x8238,\n    RGB8UI: 0x8d7d,\n    RGBA8UI: 0x8d7c,\n    R16I: 0x8233,\n    RG16I: 0x8239,\n    RGB16I: 0x8d89,\n    RGBA16I: 0x8d88,\n    R16UI: 0x8234,\n    RG16UI: 0x823a,\n    RGB16UI: 0x8d77,\n    RGBA16UI: 0x8d76,\n    R32I: 0x8235,\n    RG32I: 0x823b,\n    RGB32I: 0x8d83,\n    RGBA32I: 0x8d82,\n    R32UI: 0x8236,\n    RG32UI: 0x823c,\n    RGB32UI: 0x8d71,\n    RGBA32UI: 0x8d70,\n    RGB10_A2: 0x8059,\n    RGB10_A2UI: 0x906f,\n    SRGB: 0x8c40,\n    SRGB8: 0x8c41,\n    SRGB8_ALPHA8: 0x8c43,\n    R8_SNORM: 0x8f94,\n    RG8_SNORM: 0x8f95,\n    RGB8_SNORM: 0x8f96,\n    RGBA8_SNORM: 0x8f97,\n    DEPTH_COMPONENT16: 0x81a5,\n    DEPTH_COMPONENT24: 0x81a6,\n    DEPTH_COMPONENT32F: 0x8cac,\n};\nexport const TEXTURE_FORMAT_DEFAULTS = {\n    [GL_TYPE.UNSIGNED_BYTE]: {\n        [TEXTURE_FORMAT.RED]: TEXTURE_FORMAT_INTERNAL.R8,\n        [TEXTURE_FORMAT.RG]: TEXTURE_FORMAT_INTERNAL.RG8,\n        [TEXTURE_FORMAT.RGB]: TEXTURE_FORMAT_INTERNAL.RGB8,\n        [TEXTURE_FORMAT.RGBA]: TEXTURE_FORMAT_INTERNAL.RGBA8,\n    },\n    [GL_TYPE.UNSIGNED_SHORT]: {\n        [TEXTURE_FORMAT.DEPTH_COMPONENT]: TEXTURE_FORMAT_INTERNAL.DEPTH_COMPONENT16,\n        [TEXTURE_FORMAT.RED]: TEXTURE_FORMAT_INTERNAL.R16UI,\n        [TEXTURE_FORMAT.RG]: TEXTURE_FORMAT_INTERNAL.RG16UI,\n        [TEXTURE_FORMAT.RGB]: TEXTURE_FORMAT_INTERNAL.RGB16UI,\n        [TEXTURE_FORMAT.RGBA]: TEXTURE_FORMAT_INTERNAL.RGBA16UI,\n    },\n    [GL_TYPE.UNSIGNED_INT]: {\n        [TEXTURE_FORMAT.DEPTH_COMPONENT]: TEXTURE_FORMAT_INTERNAL.DEPTH_COMPONENT24,\n        [TEXTURE_FORMAT.RED]: TEXTURE_FORMAT_INTERNAL.R32UI,\n        [TEXTURE_FORMAT.RG]: TEXTURE_FORMAT_INTERNAL.RG32UI,\n        [TEXTURE_FORMAT.RGB]: TEXTURE_FORMAT_INTERNAL.RGB32UI,\n        [TEXTURE_FORMAT.RGBA]: TEXTURE_FORMAT_INTERNAL.RGBA32UI,\n    },\n    [GL_TYPE.FLOAT]: {\n        [TEXTURE_FORMAT.RED]: TEXTURE_FORMAT_INTERNAL.R16F,\n        [TEXTURE_FORMAT.RG]: TEXTURE_FORMAT_INTERNAL.RG16F,\n        [TEXTURE_FORMAT.RGB]: TEXTURE_FORMAT_INTERNAL.RGB16F,\n        [TEXTURE_FORMAT.RGBA]: TEXTURE_FORMAT_INTERNAL.RGBA16F,\n        [TEXTURE_FORMAT.DEPTH_COMPONENT]: TEXTURE_FORMAT_INTERNAL.DEPTH_COMPONENT32F,\n    },\n    COMPRESSED_TYPES: {},\n};\n//# sourceMappingURL=contants.js.map","export function windowSize(callback) {\n    function resize() {\n        callback({\n            width: window.innerWidth,\n            height: window.innerHeight,\n        });\n    }\n    window.addEventListener('resize', resize);\n    resize();\n    return function stop() {\n        window.removeEventListener('resize', resize);\n    };\n}\nexport function windowSizeObserver() {\n    const state = {\n        size: { width: 0, height: 0 },\n    };\n    const destroy = windowSize(s => (state.size = s));\n    return { state, destroy };\n}\n//# sourceMappingURL=dom.js.map","export const Buttons = {\n    LEFT: 0,\n    MIDDLE: 1,\n    RIGHT: 2,\n};\nexport function mouse(opts, callback) {\n    const cb = callback || opts;\n    const { element = document, enableRightButton } = opts;\n    const state = {\n        pressed: {},\n        drag: { x: 0, y: 0, dX: 0, dY: 0 },\n        dragging: false,\n    };\n    let x = 0, y = 0, oX = 0, oY = 0;\n    function onMouseDown(e) {\n        state.pressed[e.button] = e;\n        if (e.button === Buttons.LEFT) {\n            x = oX = e.clientX;\n            y = oY = e.clientY;\n            state.dragging = true;\n        }\n        cb(state);\n    }\n    function onMouseUp(e) {\n        delete state.pressed[e.button];\n        delete state.drag.event;\n        state.drag.x = 0;\n        state.drag.y = 0;\n        state.drag.dX = 0;\n        state.drag.dY = 0;\n        state.dragging = false;\n        cb(state);\n    }\n    function onMouseMove(e) {\n        if (state.dragging) {\n            state.drag.event = e;\n            state.drag.x = x - e.clientX;\n            state.drag.y = y - e.clientY;\n            state.drag.dX = oX - e.clientX;\n            state.drag.dY = oY - e.clientY;\n            oX = e.clientX;\n            oY = e.clientY;\n            cb(state);\n        }\n    }\n    function preventDefault(e) {\n        e.preventDefault();\n    }\n    element.addEventListener('mousedown', onMouseDown);\n    document.addEventListener('mouseup', onMouseUp);\n    document.addEventListener('mousemove', onMouseMove);\n    if (enableRightButton) {\n        element.addEventListener('contextmenu', preventDefault);\n    }\n    cb(state);\n    return function destroy() {\n        element.removeEventListener('mousedown', onMouseDown);\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('mouseup', onMouseUp);\n        if (enableRightButton) {\n            element.removeEventListener('contextmenu', preventDefault);\n        }\n    };\n}\nexport function mouseObserver(opts = {}) {\n    const observer = {\n        Buttons,\n        state: {},\n        destroy: () => { },\n    };\n    function callback(state) {\n        observer.state = state;\n    }\n    observer.destroy = mouse(opts, callback);\n    return observer;\n}\n//# sourceMappingURL=mouse.js.map","import * as constants from './contants';\nexport const defaultTextureSettings = {\n    wrap: 'CLAMP_TO_EDGE',\n    minFilter: 'LINEAR',\n    magFilter: 'NEAREST',\n};\nexport function getDefaultLayerSettings(gl) {\n    return {\n        clearColor: [0.0, 0.0, 0.0, 1.0],\n        blendFunc: [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA],\n    };\n}\nexport const defaultForms = {\n    renderQuad: {\n        attribs: {\n            [constants.GEOMETRY_PROP_POSITION]: {\n                buffer: new Float32Array([-1, 1, -1, -1, 1, 1, 1, -1]),\n                storeType: 'STATIC',\n            },\n            [constants.GEOMETRY_PROP_UV]: {\n                buffer: new Float32Array([0, 1, 0, 0, 1, 1, 1, 0]),\n                storeType: 'STATIC',\n            },\n        },\n        drawType: 'TRIANGLE_STRIP',\n        itemCount: 4,\n    },\n};\nexport const defaultShaders = {\n    basicEffect: {\n        vert: `\nattribute vec2 ${constants.GEOMETRY_PROP_POSITION};\nattribute vec2 ${constants.GEOMETRY_PROP_UV};\nvarying vec2 ${constants.VARYING_UV_COORDS};\nvoid main() {\n\t${constants.VARYING_UV_COORDS} = ${constants.GEOMETRY_PROP_UV};\n\tgl_Position = vec4(${constants.GEOMETRY_PROP_POSITION}, 0.0, 1.0);\n}`,\n        frag: `precision mediump float;\nuniform sampler2D ${constants.UNIFORM_SOURCE_TEXTURE};\nvarying vec2 ${constants.VARYING_UV_COORDS};\nvoid main() {\n\tgl_FragColor = texture2D(${constants.UNIFORM_SOURCE_TEXTURE}, ${constants.VARYING_UV_COORDS});\n}`,\n    },\n};\n//# sourceMappingURL=asset-lib.js.map","import { GL_TYPE } from './contants';\n// Attrib and Uniform Setters\nfunction getBindPointForSamplerType(type) {\n    return typeMap[type].bindPoint;\n}\nfunction floatSetter(gl, location) {\n    return (v) => {\n        gl.uniform1f(location, v);\n    };\n}\nfunction floatArraySetter(gl, location) {\n    return (v) => {\n        gl.uniform1fv(location, v);\n    };\n}\nfunction floatVec2Setter(gl, location) {\n    return (v) => {\n        gl.uniform2fv(location, v);\n    };\n}\nfunction floatVec3Setter(gl, location) {\n    return (v) => {\n        gl.uniform3fv(location, v);\n    };\n}\nfunction floatVec4Setter(gl, location) {\n    return (v) => {\n        gl.uniform4fv(location, v);\n    };\n}\nfunction intSetter(gl, location) {\n    return (v) => {\n        gl.uniform1i(location, v);\n    };\n}\nfunction intArraySetter(gl, location) {\n    return (v) => {\n        gl.uniform1iv(location, v);\n    };\n}\nfunction intVec2Setter(gl, location) {\n    return (v) => {\n        gl.uniform2iv(location, v);\n    };\n}\nfunction intVec3Setter(gl, location) {\n    return (v) => {\n        gl.uniform3iv(location, v);\n    };\n}\nfunction intVec4Setter(gl, location) {\n    return (v) => {\n        gl.uniform4iv(location, v);\n    };\n}\nfunction uintSetter(gl, location) {\n    return (v) => {\n        gl.uniform1ui(location, v);\n    };\n}\nfunction uintArraySetter(gl, location) {\n    return (v) => {\n        gl.uniform1uiv(location, v);\n    };\n}\nfunction uintVec2Setter(gl, location) {\n    return (v) => {\n        gl.uniform2uiv(location, v);\n    };\n}\nfunction uintVec3Setter(gl, location) {\n    return (v) => {\n        gl.uniform3uiv(location, v);\n    };\n}\nfunction uintVec4Setter(gl, location) {\n    return (v) => {\n        gl.uniform4uiv(location, v);\n    };\n}\nfunction floatMat2Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix2fv(location, false, v);\n    };\n}\nfunction floatMat3Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix3fv(location, false, v);\n    };\n}\nfunction floatMat4Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix4fv(location, false, v);\n    };\n}\nfunction floatMat23Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix2x3fv(location, false, v);\n    };\n}\nfunction floatMat32Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix3x2fv(location, false, v);\n    };\n}\nfunction floatMat24Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix2x4fv(location, false, v);\n    };\n}\nfunction floatMat42Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix4x2fv(location, false, v);\n    };\n}\nfunction floatMat34Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix3x4fv(location, false, v);\n    };\n}\nfunction floatMat43Setter(gl, location) {\n    return (v) => {\n        gl.uniformMatrix4x3fv(location, false, v);\n    };\n}\nfunction samplerSetter(gl, type, unit, location) {\n    const bindPoint = getBindPointForSamplerType(type);\n    return (texture) => {\n        gl.uniform1i(location, unit);\n        gl.activeTexture(gl.TEXTURE0 + unit);\n        gl.bindTexture(bindPoint, texture._texture);\n    };\n}\nfunction samplerArraySetter(gl, type, unit, location, size) {\n    const bindPoint = getBindPointForSamplerType(type);\n    const units = new Int32Array(size);\n    for (let i = 0; i < size; ++i) {\n        units[i] = unit + i;\n    }\n    return (textures) => {\n        gl.uniform1iv(location, units);\n        for (const index in textures) {\n            gl.activeTexture(gl.TEXTURE0 + units[index]);\n            gl.bindTexture(bindPoint, textures[index]._texture);\n        }\n    };\n}\nfunction isSamplerInfo(info) {\n    return info.Type === null;\n}\nconst typeMap = {\n    [GL_TYPE.FLOAT]: {\n        Type: Float32Array,\n        size: 4,\n        setter: floatSetter,\n        arraySetter: floatArraySetter,\n    },\n    [GL_TYPE.FLOAT_VEC2]: {\n        Type: Float32Array,\n        size: 8,\n        setter: floatVec2Setter,\n    },\n    [GL_TYPE.FLOAT_VEC3]: {\n        Type: Float32Array,\n        size: 12,\n        setter: floatVec3Setter,\n    },\n    [GL_TYPE.FLOAT_VEC4]: {\n        Type: Float32Array,\n        size: 16,\n        setter: floatVec4Setter,\n    },\n    [GL_TYPE.INT]: {\n        Type: Int32Array,\n        size: 4,\n        setter: intSetter,\n        arraySetter: intArraySetter,\n    },\n    [GL_TYPE.INT_VEC2]: { Type: Int32Array, size: 8, setter: intVec2Setter },\n    [GL_TYPE.INT_VEC3]: { Type: Int32Array, size: 12, setter: intVec3Setter },\n    [GL_TYPE.INT_VEC4]: { Type: Int32Array, size: 16, setter: intVec4Setter },\n    [GL_TYPE.UNSIGNED_INT]: {\n        Type: Uint32Array,\n        size: 4,\n        setter: uintSetter,\n        arraySetter: uintArraySetter,\n    },\n    [GL_TYPE.UNSIGNED_INT_VEC2]: {\n        Type: Uint32Array,\n        size: 8,\n        setter: uintVec2Setter,\n    },\n    [GL_TYPE.UNSIGNED_INT_VEC3]: {\n        Type: Uint32Array,\n        size: 12,\n        setter: uintVec3Setter,\n    },\n    [GL_TYPE.UNSIGNED_INT_VEC4]: {\n        Type: Uint32Array,\n        size: 16,\n        setter: uintVec4Setter,\n    },\n    [GL_TYPE.BOOL]: {\n        Type: Uint32Array,\n        size: 4,\n        setter: intSetter,\n        arraySetter: intArraySetter,\n    },\n    [GL_TYPE.BOOL_VEC2]: { Type: Uint32Array, size: 8, setter: intVec2Setter },\n    [GL_TYPE.BOOL_VEC3]: { Type: Uint32Array, size: 12, setter: intVec3Setter },\n    [GL_TYPE.BOOL_VEC4]: { Type: Uint32Array, size: 16, setter: intVec4Setter },\n    [GL_TYPE.FLOAT_MAT2]: {\n        Type: Float32Array,\n        size: 16,\n        setter: floatMat2Setter,\n    },\n    [GL_TYPE.FLOAT_MAT3]: {\n        Type: Float32Array,\n        size: 36,\n        setter: floatMat3Setter,\n    },\n    [GL_TYPE.FLOAT_MAT4]: {\n        Type: Float32Array,\n        size: 64,\n        setter: floatMat4Setter,\n    },\n    [GL_TYPE.FLOAT_MAT2X3]: {\n        Type: Float32Array,\n        size: 24,\n        setter: floatMat23Setter,\n    },\n    [GL_TYPE.FLOAT_MAT2X4]: {\n        Type: Float32Array,\n        size: 32,\n        setter: floatMat24Setter,\n    },\n    [GL_TYPE.FLOAT_MAT3X2]: {\n        Type: Float32Array,\n        size: 24,\n        setter: floatMat32Setter,\n    },\n    [GL_TYPE.FLOAT_MAT3X4]: {\n        Type: Float32Array,\n        size: 48,\n        setter: floatMat34Setter,\n    },\n    [GL_TYPE.FLOAT_MAT4X2]: {\n        Type: Float32Array,\n        size: 32,\n        setter: floatMat42Setter,\n    },\n    [GL_TYPE.FLOAT_MAT4X3]: {\n        Type: Float32Array,\n        size: 48,\n        setter: floatMat43Setter,\n    },\n    [GL_TYPE.SAMPLER_2D]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D,\n    },\n    [GL_TYPE.SAMPLER_CUBE]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_CUBE_MAP,\n    },\n    [GL_TYPE.SAMPLER_3D]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_3D,\n    },\n    [GL_TYPE.SAMPLER_2D_SHADOW]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D,\n    },\n    [GL_TYPE.SAMPLER_2D_ARRAY]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D_ARRAY,\n    },\n    [GL_TYPE.SAMPLER_2D_ARRAY_SHADOW]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D_ARRAY,\n    },\n    [GL_TYPE.SAMPLER_CUBE_SHADOW]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_CUBE_MAP,\n    },\n    [GL_TYPE.INT_SAMPLER_2D]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D,\n    },\n    [GL_TYPE.INT_SAMPLER_3D]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_3D,\n    },\n    [GL_TYPE.INT_SAMPLER_CUBE]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_CUBE_MAP,\n    },\n    [GL_TYPE.INT_SAMPLER_2D_ARRAY]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D_ARRAY,\n    },\n    [GL_TYPE.UNSIGNED_INT_SAMPLER_2D]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D,\n    },\n    [GL_TYPE.UNSIGNED_INT_SAMPLER_3D]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_3D,\n    },\n    [GL_TYPE.UNSIGNED_INT_SAMPLER_CUBE]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_CUBE_MAP,\n    },\n    [GL_TYPE.UNSIGNED_INT_SAMPLER_2D_ARRAY]: {\n        Type: null,\n        size: 0,\n        setter: samplerSetter,\n        arraySetter: samplerArraySetter,\n        bindPoint: GL_TYPE.TEXTURE_2D_ARRAY,\n    },\n};\nfunction floatAttribSetter(gl, location, typeInfo) {\n    return (b) => {\n        gl.bindBuffer(gl.ARRAY_BUFFER, b.buffer);\n        gl.enableVertexAttribArray(location);\n        gl.vertexAttribPointer(location, typeInfo.itemSize, GL_TYPE.FLOAT, b.normalize || false, b.stride || 0, b.offset || 0);\n    };\n}\nfunction intAttribSetter(gl, location, typeInfo) {\n    return (b) => {\n        gl.bindBuffer(gl.ARRAY_BUFFER, b.buffer);\n        gl.enableVertexAttribArray(location);\n        gl.vertexAttribIPointer(location, typeInfo.itemSize, GL_TYPE.INT, b.stride || 0, b.offset || 0);\n    };\n}\nfunction matAttribSetter(gl, location, typeInfo) {\n    const defaultSize = typeInfo.size;\n    const count = typeInfo.count;\n    return (b) => {\n        gl.bindBuffer(gl.ARRAY_BUFFER, b.buffer);\n        const numComponents = defaultSize;\n        const size = numComponents / count;\n        const typeInfo = typeMap[GL_TYPE.FLOAT];\n        const stride = typeInfo.size * numComponents;\n        const normalize = b.normalize || false;\n        const offset = b.offset || 0;\n        const rowOffset = stride / count;\n        for (let i = 0; i < count; ++i) {\n            gl.enableVertexAttribArray(location + i);\n            gl.vertexAttribPointer(location + i, size, GL_TYPE.FLOAT, normalize, stride, offset + rowOffset * i);\n        }\n    };\n}\nconst attrTypeMap = {\n    [GL_TYPE.FLOAT]: { size: 4, setter: floatAttribSetter, itemSize: 1 },\n    [GL_TYPE.FLOAT_VEC2]: { size: 8, setter: floatAttribSetter, itemSize: 2 },\n    [GL_TYPE.FLOAT_VEC3]: { size: 12, setter: floatAttribSetter, itemSize: 3 },\n    [GL_TYPE.FLOAT_VEC4]: { size: 16, setter: floatAttribSetter, itemSize: 4 },\n    [GL_TYPE.INT]: { size: 4, setter: intAttribSetter, itemSize: 1 },\n    [GL_TYPE.INT_VEC2]: { size: 8, setter: intAttribSetter, itemSize: 2 },\n    [GL_TYPE.INT_VEC3]: { size: 12, setter: intAttribSetter, itemSize: 3 },\n    [GL_TYPE.INT_VEC4]: { size: 16, setter: intAttribSetter, itemSize: 4 },\n    [GL_TYPE.UNSIGNED_INT]: { size: 4, setter: intAttribSetter, itemSize: 1 },\n    [GL_TYPE.UNSIGNED_INT_VEC2]: {\n        size: 8,\n        setter: intAttribSetter,\n        itemSize: 2,\n    },\n    [GL_TYPE.UNSIGNED_INT_VEC3]: {\n        size: 12,\n        setter: intAttribSetter,\n        itemSize: 3,\n    },\n    [GL_TYPE.UNSIGNED_INT_VEC4]: {\n        size: 16,\n        setter: intAttribSetter,\n        itemSize: 4,\n    },\n    [GL_TYPE.BOOL]: { size: 4, setter: intAttribSetter, itemSize: 1 },\n    [GL_TYPE.BOOL_VEC2]: { size: 8, setter: intAttribSetter, itemSize: 2 },\n    [GL_TYPE.BOOL_VEC3]: { size: 12, setter: intAttribSetter, itemSize: 3 },\n    [GL_TYPE.BOOL_VEC4]: { size: 16, setter: intAttribSetter, itemSize: 4 },\n    [GL_TYPE.FLOAT_MAT2]: { size: 4, setter: matAttribSetter, count: 2 },\n    [GL_TYPE.FLOAT_MAT3]: { size: 9, setter: matAttribSetter, count: 3 },\n    [GL_TYPE.FLOAT_MAT4]: { size: 16, setter: matAttribSetter, count: 4 },\n};\nexport function createUniformSetters(gl, program) {\n    let textureUnit = 0;\n    function createUniformSetter(program, uniformInfo) {\n        const location = gl.getUniformLocation(program, uniformInfo.name);\n        const isArray = uniformInfo.size > 1 && uniformInfo.name.substr(-3) === '[0]';\n        const type = uniformInfo.type;\n        const typeInfo = typeMap[type];\n        if (!typeInfo) {\n            throw new Error('unknown type: 0x' + type.toString(16)); // we should never get here.\n        }\n        if (location == null) {\n            return;\n        }\n        let setter;\n        if (isSamplerInfo(typeInfo)) {\n            // it's a sampler\n            const unit = textureUnit;\n            textureUnit += uniformInfo.size;\n            if (isArray) {\n                setter = typeInfo.arraySetter(gl, type, unit, location, uniformInfo.size);\n            }\n            else {\n                setter = typeInfo.setter(gl, type, unit, location);\n            }\n        }\n        else {\n            if (typeInfo.arraySetter && isArray) {\n                setter = typeInfo.arraySetter(gl, location);\n            }\n            else {\n                setter = typeInfo.setter(gl, location);\n            }\n        }\n        return { setter, location };\n    }\n    const uniformSetters = {};\n    const numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (let i = 0; i < numUniforms; ++i) {\n        const uniformInfo = gl.getActiveUniform(program, i);\n        if (!uniformInfo) {\n            continue;\n        }\n        let name = uniformInfo.name;\n        // remove the array suffix.\n        if (name.substr(-3) === '[0]') {\n            name = name.substr(0, name.length - 3);\n        }\n        if (program) {\n            const setter = createUniformSetter(program, uniformInfo);\n            if (setter) {\n                uniformSetters[name] = setter;\n            }\n        }\n    }\n    return uniformSetters;\n}\nexport function createAttributeSetters(gl, program) {\n    const attribSetters = {};\n    const numAttribs = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    for (let i = 0; i < numAttribs; i++) {\n        const attribInfo = gl.getActiveAttrib(program, i);\n        if (!attribInfo) {\n            break;\n        }\n        const location = gl.getAttribLocation(program, attribInfo.name);\n        const typeInfo = attrTypeMap[attribInfo.type];\n        const setter = typeInfo.setter(gl, location, typeInfo);\n        attribSetters[attribInfo.name] = { setter, location };\n    }\n    return attribSetters;\n}\n// Type helpers\nexport const glTypeToTypedArray = {\n    [GL_TYPE.BYTE]: Int8Array,\n    [GL_TYPE.UNSIGNED_BYTE]: Uint8Array,\n    [GL_TYPE.SHORT]: Int16Array,\n    [GL_TYPE.UNSIGNED_SHORT]: Uint16Array,\n    [GL_TYPE.INT]: Int32Array,\n    [GL_TYPE.UNSIGNED_INT]: Uint32Array,\n    [GL_TYPE.FLOAT]: Float32Array,\n    [GL_TYPE.UNSIGNED_SHORT_4_4_4_4]: Uint16Array,\n    [GL_TYPE.UNSIGNED_SHORT_5_5_5_1]: Uint16Array,\n    [GL_TYPE.UNSIGNED_SHORT_5_6_5]: Uint16Array,\n    [GL_TYPE.HALF_FLOAT]: Uint16Array,\n    [GL_TYPE.UNSIGNED_INT_2_10_10_10_REV]: Uint32Array,\n    [GL_TYPE.UNSIGNED_INT_10F_11F_11F_REV]: Uint32Array,\n    [GL_TYPE.UNSIGNED_INT_5_9_9_9_REV]: Uint32Array,\n    [GL_TYPE.FLOAT_32_UNSIGNED_INT_24_8_REV]: Uint32Array,\n    [GL_TYPE.UNSIGNED_INT_24_8]: Uint32Array,\n};\nexport function getGLTypeForTypedArray(typedArray) {\n    if (typedArray instanceof Int8Array) {\n        return GL_TYPE.BYTE;\n    }\n    if (typedArray instanceof Uint8Array) {\n        return GL_TYPE.UNSIGNED_BYTE;\n    }\n    if (typedArray instanceof Uint8ClampedArray) {\n        return GL_TYPE.UNSIGNED_BYTE;\n    }\n    if (typedArray instanceof Int16Array) {\n        return GL_TYPE.SHORT;\n    }\n    if (typedArray instanceof Uint16Array) {\n        return GL_TYPE.UNSIGNED_SHORT;\n    }\n    if (typedArray instanceof Int32Array) {\n        return GL_TYPE.INT;\n    }\n    if (typedArray instanceof Uint32Array) {\n        return GL_TYPE.UNSIGNED_INT;\n    }\n    if (typedArray instanceof Float32Array) {\n        return GL_TYPE.FLOAT;\n    }\n    throw new Error('unsupported typed array type');\n}\nexport function getGLTypeForTypedArrayType(typedArrayType) {\n    if (typedArrayType === Int8Array) {\n        return GL_TYPE.BYTE;\n    }\n    if (typedArrayType === Uint8Array) {\n        return GL_TYPE.UNSIGNED_BYTE;\n    }\n    if (typedArrayType === Uint8ClampedArray) {\n        return GL_TYPE.UNSIGNED_BYTE;\n    }\n    if (typedArrayType === Int16Array) {\n        return GL_TYPE.SHORT;\n    }\n    if (typedArrayType === Uint16Array) {\n        return GL_TYPE.UNSIGNED_SHORT;\n    }\n    if (typedArrayType === Int32Array) {\n        return GL_TYPE.INT;\n    }\n    if (typedArrayType === Uint32Array) {\n        return GL_TYPE.UNSIGNED_INT;\n    }\n    if (typedArrayType === Float32Array) {\n        return GL_TYPE.FLOAT;\n    }\n    throw new Error('unsupported typed array type');\n}\n// Settings\nexport function applyDrawSettings(gl, settings) {\n    if (settings.enable) {\n        for (const setting of settings.enable) {\n            gl.enable(setting);\n        }\n    }\n    if (settings.disable) {\n        for (const setting of settings.disable) {\n            gl.disable(setting);\n        }\n    }\n    if (settings.blendFunc) {\n        gl.blendFunc.apply(gl, settings.blendFunc);\n    }\n    if (settings.depthFunc != null) {\n        gl.depthFunc(settings.depthFunc);\n    }\n    if (settings.cullFace != null) {\n        gl.cullFace(settings.cullFace);\n    }\n    if (settings.frontFace != null) {\n        gl.frontFace(settings.frontFace);\n    }\n    if (settings.lineWidth != null) {\n        gl.lineWidth(settings.lineWidth);\n    }\n    if (settings.colorMask) {\n        gl.colorMask.apply(gl, settings.colorMask);\n    }\n    if (settings.depthMask != null) {\n        gl.depthMask(settings.depthMask);\n    }\n    if (settings.clearColor) {\n        gl.clearColor.apply(gl, settings.clearColor);\n    }\n    if (settings.clearDepth != null) {\n        gl.clearDepth(settings.clearDepth);\n    }\n    if (settings.clearBits != null) {\n        gl.clear(settings.clearBits);\n    }\n}\nexport function revertDrawSettings(gl, settings) {\n    if (settings.enable) {\n        for (const setting of settings.enable) {\n            gl.disable(setting);\n        }\n    }\n    if (settings.disable) {\n        for (const setting of settings.disable) {\n            gl.enable(setting);\n        }\n    }\n}\n//# sourceMappingURL=render-utils.js.map","import { getGLTypeForTypedArray } from './render-utils';\nlet formCounter = 1;\nexport class Form {\n    constructor(_painter, id = 'Form' + formCounter++) {\n        this._painter = _painter;\n        this.id = id;\n    }\n    update(data) {\n        const gl = this._painter.gl;\n        if (data.drawType) {\n            this._drawType = gl[data.drawType];\n        }\n        if (data.itemCount) {\n            this._itemCount = data.itemCount;\n        }\n        this._attribs = this._attribs || {};\n        for (const id in data.attribs) {\n            const attribData = data.attribs[id];\n            if (this._attribs[id] == null) {\n                this._attribs[id] = {\n                    buffer: gl.createBuffer(),\n                };\n            }\n            gl.bindBuffer(gl.ARRAY_BUFFER, this._attribs[id].buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, attribData.buffer, gl[(attribData.storeType || 'STATIC') + '_DRAW']);\n        }\n        if (data.elements) {\n            const buffer = data.elements.buffer;\n            if (this._elements == null) {\n                this._elements = {\n                    buffer: gl.createBuffer(),\n                    glType: null,\n                };\n            }\n            this._elements.glType = getGLTypeForTypedArray(buffer);\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._elements.buffer);\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, buffer, gl[(data.elements.storeType || 'STATIC') + '_DRAW']);\n        }\n        return this;\n    }\n    destroy() {\n        const gl = this._painter.gl;\n        for (const id in this._attribs) {\n            gl.deleteBuffer(this._attribs[id].buffer);\n        }\n        this._attribs = {};\n        if (this._elements) {\n            gl.deleteBuffer(this._elements.buffer);\n            this._elements = undefined;\n        }\n    }\n}\n//# sourceMappingURL=form.js.map","import { defaultTextureSettings } from './asset-lib';\nlet textureCount = 1;\nexport class Texture {\n    constructor(_painter, id = 'Texture' + textureCount++) {\n        this._painter = _painter;\n        this.id = id;\n        this._texture = null;\n        this._data = {};\n    }\n    update(data) {\n        const gl = this._painter.gl;\n        if (this._texture == null) {\n            this._texture = gl.createTexture();\n        }\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\n        if ((data.wrap && data.wrap !== this._data.wrap) ||\n            (data.wrapS && data.wrapS !== this._data.wrapS) ||\n            (data.wrapT && data.wrapT !== this._data.wrapT)) {\n            let wrapS, wrapT;\n            if (data.wrap) {\n                wrapS = wrapT = data.wrap;\n            }\n            else {\n                wrapT = data.wrapT || defaultTextureSettings.wrap;\n                wrapS = data.wrapS || defaultTextureSettings.wrap;\n            }\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl[wrapS]);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl[wrapT]);\n        }\n        else if (!(this._data.wrap || this._data.wrapS || this._data.wrapT)) {\n            this._data.wrap = this._data.wrapT = this._data.wrapS = defaultTextureSettings.wrap;\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl[this._data.wrap]);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl[this._data.wrap]);\n        }\n        if (data.magFilter && data.magFilter !== this._data.magFilter) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl[data.magFilter]);\n        }\n        else if (!this._data.magFilter) {\n            this._data.magFilter = defaultTextureSettings.magFilter;\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl[this._data.magFilter]);\n        }\n        if (data.minFilter && data.minFilter !== this._data.minFilter) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl[data.minFilter]);\n        }\n        else if (!this._data.minFilter) {\n            this._data.minFilter = defaultTextureSettings.minFilter;\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl[this._data.minFilter]);\n        }\n        if (data.asset) {\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data.asset);\n        }\n        if (data.data !== undefined) {\n            gl.texImage2D(gl.TEXTURE_2D, 0, data.type === 'FLOAT' && this._painter.isWebGL2\n                ? gl.RGBA32F\n                : gl.RGBA, data.width, // width and height are required if using custom data\n            data.height, 0, gl.RGBA, gl[data.type || 'UNSIGNED_BYTE'], data.data);\n        }\n        if (data.flipY != null && data.flipY !== this._data.flipY) {\n            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, data.flipY);\n        }\n        if (data.minFilter && data.minFilter.indexOf('MIPMAP') > 0) {\n            gl.generateMipmap(gl.TEXTURE_2D);\n        }\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        Object.assign(this._data, data);\n        return this;\n    }\n    destroy() {\n        this._painter.gl.deleteTexture(this._texture);\n        this._data = {};\n        this._texture = null;\n    }\n}\n//# sourceMappingURL=texture.js.map","import { equalObject } from 'tvs-libs/dist/utils/predicates';\nimport { Texture } from './texture';\nlet targetCount = 1;\nexport class RenderTarget {\n    constructor(_painter, id = 'Form' + targetCount++) {\n        this._painter = _painter;\n        this.id = id;\n        this.width = 0;\n        this.height = 0;\n        this.frameBuffer = null;\n        this.textures = [];\n        this.depthBuffer = null;\n        this.bufferStructure = [];\n        this._data = {};\n    }\n    update(data) {\n        const gl = this._painter.gl;\n        const width = data.width || this.width;\n        const height = data.height || this.height;\n        if (!(width && height)) {\n            return this;\n        }\n        else if (width === this.width && height === this.height) {\n            if (!data.bufferStructure)\n                return this;\n            if (data.bufferStructure.length === this.bufferStructure.length &&\n                this.bufferStructure.every((buf, i) => equalObject(buf, data.bufferStructure[i]))) {\n                return this;\n            }\n        }\n        if (this.frameBuffer == null) {\n            this.frameBuffer = gl.createFramebuffer();\n        }\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer);\n        if (data.bufferStructure && data.bufferStructure.length) {\n            this.bufferStructure = data.bufferStructure;\n            if (this.bufferStructure.some(t => t.type === 'FLOAT')) {\n                if (this._painter.isWebGL2) {\n                    gl.getExtension('EXT_color_buffer_float');\n                }\n                else {\n                    gl.getExtension('OES_texture_float');\n                }\n            }\n        }\n        const texCount = this.bufferStructure.length || 1;\n        const bufferAttachments = [gl.COLOR_ATTACHMENT0];\n        if (texCount > 1) {\n            let glx;\n            if (!this._painter.isWebGL2) {\n                glx = gl.getExtension('WEBGL_draw_buffers');\n            }\n            const attachment = this._painter.isWebGL2\n                ? gl.COLOR_ATTACHMENT0\n                : glx.COLOR_ATTACHMENT0_WEBGL;\n            for (let i = 0; i < texCount; i++) {\n                bufferAttachments[i] = attachment + i;\n            }\n            this._painter.isWebGL2\n                ? gl.drawBuffers(bufferAttachments)\n                : glx.drawBuffersWEBGL(bufferAttachments);\n        }\n        for (let i = 0; i < texCount; i++) {\n            if (!this.textures[i]) {\n                this.textures[i] = new Texture(this._painter, this.id + '_Texture' + i);\n            }\n            const texture = this.textures[i];\n            texture.update(Object.assign(Object.assign({ minFilter: 'NEAREST', magFilter: 'NEAREST' }, this.bufferStructure[i]), { data: null, width,\n                height }));\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, bufferAttachments[i], gl.TEXTURE_2D, texture._texture, 0);\n        }\n        if (this.depthBuffer == null) {\n            this.depthBuffer = gl.createRenderbuffer();\n        }\n        gl.bindRenderbuffer(gl.RENDERBUFFER, this.depthBuffer);\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\n        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this.depthBuffer);\n        const err = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n        if (err !== gl.FRAMEBUFFER_COMPLETE) {\n            console.error('framebuffer error', err, data);\n        }\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n        Object.assign(this._data, data);\n        this.width = width;\n        this.height = height;\n        return this;\n    }\n    destroy() {\n        const gl = this._painter.gl;\n        gl.deleteFramebuffer(this.frameBuffer);\n        gl.deleteRenderbuffer(this.depthBuffer);\n        for (const texture of this.textures) {\n            gl.deleteTexture(texture);\n        }\n        this.textures = [];\n        this.frameBuffer = null;\n        this.depthBuffer = null;\n        this._data = {};\n        this.bufferStructure = [];\n        this.width = 0;\n        this.height = 0;\n    }\n}\n//# sourceMappingURL=render-target.js.map","import { times } from 'tvs-libs/dist/utils/sequence';\nimport { RenderTarget } from './render-target';\nimport { Texture } from './texture';\nlet frameCount = 1;\nexport class Frame {\n    constructor(_painter, id = 'Frame' + frameCount++) {\n        this._painter = _painter;\n        this.id = id;\n        this.width = 0;\n        this.height = 0;\n        this.layers = [];\n        this._data = {};\n        this._targets = [];\n        this._textures = [];\n    }\n    image(i = 0) {\n        return ((this._targets.length &&\n            this._targets[this._targets.length - 1].textures[i]) ||\n            this._textures[i]);\n    }\n    update(data = {}) {\n        const gl = this._painter.gl;\n        const layers = Array.isArray(data.layers)\n            ? data.layers\n            : data.layers\n                ? [data.layers]\n                : this.layers;\n        const selfReferencing = data.selfReferencing || this._data.selfReferencing;\n        const layerCount = layers.reduce((count, layer) => count + (layer._uniforms.length || 1), 0);\n        const targetCount = selfReferencing || layerCount > 1 ? 2 : layerCount;\n        const width = data.width || this._data.width || gl.drawingBufferWidth;\n        const height = data.height || this._data.height || gl.drawingBufferHeight;\n        if (targetCount !== this._targets.length) {\n            this._destroyTargets();\n        }\n        const targetData = Object.assign(Object.assign({}, data), { width, height });\n        if (!this._targets.length && targetCount > 0) {\n            this._targets = times(i => new RenderTarget(this._painter, this.id + '_target' + (i + 1)).update(targetData), targetCount);\n        }\n        else if (this._targets.length) {\n            this._targets.forEach(t => {\n                t.update(targetData);\n            });\n        }\n        if (data.texture) {\n            // Hardcode to one static texture for now\n            if (!this._textures[0]) {\n                this._textures[0] = new Texture(this._painter, this.id + '_Texture0');\n            }\n            data.texture.width = data.texture.width || width;\n            data.texture.height = data.texture.height || height;\n            this._textures[0].update(data.texture);\n        }\n        Object.assign(this._data, data);\n        this.layers = layers;\n        this.width = width;\n        this.height = height;\n        return this;\n    }\n    destroy() {\n        this._destroyTargets();\n        this._textures.forEach(tex => tex.destroy());\n        this._textures = [];\n        this._data = {};\n        this.layers = [];\n        this.width = 0;\n        this.height = 0;\n    }\n    _destroyTargets() {\n        this._targets.forEach(t => t.destroy());\n        this._targets = [];\n    }\n    _swapTargets() {\n        if (this._targets.length > 1) {\n            const tmp = this._targets[0];\n            this._targets[0] = this._targets[1];\n            this._targets[1] = tmp;\n        }\n    }\n}\n//# sourceMappingURL=frame.js.map","let layerCount = 1;\nexport class Layer {\n    constructor(id = 'DrawingLayer' + layerCount++) {\n        this.id = id;\n        this.sketches = [];\n        this._data = {};\n        this._uniforms = [];\n    }\n    update(data) {\n        if (data.sketches) {\n            this.sketches = Array.isArray(data.sketches)\n                ? data.sketches\n                : [data.sketches];\n        }\n        if (data.frag) {\n            const sketch = this.sketches && this.sketches[0];\n            if (sketch) {\n                sketch.shade.update({ frag: data.frag });\n            }\n        }\n        if (data.uniforms) {\n            this._uniforms = Array.isArray(data.uniforms)\n                ? data.uniforms\n                : [data.uniforms];\n        }\n        Object.assign(this._data, data);\n        return this;\n    }\n    destroy() {\n        for (const sketch of this.sketches) {\n            sketch.destroy();\n        }\n        this._data.sketches = [];\n        this._data = {};\n        this._uniforms = [];\n    }\n}\n//# sourceMappingURL=layer.js.map","import { createAttributeSetters, createUniformSetters } from './render-utils';\nlet shadeCounter = 1;\nexport class Shade {\n    constructor(_painter, id = 'Shade' + shadeCounter++) {\n        this._painter = _painter;\n        this.id = id;\n    }\n    update(data) {\n        const gl = this._painter.gl;\n        const fragSource = (data.frag && data.frag.trim()) || this.fragSource;\n        const vertSource = (data.vert && data.vert.trim()) || this.vertSource;\n        if (!(fragSource &&\n            vertSource &&\n            (fragSource !== this.fragSource || vertSource !== this.vertSource))) {\n            return this;\n        }\n        this.destroy();\n        if (fragSource.indexOf('GL_EXT_draw_buffers') >= 0) {\n            gl.getExtension('WEBGL_draw_buffers');\n        }\n        const program = gl.createProgram();\n        const frag = gl.createShader(gl.FRAGMENT_SHADER);\n        const vert = gl.createShader(gl.VERTEX_SHADER);\n        if (!(program && vert && frag))\n            return;\n        this._program = program;\n        this._frag = frag;\n        this._vert = vert;\n        gl.attachShader(program, vert);\n        gl.attachShader(program, frag);\n        gl.shaderSource(vert, vertSource);\n        gl.shaderSource(frag, fragSource);\n        gl.compileShader(vert);\n        gl.compileShader(frag);\n        if (!gl.getShaderParameter(vert, gl.COMPILE_STATUS)) {\n            console.error('Error Compiling Vertex Shader!\\n', gl.getShaderInfoLog(vert), addLineNumbers(vertSource));\n        }\n        if (!gl.getShaderParameter(frag, gl.COMPILE_STATUS)) {\n            console.error('Error Compiling Fragment Shader!\\n', gl.getShaderInfoLog(frag), addLineNumbers(fragSource));\n        }\n        gl.linkProgram(program);\n        const linked = gl.getProgramParameter(program, gl.LINK_STATUS);\n        if (!linked) {\n            const lastError = gl.getProgramInfoLog(program);\n            console.error('Error in program linking:', lastError);\n        }\n        this._uniformSetters = createUniformSetters(gl, program);\n        this._attributeSetters = createAttributeSetters(gl, program);\n        this.fragSource = fragSource;\n        this.vertSource = vertSource;\n        return this;\n    }\n    destroy() {\n        const gl = this._painter.gl;\n        gl.deleteProgram(this._program);\n        gl.deleteShader(this._frag);\n        gl.deleteShader(this._vert);\n        this.vertSource = undefined;\n        this.fragSource = undefined;\n        this._attributeSetters = {};\n        this._uniformSetters = {};\n    }\n}\nfunction addLineNumbers(src) {\n    return src\n        .trim()\n        .split('\\n')\n        .map((line, i) => i + 1 + ': ' + line)\n        .join('\\n');\n}\n//# sourceMappingURL=shade.js.map","let sketchCounter = 1;\nexport class Sketch {\n    constructor(id = 'Sketch' + sketchCounter++) {\n        this.id = id;\n        this._uniforms = [];\n    }\n    update(data) {\n        if (data.drawSettings) {\n            this._drawSettings = data.drawSettings;\n        }\n        if (data.form) {\n            this.form = data.form;\n        }\n        if (data.shade) {\n            this.shade = data.shade;\n        }\n        if (data.uniforms) {\n            this._uniforms = Array.isArray(data.uniforms)\n                ? data.uniforms\n                : [data.uniforms];\n        }\n        return this;\n    }\n    destroy() {\n        this.form && this.form.destroy();\n        this.shade && this.shade.destroy();\n        this._drawSettings = undefined;\n        this._uniforms = [];\n    }\n}\n//# sourceMappingURL=sketch.js.map","import { defaultForms, defaultShaders, getDefaultLayerSettings, } from './asset-lib';\nimport { Form } from './form';\nimport { Frame } from './frame';\nimport { Layer } from './layer';\nimport { applyDrawSettings, revertDrawSettings } from './render-utils';\nimport { Shade } from './shade';\nimport { Sketch } from './sketch';\nimport { resizeCanvas } from './utils/context';\nexport class Painter {\n    constructor(canvas, opts = {}) {\n        this.canvas = canvas;\n        this.isWebGL2 = true;\n        this.maxBufferSamples = 0;\n        let gl = null;\n        if (!opts.useWebGL1) {\n            gl =\n                canvas.getContext('webgl2', opts) ||\n                    canvas.getContext('experimental-webgl2', opts);\n        }\n        if (gl == null) {\n            this.isWebGL2 = false;\n            gl =\n                canvas.getContext('webgl', opts) ||\n                    canvas.getContext('experimental-webgl', opts);\n        }\n        if (gl == null) {\n            throw Error('Cannot initialize WebGL.');\n        }\n        this.gl = gl;\n        this.sizeMultiplier = opts.sizeMultiplier || 1;\n        if (this.isWebGL2) {\n            this.maxBufferSamples = gl.getParameter(gl.MAX_SAMPLES);\n        }\n        this.resize();\n        applyDrawSettings(gl, getDefaultLayerSettings(gl));\n        this._renderQuad = this.createForm().update(defaultForms.renderQuad);\n        this._staticSketch = this.createFlatSketch();\n    }\n    resize() {\n        resizeCanvas(this.gl.canvas, this.sizeMultiplier);\n        return this;\n    }\n    destroy() {\n        this._staticSketch.destroy();\n        this._renderQuad.destroy();\n    }\n    updateDrawSettings(drawSettings) {\n        applyDrawSettings(this.gl, Object.assign({}, drawSettings));\n        return this;\n    }\n    createForm(id) {\n        return new Form(this, id);\n    }\n    createShade(id) {\n        return new Shade(this, id);\n    }\n    createSketch(id) {\n        return new Sketch(id);\n    }\n    createFlatSketch(id) {\n        const s = this.createSketch(id);\n        return s.update({\n            form: this._renderQuad,\n            shade: this.createShade(s.id + '_defaultShade').update(defaultShaders.basicEffect),\n        });\n    }\n    createFrame(id) {\n        return new Frame(this, id);\n    }\n    createLayer(id) {\n        return new Layer(id);\n    }\n    createEffect(id) {\n        const l = this.createLayer(id);\n        return l.update({\n            sketches: this.createFlatSketch(l.id + '_effectSketch'),\n        });\n    }\n    draw(sketch, globalUniforms) {\n        const gl = this.gl;\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n        draw(gl, sketch, globalUniforms);\n        return this;\n    }\n    compose(...frames) {\n        for (const frame of frames) {\n            renderFrame(this.gl, frame);\n        }\n        return this;\n    }\n    display(frame, idx = 0) {\n        return this.draw(this._staticSketch, { source: frame.image(idx) });\n    }\n}\nfunction draw(gl, sketch, globalUniforms, sources) {\n    const { shade: shade, form: form, _drawSettings: drawSettings, _uniforms: uniforms, } = sketch;\n    if (!(shade && form)) {\n        throw Error('cannot draw, shader or geometry are not set');\n    }\n    gl.useProgram(shade._program);\n    shadeForm(shade, form);\n    if (globalUniforms) {\n        shadeUniforms(shade, globalUniforms, sources);\n    }\n    if (drawSettings) {\n        applyDrawSettings(gl, drawSettings);\n    }\n    for (let i = 0; i < (uniforms.length || 1); i++) {\n        drawInstance(gl, sketch, uniforms[i], sources);\n    }\n    if (drawSettings) {\n        revertDrawSettings(gl, drawSettings);\n    }\n}\nfunction drawInstance(gl, sketch, uniforms, sources) {\n    if (uniforms) {\n        shadeUniforms(sketch.shade, uniforms, sources);\n    }\n    if (sketch.form._elements && sketch.form._elements.glType != null) {\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sketch.form._elements.buffer);\n        gl.drawElements(sketch.form._drawType, sketch.form._itemCount, sketch.form._elements.glType, 0);\n    }\n    else {\n        gl.drawArrays(sketch.form._drawType, 0, sketch.form._itemCount);\n    }\n}\nfunction shadeForm(shade, form) {\n    for (const name in form._attribs) {\n        const setter = shade._attributeSetters[name];\n        if (setter) {\n            setter.setter(form._attribs[name]);\n        }\n    }\n}\nfunction shadeUniforms(shade, uniforms, sources) {\n    for (const name in uniforms) {\n        const setter = shade._uniformSetters[name];\n        if (setter) {\n            let value = uniforms[name];\n            if (typeof value === 'function') {\n                value = value();\n            }\n            if (typeof value === 'string' && sources) {\n                setter.setter(sources[value]);\n            }\n            else {\n                setter.setter(value);\n            }\n        }\n    }\n}\nfunction renderLayer(gl, layer, uniforms, target, source) {\n    if (target) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, target.frameBuffer);\n        gl.viewport(0, 0, target.width, target.height);\n    }\n    else {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    }\n    if (layer._data.drawSettings) {\n        applyDrawSettings(gl, layer._data.drawSettings);\n    }\n    for (const sketch of layer.sketches) {\n        draw(gl, sketch, uniforms, source);\n    }\n    if (layer._data.drawSettings) {\n        revertDrawSettings(gl, layer._data.drawSettings);\n    }\n}\nfunction renderFrame(gl, frame) {\n    for (let i = 0; i < frame.layers.length; i++) {\n        const layer = frame.layers[i];\n        const layerPasses = layer._uniforms.length || 1;\n        for (let j = 0; j < layerPasses; j++) {\n            const target = frame._targets[0];\n            const sources = i + j === 0 && frame._textures.length\n                ? frame._textures\n                : frame._targets[1] && frame._targets[1].textures;\n            renderLayer(gl, layer, layer._uniforms[j], target, sources);\n            frame._swapTargets();\n        }\n    }\n}\n//# sourceMappingURL=painter.js.map","import { once } from './scheduler'\nimport { windowSize } from 'tvs-libs/dist/events/dom'\nimport { keyboard, KeyState } from 'tvs-libs/dist/events/keyboard'\nimport { mouse, MouseState } from 'tvs-libs/dist/events/mouse'\nimport { deepOverride } from 'tvs-libs/dist/utils/object'\nimport { PainterOptions } from 'tvs-painter'\nimport { Form } from 'tvs-painter/dist/form'\nimport { Frame } from 'tvs-painter/dist/frame'\nimport { Layer } from 'tvs-painter/dist/layer'\nimport { Painter } from 'tvs-painter/dist/painter'\nimport { Shade } from 'tvs-painter/dist/shade'\nimport { Sketch } from 'tvs-painter/dist/sketch'\n\n// === Painter ===\n\nlet currentCanvas: HTMLCanvasElement\nlet painter: Painter\n\nexport function getPainter(canvas: HTMLCanvasElement, opts?: PainterOptions) {\n\tinit(canvas, opts)\n\treturn painter\n}\n\nconst forms: { [id: string]: Form } = {}\nexport function getForm(painter: Painter, id: string) {\n\treturn forms[id] || (forms[id] = painter.createForm('Form_' + id))\n}\n\nconst shades: { [id: string]: Shade } = {}\nexport function getShade(painter: Painter, id: string) {\n\treturn shades[id] || (shades[id] = painter.createShade('Shade_' + id))\n}\n\nconst sketches: { [id: string]: Sketch } = {}\nexport function getSketch(painter: Painter, id: string) {\n\treturn sketches[id] || (sketches[id] = painter.createSketch('Sketch_' + id))\n}\n\nconst layers: { [id: string]: Layer } = {}\nexport function getLayer(painter: Painter, id: string) {\n\treturn layers[id] || (layers[id] = painter.createLayer('Layer_' + id))\n}\n\nconst frames: { [id: string]: Frame } = {}\nexport function getFrame(painter: Painter, id: string) {\n\treturn frames[id] || (frames[id] = painter.createFrame('Frame_' + id))\n}\n\nconst effects: { [id: string]: Layer } = {}\nexport function getEffect(painter: Painter, id: string) {\n\treturn effects[id] || (effects[id] = painter.createEffect('Effect_' + id))\n}\n\n// === State ===\n\nexport interface BaseState {\n\tdevice: {\n\t\ttpf: number\n\t\tcanvas: HTMLCanvasElement\n\t\tmouse: MouseState\n\t\tkeys: KeyState\n\t\tsizeMultiplier: number\n\t\tkeepCanvasSize?: boolean\n\t}\n}\n\nexport const state: BaseState = {\n\tdevice: {\n\t\ttpf: 0,\n\t\tsizeMultiplier: 1,\n\t},\n} as BaseState\n;(window as any).state = state\n\nexport function get<\n\tS extends BaseState = BaseState,\n\tK extends keyof S = keyof S\n>(prop: K): S[K] {\n\treturn (state as S)[prop]\n}\n\nexport function set<\n\tS extends BaseState = BaseState,\n\tK extends keyof S = keyof S\n>(key: K, val: S[K], opts?: { reset: any }) {\n\tconst s = state as S\n\tif (s[key]) {\n\t\tconst reset = opts && opts.reset\n\t\tif (reset !== true) {\n\t\t\tval = deepOverride(val, s[key], { ignore: reset })\n\t\t}\n\t}\n\ts[key] = val\n}\n\nexport function getState<S extends BaseState>() {\n\treturn state as S\n}\n\n// === Systems ===\n\ntype ActionHandler<S extends BaseState = BaseState> = (\n\tevent: string,\n\tstate: S,\n) => void\n\nconst systems: { [id: string]: ActionHandler<any> } = {}\n\nexport function addSystem<S extends BaseState = BaseState>(\n\tid: string,\n\ts: ActionHandler<S>,\n) {\n\tsystems[id] = s\n}\n\nexport function dispatch(event: string) {\n\tfor (const k in systems) {\n\t\tsystems[k](event, state)\n\t}\n}\n\nexport const baseEvents = {\n\tFRAME: 'frame',\n\tRESIZE: 'resize',\n}\n\n// === Init ===\n\nlet cancelWindow: () => void\nlet cancelMouse: () => void\nlet cancelKeys: () => void\n\nexport function init(canvas: HTMLCanvasElement, opts?: PainterOptions) {\n\tif (canvas !== currentCanvas) {\n\t\tcurrentCanvas = canvas\n\n\t\tpainter = new Painter(canvas, opts)\n\n\t\tstate.device.canvas = canvas\n\n\t\tcancelWindow && cancelWindow()\n\t\tcancelMouse && cancelMouse()\n\t\tcancelKeys && cancelKeys()\n\n\t\tcancelWindow = windowSize(() =>\n\t\t\tonce(() => {\n\t\t\t\tpainter.sizeMultiplier = state.device.sizeMultiplier\n\t\t\t\tpainter.resize()\n\t\t\t\tdispatch(baseEvents.RESIZE)\n\t\t\t}, 'resize'),\n\t\t)\n\n\t\tcancelMouse = mouse(\n\t\t\t{ element: canvas, enableRightButton: true },\n\t\t\tm => (state.device.mouse = m),\n\t\t)\n\n\t\tcancelKeys = keyboard(k => (state.device.keys = k))\n\t}\n}\n\n\nif (module.hot) {module.hot.accept(function(err) {\nif (err) {\nconsole.error(err);\n}\n});\n}\n","export function deepmerge(obj1, obj2) {\n    if (typeof obj1 === 'object' &&\n        typeof obj2 === 'object' &&\n        !Array.isArray(obj1) &&\n        !Array.isArray(obj2) &&\n        obj1 !== obj2) {\n        const result = Object.assign({}, obj1);\n        for (const key in obj2) {\n            const val1 = obj1[key];\n            const val2 = obj2[key];\n            if (typeof val2 !== 'undefined') {\n                result[key] = deepmerge(val1, val2);\n            }\n            else {\n                delete result[key];\n            }\n        }\n        return result;\n    }\n    return obj2;\n}\nexport function deepOverride(obj1, obj2, opt) {\n    const ignore = opt && opt.ignore;\n    if (typeof obj1 === 'object' &&\n        typeof obj2 === 'object' &&\n        !Array.isArray(obj1) &&\n        !Array.isArray(obj2) &&\n        obj1 !== obj2) {\n        for (const key in obj1) {\n            if (obj1.hasOwnProperty(key) &&\n                !(ignore && key in ignore && ignore[key] === true)) {\n                const val1 = obj1[key];\n                const val2 = obj2[key];\n                if (val2 !== undefined) {\n                    obj1[key] = deepOverride(val1, val2, {\n                        ignore: ignore && ignore[key],\n                    });\n                }\n            }\n        }\n        return obj1;\n    }\n    return obj2;\n}\n//# sourceMappingURL=object.js.map","import { randInt, randIntInRange } from '../math/random';\nexport function pickRandom(arr) {\n    return arr[randInt(arr.length)];\n}\nexport function doTimes(fn, count) {\n    for (let i = 0; i < count; i++) {\n        fn(i);\n    }\n}\nexport function times(fn, count, res = []) {\n    for (let i = 0; i < count; i++) {\n        res[i] = fn(i);\n    }\n    return res;\n}\nexport function zip(fn, as, bs, res = []) {\n    const length = Math.min(as.length, bs.length);\n    for (let i = 0; i < length; i++) {\n        res[i] = fn(as[i], bs[i]);\n    }\n    return res;\n}\nexport function flatten(array, res = []) {\n    for (const subarray of array) {\n        const currentLength = res.length;\n        for (let i = 0; i < subarray.length; i++) {\n            res[i + currentLength] = subarray[i];\n        }\n    }\n    return res;\n}\nexport function mapcat(fn, array, res = []) {\n    return flatten(array.map(fn), res);\n}\nexport function shuffle(arr) {\n    const shuffled = [];\n    for (let i = 0; i < arr.length; i++) {\n        const j = randIntInRange(i, arr.length);\n        const temp = shuffled[i] !== undefined ? shuffled[i] : arr[i];\n        shuffled[i] = shuffled[j] !== undefined ? shuffled[j] : arr[j];\n        shuffled[j] = temp;\n    }\n    return shuffled;\n}\nexport function map(fn, coll) {\n    if (Array.isArray(coll)) {\n        return coll.map(fn);\n    }\n    else {\n        const obj = {};\n        for (const key in coll) {\n            obj[key] = fn(coll[key], key);\n        }\n        return obj;\n    }\n}\nexport function each(fn, coll) {\n    for (const key in coll) {\n        fn(coll[key], key);\n    }\n}\n//# sourceMappingURL=sequence.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","export const DEFAULT_EPS = 1e-6;\n/**\n * Internal use only. **Do NOT use in user land code!**\n *\n * @internal\n */\nexport const SEMAPHORE = Symbol();\n/**\n * No-effect placeholder function.\n */\nexport const NO_OP = () => { };\n/**\n * Catch-all event ID\n */\nexport const EVENT_ALL = \"*\";\nexport const EVENT_ENABLE = \"enable\";\nexport const EVENT_DISABLE = \"disable\";\n","export var Keys;\n(function (Keys) {\n    Keys[Keys[\"CANCEL\"] = 3] = \"CANCEL\";\n    Keys[Keys[\"HELP\"] = 6] = \"HELP\";\n    Keys[Keys[\"BACK_SPACE\"] = 8] = \"BACK_SPACE\";\n    Keys[Keys[\"TAB\"] = 9] = \"TAB\";\n    Keys[Keys[\"CLEAR\"] = 12] = \"CLEAR\";\n    Keys[Keys[\"RETURN\"] = 13] = \"RETURN\";\n    Keys[Keys[\"ENTER\"] = 14] = \"ENTER\";\n    Keys[Keys[\"SHIFT\"] = 16] = \"SHIFT\";\n    Keys[Keys[\"CONTROL\"] = 17] = \"CONTROL\";\n    Keys[Keys[\"ALT\"] = 18] = \"ALT\";\n    Keys[Keys[\"PAUSE\"] = 19] = \"PAUSE\";\n    Keys[Keys[\"CAPS_LOCK\"] = 20] = \"CAPS_LOCK\";\n    Keys[Keys[\"ESCAPE\"] = 27] = \"ESCAPE\";\n    Keys[Keys[\"SPACE\"] = 32] = \"SPACE\";\n    Keys[Keys[\"PAGE_UP\"] = 33] = \"PAGE_UP\";\n    Keys[Keys[\"PAGE_DOWN\"] = 34] = \"PAGE_DOWN\";\n    Keys[Keys[\"END\"] = 35] = \"END\";\n    Keys[Keys[\"HOME\"] = 36] = \"HOME\";\n    Keys[Keys[\"LEFT\"] = 37] = \"LEFT\";\n    Keys[Keys[\"UP\"] = 38] = \"UP\";\n    Keys[Keys[\"RIGHT\"] = 39] = \"RIGHT\";\n    Keys[Keys[\"DOWN\"] = 40] = \"DOWN\";\n    Keys[Keys[\"PRINTSCREEN\"] = 44] = \"PRINTSCREEN\";\n    Keys[Keys[\"INSERT\"] = 45] = \"INSERT\";\n    Keys[Keys[\"DELETE\"] = 46] = \"DELETE\";\n    Keys[Keys[\"DIGIT_0\"] = 48] = \"DIGIT_0\";\n    Keys[Keys[\"DIGIT_1\"] = 49] = \"DIGIT_1\";\n    Keys[Keys[\"DIGIT_2\"] = 50] = \"DIGIT_2\";\n    Keys[Keys[\"DIGIT_3\"] = 51] = \"DIGIT_3\";\n    Keys[Keys[\"DIGIT_4\"] = 52] = \"DIGIT_4\";\n    Keys[Keys[\"DIGIT_5\"] = 53] = \"DIGIT_5\";\n    Keys[Keys[\"DIGIT_6\"] = 54] = \"DIGIT_6\";\n    Keys[Keys[\"DIGIT_7\"] = 55] = \"DIGIT_7\";\n    Keys[Keys[\"DIGIT_8\"] = 56] = \"DIGIT_8\";\n    Keys[Keys[\"DIGIT_9\"] = 57] = \"DIGIT_9\";\n    Keys[Keys[\"SEMICOLON\"] = 59] = \"SEMICOLON\";\n    Keys[Keys[\"EQUALS\"] = 61] = \"EQUALS\";\n    Keys[Keys[\"A\"] = 65] = \"A\";\n    Keys[Keys[\"B\"] = 66] = \"B\";\n    Keys[Keys[\"C\"] = 67] = \"C\";\n    Keys[Keys[\"D\"] = 68] = \"D\";\n    Keys[Keys[\"E\"] = 69] = \"E\";\n    Keys[Keys[\"F\"] = 70] = \"F\";\n    Keys[Keys[\"G\"] = 71] = \"G\";\n    Keys[Keys[\"H\"] = 72] = \"H\";\n    Keys[Keys[\"I\"] = 73] = \"I\";\n    Keys[Keys[\"J\"] = 74] = \"J\";\n    Keys[Keys[\"K\"] = 75] = \"K\";\n    Keys[Keys[\"L\"] = 76] = \"L\";\n    Keys[Keys[\"M\"] = 77] = \"M\";\n    Keys[Keys[\"N\"] = 78] = \"N\";\n    Keys[Keys[\"O\"] = 79] = \"O\";\n    Keys[Keys[\"P\"] = 80] = \"P\";\n    Keys[Keys[\"Q\"] = 81] = \"Q\";\n    Keys[Keys[\"R\"] = 82] = \"R\";\n    Keys[Keys[\"S\"] = 83] = \"S\";\n    Keys[Keys[\"T\"] = 84] = \"T\";\n    Keys[Keys[\"U\"] = 85] = \"U\";\n    Keys[Keys[\"V\"] = 86] = \"V\";\n    Keys[Keys[\"W\"] = 87] = \"W\";\n    Keys[Keys[\"X\"] = 88] = \"X\";\n    Keys[Keys[\"Y\"] = 89] = \"Y\";\n    Keys[Keys[\"Z\"] = 90] = \"Z\";\n    Keys[Keys[\"CONTEXT_MENU\"] = 93] = \"CONTEXT_MENU\";\n    Keys[Keys[\"NUMPAD0\"] = 96] = \"NUMPAD0\";\n    Keys[Keys[\"NUMPAD1\"] = 97] = \"NUMPAD1\";\n    Keys[Keys[\"NUMPAD2\"] = 98] = \"NUMPAD2\";\n    Keys[Keys[\"NUMPAD3\"] = 99] = \"NUMPAD3\";\n    Keys[Keys[\"NUMPAD4\"] = 100] = \"NUMPAD4\";\n    Keys[Keys[\"NUMPAD5\"] = 101] = \"NUMPAD5\";\n    Keys[Keys[\"NUMPAD6\"] = 102] = \"NUMPAD6\";\n    Keys[Keys[\"NUMPAD7\"] = 103] = \"NUMPAD7\";\n    Keys[Keys[\"NUMPAD8\"] = 104] = \"NUMPAD8\";\n    Keys[Keys[\"NUMPAD9\"] = 105] = \"NUMPAD9\";\n    Keys[Keys[\"MULTIPLY\"] = 106] = \"MULTIPLY\";\n    Keys[Keys[\"ADD\"] = 107] = \"ADD\";\n    Keys[Keys[\"SEPARATOR\"] = 108] = \"SEPARATOR\";\n    Keys[Keys[\"SUBTRACT\"] = 109] = \"SUBTRACT\";\n    Keys[Keys[\"DECIMAL\"] = 110] = \"DECIMAL\";\n    Keys[Keys[\"DIVIDE\"] = 111] = \"DIVIDE\";\n    Keys[Keys[\"F1\"] = 112] = \"F1\";\n    Keys[Keys[\"F2\"] = 113] = \"F2\";\n    Keys[Keys[\"F3\"] = 114] = \"F3\";\n    Keys[Keys[\"F4\"] = 115] = \"F4\";\n    Keys[Keys[\"F5\"] = 116] = \"F5\";\n    Keys[Keys[\"F6\"] = 117] = \"F6\";\n    Keys[Keys[\"F7\"] = 118] = \"F7\";\n    Keys[Keys[\"F8\"] = 119] = \"F8\";\n    Keys[Keys[\"F9\"] = 120] = \"F9\";\n    Keys[Keys[\"F10\"] = 121] = \"F10\";\n    Keys[Keys[\"F11\"] = 122] = \"F11\";\n    Keys[Keys[\"F12\"] = 123] = \"F12\";\n    Keys[Keys[\"F13\"] = 124] = \"F13\";\n    Keys[Keys[\"F14\"] = 125] = \"F14\";\n    Keys[Keys[\"F15\"] = 126] = \"F15\";\n    Keys[Keys[\"F16\"] = 127] = \"F16\";\n    Keys[Keys[\"F17\"] = 128] = \"F17\";\n    Keys[Keys[\"F18\"] = 129] = \"F18\";\n    Keys[Keys[\"F19\"] = 130] = \"F19\";\n    Keys[Keys[\"F20\"] = 131] = \"F20\";\n    Keys[Keys[\"F21\"] = 132] = \"F21\";\n    Keys[Keys[\"F22\"] = 133] = \"F22\";\n    Keys[Keys[\"F23\"] = 134] = \"F23\";\n    Keys[Keys[\"F24\"] = 135] = \"F24\";\n    Keys[Keys[\"NUM_LOCK\"] = 144] = \"NUM_LOCK\";\n    Keys[Keys[\"SCROLL_LOCK\"] = 145] = \"SCROLL_LOCK\";\n    Keys[Keys[\"COMMA\"] = 188] = \"COMMA\";\n    Keys[Keys[\"PERIOD\"] = 190] = \"PERIOD\";\n    Keys[Keys[\"SLASH\"] = 191] = \"SLASH\";\n    Keys[Keys[\"BACK_QUOTE\"] = 192] = \"BACK_QUOTE\";\n    Keys[Keys[\"OPEN_BRACKET\"] = 219] = \"OPEN_BRACKET\";\n    Keys[Keys[\"BACK_SLASH\"] = 220] = \"BACK_SLASH\";\n    Keys[Keys[\"CLOSE_BRACKET\"] = 221] = \"CLOSE_BRACKET\";\n    Keys[Keys[\"QUOTE\"] = 222] = \"QUOTE\";\n    Keys[Keys[\"META\"] = 224] = \"META\";\n})(Keys || (Keys = {}));\nexport function keyboard(opts, callback) {\n    const cb = callback || opts;\n    const { element = window } = opts;\n    const pressed = {};\n    function onKeydown(event) {\n        pressed[event.keyCode] = Date.now();\n        cb(pressed);\n    }\n    function onKeyup(event) {\n        delete pressed[event.keyCode];\n        cb(pressed);\n    }\n    element.addEventListener('keyup', onKeyup, false);\n    element.addEventListener('keydown', onKeydown, false);\n    cb(pressed);\n    return function stop() {\n        element.removeEventListener('keyup', onKeyup);\n        element.removeEventListener('keydown', onKeydown);\n    };\n}\nexport function keyboardObserver(opts) {\n    const observer = {\n        Keys,\n        state: { pressed: {} },\n        destroy: () => { },\n    };\n    function callback(pressed) {\n        observer.state.pressed = pressed;\n    }\n    observer.destroy = keyboard(callback, opts);\n    return observer;\n}\n//# sourceMappingURL=keyboard.js.map","import { baseEvents, getPainter } from '../../shared-utils/painterState'\n\nexport const canvas = document.getElementById('canvas') as HTMLCanvasElement\n\nexport const painter = getPainter(canvas)\n\nexport const gl = painter.gl\n\nexport const events = {\n\t...baseEvents,\n}\n\n\nif (module.hot) {module.hot.accept(function(err) {\nif (err) {\nconsole.error(err);\n}\n});\n}\n","export const isString = (x) => typeof x === \"string\";\n","let symID = 0;\n/**\n * Helper for deterministic code generation / testing. Resets sym ID\n * counter.\n */\nexport const resetSymID = () => (symID = 0);\n/**\n * Generates a new symbol name, e.g. `_sa2`. Uses base36 for counter to\n * keep names short.\n */\nexport const gensym = () => `_s${(symID++).toString(36)}`;\n","export const isArray = Array.isArray;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","const OBJP = Object.getPrototypeOf;\n/**\n * Similar to {@link isObject}, but also checks if prototype is that of\n * `Object` (or `null`).\n *\n * @param x -\n */\nexport const isPlainObject = (x) => {\n    let p;\n    return (x != null &&\n        typeof x === \"object\" &&\n        ((p = OBJP(x)) === null || OBJP(p) === null));\n};\n","const OBJP = Object.getPrototypeOf({});\nconst FN = \"function\";\nconst STR = \"string\";\nexport const equiv = (a, b) => {\n    let proto;\n    if (a === b) {\n        return true;\n    }\n    if (a != null) {\n        if (typeof a.equiv === FN) {\n            return a.equiv(b);\n        }\n    }\n    else {\n        return a == b;\n    }\n    if (b != null) {\n        if (typeof b.equiv === FN) {\n            return b.equiv(a);\n        }\n    }\n    else {\n        return a == b;\n    }\n    if (typeof a === STR || typeof b === STR) {\n        return false;\n    }\n    if (((proto = Object.getPrototypeOf(a)), proto == null || proto === OBJP) &&\n        ((proto = Object.getPrototypeOf(b)), proto == null || proto === OBJP)) {\n        return equivObject(a, b);\n    }\n    if (typeof a !== FN &&\n        a.length !== undefined &&\n        typeof b !== FN &&\n        b.length !== undefined) {\n        return equivArrayLike(a, b);\n    }\n    if (a instanceof Set && b instanceof Set) {\n        return equivSet(a, b);\n    }\n    if (a instanceof Map && b instanceof Map) {\n        return equivMap(a, b);\n    }\n    if (a instanceof Date && b instanceof Date) {\n        return a.getTime() === b.getTime();\n    }\n    if (a instanceof RegExp && b instanceof RegExp) {\n        return a.toString() === b.toString();\n    }\n    // NaN\n    return a !== a && b !== b;\n};\nexport const equivArrayLike = (a, b, _equiv = equiv) => {\n    let l = a.length;\n    if (l === b.length) {\n        while (--l >= 0 && _equiv(a[l], b[l]))\n            ;\n    }\n    return l < 0;\n};\nexport const equivSet = (a, b, _equiv = equiv) => a.size === b.size && _equiv([...a.keys()].sort(), [...b.keys()].sort());\nexport const equivMap = (a, b, _equiv = equiv) => a.size === b.size && _equiv([...a].sort(), [...b].sort());\nexport const equivObject = (a, b, _equiv = equiv) => {\n    if (Object.keys(a).length !== Object.keys(b).length) {\n        return false;\n    }\n    for (let k in a) {\n        if (!b.hasOwnProperty(k) || !_equiv(a[k], b[k])) {\n            return false;\n        }\n    }\n    return true;\n};\n","export function dissoc(coll, keys) {\n    for (let k of keys) {\n        coll.delete(k);\n    }\n    return coll;\n}\nexport const dissocObj = (obj, keys) => {\n    for (let k of keys) {\n        delete obj[k];\n    }\n    return obj;\n};\n","/**\n * Reducer composition helper, internally used by various transducers\n * during initialization. Takes existing reducer `rfn` (a 3-tuple) and a\n * reducing function `fn`. Returns a new reducer tuple.\n *\n * @remarks\n * `rfn[2]` reduces values of type `B` into an accumulator of type `A`.\n * `fn` accepts values of type `C` and produces interim results of type\n * `B`, which are then (possibly) passed to the \"inner\" `rfn[2]`\n * function. Therefore the resulting reducer takes inputs of `C` and an\n * accumulator of type `A`.\n *\n * It is assumed that `fn` internally calls `rfn[2]` to pass its own\n * results for further processing by the nested reducer `rfn`.\n *\n * @example\n * ```ts\n * compR(rfn, fn)\n * // [rfn[0], rfn[1], fn]\n * ```\n *\n * @param rfn -\n * @param fn -\n */\nexport const compR = (rfn, fn) => [rfn[0], rfn[1], fn];\n","export const implementsFunction = (x, fn) => x != null && typeof x[fn] === \"function\";\n","import { implementsFunction } from \"@thi.ng/checks\";\nexport const ensureTransducer = (x) => implementsFunction(x, \"xform\")\n    ? x.xform()\n    : x;\n","export class Reduced {\n    constructor(val) {\n        this.value = val;\n    }\n    deref() {\n        return this.value;\n    }\n}\nexport const reduced = (x) => new Reduced(x);\nexport const isReduced = (x) => x instanceof Reduced;\nexport const ensureReduced = (x) => x instanceof Reduced ? x : new Reduced(x);\nexport const unreduced = (x) => (x instanceof Reduced ? x.deref() : x);\n","export const defError = (prefix, suffix = (msg) => (msg !== undefined ? \": \" + msg : \"\")) => class extends Error {\n    constructor(msg) {\n        super(prefix(msg) + suffix(msg));\n    }\n};\n","import { defError } from \"./deferror\";\nexport const IllegalArityError = defError(() => \"illegal arity\");\nexport const illegalArity = (n) => {\n    throw new IllegalArityError(n);\n};\n","import { implementsFunction, isArrayLike, isIterable } from \"@thi.ng/checks\";\nimport { illegalArity } from \"@thi.ng/errors\";\nimport { isReduced, unreduced } from \"./reduced\";\nconst parseArgs = (args) => args.length === 2\n    ? [undefined, args[1]]\n    : args.length === 3\n        ? [args[1], args[2]]\n        : illegalArity(args.length);\nexport function reduce(...args) {\n    const rfn = args[0];\n    const init = rfn[0];\n    const complete = rfn[1];\n    const reduce = rfn[2];\n    args = parseArgs(args);\n    const acc = args[0] == null ? init() : args[0];\n    const xs = args[1];\n    return unreduced(complete(implementsFunction(xs, \"$reduce\")\n        ? xs.$reduce(reduce, acc)\n        : isArrayLike(xs)\n            ? reduceArray(reduce, acc, xs)\n            : reduceIterable(reduce, acc, xs)));\n}\nconst reduceArray = (rfn, acc, xs) => {\n    for (let i = 0, n = xs.length; i < n; i++) {\n        acc = rfn(acc, xs[i]);\n        if (isReduced(acc)) {\n            acc = acc.deref();\n            break;\n        }\n    }\n    return acc;\n};\nconst reduceIterable = (rfn, acc, xs) => {\n    for (let x of xs) {\n        acc = rfn(acc, x);\n        if (isReduced(acc)) {\n            acc = acc.deref();\n            break;\n        }\n    }\n    return acc;\n};\n/**\n * Convenience helper for building a full {@link Reducer} using the identity\n * function (i.e. `(x) => x`) as completion step (true for 90% of all\n * bundled transducers).\n *\n * @param init - init step of reducer\n * @param rfn - reduction step of reducer\n */\nexport const reducer = (init, rfn) => [init, (acc) => acc, rfn];\nexport const $$reduce = (rfn, args) => {\n    const n = args.length - 1;\n    return isIterable(args[n])\n        ? args.length > 1\n            ? reduce(rfn.apply(null, args.slice(0, n)), args[n])\n            : reduce(rfn(), args[0])\n        : undefined;\n};\n","export const isArrayLike = (x) => x != null && typeof x !== \"function\" && x.length !== undefined;\n","import { NO_OP, SEMAPHORE } from \"@thi.ng/api\";\nimport { isIterable } from \"@thi.ng/checks\";\nimport { ensureTransducer } from \"./internal/ensure\";\nimport { isReduced, unreduced } from \"./reduced\";\nimport { push } from \"./rfn/push\";\n/**\n * Takes a transducer and input iterable. Returns iterator of\n * transformed results.\n *\n * @param xform -\n * @param xs -\n */\nexport function* iterator(xform, xs) {\n    const rfn = ensureTransducer(xform)(push());\n    const complete = rfn[1];\n    const reduce = rfn[2];\n    for (let x of xs) {\n        const y = reduce([], x);\n        if (isReduced(y)) {\n            yield* unreduced(complete(y.deref()));\n            return;\n        }\n        if (y.length) {\n            yield* y;\n        }\n    }\n    yield* unreduced(complete([]));\n}\n/**\n * Optimized version of {@link iterator} for transducers which are\n * guaranteed to:\n *\n * 1) Only produce none or a single result per input\n * 2) Do not require a `completion` reduction step\n *\n * @param xform -\n * @param xs -\n */\nexport function* iterator1(xform, xs) {\n    const reduce = (ensureTransducer(xform)([NO_OP, NO_OP, (_, x) => x]))[2];\n    for (let x of xs) {\n        let y = reduce(SEMAPHORE, x);\n        if (isReduced(y)) {\n            y = unreduced(y.deref());\n            if (y !== SEMAPHORE) {\n                yield y;\n            }\n            return;\n        }\n        if (y !== SEMAPHORE) {\n            yield y;\n        }\n    }\n}\n/**\n * Helper function used by various transducers to wrap themselves as\n * transforming iterators. Delegates to {@link iterator1} by default.\n *\n * @param xform -\n * @param args -\n * @param impl -\n *\n * @internal\n */\nexport const $iter = (xform, args, impl = iterator1) => {\n    const n = args.length - 1;\n    return isIterable(args[n])\n        ? args.length > 1\n            ? impl(xform.apply(null, args.slice(0, n)), args[n])\n            : impl(xform(), args[0])\n        : undefined;\n};\n","import { compR } from \"../func/compr\";\nimport { iterator1 } from \"../iterator\";\nexport function map(fn, src) {\n    return src\n        ? iterator1(map(fn), src)\n        : (rfn) => {\n            const r = rfn[2];\n            return compR(rfn, (acc, x) => r(acc, fn(x)));\n        };\n}\n","import { mixin } from \"@thi.ng/api\";\nimport { isNode } from \"@thi.ng/checks\";\nimport { map } from \"@thi.ng/transducers\";\nconst inspect = isNode() ? require(\"util\").inspect : null;\nconst inspectSet = (coll, opts) => [...map((x) => inspect(x, opts), coll)].join(\", \");\nconst inspectMap = (coll, opts) => [\n    ...map(([k, v]) => `${inspect(k, opts)} => ${inspect(v, opts)}`, coll),\n].join(\", \");\n/**\n * NodeJS inspection mixin\n *\n * @remarks\n * Reference:\n * https://nodejs.org/api/util.html#util_custom_inspection_functions_on_objects\n *\n * @internal\n */\nexport const inspectable = mixin({\n    [Symbol.for(\"nodejs.util.inspect.custom\")](depth, opts) {\n        const name = this[Symbol.toStringTag];\n        const childOpts = Object.assign(Object.assign({}, opts), { depth: opts.depth === null ? null : opts.depth - 1 });\n        return depth >= 0\n            ? [\n                `${name}(${this.size || 0}) {`,\n                inspect\n                    ? this instanceof Set\n                        ? inspectSet(this, childOpts)\n                        : this instanceof Map\n                            ? inspectMap(this, childOpts)\n                            : \"\"\n                    : \"\",\n                \"}\",\n            ].join(\" \")\n            : opts.stylize(`[${name}]`, \"special\");\n    },\n});\n","/**\n * Class behavior mixin based on:\n * {@link http://raganwald.com/2015/06/26/decorators-in-es7.html}\n *\n * Additionally only injects/overwrites properties in target, which are\n * NOT marked with `@nomixin` (i.e. haven't set their `configurable`\n * property descriptor flag to `false`)\n *\n * @param behaviour - to mixin\n * @param sharedBehaviour -\n * @returns decorator function\n */\nexport const mixin = (behaviour, sharedBehaviour = {}) => {\n    const instanceKeys = Reflect.ownKeys(behaviour);\n    const sharedKeys = Reflect.ownKeys(sharedBehaviour);\n    const typeTag = Symbol(\"isa\");\n    function _mixin(clazz) {\n        for (let key of instanceKeys) {\n            const existing = Object.getOwnPropertyDescriptor(clazz.prototype, key);\n            if (!existing || existing.configurable) {\n                Object.defineProperty(clazz.prototype, key, {\n                    value: behaviour[key],\n                    writable: true\n                });\n            }\n            else {\n                console.log(`not patching: ${clazz.name}.${key.toString()}`);\n            }\n        }\n        Object.defineProperty(clazz.prototype, typeTag, { value: true });\n        return clazz;\n    }\n    for (let key of sharedKeys) {\n        Object.defineProperty(_mixin, key, {\n            value: sharedBehaviour[key],\n            enumerable: sharedBehaviour.propertyIsEnumerable(key)\n        });\n    }\n    Object.defineProperty(_mixin, Symbol.hasInstance, {\n        value: (x) => !!x[typeTag]\n    });\n    return _mixin;\n};\n","export const isMap = (x) => x instanceof Map;\n","import { isMap } from \"@thi.ng/checks\";\nexport function into(dest, src) {\n    if (isMap(dest)) {\n        for (let x of src) {\n            dest.set(x[0], x[1]);\n        }\n    }\n    else {\n        for (let x of src) {\n            dest.add(x);\n        }\n    }\n    return dest;\n}\n","var ArraySet_1;\nimport { __decorate } from \"tslib\";\nimport { SEMAPHORE } from \"@thi.ng/api\";\nimport { equiv } from \"@thi.ng/equiv\";\nimport { dissoc } from \"./dissoc\";\nimport { equivSet } from \"./internal/equiv\";\nimport { inspectable } from \"./internal/inspect\";\nimport { into } from \"./into\";\nconst __private = new WeakMap();\nconst __vals = (inst) => __private.get(inst).vals;\n/**\n * An alternative set implementation to the native ES6 Set type. Uses\n * customizable equality/equivalence predicate and so is more useful\n * when dealing with structured data. Implements full API of native Set\n * and by the default uses {@link @thi.ng/equiv#equiv} for equivalence\n * checking.\n *\n * Additionally, the type also implements the {@link @thi.ng/api#ICopy},\n * {@link @thi.ng/api#IEmpty} and {@link @thi.ng/api#IEquiv} interfaces\n * itself.\n */\nlet ArraySet = ArraySet_1 = class ArraySet extends Set {\n    constructor(vals, opts = {}) {\n        super();\n        __private.set(this, { equiv: opts.equiv || equiv, vals: [] });\n        vals && this.into(vals);\n    }\n    *[Symbol.iterator]() {\n        yield* __vals(this);\n    }\n    get [Symbol.species]() {\n        return ArraySet_1;\n    }\n    get [Symbol.toStringTag]() {\n        return \"ArraySet\";\n    }\n    get size() {\n        return __vals(this).length;\n    }\n    copy() {\n        const $this = __private.get(this);\n        const s = new ArraySet_1(null, { equiv: $this.equiv });\n        __private.get(s).vals = $this.vals.slice();\n        return s;\n    }\n    empty() {\n        return new ArraySet_1(null, this.opts());\n    }\n    clear() {\n        __vals(this).length = 0;\n    }\n    first() {\n        if (this.size) {\n            return __vals(this)[0];\n        }\n    }\n    add(key) {\n        !this.has(key) && __vals(this).push(key);\n        return this;\n    }\n    into(keys) {\n        return into(this, keys);\n    }\n    has(key) {\n        return this.get(key, SEMAPHORE) !== SEMAPHORE;\n    }\n    /**\n     * Returns the canonical value for `x`, if present. If the set\n     * contains no equivalent for `x`, returns `notFound`.\n     *\n     * @param key - search key\n     * @param notFound - default value\n     */\n    get(key, notFound) {\n        const $this = __private.get(this);\n        const eq = $this.equiv;\n        const vals = $this.vals;\n        for (let i = vals.length; --i >= 0;) {\n            if (eq(vals[i], key)) {\n                return vals[i];\n            }\n        }\n        return notFound;\n    }\n    delete(key) {\n        const $this = __private.get(this);\n        const eq = $this.equiv;\n        const vals = $this.vals;\n        for (let i = vals.length; --i >= 0;) {\n            if (eq(vals[i], key)) {\n                vals.splice(i, 1);\n                return true;\n            }\n        }\n        return false;\n    }\n    disj(keys) {\n        return dissoc(this, keys);\n    }\n    equiv(o) {\n        return equivSet(this, o);\n    }\n    forEach(fn, thisArg) {\n        const vals = __vals(this);\n        for (let i = vals.length; --i >= 0;) {\n            const v = vals[i];\n            fn.call(thisArg, v, v, this);\n        }\n    }\n    *entries() {\n        for (let v of __vals(this)) {\n            yield [v, v];\n        }\n    }\n    *keys() {\n        yield* __vals(this);\n    }\n    *values() {\n        yield* __vals(this);\n    }\n    opts() {\n        return { equiv: __private.get(this).equiv };\n    }\n};\nArraySet = ArraySet_1 = __decorate([\n    inspectable\n], ArraySet);\nexport { ArraySet };\nexport const defArraySet = (vals, opts) => new ArraySet(vals, opts);\n","import { equiv } from \"@thi.ng/equiv\";\nexport const equivMap = (a, b) => {\n    if (a === b) {\n        return true;\n    }\n    if (!(b instanceof Map) || a.size !== b.size) {\n        return false;\n    }\n    for (let p of a.entries()) {\n        if (!equiv(b.get(p[0]), p[1])) {\n            return false;\n        }\n    }\n    return true;\n};\nexport const equivSet = (a, b) => {\n    if (a === b) {\n        return true;\n    }\n    if (!(b instanceof Set) || a.size !== b.size) {\n        return false;\n    }\n    for (let k of a.keys()) {\n        if (!b.has(k)) {\n            return false;\n        }\n    }\n    return true;\n};\n","var EquivMap_1;\nimport { __decorate } from \"tslib\";\nimport { SEMAPHORE } from \"@thi.ng/api\";\nimport { isPlainObject } from \"@thi.ng/checks\";\nimport { equiv } from \"@thi.ng/equiv\";\nimport { pairs } from \"@thi.ng/transducers\";\nimport { ArraySet } from \"./array-set\";\nimport { dissoc } from \"./dissoc\";\nimport { equivMap } from \"./internal/equiv\";\nimport { inspectable } from \"./internal/inspect\";\nimport { into } from \"./into\";\nconst __private = new WeakMap();\nconst __map = (map) => __private.get(map).map;\nlet EquivMap = EquivMap_1 = class EquivMap extends Map {\n    /**\n     * Creates a new instance with optional initial key-value pairs and\n     * provided options. If no `opts` are given, uses `ArraySet` for\n     * storing canonical keys and {@link @thi.ng/equiv#equiv} for\n     * checking key equivalence.\n     *\n     * @param pairs - key-value pairs\n     * @param opts - config options\n     */\n    constructor(pairs, opts) {\n        super();\n        const _opts = Object.assign({ equiv, keys: ArraySet }, opts);\n        __private.set(this, {\n            keys: new _opts.keys(null, { equiv: _opts.equiv }),\n            map: new Map(),\n            opts: _opts,\n        });\n        if (pairs) {\n            this.into(pairs);\n        }\n    }\n    [Symbol.iterator]() {\n        return this.entries();\n    }\n    get [Symbol.species]() {\n        return EquivMap_1;\n    }\n    get [Symbol.toStringTag]() {\n        return \"EquivMap\";\n    }\n    get size() {\n        return __private.get(this).keys.size;\n    }\n    clear() {\n        const $this = __private.get(this);\n        $this.keys.clear();\n        $this.map.clear();\n    }\n    empty() {\n        return new EquivMap_1(null, __private.get(this).opts);\n    }\n    copy() {\n        const $this = __private.get(this);\n        const m = new EquivMap_1();\n        __private.set(m, {\n            keys: $this.keys.copy(),\n            map: new Map($this.map),\n            opts: $this.opts,\n        });\n        return m;\n    }\n    equiv(o) {\n        return equivMap(this, o);\n    }\n    delete(key) {\n        const $this = __private.get(this);\n        key = $this.keys.get(key, SEMAPHORE);\n        if (key !== SEMAPHORE) {\n            $this.map.delete(key);\n            $this.keys.delete(key);\n            return true;\n        }\n        return false;\n    }\n    dissoc(keys) {\n        return dissoc(this, keys);\n    }\n    forEach(fn, thisArg) {\n        for (let pair of __map(this)) {\n            fn.call(thisArg, pair[1], pair[0], this);\n        }\n    }\n    get(key, notFound) {\n        const $this = __private.get(this);\n        key = $this.keys.get(key, SEMAPHORE);\n        if (key !== SEMAPHORE) {\n            return $this.map.get(key);\n        }\n        return notFound;\n    }\n    has(key) {\n        return __private.get(this).keys.has(key);\n    }\n    set(key, value) {\n        const $this = __private.get(this);\n        const k = $this.keys.get(key, SEMAPHORE);\n        if (k !== SEMAPHORE) {\n            $this.map.set(k, value);\n        }\n        else {\n            $this.keys.add(key);\n            $this.map.set(key, value);\n        }\n        return this;\n    }\n    into(pairs) {\n        return into(this, pairs);\n    }\n    entries() {\n        return __map(this).entries();\n    }\n    keys() {\n        return __map(this).keys();\n    }\n    values() {\n        return __map(this).values();\n    }\n    opts() {\n        return __private.get(this).opts;\n    }\n};\nEquivMap = EquivMap_1 = __decorate([\n    inspectable\n], EquivMap);\nexport { EquivMap };\nexport function defEquivMap(src, opts) {\n    return new EquivMap(isPlainObject(src) ? pairs(src) : src, opts);\n}\n","export const isSet = (x) => x instanceof Set;\n","import { xformSetOp } from \"./internal/xform-setop\";\nimport { into } from \"./into\";\nimport { copy } from \"./utils\";\n/**\n * Computes union of sets `a` and `b` and writes results to new set or\n * optionally given set `out` (assumed to be empty for correct results).\n *\n * @param a - first set\n * @param b - other set\n * @param out - result set\n */\nexport const union = (a, b, out) => {\n    if (a.size < b.size) {\n        const t = a;\n        a = b;\n        b = t;\n    }\n    out = out ? into(out, a) : copy(a, Set);\n    return a === b ? out : into(out, b);\n};\nexport function unionR(src) {\n    return xformSetOp(unionR, union, src);\n}\n","import { implementsFunction, isMap, isSet } from \"@thi.ng/checks\";\nexport const empty = (x, ctor) => implementsFunction(x, \"empty\")\n    ? x.empty()\n    : new (x[Symbol.species] || ctor)();\nexport const copy = (x, ctor) => implementsFunction(x, \"copy\")\n    ? x.copy()\n    : new (x[Symbol.species] || ctor)(x);\nexport const first = (x) => x[Symbol.iterator]().next().value;\nexport const objValues = (src) => {\n    const vals = [];\n    for (let k in src) {\n        src.hasOwnProperty(k) && vals.push(src[k]);\n    }\n    return vals;\n};\nexport const ensureMap = (x) => isMap(x) ? x : new Map(x);\nexport const ensureSet = (x) => isSet(x) ? x : new Set(x);\n","import { defError } from \"./deferror\";\nexport const IllegalArgumentError = defError(() => \"illegal argument(s)\");\nexport const illegalArgs = (msg) => {\n    throw new IllegalArgumentError(msg);\n};\n","import { compR } from \"../func/compr\";\nimport { iterator1 } from \"../iterator\";\nexport function filter(pred, src) {\n    return src\n        ? iterator1(filter(pred), src)\n        : (rfn) => {\n            const r = rfn[2];\n            return compR(rfn, (acc, x) => (pred(x) ? r(acc, x) : acc));\n        };\n}\n","import { ArraySet, EquivMap, union } from \"@thi.ng/associative\";\nimport { equiv } from \"@thi.ng/equiv\";\nimport { illegalArgs } from \"@thi.ng/errors\";\nimport { filter, reduce, reducer } from \"@thi.ng/transducers\";\nexport const defDGraph = (edges) => new DGraph(edges);\nexport class DGraph {\n    constructor(edges) {\n        this.dependencies = new EquivMap();\n        this.dependents = new EquivMap();\n        if (edges) {\n            for (let [a, b] of edges) {\n                this.addDependency(a, b);\n            }\n        }\n    }\n    *[Symbol.iterator]() {\n        yield* this.sort();\n    }\n    get [Symbol.species]() {\n        return DGraph;\n    }\n    copy() {\n        const g = new DGraph();\n        for (let e of this.dependencies) {\n            g.dependencies.set(e[0], e[1].copy());\n        }\n        for (let e of this.dependents) {\n            g.dependents.set(e[0], e[1].copy());\n        }\n        return g;\n    }\n    addNode(node) {\n        !this.dependencies.has(node) &&\n            this.dependencies.set(node, new ArraySet());\n        return this;\n    }\n    addDependency(node, dep) {\n        if (equiv(node, dep) || this.depends(dep, node)) {\n            illegalArgs(`Circular dependency between: ${node} & ${dep}`);\n        }\n        let deps = this.dependencies.get(node);\n        this.dependencies.set(node, deps ? deps.add(dep) : new ArraySet([dep]));\n        deps = this.dependents.get(dep);\n        this.dependents.set(dep, deps ? deps.add(node) : new ArraySet([node]));\n        return this;\n    }\n    addDependencies(node, deps) {\n        for (let d of deps) {\n            this.addDependency(node, d);\n        }\n    }\n    removeEdge(node, dep) {\n        let deps = this.dependencies.get(node);\n        if (deps) {\n            deps.delete(dep);\n        }\n        deps = this.dependents.get(dep);\n        if (deps) {\n            deps.delete(node);\n        }\n        return this;\n    }\n    removeNode(x) {\n        this.dependencies.delete(x);\n        return this;\n    }\n    depends(x, y) {\n        return this.transitiveDependencies(x).has(y);\n    }\n    dependent(x, y) {\n        return this.transitiveDependents(x).has(y);\n    }\n    immediateDependencies(x) {\n        return this.dependencies.get(x) || new ArraySet();\n    }\n    immediateDependents(x) {\n        return this.dependents.get(x) || new ArraySet();\n    }\n    isLeaf(x) {\n        return this.immediateDependents(x).size === 0;\n    }\n    isRoot(x) {\n        return this.immediateDependencies(x).size === 0;\n    }\n    nodes() {\n        return union(new ArraySet(this.dependencies.keys()), new ArraySet(this.dependents.keys()));\n    }\n    leaves() {\n        return filter((node) => this.isLeaf(node), this.nodes());\n    }\n    roots() {\n        return filter((node) => this.isRoot(node), this.nodes());\n    }\n    transitiveDependencies(x) {\n        return transitive(this.dependencies, x);\n    }\n    transitiveDependents(x) {\n        return transitive(this.dependents, x);\n    }\n    sort() {\n        const sorted = [];\n        const g = this.copy();\n        let queue = new ArraySet(g.leaves());\n        while (true) {\n            if (!queue.size) {\n                return sorted.reverse();\n            }\n            const node = queue.first();\n            queue.delete(node);\n            for (let d of [...g.immediateDependencies(node)]) {\n                g.removeEdge(node, d);\n                if (g.isLeaf(d)) {\n                    queue.add(d);\n                }\n            }\n            sorted.push(node);\n            g.removeNode(node);\n        }\n    }\n}\nconst transitive = (nodes, x) => {\n    const deps = nodes.get(x);\n    if (deps) {\n        return reduce(reducer(null, (acc, k) => union(acc, transitive(nodes, k))), deps, deps);\n    }\n    return new ArraySet();\n};\n","const RE_VEC = /^[iub]?vec[234]$/;\nconst RE_MAT = /^mat[234]$/;\n/**\n * Returns true, if given term evaluates to a boolean value.\n */\nexport const isBool = (t) => t.type === \"bool\";\n/**\n * Returns true, if given term evaluates to a float value.\n */\nexport const isFloat = (t) => t.type === \"float\";\n/**\n * Returns true, if given term evaluates to a signed integer value.\n */\nexport const isInt = (t) => t.type === \"int\";\n/**\n * Returns true, if given term evaluates to an unsigned integer value.\n */\nexport const isUint = (t) => t.type === \"uint\";\n/**\n * Returns true, if given term is a literal.\n */\nexport const isLit = (t) => t.tag === \"lit\";\n/**\n * Returns true, if given term is a float literal.\n */\nexport const isLitFloat = (t) => isLit(t) && isFloat(t);\n/**\n * Returns true, if given term is a signed integer literal.\n */\nexport const isLitInt = (t) => isLit(t) && isInt(t);\n/**\n * Returns true, if given term is a numeric literal (float, int, uint).\n */\nexport const isLitNumeric = (t) => isLit(t) && (isFloat(t) || isInt(t) || isUint(t));\n/**\n * Returns true, if given term evaluates to a vector value (vec, ivec, bvec).\n */\nexport const isVec = (t) => RE_VEC.test(t.type);\n/**\n * Returns true, if given term evaluates to a matrix value.\n */\nexport const isMat = (t) => RE_MAT.test(t.type);\n","import { isArray } from \"@thi.ng/checks\";\nimport { DGraph } from \"@thi.ng/dgraph\";\nimport { isMat, isVec } from \"./checks\";\n/**\n * Helper function for {@link walk}. Returns child nodes for any control\n * flow nodes containing a child scope.\n *\n * {@link allChildren}\n */\nexport const scopedChildren = (t) => t.tag === \"fn\" || t.tag === \"for\" || t.tag == \"while\"\n    ? t.scope.body\n    : t.tag === \"if\"\n        ? t.f\n            ? t.t.body.concat(t.f.body)\n            : t.t.body\n        : undefined;\n/**\n * Helper function for {@link walk}. Returns an array of all child nodes for\n * a given term (if any).\n *\n * {@link scopedChildren}\n */\nexport const allChildren = (t) => scopedChildren(t) ||\n    (t.tag === \"scope\"\n        ? t.body\n        : t.tag === \"ternary\"\n            ? [t.t, t.f]\n            : t.tag === \"ret\"\n                ? [t.val]\n                : t.tag === \"call\" || t.tag === \"call_i\"\n                    ? t.args\n                    : t.tag === \"sym\" && t.init\n                        ? [t.init]\n                        : t.tag === \"decl\"\n                            ? [t.id]\n                            : t.tag === \"op1\" || t.tag === \"swizzle\"\n                                ? [t.val]\n                                : t.tag === \"op2\"\n                                    ? [t.l, t.r]\n                                    : t.tag === \"assign\"\n                                        ? [t.r]\n                                        : isVec(t) || isMat(t)\n                                            ? t.val\n                                            : undefined);\n/**\n * Traverses given AST in depth-first order and applies `visit` and\n * `children` fns to each node. Descends only further if `children`\n * returns an array of child nodes. The `visit` function must accept 2\n * args: the accumulator (`acc`) given to {@link walk} and a tree node. The\n * return value of `visit` becomes the new `acc` value, much like in a\n * reduce operation. {@link walk} itself returns the final `acc`.\n *\n * If `pre` is true (default), the `visit` function will be called prior\n * to visiting a node's children. If false, the visitor is called on the\n * way back up.\n *\n * @param visit -\n * @param children -\n * @param acc -\n * @param tree -\n * @param pre -\n */\nexport const walk = (visit, children, acc, tree, pre = true) => {\n    if (isArray(tree)) {\n        tree.forEach((x) => (acc = walk(visit, children, acc, x, pre)));\n    }\n    else {\n        pre && (acc = visit(acc, tree));\n        const c = children(tree);\n        c && (acc = walk(visit, children, acc, c, pre));\n        !pre && (acc = visit(acc, tree));\n    }\n    return acc;\n};\n/**\n * Builds dependency graph of given function, by recursively adding all\n * function dependencies. Returns graph.\n *\n * @param fn -\n * @param graph -\n */\nexport const buildCallGraph = (fn, graph = new DGraph()) => fn.deps && fn.deps.length\n    ? fn.deps.reduce((graph, d) => buildCallGraph(d, graph.addDependency(fn, d)), graph)\n    : graph.addNode(fn);\nexport const decl = (id) => ({\n    tag: \"decl\",\n    type: id.type,\n    id\n});\n/**\n * Wraps the given AST node array in `scope` node, optionally as global\n * scope (default false). The interpretation of the global flag is\n * dependent on the target code gen. I.e. for GLSL / JS, the flag\n * disables wrapping the scope's body in `{}`, but else has no\n * difference. In general this node type only serves as internal\n * mechanism for various control flow AST nodes and should not need to\n * be used directly from user land code (though might be useful to\n * create custom / higher level control flow nodes).\n *\n * @param body -\n * @param global -\n */\nexport const scope = (body, global = false) => ({\n    tag: \"scope\",\n    type: \"void\",\n    body: (body\n        .filter((x) => x != null)\n        .map((x) => (x.tag === \"sym\" ? decl(x) : x))),\n    global\n});\n/**\n * Takes an array of global sym/var definitions ({@link input},\n * {@link output}, {@link uniform}) and functions defined via\n * {@link (defn:1)}. Constructs the call graph of all transitively used\n * functions and bundles everything in topological order within a global\n * scope object, which is then returned to the user and can be passed to\n * a target codegen for full program output.\n *\n * - {@link scope}\n * - {@link input}\n * - {@link output}\n * - {@link uniform}\n *\n * @param body -\n */\nexport const program = (body) => {\n    const syms = body.filter((x) => x.tag !== \"fn\");\n    const g = body.reduce((acc, x) => (x.tag === \"fn\" ? buildCallGraph(x, acc) : acc), new DGraph());\n    return scope(syms.concat(g.sort()), true);\n};\n","import { assert } from \"@thi.ng/api\";\nimport { isString } from \"@thi.ng/checks\";\nimport { illegalArgs } from \"@thi.ng/errors\";\nimport { gensym } from \"./idgen\";\nexport function sym(type, ...xs) {\n    let id;\n    let opts;\n    let init;\n    switch (xs.length) {\n        case 0:\n            if (!isString(type)) {\n                init = type;\n                type = init.type;\n            }\n            break;\n        case 1:\n            if (isString(xs[0])) {\n                id = xs[0];\n            }\n            else if (xs[0].tag) {\n                init = xs[0];\n            }\n            else {\n                opts = xs[0];\n            }\n            break;\n        case 2:\n            if (isString(xs[0])) {\n                [id, opts] = xs;\n            }\n            else {\n                [opts, init] = xs;\n            }\n            break;\n        case 3:\n            [id, opts, init] = xs;\n            break;\n        default:\n            illegalArgs();\n    }\n    return {\n        tag: \"sym\",\n        type,\n        id: id || gensym(),\n        opts: opts || {},\n        init: init\n    };\n}\nexport const constSym = (type, id, opts, init) => sym(type, id || gensym(), Object.assign({ const: true }, opts), init);\n/**\n * Defines a new symbol with optional initial array values.\n *\n * Important: Array initializers are UNSUPPORTED in GLSL ES v1 (WebGL),\n * any code using such initializers will only work under WebGL2 or other\n * targets.\n */\nexport const arraySym = (type, id, opts = {}, init) => {\n    if (init && opts.num == null) {\n        opts.num = init.length;\n    }\n    assert(opts.num != null, \"missing array length\");\n    init &&\n        assert(opts.num === init.length, `expected ${opts.num} items in array, but got ${init.length}`);\n    const atype = (type + \"[]\");\n    return {\n        tag: \"sym\",\n        type: atype,\n        id: id || gensym(),\n        opts,\n        init: init\n            ? {\n                tag: \"array_init\",\n                type: atype,\n                init\n            }\n            : undefined\n    };\n};\nexport const input = (type, id, opts) => sym(type, id, Object.assign({ q: \"in\", type: \"in\" }, opts));\nexport const output = (type, id, opts) => sym(type, id, Object.assign({ q: \"out\", type: \"out\" }, opts));\nexport const uniform = (type, id, opts) => sym(type, id, Object.assign({ q: \"in\", type: \"uni\" }, opts));\n","import { assert } from \"@thi.ng/api\";\nimport { isString } from \"@thi.ng/checks\";\nimport { gensym } from \"./idgen\";\nimport { allChildren, scope, scopedChildren, walk } from \"./scope\";\nimport { sym } from \"./sym\";\nconst defArg = (a) => {\n    const [type, id, opts] = isString(a) ? [a] : a;\n    return {\n        tag: \"arg\",\n        type,\n        id: id || gensym(),\n        opts: Object.assign({ q: \"in\" }, opts)\n    };\n};\n// prettier-ignore\nexport function defn(type, id, _args, _body) {\n    const args = _args.map(defArg);\n    const body = (_body(...args.map((x) => sym(x.type, x.id, x.opts))).filter((x) => x != null));\n    // count & check returns\n    const returns = walk((n, t) => {\n        if (t.tag === \"ret\") {\n            assert(t.type === type, `wrong return type for function '${id}', expected ${type}, got ${t.type}`);\n            n++;\n        }\n        return n;\n    }, scopedChildren, 0, body);\n    if (type !== \"void\" && !returns) {\n        throw new Error(`function '${id}' must return a value of type ${type}`);\n    }\n    // verify all non-builtin functions called are also\n    // provided as deps to ensure complete call graph later\n    const deps = walk((acc, t) => {\n        if (t.tag === \"call\" && t.fn) {\n            acc.push(t.fn);\n        }\n        return acc;\n    }, allChildren, [], body);\n    const $ = (...xs) => funcall($, ...xs);\n    return Object.assign($, {\n        tag: \"fn\",\n        type,\n        id,\n        args,\n        deps,\n        scope: scope(body)\n    });\n}\n/**\n * Syntax sugar for defining `void main()` functions.\n *\n * @param body -\n */\nexport const defMain = (body) => defn(\"void\", \"main\", [], body);\nexport function ret(val) {\n    return {\n        tag: \"ret\",\n        type: val ? val.type : \"void\",\n        val\n    };\n}\n// prettier-ignore\nexport function funcall(fn, ...args) {\n    return isString(fn)\n        ? {\n            tag: \"call\",\n            type: args[0],\n            id: fn,\n            args: args.slice(1)\n        }\n        : {\n            tag: \"call\",\n            type: fn.type,\n            id: fn.id,\n            args,\n            fn\n        };\n}\nexport const builtinCall = (id, type, ...args) => ({\n    tag: \"call_i\",\n    type,\n    id,\n    args\n});\n","export const isNumber = (x) => typeof x === \"number\";\n","export const isBoolean = (x) => typeof x === \"boolean\";\n","import { isBoolean, isNumber } from \"@thi.ng/checks\";\nimport { isVec } from \"./checks\";\nexport const lit = (type, val, info) => ({\n    tag: \"lit\",\n    type,\n    info,\n    val\n});\nexport const bool = (x) => lit(\"bool\", isNumber(x) ? !!x : x);\nexport const float = (x) => lit(\"float\", isBoolean(x) ? x & 1 : x);\nexport const int = (x) => lit(\"int\", isBoolean(x) ? x & 1 : isNumber(x) ? x | 0 : x);\nexport const uint = (x) => lit(\"uint\", isBoolean(x) ? x & 1 : isNumber(x) ? x >>> 0 : x);\nconst wrap = (type, ctor) => (x) => isNumber(x)\n    ? ctor(x)\n    : x !== undefined && !isVec(x) && x.type !== type\n        ? ctor(x)\n        : x;\n/**\n * Takes a plain number or numeric term and wraps it as float literal if\n * needed.\n *\n * @param x -\n */\nexport const wrapFloat = wrap(\"float\", float);\n/**\n * Takes a plain number or numeric term and wraps it as signed integer\n * literal if needed.\n *\n * @param x -\n */\nexport const wrapInt = wrap(\"int\", int);\n/**\n * Takes a plain number or numeric term and wraps it as unsigned integer\n * literal if needed.\n *\n * @param x -\n */\nexport const wrapUint = wrap(\"uint\", uint);\n/**\n * Takes a plain number or numeric term and wraps it as boolean literal\n * if needed.\n *\n * @param x -\n */\nexport const wrapBool = wrap(\"bool\", bool);\nexport const TRUE = lit(\"bool\", true);\nexport const FALSE = lit(\"bool\", false);\nexport const FLOAT0 = float(0);\nexport const FLOAT1 = float(1);\nexport const FLOAT2 = float(2);\nexport const FLOAT05 = float(0.5);\nexport const INT0 = int(0);\nexport const INT1 = int(1);\nexport const UINT0 = uint(0);\nexport const UINT1 = uint(1);\nexport const PI = float(Math.PI);\nexport const TAU = float(Math.PI * 2);\nexport const HALF_PI = float(Math.PI / 2);\nexport const SQRT2 = float(Math.SQRT2);\nconst $gvec = (wrap, init) => (xs) => [xs[0] === undefined ? init : wrap(xs[0]), ...xs.slice(1).map(wrap)];\nconst $vec = $gvec(wrapFloat, FLOAT0);\nconst $ivec = $gvec(wrapInt, INT0);\nconst $uvec = $gvec(wrapUint, UINT0);\nconst $bvec = $gvec(wrapBool, FALSE);\nconst $gvec2 = (type, ctor, xs) => lit(type, (xs = ctor(xs)), [\"n\", \"n\"][xs.length]);\nconst $gvec3 = (type, ctor, xs) => lit(type, (xs = ctor(xs)), [\"n\", \"n\", \"vn\"][xs.length]);\nconst $gvec4 = (type, ctor, xs) => lit(type, (xs = ctor(xs)), xs.length === 2\n    ? isVec(xs[1])\n        ? \"vv\"\n        : \"vn\"\n    : [\"n\", \"n\", , \"vnn\"][xs.length]);\nconst $gmat = (type, info, xs) => lit(type, (xs = $vec(xs)), info[xs.length]);\n// prettier-ignore\nexport function vec2(...xs) {\n    return $gvec2(\"vec2\", $vec, xs);\n}\nexport function vec3(...xs) {\n    return $gvec3(\"vec3\", $vec, xs);\n}\nexport function vec4(...xs) {\n    return $gvec4(\"vec4\", $vec, xs);\n}\n// prettier-ignore\nexport function ivec2(...xs) {\n    return $gvec2(\"ivec2\", $ivec, xs);\n}\nexport function ivec3(...xs) {\n    return $gvec3(\"ivec3\", $ivec, xs);\n}\nexport function ivec4(...xs) {\n    return $gvec4(\"ivec4\", $ivec, xs);\n}\n// prettier-ignore\nexport function uvec2(...xs) {\n    return $gvec2(\"uvec2\", $uvec, xs);\n}\nexport function uvec3(...xs) {\n    return $gvec3(\"uvec3\", $uvec, xs);\n}\nexport function uvec4(...xs) {\n    return $gvec4(\"uvec4\", $uvec, xs);\n}\n// prettier-ignore\nexport function bvec2(...xs) {\n    return $gvec2(\"bvec2\", $bvec, xs);\n}\nexport function bvec3(...xs) {\n    return $gvec3(\"bvec3\", $bvec, xs);\n}\nexport function bvec4(...xs) {\n    return $gvec4(\"bvec4\", $bvec, xs);\n}\nexport function mat2(...xs) {\n    return $gmat(\"mat2\", [\"n\", \"n\", \"vv\"], xs);\n}\nexport function mat3(...xs) {\n    return $gmat(\"mat3\", [\"n\", \"n\", , \"vvv\"], xs);\n}\nexport function mat4(...xs) {\n    return $gmat(\"mat4\", [\"n\", \"n\", , , \"vvvv\"], xs);\n}\n","import { bool, float, int, uint, vec2, vec3, vec4 } from \"./lit\";\n/**\n * Returns base type for given term. Used for array ops.\n *\n * @example\n * ```ts\n * itemType(\"vec2[]\") => \"vec2\"\n * ```\n */\nexport const itemType = (type) => type.replace(\"[]\", \"\");\n/**\n * Takes a numeric term and a plain number, returns number wrapped in\n * typed literal compatible with term.\n *\n * @param t -\n * @param x -\n */\nexport const numberWithMatchingType = (t, x) => {\n    const id = t.type[0];\n    return id === \"i\"\n        ? int(x)\n        : id === \"u\"\n            ? uint(x)\n            : id === \"b\"\n                ? bool(x)\n                : float(x);\n};\nexport const matchingPrimFor = (t, x) => {\n    const ctor = { vec2, vec3, vec4 }[t.type];\n    return ctor ? ctor(x) : x;\n};\nexport const matchingBoolType = (t) => ({\n    float: \"bool\",\n    int: \"bool\",\n    uint: \"bool\",\n    vec2: \"bvec2\",\n    ivec2: \"bvec2\",\n    uvec2: \"bvec2\",\n    vec3: \"bvec3\",\n    ivec3: \"bvec3\",\n    uvec3: \"bvec3\",\n    vec4: \"bvec4\",\n    ivec4: \"bvec4\",\n    uvec4: \"bvec4\"\n}[t.type]);\n","import { isNumber } from \"@thi.ng/checks\";\nimport { isMat, isVec } from \"./checks\";\nimport { numberWithMatchingType } from \"./item\";\nimport { float } from \"./lit\";\nexport const op1 = (op, val, post = false) => ({\n    tag: \"op1\",\n    type: val.type,\n    op,\n    val,\n    post\n});\nconst OP_INFO = {\n    mave: \"mv\",\n    vema: \"vm\",\n    vefl: \"vn\",\n    mafl: \"vn\",\n    flve: \"nv\",\n    flma: \"nv\",\n    ivin: \"vn\",\n    iniv: \"nv\",\n    uvui: \"vn\",\n    uiuv: \"nv\"\n};\nexport const op2 = (op, _l, _r, rtype, info) => {\n    const nl = isNumber(_l);\n    const nr = isNumber(_r);\n    let type;\n    let l;\n    let r;\n    if (nl) {\n        if (nr) {\n            // (number, number)\n            l = float(_l);\n            r = float(_r);\n            type = \"float\";\n        }\n        else {\n            // (number, term)\n            r = _r;\n            l = numberWithMatchingType(r, _l);\n            type = r.type;\n        }\n    }\n    else if (nr) {\n        // (term, number)\n        l = _l;\n        r = numberWithMatchingType(l, _r);\n        type = l.type;\n    }\n    else {\n        // (term, term)\n        l = _l;\n        r = _r;\n        type =\n            rtype ||\n                (isVec(l)\n                    ? l.type\n                    : isVec(r)\n                        ? r.type\n                        : isMat(r)\n                            ? r.type\n                            : l.type);\n    }\n    return {\n        tag: \"op2\",\n        type: rtype || type,\n        info: info || OP_INFO[l.type.substr(0, 2) + r.type.substr(0, 2)],\n        op,\n        l: l,\n        r: r\n    };\n};\nexport const inc = (t) => op1(\"++\", t, true);\nexport const dec = (t) => op1(\"--\", t, true);\n// prettier-ignore\nexport function add(l, r) {\n    return op2(\"+\", l, r);\n}\nexport function sub(l, r) {\n    return op2(\"-\", l, r);\n}\nexport function mul(l, r) {\n    return op2(\"*\", l, r, !isNumber(l) && !isNumber(r) && isMat(l) && isVec(r)\n        ? r.type\n        : undefined);\n}\nexport function div(l, r) {\n    return op2(\"/\", l, r);\n}\nexport function modi(l, r) {\n    return op2(\"%\", isNumber(l) ? numberWithMatchingType(r, l) : l, isNumber(r) ? numberWithMatchingType(l, r) : r);\n}\nexport const neg = (val) => op1(\"-\", val);\n/**\n * Multiply-add: a * b + c. All must be of same type.\n *\n * @param a -\n * @param b -\n * @param c -\n */\nexport const madd = (a, b, c) => add(mul(a, b), c);\n/**\n * Add-multiply: (a + b) * c. All must be of same type.\n *\n * @param a -\n * @param b -\n * @param c -\n */\nexport const addm = (a, b, c) => mul(add(a, b), c);\nexport const not = (val) => op1(\"!\", val);\nexport const or = (a, b) => op2(\"||\", a, b);\nexport const and = (a, b) => op2(\"&&\", a, b);\nconst cmp = (op) => (a, b) => op2(op, a, b, \"bool\");\nexport const eq = cmp(\"==\");\nexport const neq = cmp(\"!=\");\nexport const lt = cmp(\"<\");\nexport const lte = cmp(\"<=\");\nexport const gt = cmp(\">\");\nexport const gte = cmp(\">=\");\nexport const bitnot = (val) => op1(\"~\", val);\n// prettier-ignore\nexport function bitand(l, r) {\n    return op2(\"&\", l, r, undefined);\n}\n// prettier-ignore\nexport function bitor(l, r) {\n    return op2(\"|\", l, r, undefined);\n}\n// prettier-ignore\nexport function bitxor(l, r) {\n    return op2(\"^\", l, r, undefined);\n}\n","import { assert } from \"@thi.ng/api\";\nexport const assign = (l, r) => {\n    assert(l.tag !== \"swizzle\" || l.val.tag === \"sym\", \"can't assign to non-symbol swizzle\");\n    return {\n        tag: \"assign\",\n        type: l.type,\n        l,\n        r\n    };\n};\n","export function $(val, id) {\n    const type = val.type[0];\n    const rtype = (a, b) => id.length === 1 ? a : (b + id.length);\n    return {\n        tag: \"swizzle\",\n        type: type === \"i\"\n            ? rtype(\"int\", \"ivec\")\n            : type === \"u\"\n                ? rtype(\"uint\", \"uvec\")\n                : type === \"b\"\n                    ? rtype(\"bool\", \"bvec\")\n                    : rtype(\"float\", \"vec\"),\n        val,\n        id\n    };\n}\nexport const $x = (val) => $(val, \"x\");\nexport const $y = (val) => $(val, \"y\");\nexport const $z = (val) => $(val, \"z\");\nexport const $w = (val) => $(val, \"w\");\nexport function $xy(val) {\n    return $(val, \"xy\");\n}\nexport function $xyz(val) {\n    return $(val, \"xyz\");\n}\n","import { decl, scope } from \"./scope\";\nexport const ifThen = (test, truthy, falsey) => ({\n    tag: \"if\",\n    type: \"void\",\n    test,\n    t: scope(truthy),\n    f: falsey ? scope(falsey) : undefined\n});\nexport const ternary = (test, t, f) => ({\n    tag: \"ternary\",\n    type: t.type,\n    test,\n    t,\n    f\n});\nexport function forLoop(...xs) {\n    const [init, test, iter, body] = xs.length === 2\n        ? [, xs[0], , xs[1]]\n        : xs.length === 3\n            ? [xs[0], xs[1], , xs[2]]\n            : xs;\n    return {\n        tag: \"for\",\n        type: \"void\",\n        init: init ? decl(init) : undefined,\n        test: test(init),\n        iter: iter ? iter(init) : undefined,\n        scope: scope(body(init))\n    };\n}\nexport const whileLoop = (test, body) => ({\n    tag: \"while\",\n    type: \"void\",\n    test,\n    scope: scope(body)\n});\nconst ctrl = (id) => ({\n    tag: \"ctrl\",\n    type: \"void\",\n    id\n});\nexport const brk = ctrl(\"break\");\nexport const cont = ctrl(\"continue\");\nexport const discard = ctrl(\"discard\");\n","import { builtinCall } from \"../ast/function\";\nimport { matchingBoolType, matchingPrimFor } from \"../ast/item\";\nconst primOp1 = (name) => (a) => builtinCall(name, a.type, a);\nconst primOp2 = (name) => (a, b) => builtinCall(name, a.type, a, b);\nconst primOp3 = (name) => (a, b, c) => builtinCall(name, a.type, a, b, c);\n/**\n * Returns normalized version of given vector.\n *\n * @param v -\n */\nexport const normalize = (v) => builtinCall(\"normalize\", v.type, v);\n/**\n * Returns length / magnitude of given vector.\n *\n * @param v -\n */\nexport const length = (v) => builtinCall(\"length\", \"float\", v);\nexport const distance = (a, b) => builtinCall(\"distance\", \"float\", a, b);\n/**\n * Returns dot product of given vectors.\n *\n * @param a -\n * @param b -\n */\nexport const dot = (a, b) => builtinCall(\"dot\", \"float\", a, b);\n/**\n * Returns cross product of given 3D vectors.\n *\n * @param a -\n * @param b -\n */\nexport const cross = (a, b) => builtinCall(\"cross\", a.type, a, b);\nexport const reflect = (i, n) => builtinCall(\"reflect\", i.type, i, n);\nexport const refract = (i, n, ior) => builtinCall(\"refract\", i.type, i, n, ior);\nexport const faceForward = (i, n, nref) => builtinCall(\"faceForward\", i.type, i, n, nref);\nexport const min = primOp2(\"min\");\nexport const max = primOp2(\"max\");\nexport const clamp = primOp3(\"clamp\");\nexport const step = primOp2(\"step\");\nexport const smoothstep = primOp3(\"smoothstep\");\nexport const radians = primOp1(\"radians\");\nexport const degrees = primOp1(\"degrees\");\nexport const cos = primOp1(\"cos\");\nexport const sin = primOp1(\"sin\");\nexport const tan = primOp1(\"tan\");\nexport const acos = primOp1(\"acos\");\nexport const asin = primOp1(\"asin\");\nexport function atan(a, b) {\n    const f = b\n        ? builtinCall(\"atan\", a.type, a, b)\n        : builtinCall(\"atan\", a.type, a);\n    b && (f.info = \"nn\");\n    return f;\n}\nexport const pow = primOp2(\"pow\");\nexport const exp = primOp1(\"exp\");\nexport const log = primOp1(\"log\");\nexport const exp2 = primOp1(\"exp2\");\nexport const log2 = primOp1(\"log2\");\nexport const sqrt = primOp1(\"sqrt\");\nexport const inversesqrt = primOp1(\"inversesqrt\");\nexport const abs = primOp1(\"abs\");\nexport const sign = primOp1(\"sign\");\nexport const floor = primOp1(\"floor\");\nexport const ceil = primOp1(\"ceil\");\nexport const fract = primOp1(\"fract\");\nexport const powf = (x, y) => pow(x, matchingPrimFor(x, y));\nexport function mod(a, b) {\n    const f = builtinCall(\"mod\", a.type, a, b);\n    b.type === \"float\" && (f.info = \"n\");\n    return f;\n}\n/**\n * Important: Currently unsupported by JS target.\n *\n * TODO add additional metadata for JS (`b` is an output var), issue #96\n *\n * @param a -\n * @param b -\n */\n// prettier-ignore\nexport const modf = (a, b) => builtinCall(\"modf\", a.type, a, b);\nexport function mix(a, b, c) {\n    const f = builtinCall(\"mix\", a.type, a, b, c);\n    c.type === \"float\" && (f.info = \"n\");\n    return f;\n}\n// prettier-ignore\nexport const matrixCompMult = (a, b) => builtinCall(\"matrixCompMult\", a.type, a, b);\nexport function isnan(a) {\n    return builtinCall(\"isnan\", matchingBoolType(a), a);\n}\nexport function isinf(a) {\n    return builtinCall(\"isinf\", matchingBoolType(a), a);\n}\n","import { add, defn, div, FLOAT0, FLOAT05, FLOAT1, FLOAT2, mix, mul, neq, ret, sub, ternary } from \"@thi.ng/shader-ast\";\n/**\n * Returns normalized value of `x` WRT to interval [a,b]. Returns 0, if\n * `a` equals `b`.\n *\n * @param x -\n * @param a -\n * @param b -\n */\nexport const fitNorm1 = defn(\"float\", \"fitNorm1\", [\"float\", \"float\", \"float\"], (x, a, b) => [ret(ternary(neq(a, b), div(sub(x, a), sub(b, a)), FLOAT0))]);\n/**\n * Inline function. Fits value `a` in [0..1] interval to new interval\n * [b..c]. No clamping performed. Same as `mix(b, c, a)`\n *\n * @param a -\n * @param b -\n * @param c -\n */\nexport const fit01 = (a, b, c) => mix(b, c, a);\n/**\n * Inline function. Fits value `x` in [-1..+1] interval to [0..1]\n * interval. No clamping performed.\n *\n * @param x -\n */\nexport const fit1101 = (x) => add(mul(x, FLOAT05), FLOAT05);\n/**\n * Inline function. Fits value `x` in [0..1] interval to [-1..+1]\n * interval. No clamping performed.\n *\n * @param x -\n */\nexport const fit0111 = (x) => sub(mul(x, FLOAT2), FLOAT1);\n","import { $x, $xy, $y, assign, defn, div, mul, ret, sym } from \"@thi.ng/shader-ast\";\nimport { fit0111 } from \"../math/fit\";\n/**\n * Computes UV coord in [0..1] interval from given `fragCoord` and screen `res`.\n *\n * @param fragCoord -\n * @param res -\n */\nexport const fragUV = (fragCoord, res) => div($xy(fragCoord), res);\n/**\n * Takes `pos`, a screen coord (e.g. gl_FragCoord) and viewport\n * resolution `res`, returns aspect corrected uv, with uv.y in [-1..1]\n * interval.\n *\n * @param fragCoord - vec2\n * @param res - vec2\n */\nexport const aspectCorrectedUV = defn(\"vec2\", \"aspectCorrectedUV\", [\"vec2\", \"vec2\"], (pos, res) => {\n    let uv;\n    return [\n        (uv = sym(\"vec2\", fit0111(div(pos, res)))),\n        assign($x(uv), mul($x(uv), div($x(res), $y(res)))),\n        ret(uv)\n    ];\n});\n","import { add, assign, defn, float, FLOAT0, FLOAT05, forLoop, inc, lt, mul, ret, sym } from \"@thi.ng/shader-ast\";\n/**\n * Higher order function. Takes an AST type ID, a single-arg scalar\n * function `fn`, number of octaves (default: 4) and an optional\n * function name. Returns a new function which computes the summed value\n * of `fn` over the given number octaves and accepts 3 args:\n *\n * - position (float)\n * - octave shift (float)\n * - octave decay (usually 0.5)\n *\n * For each octave `i` [0..oct), the function is (in principle)\n * evaluated as:\n *\n * n += decay / exp2(i) * fn(pos * exp2(i) + i * shift)\n *\n * @param fn -\n * @param oct -\n * @param name -\n */\nexport const additive = (type, fn, oct = 4, name = \"additive\") => defn(\"float\", name, [[type], [type], \"float\"], (pos, shift, decay) => {\n    let n;\n    let amp;\n    return [\n        (n = sym(FLOAT0)),\n        (amp = sym(FLOAT05)),\n        forLoop(sym(\"float\", float(0)), (i) => lt(i, float(oct)), inc, (i) => [\n            assign(n, add(n, mul(amp, fn(add(pos, mul(i, shift)))))),\n            assign(amp, mul(amp, decay)),\n            assign(pos, mul(pos, 2))\n        ]),\n        ret(n)\n    ];\n});\n","import { defn, dot, ret } from \"@thi.ng/shader-ast\";\nexport const magSq2 = defn(\"float\", \"magSq2\", [\"vec2\"], (v) => [\n    ret(dot(v, v))\n]);\nexport const magSq3 = defn(\"float\", \"magSq3\", [\"vec3\"], (v) => [\n    ret(dot(v, v))\n]);\nexport const magSq4 = defn(\"float\", \"magSq4\", [\"vec4\"], (v) => [\n    ret(dot(v, v))\n]);\n","import { add, defn, float, FLOAT1, mod, mul, ret } from \"@thi.ng/shader-ast\";\nconst __permute = (type, suffix = \"\") => defn(type, `permute${suffix}`, [type], (v) => [\n    ret(mod(mul(v, add(mul(v, float(34)), FLOAT1)), float(289)))\n]);\nexport const permute = __permute(\"float\");\nexport const permute2 = __permute(\"vec2\", \"2\");\nexport const permute3 = __permute(\"vec3\", \"3\");\nexport const permute4 = __permute(\"vec4\", \"4\");\n","import { $, $x, $xy, $y, abs, add, assign, defn, dot, float, FLOAT05, FLOAT1, floor, fract, gt, max, mod, mul, ret, sub, sym, ternary, vec2, vec3, vec4 } from \"@thi.ng/shader-ast\";\nimport { magSq2 } from \"../math/magsq\";\nimport { permute3 } from \"./permute\";\n/**\n * Array and textureless GLSL 2D simplex noise function. Ported from\n * original GLSL implementation by Ian McEwan & Ashima Arts.\n *\n * {@link https://github.com/ashima/webgl-noise}\n */\nexport const snoise2 = defn(\"float\", \"snoise2\", [\"vec2\"], (v) => {\n    let C;\n    let i;\n    let i1;\n    let x0;\n    let x12;\n    let p;\n    let m;\n    let x;\n    let h;\n    let ox;\n    let a0;\n    let g;\n    return [\n        (C = sym(vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439))),\n        (i = sym(floor(add(v, dot(v, $(C, \"yy\")))))),\n        (x0 = sym(add(sub(v, i), dot(i, $(C, \"xx\"))))),\n        (i1 = sym(ternary(gt($x(x0), $y(x0)), vec2(1, 0), vec2(0, 1)))),\n        (x12 = sym(sub(add($(x0, \"xyxy\"), $(C, \"xxzz\")), vec4(i1, 0, 0)))),\n        assign(i, mod(i, float(289))),\n        (p = sym(permute3(add(permute3(add(vec3(0, $y(i1), 1), $y(i))), add(vec3(0, $x(i1), 1), $x(i)))))),\n        (m = sym(max(sub(FLOAT05, vec3(magSq2(x0), magSq2($xy(x12)), magSq2($(x12, \"zw\")))), vec3()))),\n        assign(m, mul(m, m)),\n        assign(m, mul(m, m)),\n        (x = sym(sub(mul(2, fract(mul(p, $(C, \"www\")))), FLOAT1))),\n        (h = sym(sub(abs(x), FLOAT05))),\n        (ox = sym(floor(add(x, FLOAT05)))),\n        (a0 = sym(sub(x, ox))),\n        assign(m, mul(m, sub(1.79284291400159, mul(0.85373472095314, add(mul(a0, a0), mul(h, h)))))),\n        (g = sym(vec3(add(mul($x(a0), $x(x0)), mul($x(h), $y(x0)))))),\n        assign($(g, \"yz\"), add(mul($(a0, \"yz\"), $(x12, \"xz\")), mul($(h, \"yz\"), $(x12, \"yw\")))),\n        ret(mul(130, dot(m, g)))\n    ];\n});\n","import { defError } from \"./deferror\";\nexport const UnsupportedOperationError = defError(() => \"unsupported operation\");\nexport const unsupported = (msg) => {\n    throw new UnsupportedOperationError(msg);\n};\n","export var LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"FINE\"] = 0] = \"FINE\";\n    LogLevel[LogLevel[\"DEBUG\"] = 1] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 2] = \"INFO\";\n    LogLevel[LogLevel[\"WARN\"] = 3] = \"WARN\";\n    LogLevel[LogLevel[\"SEVERE\"] = 4] = \"SEVERE\";\n    LogLevel[LogLevel[\"NONE\"] = 5] = \"NONE\";\n})(LogLevel || (LogLevel = {}));\n","import { LogLevel } from \"./api/logger\";\nexport const NULL_LOGGER = Object.freeze({\n    level: LogLevel.NONE,\n    fine() { },\n    debug() { },\n    info() { },\n    warn() { },\n    severe() { }\n});\nexport class ConsoleLogger {\n    constructor(id, level = LogLevel.FINE) {\n        this.id = id;\n        this.level = level;\n    }\n    fine(...args) {\n        this.level <= LogLevel.FINE && this.log(\"FINE\", args);\n    }\n    debug(...args) {\n        this.level <= LogLevel.DEBUG && this.log(\"DEBUG\", args);\n    }\n    info(...args) {\n        this.level <= LogLevel.INFO && this.log(\"INFO\", args);\n    }\n    warn(...args) {\n        this.level <= LogLevel.WARN && this.log(\"WARN\", args);\n    }\n    severe(...args) {\n        this.level <= LogLevel.SEVERE && this.log(\"SEVERE\", args);\n    }\n    log(level, args) {\n        console.log(`[${level}] ${this.id}:`, ...args);\n    }\n}\n","import { NULL_LOGGER } from \"@thi.ng/api\";\n/**\n * Unique symbol used for registering a default / fallback\n * implementation.\n */\nexport const DEFAULT = Symbol();\nexport let LOGGER = NULL_LOGGER;\nexport const setLogger = (logger) => (LOGGER = logger);\n","import { unsupported } from \"@thi.ng/errors\";\nimport { DEFAULT, LOGGER } from \"./constants\";\nexport function defmulti(f, ancestors) {\n    const impls = {};\n    const rels = ancestors\n        ? makeRels(ancestors)\n        : {};\n    const fn = (...args) => {\n        const id = f(...args);\n        const g = impls[id] || findImpl(impls, rels, id) || impls[DEFAULT];\n        return g\n            ? g(...args)\n            : unsupported(`missing implementation for: \"${id.toString()}\"`);\n    };\n    fn.add = (id, g) => {\n        if (impls[id]) {\n            LOGGER.warn(`overwriting '${id.toString()}' impl`);\n        }\n        impls[id] = g;\n        return true;\n    };\n    fn.addAll = (_impls) => {\n        let ok = true;\n        for (let id in _impls) {\n            ok = fn.add(id, _impls[id]) && ok;\n        }\n        return ok;\n    };\n    fn.remove = (id) => {\n        if (!impls[id])\n            return false;\n        delete impls[id];\n        return true;\n    };\n    fn.callable = (...args) => {\n        const id = f(...args);\n        return !!(impls[id] ||\n            findImpl(impls, rels, id) ||\n            impls[DEFAULT]);\n    };\n    fn.isa = (id, parent) => {\n        let val = rels[id];\n        !val && (rels[id] = val = new Set());\n        val.add(parent);\n    };\n    fn.impls = () => {\n        const res = new Set(Object.keys(impls));\n        for (let id in rels) {\n            findImpl(impls, rels, id) && res.add(id);\n        }\n        impls[DEFAULT] && res.add(DEFAULT);\n        return res;\n    };\n    fn.rels = () => rels;\n    fn.parents = (id) => rels[id];\n    fn.ancestors = (id) => new Set(findAncestors([], rels, id));\n    return fn;\n}\nconst findImpl = (impls, rels, id) => {\n    const parents = rels[id];\n    if (!parents)\n        return;\n    for (let p of parents) {\n        let impl = impls[p] || findImpl(impls, rels, p);\n        if (impl)\n            return impl;\n    }\n};\nconst findAncestors = (acc, rels, id) => {\n    const parents = rels[id];\n    if (parents) {\n        for (let p of parents) {\n            acc.push(p);\n            findAncestors(acc, rels, p);\n        }\n    }\n    return acc;\n};\nconst makeRels = (spec) => {\n    const rels = {};\n    for (let k in spec) {\n        const val = spec[k];\n        rels[k] = val instanceof Set ? val : new Set(val);\n    }\n    return rels;\n};\n","import { DEFAULT, defmulti } from \"@thi.ng/defmulti\";\nimport { unsupported } from \"@thi.ng/errors\";\n/**\n * Takes an object of code generator functions and returns a new code\n * generator / compile target function which serializes a given AST\n * using the provided node type implementations.\n *\n * {@link @thi.ng/shader-ast-glsl#targetGLSL}\n *\n * @param impls -\n */\nexport const defTarget = (impls) => {\n    const emit = defmulti((x) => x.tag);\n    emit.add(DEFAULT, (t) => unsupported(`no impl for AST node type: '${t.tag}'`));\n    emit.addAll(impls);\n    return emit;\n};\n","export var GLSLVersion;\n(function (GLSLVersion) {\n    GLSLVersion[\"GLES_100\"] = \"100\";\n    GLSLVersion[\"GLES_300\"] = \"300 es\";\n})(GLSLVersion || (GLSLVersion = {}));\n","import { isBoolean, isNumber } from \"@thi.ng/checks\";\nimport { unsupported } from \"@thi.ng/errors\";\nimport { defTarget, isMat, isVec, itemType, sym } from \"@thi.ng/shader-ast\";\nimport { GLSLVersion } from \"./api\";\nconst RE_SEMI = /[};]$/;\n/**\n * GLSL code gen, targets GLSL ES 3.00 (WebGL2) by default.\n *\n * Use options object to configure shader type and GLSL version: `100`\n * for WebGL, 300 for WebGL2. Currently, the only differences in terms\n * of code generation, not correctness, are:\n *\n * - attribute, varying, uniform declarations\n * - texture lookup function naming\n *\n * Unsupported features in GLSL 100:\n *\n * - Fragment shader output vars\n *\n * @param opts -\n */\nexport const targetGLSL = (opts) => {\n    const _opts = Object.assign({ type: \"fs\", version: GLSLVersion.GLES_300, versionPragma: true, prelude: \"\" }, opts);\n    const isVS = _opts.type === \"vs\";\n    // TODO update once we have struct support\n    const $type = (t) => t;\n    const $list = (body, sep = \", \") => body.map(emit).join(sep);\n    const $fn = (t) => `${t.id}(${$list(t.args)})`;\n    const $decl = (sym, arg = false) => {\n        const { id, type, opts, init } = sym;\n        const res = [];\n        if (opts.type) {\n            let type;\n            if (_opts.version < GLSLVersion.GLES_300) {\n                if (isVS) {\n                    type = {\n                        in: \"attribute\",\n                        out: \"varying\",\n                        uni: \"uniform\"\n                    }[opts.type];\n                }\n                else {\n                    type = {\n                        in: \"varying\",\n                        out: null,\n                        uni: \"uniform\"\n                    }[opts.type];\n                    !type &&\n                        unsupported(\"GLSL 100 doesn't support fragment shader output variables\");\n                }\n            }\n            else {\n                opts.loc != null && res.push(`layout(location=${opts.loc}) `);\n                type = opts.type === \"uni\" ? \"uniform\" : opts.type;\n            }\n            res.push(type + \" \");\n        }\n        else {\n            opts.const && res.push(\"const \");\n            arg && opts.q && res.push(opts.q + \" \");\n        }\n        opts.prec && res.push(opts.prec + \" \");\n        res.push($type(itemType(type)), \" \", id);\n        opts.num && res.push(`[${opts.num}]`);\n        init && res.push(\" = \", emit(init));\n        return res.join(\"\");\n    };\n    const emit = defTarget({\n        arg: (t) => $decl(t, true),\n        array_init: (t) => _opts.version >= GLSLVersion.GLES_300\n            ? `${t.type}(${$list(t.init)})`\n            : unsupported(`array initializers not available in GLSL ${_opts.version}`),\n        assign: (t) => emit(t.l) + \" = \" + emit(t.r),\n        ctrl: (t) => t.id,\n        call: $fn,\n        call_i: (t) => t.id === \"texture\" && _opts.version < GLSLVersion.GLES_300\n            ? `${t.id}${t.args[0].type.substr(7)}(${$list(t.args)})`\n            : $fn(t),\n        decl: (t) => $decl(t.id),\n        fn: (t) => `${$type(t.type)} ${t.id}(${$list(t.args)}) ${emit(t.scope)}`,\n        for: (t) => `for(${t.init ? emit(t.init) : \"\"}; ${emit(t.test)}; ${t.iter ? emit(t.iter) : \"\"}) ${emit(t.scope)}`,\n        idx: (t) => `${emit(t.val)}[${emit(t.id)}]`,\n        if: (t) => {\n            const res = `if (${emit(t.test)}) ` + emit(t.t);\n            return t.f ? res + \" else \" + emit(t.f) : res;\n        },\n        lit: (t) => {\n            const v = t.val;\n            switch (t.type) {\n                case \"bool\":\n                    return isBoolean(v) ? String(v) : `bool(${emit(v)})`;\n                case \"float\":\n                    return isNumber(v)\n                        ? v === Math.trunc(v)\n                            ? v + \".0\"\n                            : String(v)\n                        : `float(${emit(v)})`;\n                case \"int\":\n                case \"uint\":\n                    return isNumber(v) ? String(v) : `${t.type}(${emit(v)})`;\n                default: {\n                    if (isVec(t) || isMat(t)) {\n                        return `${t.type}(${$list(v)})`;\n                    }\n                    return unsupported(`unknown type: ${t.type}`);\n                }\n            }\n        },\n        op1: (t) => t.post ? `(${emit(t.val)}${t.op})` : `(${t.op}${emit(t.val)})`,\n        op2: (t) => `(${emit(t.l)} ${t.op} ${emit(t.r)})`,\n        ret: (t) => \"return\" + (t.val ? \" \" + emit(t.val) : \"\"),\n        scope: (t) => {\n            let res = t.body\n                .map(emit)\n                .reduce((acc, x) => (acc.push(RE_SEMI.test(x) ? x : x + \";\"), acc), [])\n                .join(\"\\n\");\n            res += t.body.length && !RE_SEMI.test(res) ? \";\" : \"\";\n            if (!t.global) {\n                return `{\\n${res}\\n}`;\n            }\n            if (_opts.prelude) {\n                res = _opts.prelude + \"\\n\" + res;\n            }\n            if (_opts.versionPragma) {\n                res = `#version ${_opts.version}\\n` + res;\n            }\n            return res;\n        },\n        swizzle: (t) => `${emit(t.val)}.${t.id}`,\n        sym: (t) => t.id,\n        ternary: (t) => `(${emit(t.test)} ? ${emit(t.t)} : ${emit(t.f)})`,\n        while: (t) => `while (${emit(t.test)}) ${emit(t.scope)}`\n    });\n    Object.assign(emit, {\n        gl_FragColor: sym(\"vec4\", \"gl_FragColor\"),\n        gl_FragCoord: sym(\"vec4\", \"gl_FragCoord\", { const: true }),\n        gl_FragData: sym(\"vec4[]\", \"gl_FragData\", { num: 1 }),\n        gl_FrontFacing: sym(\"bool\", \"gl_FrontFacing\", { const: true }),\n        gl_PointCoord: sym(\"vec2\", \"gl_PointCoord\", { const: true }),\n        gl_PointSize: sym(\"float\", \"gl_PointSize\"),\n        gl_Position: sym(\"vec4\", \"gl_Position\")\n    });\n    return emit;\n};\n","import {\n\tdefn,\n\tVec2Sym,\n\tFloatSym,\n\tsym,\n\tadd,\n\tvec2,\n\tfloat,\n\tret,\n\tvec4,\n\tvec3,\n\tprogram,\n\tdefMain,\n\tuniform,\n\tTaggedFn3,\n\tVec4Sym,\n\tassign,\n\t$xy,\n} from '@thi.ng/shader-ast'\nimport {\n\tadditive,\n\taspectCorrectedUV,\n\tfit1101,\n\tsnoise2,\n} from '@thi.ng/shader-ast-stdlib'\nimport { targetGLSL, GLSLVersion } from '@thi.ng/shader-ast-glsl'\n\nconst fs = targetGLSL({\n\tversion: GLSLVersion.GLES_100,\n\ttype: 'fs',\n\tprelude: 'precision mediump float;',\n})\n\nlet getImage = defn(\n\t'vec4',\n\t'mainImage',\n\t['vec2', 'vec2', 'float'],\n\t(fragCoord: Vec2Sym, res: Vec2Sym, time: FloatSym) => {\n\t\tlet uv: Vec2Sym\n\t\tlet col: FloatSym\n\t\treturn [\n\t\t\t(uv = sym(aspectCorrectedUV(fragCoord, res))),\n\t\t\t// dynamically create a multi-octave version of `snoise2`\n\t\t\t// computed over 4 octaves w/ given phase shift and decay\n\t\t\t// factor (both per octave)\n\t\t\t(col = sym(\n\t\t\t\tadditive('vec2', snoise2, 4)(add(uv, time), vec2(2), float(0.5)),\n\t\t\t)),\n\t\t\tret(vec4(vec3(fit1101(col)), 1)),\n\t\t]\n\t},\n)\n\nlet resolution: Vec2Sym\nlet time: FloatSym\n\nexport const noiseShader = fs(\n\tprogram([\n\t\t(resolution = uniform('vec2', 'resolution')),\n\t\t(time = uniform('float', 'time')),\n\t\tdefMain(() => [\n\t\t\tassign(fs.gl_FragColor, getImage($xy(fs.gl_FragCoord), resolution, time)),\n\t\t]),\n\t]),\n)\n\nconsole.log(noiseShader)\n\n\nif (module.hot) {module.hot.accept(function(err) {\nif (err) {\nconsole.error(err);\n}\n});\n}\n","import {\n\tgetEffect,\n\tget,\n\tdispatch,\n\tgetFrame,\n\taddSystem,\n} from '../../shared-utils/painterState'\nimport { painter, events } from './context'\nimport { noiseShader } from './shaders'\nimport { repeat } from '../../shared-utils/scheduler'\n\n// ===== layers =====\n\nexport const noise = getEffect(painter, 'noise').update({\n\tfrag: noiseShader,\n})\n\nexport const toNormal = getEffect(painter, 'toNormal')\n\nconst noiseFrame = getFrame(painter, 'noise').update({\n\tlayers: noise,\n})\n\nlet time = 0\n\nrepeat(tpf => {\n\tconst d = get('device')\n\td.tpf = tpf\n\t// dispatch(events.FRAME)\n\n\ttime += tpf / 10000\n\tnoise.update({\n\t\tuniforms: {\n\t\t\tresolution: [d.canvas.width, d.canvas.height],\n\t\t\ttime,\n\t\t},\n\t})\n\tpainter.compose(noiseFrame).display(noiseFrame)\n}, 'loop')\n\naddSystem('index', (e, s) => {\n\tif (e === events.RESIZE) {\n\t\tnoiseFrame.update()\n\t}\n})\n\n\nif (module.hot) {module.hot.accept(function(err) {\nif (err) {\nconsole.error(err);\n}\n});\n}\n","export function randInt(int) {\n    return Math.floor(Math.random() * int);\n}\nexport function randIntInRange(from, to) {\n    return randInt(to - from) + from;\n}\nexport function normalRand() {\n    return (Math.random() + Math.random() + Math.random()) / 3;\n}\n//# sourceMappingURL=random.js.map","import { NO_OP } from \"./constants\";\n/**\n * Takes a `test` result or predicate function without args and throws\n * error with given `msg` if test failed (i.e. is falsy).\n *\n * @remarks\n * The function is only enabled if `process.env.NODE_ENV != \"production\"`\n * or if the `UMBRELLA_ASSERTS` env var is set to 1.\n */\nexport const assert = typeof process === \"undefined\" ||\n    process.env.NODE_ENV !== \"production\" ||\n    process.env.UMBRELLA_ASSERTS === \"1\"\n    ? (test, msg = \"assertion failed\") => {\n        if ((typeof test === \"function\" && !test()) || !test) {\n            throw new Error(typeof msg === \"function\" ? msg() : msg);\n        }\n    }\n    : NO_OP;\n","export const isNode = () => {\n    if (typeof process === \"object\") {\n        if (typeof process.versions === \"object\") {\n            if (typeof process.versions.node !== \"undefined\") {\n                return true;\n            }\n        }\n    }\n    return false;\n};\n","// onNextTick\n// schedule actions on next animation frame\n\ntype Callback = (n: number) => void\n\nlet updateOnce: { [id: string]: Callback } | null = null\nconst updateRepeat: { [id: string]: Callback } = {}\n\nlet willUpdate = false\n\nlet uidCounter = 0\n\nlet oldTime = 0\n\nfunction processUpdates(time: number) {\n\tconst tpf = oldTime ? time - oldTime : oldTime\n\toldTime = time\n\n\tif (updateOnce) {\n\t\tfor (const id in updateOnce) {\n\t\t\tupdateOnce[id](tpf)\n\t\t}\n\t\tupdateOnce = null\n\t}\n\n\tlet updates = 0\n\tfor (const id in updateRepeat) {\n\t\tupdates++\n\t\tupdateRepeat[id](tpf)\n\t}\n\n\tif (!updates) {\n\t\twillUpdate = false\n\t\toldTime = 0\n\t} else {\n\t\trequestAnimationFrame(processUpdates)\n\t}\n}\n\nexport function once(fn: Callback, id?: string | number) {\n\tid = id || fn.name || uidCounter++\n\tupdateOnce = updateOnce || {}\n\tupdateOnce[id] = fn\n\n\tif (!willUpdate) {\n\t\trequestAnimationFrame(processUpdates)\n\t\twillUpdate = true\n\t}\n}\n\nexport function repeat(fn: Callback, id?: string | number) {\n\tid = id || fn.name || uidCounter++\n\tupdateRepeat[id] = fn\n\n\tif (!willUpdate) {\n\t\trequestAnimationFrame(processUpdates)\n\t\twillUpdate = true\n\t}\n\n\treturn id\n}\n\nexport function stop(id: Callback | string | number) {\n\tif (typeof id === 'function') {\n\t\tid = id.name\n\t}\n\tdelete updateRepeat[id]\n}\n\n\nif (module.hot) {module.hot.accept(function(err) {\nif (err) {\nconsole.error(err);\n}\n});\n}\n","export const and = (p1, p2) => (a, b) => p1(a, b) && p2(a, b);\nexport const not = (p) => (...args) => !p(...args);\nexport const defined = a => a != null;\nexport const notEmpty = a => a && a.length;\nexport const unequal = (a, b) => a !== b;\nexport const equal = (a, b) => a === b;\nexport function equalArray(arr1, arr2) {\n    if (arr1 === arr2) {\n        return true;\n    }\n    if (!arr2 || !arr1) {\n        return false;\n    }\n    if (arr1.length !== arr2.length) {\n        return false;\n    }\n    for (let i = 0; i < arr1.length; i++) {\n        if (arr1[i] !== arr2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function equalObject(obj1, obj2) {\n    if (obj1 === obj2) {\n        return true;\n    }\n    if (!obj2) {\n        return false;\n    }\n    const k1 = Object.keys(obj1);\n    const k2 = Object.keys(obj2);\n    if (!equalArray(k1, k2)) {\n        return false;\n    }\n    for (const key of k1) {\n        if (obj1[key] !== obj2[key]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=predicates.js.map","export function makeClear(gl, ...clearArray) {\n    return clearArray.reduce((res, item) => res | gl[item.toUpperCase() + '_BUFFER_BIT'], 0);\n}\nexport function setBlendFunc(gl, blendOpts) {\n    gl.blendFunc.apply(gl, blendOpts.map(opt => gl[opt.toUpperCase()]));\n}\n/**\n * @param {HTMLCanvasElement} canvas The canvas to resize.\n * @param {number} [multiplier] optional `window.devicePixelRatio`.\n * @return {boolean} true if the canvas was resized.\n */\nexport function resizeCanvas(canvas, multiplier = 1) {\n    let width = canvas.width;\n    let height = canvas.height;\n    if ('clientWidth' in canvas && 'clientHeight' in canvas) {\n        width = (canvas.clientWidth * multiplier) | 0;\n        height = (canvas.clientHeight * multiplier) | 0;\n    }\n    if (canvas.width !== width || canvas.height !== height) {\n        canvas.width = width;\n        canvas.height = height;\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=context.js.map"],"sourceRoot":""}