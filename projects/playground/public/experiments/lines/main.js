!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=76)}([function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"d",(function(){return u}));const r="position",i="normal",a="uv",o="source",s="coords",u={FLOAT:5126,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FLOAT_MAT2X3:35685,FLOAT_MAT2X4:35686,FLOAT_MAT3X2:35687,FLOAT_MAT3X4:35688,FLOAT_MAT4X2:35689,FLOAT_MAT4X3:35690,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT:5125,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_3D:32879,TEXTURE_2D_ARRAY:35866,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042},c=6403,f=33319,d=6407,l=6408,h=6402,p=33321,b=33323,_=32849,m=32856,g=33325,E=33327,M=34843,y=34842,v=33332,T=33338,A=36215,S=36214,O=33334,R=33340,F=36209,N=36208,w=33189,I=33190,U=36012;u.UNSIGNED_BYTE,u.UNSIGNED_SHORT,u.UNSIGNED_INT,u.FLOAT},function(t,e,n){"use strict";n.d(e,"i",(function(){return tt})),n.d(e,"f",(function(){return nt})),n.d(e,"j",(function(){return it})),n.d(e,"k",(function(){return ot})),n.d(e,"h",(function(){return ut})),n.d(e,"g",(function(){return ft})),n.d(e,"e",(function(){return lt})),n.d(e,"d",(function(){return pt})),n.d(e,"m",(function(){return bt})),n.d(e,"l",(function(){return _t})),n.d(e,"a",(function(){return gt})),n.d(e,"c",(function(){return Et})),n.d(e,"b",(function(){return Mt}));var r=n(8);function i(t){function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}var a=n(4);var o=n(0);const s="CLAMP_TO_EDGE",u="LINEAR",c="NEAREST";const f={renderQuad:{attribs:{[o.b]:{buffer:new Float32Array([-1,1,-1,-1,1,1,1,-1]),storeType:"STATIC"},[o.c]:{buffer:new Float32Array([0,1,0,0,1,1,1,0]),storeType:"STATIC"}},drawType:"TRIANGLE_STRIP",itemCount:4}},d={basicEffect:{vert:`\nattribute vec2 ${o.b};\nattribute vec2 ${o.c};\nvarying vec2 ${o.f};\nvoid main() {\n\t${o.f} = ${o.c};\n\tgl_Position = vec4(${o.b}, 0.0, 1.0);\n}`,frag:`precision mediump float;\nuniform sampler2D ${o.e};\nvarying vec2 ${o.f};\nvoid main() {\n\tgl_FragColor = texture2D(${o.e}, ${o.f});\n}`}};function l(t){return M[t].bindPoint}function h(t,e){return n=>{t.uniform1i(e,n)}}function p(t,e){return n=>{t.uniform1iv(e,n)}}function b(t,e){return n=>{t.uniform2iv(e,n)}}function _(t,e){return n=>{t.uniform3iv(e,n)}}function m(t,e){return n=>{t.uniform4iv(e,n)}}function g(t,e,n,r){const i=l(e);return e=>{t.uniform1i(r,n),t.activeTexture(t.TEXTURE0+n),t.bindTexture(i,e._texture)}}function E(t,e,n,r,i){const a=l(e),o=new Int32Array(i);for(let t=0;t<i;++t)o[t]=n+t;return e=>{t.uniform1iv(r,o);for(const n in e)t.activeTexture(t.TEXTURE0+o[n]),t.bindTexture(a,e[n]._texture)}}const M={[o.d.FLOAT]:{Type:Float32Array,size:4,setter:function(t,e){return n=>{t.uniform1f(e,n)}},arraySetter:function(t,e){return n=>{t.uniform1fv(e,n)}}},[o.d.FLOAT_VEC2]:{Type:Float32Array,size:8,setter:function(t,e){return n=>{t.uniform2fv(e,n)}}},[o.d.FLOAT_VEC3]:{Type:Float32Array,size:12,setter:function(t,e){return n=>{t.uniform3fv(e,n)}}},[o.d.FLOAT_VEC4]:{Type:Float32Array,size:16,setter:function(t,e){return n=>{t.uniform4fv(e,n)}}},[o.d.INT]:{Type:Int32Array,size:4,setter:h,arraySetter:p},[o.d.INT_VEC2]:{Type:Int32Array,size:8,setter:b},[o.d.INT_VEC3]:{Type:Int32Array,size:12,setter:_},[o.d.INT_VEC4]:{Type:Int32Array,size:16,setter:m},[o.d.UNSIGNED_INT]:{Type:Uint32Array,size:4,setter:function(t,e){return n=>{t.uniform1ui(e,n)}},arraySetter:function(t,e){return n=>{t.uniform1uiv(e,n)}}},[o.d.UNSIGNED_INT_VEC2]:{Type:Uint32Array,size:8,setter:function(t,e){return n=>{t.uniform2uiv(e,n)}}},[o.d.UNSIGNED_INT_VEC3]:{Type:Uint32Array,size:12,setter:function(t,e){return n=>{t.uniform3uiv(e,n)}}},[o.d.UNSIGNED_INT_VEC4]:{Type:Uint32Array,size:16,setter:function(t,e){return n=>{t.uniform4uiv(e,n)}}},[o.d.BOOL]:{Type:Uint32Array,size:4,setter:h,arraySetter:p},[o.d.BOOL_VEC2]:{Type:Uint32Array,size:8,setter:b},[o.d.BOOL_VEC3]:{Type:Uint32Array,size:12,setter:_},[o.d.BOOL_VEC4]:{Type:Uint32Array,size:16,setter:m},[o.d.FLOAT_MAT2]:{Type:Float32Array,size:16,setter:function(t,e){return n=>{t.uniformMatrix2fv(e,!1,n)}}},[o.d.FLOAT_MAT3]:{Type:Float32Array,size:36,setter:function(t,e){return n=>{t.uniformMatrix3fv(e,!1,n)}}},[o.d.FLOAT_MAT4]:{Type:Float32Array,size:64,setter:function(t,e){return n=>{t.uniformMatrix4fv(e,!1,n)}}},[o.d.FLOAT_MAT2X3]:{Type:Float32Array,size:24,setter:function(t,e){return n=>{t.uniformMatrix2x3fv(e,!1,n)}}},[o.d.FLOAT_MAT2X4]:{Type:Float32Array,size:32,setter:function(t,e){return n=>{t.uniformMatrix2x4fv(e,!1,n)}}},[o.d.FLOAT_MAT3X2]:{Type:Float32Array,size:24,setter:function(t,e){return n=>{t.uniformMatrix3x2fv(e,!1,n)}}},[o.d.FLOAT_MAT3X4]:{Type:Float32Array,size:48,setter:function(t,e){return n=>{t.uniformMatrix3x4fv(e,!1,n)}}},[o.d.FLOAT_MAT4X2]:{Type:Float32Array,size:32,setter:function(t,e){return n=>{t.uniformMatrix4x2fv(e,!1,n)}}},[o.d.FLOAT_MAT4X3]:{Type:Float32Array,size:48,setter:function(t,e){return n=>{t.uniformMatrix4x3fv(e,!1,n)}}},[o.d.SAMPLER_2D]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D},[o.d.SAMPLER_CUBE]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.SAMPLER_3D]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_3D},[o.d.SAMPLER_2D_SHADOW]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D},[o.d.SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.SAMPLER_2D_ARRAY_SHADOW]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.SAMPLER_CUBE_SHADOW]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.INT_SAMPLER_2D]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D},[o.d.INT_SAMPLER_3D]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_3D},[o.d.INT_SAMPLER_CUBE]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.INT_SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D_ARRAY},[o.d.UNSIGNED_INT_SAMPLER_2D]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D},[o.d.UNSIGNED_INT_SAMPLER_3D]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_3D},[o.d.UNSIGNED_INT_SAMPLER_CUBE]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_CUBE_MAP},[o.d.UNSIGNED_INT_SAMPLER_2D_ARRAY]:{Type:null,size:0,setter:g,arraySetter:E,bindPoint:o.d.TEXTURE_2D_ARRAY}};function y(t,e,n){return r=>{t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n.itemSize,o.d.FLOAT,r.normalize||!1,r.stride||0,r.offset||0)}}function v(t,e,n){return r=>{t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.itemSize,o.d.INT,r.stride||0,r.offset||0)}}function T(t,e,n){const r=n.size,i=n.count;return n=>{t.bindBuffer(t.ARRAY_BUFFER,n.buffer);const a=r,s=a/i,u=M[o.d.FLOAT].size*a,c=n.normalize||!1,f=n.offset||0,d=u/i;for(let n=0;n<i;++n)t.enableVertexAttribArray(e+n),t.vertexAttribPointer(e+n,s,o.d.FLOAT,c,u,f+d*n)}}const A={[o.d.FLOAT]:{size:4,setter:y,itemSize:1},[o.d.FLOAT_VEC2]:{size:8,setter:y,itemSize:2},[o.d.FLOAT_VEC3]:{size:12,setter:y,itemSize:3},[o.d.FLOAT_VEC4]:{size:16,setter:y,itemSize:4},[o.d.INT]:{size:4,setter:v,itemSize:1},[o.d.INT_VEC2]:{size:8,setter:v,itemSize:2},[o.d.INT_VEC3]:{size:12,setter:v,itemSize:3},[o.d.INT_VEC4]:{size:16,setter:v,itemSize:4},[o.d.UNSIGNED_INT]:{size:4,setter:v,itemSize:1},[o.d.UNSIGNED_INT_VEC2]:{size:8,setter:v,itemSize:2},[o.d.UNSIGNED_INT_VEC3]:{size:12,setter:v,itemSize:3},[o.d.UNSIGNED_INT_VEC4]:{size:16,setter:v,itemSize:4},[o.d.BOOL]:{size:4,setter:v,itemSize:1},[o.d.BOOL_VEC2]:{size:8,setter:v,itemSize:2},[o.d.BOOL_VEC3]:{size:12,setter:v,itemSize:3},[o.d.BOOL_VEC4]:{size:16,setter:v,itemSize:4},[o.d.FLOAT_MAT2]:{size:4,setter:T,count:2},[o.d.FLOAT_MAT3]:{size:9,setter:T,count:3},[o.d.FLOAT_MAT4]:{size:16,setter:T,count:4}};o.d.BYTE,Int8Array,o.d.UNSIGNED_BYTE,Uint8Array,o.d.SHORT,Int16Array,o.d.UNSIGNED_SHORT,Uint16Array,o.d.INT,Int32Array,o.d.UNSIGNED_INT,Uint32Array,o.d.FLOAT,Float32Array,o.d.UNSIGNED_SHORT_4_4_4_4,Uint16Array,o.d.UNSIGNED_SHORT_5_5_5_1,Uint16Array,o.d.UNSIGNED_SHORT_5_6_5,Uint16Array,o.d.HALF_FLOAT,Uint16Array,o.d.UNSIGNED_INT_2_10_10_10_REV,Uint32Array,o.d.UNSIGNED_INT_10F_11F_11F_REV,Uint32Array,o.d.UNSIGNED_INT_5_9_9_9_REV,Uint32Array,o.d.FLOAT_32_UNSIGNED_INT_24_8_REV,Uint32Array,o.d.UNSIGNED_INT_24_8,Uint32Array;function S(t,e){if(e.enable)for(const n of e.enable)t.enable(n);if(e.disable)for(const n of e.disable)t.disable(n);e.blendFunc&&t.blendFunc.apply(t,e.blendFunc),null!=e.depthFunc&&t.depthFunc(e.depthFunc),null!=e.cullFace&&t.cullFace(e.cullFace),null!=e.frontFace&&t.frontFace(e.frontFace),null!=e.lineWidth&&t.lineWidth(e.lineWidth),e.colorMask&&t.colorMask.apply(t,e.colorMask),null!=e.depthMask&&t.depthMask(e.depthMask),e.clearColor&&t.clearColor.apply(t,e.clearColor),null!=e.clearDepth&&t.clearDepth(e.clearDepth),null!=e.clearBits&&t.clear(e.clearBits)}function O(t,e){if(e.enable)for(const n of e.enable)t.disable(n);if(e.disable)for(const n of e.disable)t.enable(n)}let R=1;class F{constructor(t,e="Form"+R++){this._painter=t,this.id=e}update(t){const e=this._painter.gl;t.drawType&&(this._drawType=e[t.drawType]),t.itemCount&&(this._itemCount=t.itemCount),this._attribs=this._attribs||{};for(const n in t.attribs){const r=t.attribs[n];null==this._attribs[n]&&(this._attribs[n]={buffer:e.createBuffer()}),e.bindBuffer(e.ARRAY_BUFFER,this._attribs[n].buffer),e.bufferData(e.ARRAY_BUFFER,r.buffer,e[(r.storeType||"STATIC")+"_DRAW"])}if(t.elements){const n=t.elements.buffer;null==this._elements&&(this._elements={buffer:e.createBuffer(),glType:null}),this._elements.glType=function(t){if(t instanceof Int8Array)return o.d.BYTE;if(t instanceof Uint8Array)return o.d.UNSIGNED_BYTE;if(t instanceof Uint8ClampedArray)return o.d.UNSIGNED_BYTE;if(t instanceof Int16Array)return o.d.SHORT;if(t instanceof Uint16Array)return o.d.UNSIGNED_SHORT;if(t instanceof Int32Array)return o.d.INT;if(t instanceof Uint32Array)return o.d.UNSIGNED_INT;if(t instanceof Float32Array)return o.d.FLOAT;throw new Error("unsupported typed array type")}(n),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._elements.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e[(t.elements.storeType||"STATIC")+"_DRAW"])}return this}destroy(){const t=this._painter.gl;for(const e in this._attribs)t.deleteBuffer(this._attribs[e].buffer);this._attribs={},this._elements&&(t.deleteBuffer(this._elements.buffer),this._elements=void 0)}}var N=n(3),w=n(11);let I=1;class U{constructor(t,e="Texture"+I++){this._painter=t,this.id=e,this._texture=null,this._data={}}update(t){const e=this._painter.gl;if(null==this._texture&&(this._texture=e.createTexture()),e.bindTexture(e.TEXTURE_2D,this._texture),t.wrap&&t.wrap!==this._data.wrap||t.wrapS&&t.wrapS!==this._data.wrapS||t.wrapT&&t.wrapT!==this._data.wrapT){let n,r;t.wrap?n=r=t.wrap:(r=t.wrapT||s,n=t.wrapS||s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[n]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[r])}else this._data.wrap||this._data.wrapS||this._data.wrapT||(this._data.wrap=this._data.wrapT=this._data.wrapS=s,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[this._data.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[this._data.wrap]));return t.magFilter&&t.magFilter!==this._data.magFilter?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[t.magFilter]):this._data.magFilter||(this._data.magFilter=c,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[this._data.magFilter])),t.minFilter&&t.minFilter!==this._data.minFilter?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[t.minFilter]):this._data.minFilter||(this._data.minFilter=u,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[this._data.minFilter])),t.asset&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.asset),void 0!==t.data&&e.texImage2D(e.TEXTURE_2D,0,"FLOAT"===t.type&&this._painter.isWebGL2?e.RGBA32F:e.RGBA,t.width,t.height,0,e.RGBA,e[t.type||"UNSIGNED_BYTE"],t.data),null!=t.flipY&&t.flipY!==this._data.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),t.minFilter&&t.minFilter.indexOf("MIPMAP")>0&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),Object.assign(this._data,t),this}destroy(){this._painter.gl.deleteTexture(this._texture),this._data={},this._texture=null}}let D=1;class L{constructor(t,e="Form"+D++){this._painter=t,this.id=e,this.width=0,this.height=0,this.antialias=!1,this.frameBuffer=null,this.antiAliasFrameBuffer=null,this.antiAliasRenderBuffer=null,this.textures=[],this.depthBuffer=null,this.bufferStructure=[],this._data={}}update(t){var e;const n=this._painter.gl,r=t.width||this.width,i=t.height||this.height;if(!r||!i)return this;if(r===this.width&&i===this.height){if(!t.bufferStructure)return this;if(t.bufferStructure.length===this.bufferStructure.length&&this.bufferStructure.every((e,n)=>Object(w.b)(e,t.bufferStructure[n])))return this}null==this.frameBuffer&&(this.frameBuffer=n.createFramebuffer()),null==this.depthBuffer&&(this.depthBuffer=n.createRenderbuffer()),t.bufferStructure&&t.bufferStructure.length&&(this.bufferStructure=t.bufferStructure,this.bufferStructure.some(t=>"FLOAT"===t.type)&&(this._painter.isWebGL2?n.getExtension("EXT_color_buffer_float"):n.getExtension("OES_texture_float")));const a=this.bufferStructure.length||1,o=[n.COLOR_ATTACHMENT0];if(n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer),a>1){let t;this._painter.isWebGL2||(t=n.getExtension("WEBGL_draw_buffers"));const e=this._painter.isWebGL2?n.COLOR_ATTACHMENT0:t.COLOR_ATTACHMENT0_WEBGL;for(let t=0;t<a;t++)o[t]=e+t;this._painter.isWebGL2?n.drawBuffers(o):t.drawBuffersWEBGL(o)}if(this.antialias=1===a&&this._painter.isWebGL2&&(t.antialias||(null===(e=this._data)||void 0===e?void 0:e.antialias)),this.antialias){const t=n;null==this.antiAliasFrameBuffer&&(this.antiAliasFrameBuffer=n.createFramebuffer()),null==this.antiAliasRenderBuffer&&(this.antiAliasRenderBuffer=n.createRenderbuffer()),n.bindFramebuffer(n.FRAMEBUFFER,this.antiAliasFrameBuffer),n.bindRenderbuffer(n.RENDERBUFFER,this.antiAliasRenderBuffer),t.renderbufferStorageMultisample(n.RENDERBUFFER,Math.min(4,n.getParameter(t.MAX_SAMPLES)),t.RGBA8,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,this.antiAliasRenderBuffer),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),t.renderbufferStorageMultisample(n.RENDERBUFFER,Math.min(4,n.getParameter(t.MAX_SAMPLES)),n.DEPTH_COMPONENT16,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer),n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer)}else n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,r,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer);for(let t=0;t<a;t++){this.textures[t]||(this.textures[t]=new U(this._painter,this.id+"_Texture"+t));const e=this.textures[t];e.update(Object.assign(Object.assign({minFilter:"NEAREST",magFilter:"NEAREST"},this.bufferStructure[t]),{data:null,width:r,height:i})),n.framebufferTexture2D(n.FRAMEBUFFER,o[t],n.TEXTURE_2D,e._texture,0)}if(this.antialias){n.bindFramebuffer(n.FRAMEBUFFER,this.antiAliasFrameBuffer);const e=n.checkFramebufferStatus(n.FRAMEBUFFER);e!==n.FRAMEBUFFER_COMPLETE&&console.error("antialias framebuffer error",e,t),n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer)}const s=n.checkFramebufferStatus(n.FRAMEBUFFER);return s!==n.FRAMEBUFFER_COMPLETE&&console.error("framebuffer error",s,t),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),Object.assign(this._data,t),this.width=r,this.height=i,this}destroy(){const t=this._painter.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteRenderbuffer(this.depthBuffer);for(const e of this.textures)t.deleteTexture(e);this.antiAliasFrameBuffer&&t.deleteFramebuffer(this.antiAliasFrameBuffer),this.antiAliasRenderBuffer&&t.deleteRenderbuffer(this.antiAliasRenderBuffer),this.textures=[],this.frameBuffer=null,this.depthBuffer=null,this._data={},this.bufferStructure=[],this.width=0,this.height=0}}let j=1;class P{constructor(t,e="Frame"+j++){this._painter=t,this.id=e,this.width=0,this.height=0,this.layers=[],this._data={},this._targets=[],this._textures=[]}image(t=0){return this._targets.length&&this._targets[this._targets.length-1].textures[t]||this._textures[t]}update(t={}){var e,n,r,i;const a=this._painter.gl,o=Array.isArray(t.layers)?t.layers:t.layers?[t.layers]:this.layers,s=t.selfReferencing||this._data.selfReferencing,u=o.reduce((t,e)=>t+(e._uniforms.length||1),0),c=s||u>1?2:u,f=t.width||(null===(e=t.texture)||void 0===e?void 0:e.width)||this._data.width||(null===(n=this._data.texture)||void 0===n?void 0:n.width)||a.drawingBufferWidth,d=t.height||(null===(r=t.texture)||void 0===r?void 0:r.height)||this._data.height||(null===(i=this._data.texture)||void 0===i?void 0:i.height)||a.drawingBufferHeight,l=t.antialias||this._data.antialias||!0;c!==this._targets.length&&this._destroyTargets();const h=Object.assign(Object.assign({},t),{width:f,height:d,antialias:l});return!this._targets.length&&c>0?this._targets=Object(N.h)(t=>new L(this._painter,this.id+"_target"+(t+1)).update(h),c):this._targets.length&&this._targets.forEach(t=>{t.update(h)}),t.texture&&(this._textures[0]||(this._textures[0]=new U(this._painter,this.id+"_Texture0")),t.texture.width=f,t.texture.height=d,this._textures[0].update(t.texture)),Object.assign(this._data,t),this.layers=o,this.width=f,this.height=d,this}destroy(){this._destroyTargets(),this._textures.forEach(t=>t.destroy()),this._textures=[],this._data={},this.layers=[],this.width=0,this.height=0}_destroyTargets(){this._targets.forEach(t=>t.destroy()),this._targets=[]}_swapTargets(){if(this._targets.length>1){const t=this._targets[0];this._targets[0]=this._targets[1],this._targets[1]=t}}}let x=1;class B{constructor(t="DrawingLayer"+x++){this.id=t,this.sketches=[],this._data={},this._uniforms=[]}update(t){if(t.sketches&&(this.sketches=Array.isArray(t.sketches)?t.sketches:[t.sketches]),t.frag){const e=this.sketches&&this.sketches[0];e&&e.shade.update({frag:t.frag})}return t.uniforms&&(this._uniforms=Array.isArray(t.uniforms)?t.uniforms:[t.uniforms]),Object.assign(this._data,t),this}destroy(){for(const t of this.sketches)t.destroy();this._data.sketches=[],this._data={},this._uniforms=[]}}let C=1;class z{constructor(t,e="Shade"+C++){this._painter=t,this.id=e}update(t){const e=this._painter.gl,n=t.frag&&t.frag.trim()||this.fragSource,r=t.vert&&t.vert.trim()||this.vertSource;if(!n||!r||n===this.fragSource&&r===this.vertSource)return this;this.destroy(),n.indexOf("GL_EXT_draw_buffers")>=0&&e.getExtension("WEBGL_draw_buffers");const i=e.createProgram(),a=e.createShader(e.FRAGMENT_SHADER),o=e.createShader(e.VERTEX_SHADER);if(i&&o&&a){if(this._program=i,this._frag=a,this._vert=o,e.attachShader(i,o),e.attachShader(i,a),e.shaderSource(o,r),e.shaderSource(a,n),e.compileShader(o),e.compileShader(a),e.getShaderParameter(o,e.COMPILE_STATUS)||console.error("Error Compiling Vertex Shader!\n",e.getShaderInfoLog(o),G(r)),e.getShaderParameter(a,e.COMPILE_STATUS)||console.error("Error Compiling Fragment Shader!\n",e.getShaderInfoLog(a),G(n)),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);console.error("Error in program linking:",t)}return this._uniformSetters=function(t,e){let n=0;function r(e,r){const i=t.getUniformLocation(e,r.name),a=r.size>1&&"[0]"===r.name.substr(-3),o=r.type,s=M[o];if(!s)throw new Error("unknown type: 0x"+o.toString(16));if(null==i)return;let u;if(null===s.Type){const e=n;n+=r.size,u=a?s.arraySetter(t,o,e,i,r.size):s.setter(t,o,e,i)}else u=s.arraySetter&&a?s.arraySetter(t,i):s.setter(t,i);return{setter:u,location:i}}const i={},a=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<a;++n){const a=t.getActiveUniform(e,n);if(!a)continue;let o=a.name;if("[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3)),e){const t=r(e,a);t&&(i[o]=t)}}return i}(e,i),this._attributeSetters=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i);if(!r)break;const a=t.getAttribLocation(e,r.name),o=A[r.type],s=o.setter(t,a,o);n[r.name]={setter:s,location:a}}return n}(e,i),this.fragSource=n,this.vertSource=r,this}}destroy(){const t=this._painter.gl;t.deleteProgram(this._program),t.deleteShader(this._frag),t.deleteShader(this._vert),this.vertSource=void 0,this.fragSource=void 0,this._attributeSetters={},this._uniformSetters={}}}function G(t){return t.trim().split("\n").map((t,e)=>e+1+": "+t).join("\n")}let k=1;class X{constructor(t="Sketch"+k++){this.id=t,this._uniforms=[]}update(t){return t.drawSettings&&(this._drawSettings=t.drawSettings),t.form&&(this.form=t.form),t.shade&&(this.shade=t.shade),t.uniforms&&(this._uniforms=Array.isArray(t.uniforms)?t.uniforms:[t.uniforms]),this}destroy(){this.form&&this.form.destroy(),this.shade&&this.shade.destroy(),this._drawSettings=void 0,this._uniforms=[]}}var Y=n(13);class ${constructor(t,e={}){this.canvas=t,this.isWebGL2=!0,this.maxBufferSamples=0;let n=null;if(e.useWebGL1||(n=t.getContext("webgl2",e)||t.getContext("experimental-webgl2",e)),null==n&&(this.isWebGL2=!1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)),null==n)throw Error("Cannot initialize WebGL.");this.gl=n,this.sizeMultiplier=e.sizeMultiplier||1,this.isWebGL2&&(this.maxBufferSamples=n.getParameter(n.MAX_SAMPLES)),this.resize(),S(n,function(t){return{clearColor:[0,0,0,1],blendFunc:[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA]}}(n)),this._renderQuad=this.createForm().update(f.renderQuad),this._staticSketch=this.createFlatSketch()}resize(){return Object(Y.b)(this.gl.canvas,this.sizeMultiplier),this}destroy(){this._staticSketch.destroy(),this._renderQuad.destroy()}updateDrawSettings(t){return S(this.gl,Object.assign({},t)),this}createForm(t){return new F(this,t)}createShade(t){return new z(this,t)}createSketch(t){return new X(t)}createFlatSketch(t){const e=this.createSketch(t);return e.update({form:this._renderQuad,shade:this.createShade(e.id+"_defaultShade").update(d.basicEffect)})}createFrame(t){return new P(this,t)}createLayer(t){return new B(t)}createEffect(t){const e=this.createLayer(t);return e.update({sketches:this.createFlatSketch(e.id+"_effectSketch")})}draw(t,e){const n=this.gl;return n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),V(n,t,e),this}compose(...t){for(const e of t)K(this.gl,e);return this}display(t,e=0){return this.draw(this._staticSketch,{source:t.image(e)})}}function V(t,e,n,r){const{shade:i,form:a,_drawSettings:o,_uniforms:s}=e;if(!i||!a)throw Error("cannot draw, shader or geometry are not set");t.useProgram(i._program),function(t,e){for(const n in e._attribs){const r=t._attributeSetters[n];r&&r.setter(e._attribs[n])}}(i,a),n&&H(i,n,r),o&&S(t,o);for(let n=0;n<(s.length||1);n++)q(t,e,s[n],r);o&&O(t,o)}function q(t,e,n,r){n&&H(e.shade,n,r),e.form._elements&&null!=e.form._elements.glType?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.form._elements.buffer),t.drawElements(e.form._drawType,e.form._itemCount,e.form._elements.glType,0)):t.drawArrays(e.form._drawType,0,e.form._itemCount)}function H(t,e,n){for(const r in e){const i=t._uniformSetters[r];if(i){let t=e[r];"function"==typeof t&&(t=t()),"string"==typeof t&&n?i.setter(n[t]):i.setter(t)}}}function W(t,e,n,r,i){r?(t.bindFramebuffer(t.FRAMEBUFFER,r.antialias?r.antiAliasFrameBuffer:r.frameBuffer),t.viewport(0,0,r.width,r.height)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),e._data.drawSettings&&S(t,e._data.drawSettings);for(const r of e.sketches)V(t,r,n,i);if(r&&r.antialias){const e=t;t.bindFramebuffer(e.READ_FRAMEBUFFER,r.antiAliasFrameBuffer),t.bindFramebuffer(e.DRAW_FRAMEBUFFER,r.frameBuffer),e.clearBufferfv(e.COLOR,0,[1,1,1,1]),e.blitFramebuffer(0,0,r.width,r.height,0,0,r.width,r.height,t.COLOR_BUFFER_BIT,t.LINEAR)}e._data.drawSettings&&O(t,e._data.drawSettings)}function K(t,e){for(let n=0;n<e.layers.length;n++){const r=e.layers[n],i=r._uniforms.length||1;for(let a=0;a<i;a++){const i=e._targets[0],o=n+a===0&&e._textures.length?e._textures:e._targets[1]&&e._targets[1].textures;W(t,r,r._uniforms[a],i,o),e._swapTargets()}}}var Q=n(9);let Z,J;function tt(t,e){return function(t,e){t!==Z&&(Z=t,J=new $(t,e),ht.device.canvas=t,yt&&yt(),vt&&vt(),Tt&&Tt(),yt=i(()=>Object(r.a)(()=>{J.sizeMultiplier=ht.device.sizeMultiplier,J.resize(),Et(Mt.RESIZE)},"resize")),vt=Object(Q.b)({element:t,enableRightButton:!0,holdRadius:7,holdDelay:250},t=>ht.device.pointer=t),Tt=Object(a.b)(t=>ht.device.keys=t))}(t,e),J}const et={};function nt(t,e){return et[e]||(et[e]=t.createForm("Form_"+e))}const rt={};function it(t,e){return rt[e]||(rt[e]=t.createShade("Shade_"+e))}const at={};function ot(t,e){return at[e]||(at[e]=t.createSketch("Sketch_"+e))}const st={};function ut(t,e){return st[e]||(st[e]=t.createLayer("Layer_"+e))}const ct={};function ft(t,e){return ct[e]||(ct[e]=t.createFrame("Frame_"+e))}const dt={};function lt(t,e){return dt[e]||(dt[e]=t.createEffect("Effect_"+e))}const ht={device:{tpf:0,sizeMultiplier:1}};function pt(t){return ht[t]}function bt(t,e,n){const r=ht;if(r[t]){const i=n&&n.reset;!0!==i&&(e=function t(e,n,r){const i=r&&r.ignore;if("object"==typeof e&&"object"==typeof n&&!Array.isArray(e)&&!Array.isArray(n)&&e!==n){for(const r in e)if(e.hasOwnProperty(r)&&(!i||!(r in i)||!0!==i[r])){const a=e[r],o=n[r];void 0!==o&&(e[r]=t(a,o,{ignore:i&&i[r]}))}return e}return n}(e,r[t],{ignore:i}))}r[t]=e}function _t(){return ht}window.state=ht;const mt={};function gt(t,e){mt[t]=e}function Et(t){for(const e in mt)mt[e](t,ht)}const Mt={FRAME:"frame",RESIZE:"resize"};let yt,vt,Tt},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i}));var r={};n.r(r),n.d(r,"create",(function(){return c})),n.d(r,"clone",(function(){return f})),n.d(r,"copy",(function(){return d})),n.d(r,"fromValues",(function(){return l})),n.d(r,"set",(function(){return h})),n.d(r,"identity",(function(){return p})),n.d(r,"transpose",(function(){return b})),n.d(r,"invert",(function(){return _})),n.d(r,"adjoint",(function(){return m})),n.d(r,"determinant",(function(){return g})),n.d(r,"multiply",(function(){return E})),n.d(r,"translate",(function(){return M})),n.d(r,"scale",(function(){return y})),n.d(r,"rotate",(function(){return v})),n.d(r,"rotateX",(function(){return T})),n.d(r,"rotateY",(function(){return A})),n.d(r,"rotateZ",(function(){return S})),n.d(r,"fromTranslation",(function(){return O})),n.d(r,"fromScaling",(function(){return R})),n.d(r,"fromRotation",(function(){return F})),n.d(r,"fromXRotation",(function(){return N})),n.d(r,"fromYRotation",(function(){return w})),n.d(r,"fromZRotation",(function(){return I})),n.d(r,"fromRotationTranslation",(function(){return U})),n.d(r,"fromQuat2",(function(){return D})),n.d(r,"getTranslation",(function(){return L})),n.d(r,"getScaling",(function(){return j})),n.d(r,"getRotation",(function(){return P})),n.d(r,"fromRotationTranslationScale",(function(){return x})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return B})),n.d(r,"fromQuat",(function(){return C})),n.d(r,"frustum",(function(){return z})),n.d(r,"perspective",(function(){return G})),n.d(r,"perspectiveFromFieldOfView",(function(){return k})),n.d(r,"ortho",(function(){return X})),n.d(r,"lookAt",(function(){return Y})),n.d(r,"targetTo",(function(){return $})),n.d(r,"str",(function(){return V})),n.d(r,"frob",(function(){return q})),n.d(r,"add",(function(){return H})),n.d(r,"subtract",(function(){return W})),n.d(r,"multiplyScalar",(function(){return K})),n.d(r,"multiplyScalarAndAdd",(function(){return Q})),n.d(r,"exactEquals",(function(){return Z})),n.d(r,"equals",(function(){return J})),n.d(r,"mul",(function(){return tt})),n.d(r,"sub",(function(){return et}));var i={};n.r(i),n.d(i,"create",(function(){return nt})),n.d(i,"clone",(function(){return rt})),n.d(i,"length",(function(){return it})),n.d(i,"fromValues",(function(){return at})),n.d(i,"copy",(function(){return ot})),n.d(i,"set",(function(){return st})),n.d(i,"add",(function(){return ut})),n.d(i,"subtract",(function(){return ct})),n.d(i,"multiply",(function(){return ft})),n.d(i,"divide",(function(){return dt})),n.d(i,"ceil",(function(){return lt})),n.d(i,"floor",(function(){return ht})),n.d(i,"min",(function(){return pt})),n.d(i,"max",(function(){return bt})),n.d(i,"round",(function(){return _t})),n.d(i,"scale",(function(){return mt})),n.d(i,"scaleAndAdd",(function(){return gt})),n.d(i,"distance",(function(){return Et})),n.d(i,"squaredDistance",(function(){return Mt})),n.d(i,"squaredLength",(function(){return yt})),n.d(i,"negate",(function(){return vt})),n.d(i,"inverse",(function(){return Tt})),n.d(i,"normalize",(function(){return At})),n.d(i,"dot",(function(){return St})),n.d(i,"cross",(function(){return Ot})),n.d(i,"lerp",(function(){return Rt})),n.d(i,"hermite",(function(){return Ft})),n.d(i,"bezier",(function(){return Nt})),n.d(i,"random",(function(){return wt})),n.d(i,"transformMat4",(function(){return It})),n.d(i,"transformMat3",(function(){return Ut})),n.d(i,"transformQuat",(function(){return Dt})),n.d(i,"rotateX",(function(){return Lt})),n.d(i,"rotateY",(function(){return jt})),n.d(i,"rotateZ",(function(){return Pt})),n.d(i,"angle",(function(){return xt})),n.d(i,"zero",(function(){return Bt})),n.d(i,"str",(function(){return Ct})),n.d(i,"exactEquals",(function(){return zt})),n.d(i,"equals",(function(){return Gt})),n.d(i,"sub",(function(){return Xt})),n.d(i,"mul",(function(){return Yt})),n.d(i,"div",(function(){return $t})),n.d(i,"dist",(function(){return Vt})),n.d(i,"sqrDist",(function(){return qt})),n.d(i,"len",(function(){return Ht})),n.d(i,"sqrLen",(function(){return Wt})),n.d(i,"forEach",(function(){return Kt}));var a={};n.r(a),n.d(a,"create",(function(){return Jt})),n.d(a,"identity",(function(){return te})),n.d(a,"setAxisAngle",(function(){return ee})),n.d(a,"getAxisAngle",(function(){return ne})),n.d(a,"getAngle",(function(){return re})),n.d(a,"multiply",(function(){return ie})),n.d(a,"rotateX",(function(){return ae})),n.d(a,"rotateY",(function(){return oe})),n.d(a,"rotateZ",(function(){return se})),n.d(a,"calculateW",(function(){return ue})),n.d(a,"exp",(function(){return ce})),n.d(a,"ln",(function(){return fe})),n.d(a,"pow",(function(){return de})),n.d(a,"slerp",(function(){return le})),n.d(a,"random",(function(){return he})),n.d(a,"invert",(function(){return pe})),n.d(a,"conjugate",(function(){return be})),n.d(a,"fromMat3",(function(){return _e})),n.d(a,"fromEuler",(function(){return me})),n.d(a,"str",(function(){return ge})),n.d(a,"clone",(function(){return Oe})),n.d(a,"fromValues",(function(){return Re})),n.d(a,"copy",(function(){return Fe})),n.d(a,"set",(function(){return Ne})),n.d(a,"add",(function(){return we})),n.d(a,"mul",(function(){return Ie})),n.d(a,"scale",(function(){return Ue})),n.d(a,"dot",(function(){return De})),n.d(a,"lerp",(function(){return Le})),n.d(a,"length",(function(){return je})),n.d(a,"len",(function(){return Pe})),n.d(a,"squaredLength",(function(){return xe})),n.d(a,"sqrLen",(function(){return Be})),n.d(a,"normalize",(function(){return Ce})),n.d(a,"exactEquals",(function(){return ze})),n.d(a,"equals",(function(){return Ge})),n.d(a,"rotationTo",(function(){return ke})),n.d(a,"sqlerp",(function(){return Xe})),n.d(a,"setAxes",(function(){return Ye}));var o=1e-6,s="undefined"!=typeof Float32Array?Float32Array:Array,u=Math.random;Math.PI;function c(){var t=new s(16);return s!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function f(t){var e=new s(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function d(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,r,i,a,o,u,c,f,d,l,h,p,b,_){var m=new s(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=a,m[6]=o,m[7]=u,m[8]=c,m[9]=f,m[10]=d,m[11]=l,m[12]=h,m[13]=p,m[14]=b,m[15]=_,m}function h(t,e,n,r,i,a,o,s,u,c,f,d,l,h,p,b,_){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=f,t[10]=d,t[11]=l,t[12]=h,t[13]=p,t[14]=b,t[15]=_,t}function p(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function b(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function _(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],f=e[8],d=e[9],l=e[10],h=e[11],p=e[12],b=e[13],_=e[14],m=e[15],g=n*s-r*o,E=n*u-i*o,M=n*c-a*o,y=r*u-i*s,v=r*c-a*s,T=i*c-a*u,A=f*b-d*p,S=f*_-l*p,O=f*m-h*p,R=d*_-l*b,F=d*m-h*b,N=l*m-h*_,w=g*N-E*F+M*R+y*O-v*S+T*A;return w?(w=1/w,t[0]=(s*N-u*F+c*R)*w,t[1]=(i*F-r*N-a*R)*w,t[2]=(b*T-_*v+m*y)*w,t[3]=(l*v-d*T-h*y)*w,t[4]=(u*O-o*N-c*S)*w,t[5]=(n*N-i*O+a*S)*w,t[6]=(_*M-p*T-m*E)*w,t[7]=(f*T-l*M+h*E)*w,t[8]=(o*F-s*O+c*A)*w,t[9]=(r*O-n*F-a*A)*w,t[10]=(p*v-b*M+m*g)*w,t[11]=(d*M-f*v-h*g)*w,t[12]=(s*S-o*R-u*A)*w,t[13]=(n*R-r*S+i*A)*w,t[14]=(b*E-p*y-_*g)*w,t[15]=(f*y-d*E+l*g)*w,t):null}function m(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],f=e[8],d=e[9],l=e[10],h=e[11],p=e[12],b=e[13],_=e[14],m=e[15];return t[0]=s*(l*m-h*_)-d*(u*m-c*_)+b*(u*h-c*l),t[1]=-(r*(l*m-h*_)-d*(i*m-a*_)+b*(i*h-a*l)),t[2]=r*(u*m-c*_)-s*(i*m-a*_)+b*(i*c-a*u),t[3]=-(r*(u*h-c*l)-s*(i*h-a*l)+d*(i*c-a*u)),t[4]=-(o*(l*m-h*_)-f*(u*m-c*_)+p*(u*h-c*l)),t[5]=n*(l*m-h*_)-f*(i*m-a*_)+p*(i*h-a*l),t[6]=-(n*(u*m-c*_)-o*(i*m-a*_)+p*(i*c-a*u)),t[7]=n*(u*h-c*l)-o*(i*h-a*l)+f*(i*c-a*u),t[8]=o*(d*m-h*b)-f*(s*m-c*b)+p*(s*h-c*d),t[9]=-(n*(d*m-h*b)-f*(r*m-a*b)+p*(r*h-a*d)),t[10]=n*(s*m-c*b)-o*(r*m-a*b)+p*(r*c-a*s),t[11]=-(n*(s*h-c*d)-o*(r*h-a*d)+f*(r*c-a*s)),t[12]=-(o*(d*_-l*b)-f*(s*_-u*b)+p*(s*l-u*d)),t[13]=n*(d*_-l*b)-f*(r*_-i*b)+p*(r*l-i*d),t[14]=-(n*(s*_-u*b)-o*(r*_-i*b)+p*(r*u-i*s)),t[15]=n*(s*l-u*d)-o*(r*l-i*d)+f*(r*u-i*s),t}function g(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],f=t[9],d=t[10],l=t[11],h=t[12],p=t[13],b=t[14],_=t[15];return(e*o-n*a)*(d*_-l*b)-(e*s-r*a)*(f*_-l*p)+(e*u-i*a)*(f*b-d*p)+(n*s-r*o)*(c*_-l*h)-(n*u-i*o)*(c*b-d*h)+(r*u-i*s)*(c*p-f*h)}function E(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],f=e[7],d=e[8],l=e[9],h=e[10],p=e[11],b=e[12],_=e[13],m=e[14],g=e[15],E=n[0],M=n[1],y=n[2],v=n[3];return t[0]=E*r+M*s+y*d+v*b,t[1]=E*i+M*u+y*l+v*_,t[2]=E*a+M*c+y*h+v*m,t[3]=E*o+M*f+y*p+v*g,E=n[4],M=n[5],y=n[6],v=n[7],t[4]=E*r+M*s+y*d+v*b,t[5]=E*i+M*u+y*l+v*_,t[6]=E*a+M*c+y*h+v*m,t[7]=E*o+M*f+y*p+v*g,E=n[8],M=n[9],y=n[10],v=n[11],t[8]=E*r+M*s+y*d+v*b,t[9]=E*i+M*u+y*l+v*_,t[10]=E*a+M*c+y*h+v*m,t[11]=E*o+M*f+y*p+v*g,E=n[12],M=n[13],y=n[14],v=n[15],t[12]=E*r+M*s+y*d+v*b,t[13]=E*i+M*u+y*l+v*_,t[14]=E*a+M*c+y*h+v*m,t[15]=E*o+M*f+y*p+v*g,t}function M(t,e,n){var r,i,a,o,s,u,c,f,d,l,h,p,b=n[0],_=n[1],m=n[2];return e===t?(t[12]=e[0]*b+e[4]*_+e[8]*m+e[12],t[13]=e[1]*b+e[5]*_+e[9]*m+e[13],t[14]=e[2]*b+e[6]*_+e[10]*m+e[14],t[15]=e[3]*b+e[7]*_+e[11]*m+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],f=e[7],d=e[8],l=e[9],h=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=f,t[8]=d,t[9]=l,t[10]=h,t[11]=p,t[12]=r*b+s*_+d*m+e[12],t[13]=i*b+u*_+l*m+e[13],t[14]=a*b+c*_+h*m+e[14],t[15]=o*b+f*_+p*m+e[15]),t}function y(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function v(t,e,n,r){var i,a,s,u,c,f,d,l,h,p,b,_,m,g,E,M,y,v,T,A,S,O,R,F,N=r[0],w=r[1],I=r[2],U=Math.hypot(N,w,I);return U<o?null:(N*=U=1/U,w*=U,I*=U,i=Math.sin(n),s=1-(a=Math.cos(n)),u=e[0],c=e[1],f=e[2],d=e[3],l=e[4],h=e[5],p=e[6],b=e[7],_=e[8],m=e[9],g=e[10],E=e[11],M=N*N*s+a,y=w*N*s+I*i,v=I*N*s-w*i,T=N*w*s-I*i,A=w*w*s+a,S=I*w*s+N*i,O=N*I*s+w*i,R=w*I*s-N*i,F=I*I*s+a,t[0]=u*M+l*y+_*v,t[1]=c*M+h*y+m*v,t[2]=f*M+p*y+g*v,t[3]=d*M+b*y+E*v,t[4]=u*T+l*A+_*S,t[5]=c*T+h*A+m*S,t[6]=f*T+p*A+g*S,t[7]=d*T+b*A+E*S,t[8]=u*O+l*R+_*F,t[9]=c*O+h*R+m*F,t[10]=f*O+p*R+g*F,t[11]=d*O+b*R+E*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function T(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],f=e[9],d=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+f*r,t[6]=s*i+d*r,t[7]=u*i+l*r,t[8]=c*i-a*r,t[9]=f*i-o*r,t[10]=d*i-s*r,t[11]=l*i-u*r,t}function A(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[8],f=e[9],d=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-f*r,t[2]=s*i-d*r,t[3]=u*i-l*r,t[8]=a*r+c*i,t[9]=o*r+f*i,t[10]=s*r+d*i,t[11]=u*r+l*i,t}function S(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[4],f=e[5],d=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+f*r,t[2]=s*i+d*r,t[3]=u*i+l*r,t[4]=c*i-a*r,t[5]=f*i-o*r,t[6]=d*i-s*r,t[7]=l*i-u*r,t}function O(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function R(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function F(t,e,n){var r,i,a,s=n[0],u=n[1],c=n[2],f=Math.hypot(s,u,c);return f<o?null:(s*=f=1/f,u*=f,c*=f,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=s*s*a+i,t[1]=u*s*a+c*r,t[2]=c*s*a-u*r,t[3]=0,t[4]=s*u*a-c*r,t[5]=u*u*a+i,t[6]=c*u*a+s*r,t[7]=0,t[8]=s*c*a+u*r,t[9]=u*c*a-s*r,t[10]=c*c*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function N(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function U(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,u=i+i,c=a+a,f=r*s,d=r*u,l=r*c,h=i*u,p=i*c,b=a*c,_=o*s,m=o*u,g=o*c;return t[0]=1-(h+b),t[1]=d+g,t[2]=l-m,t[3]=0,t[4]=d-g,t[5]=1-(f+b),t[6]=p+_,t[7]=0,t[8]=l+m,t[9]=p-_,t[10]=1-(f+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function D(t,e){var n=new s(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],u=e[4],c=e[5],f=e[6],d=e[7],l=r*r+i*i+a*a+o*o;return l>0?(n[0]=2*(u*o+d*r+c*a-f*i)/l,n[1]=2*(c*o+d*i+f*r-u*a)/l,n[2]=2*(f*o+d*a+u*i-c*r)/l):(n[0]=2*(u*o+d*r+c*a-f*i),n[1]=2*(c*o+d*i+f*r-u*a),n[2]=2*(f*o+d*a+u*i-c*r)),U(t,e,n),t}function L(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function j(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(u,c,f),t}function P(t,e){var n=new s(3);j(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,u=e[1]*i,c=e[2]*a,f=e[4]*r,d=e[5]*i,l=e[6]*a,h=e[8]*r,p=e[9]*i,b=e[10]*a,_=o+d+b,m=0;return _>0?(m=2*Math.sqrt(_+1),t[3]=.25*m,t[0]=(l-p)/m,t[1]=(h-c)/m,t[2]=(u-f)/m):o>d&&o>b?(m=2*Math.sqrt(1+o-d-b),t[3]=(l-p)/m,t[0]=.25*m,t[1]=(u+f)/m,t[2]=(h+c)/m):d>b?(m=2*Math.sqrt(1+d-o-b),t[3]=(h-c)/m,t[0]=(u+f)/m,t[1]=.25*m,t[2]=(l+p)/m):(m=2*Math.sqrt(1+b-o-d),t[3]=(u-f)/m,t[0]=(h+c)/m,t[1]=(l+p)/m,t[2]=.25*m),t}function x(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,c=a+a,f=o+o,d=i*u,l=i*c,h=i*f,p=a*c,b=a*f,_=o*f,m=s*u,g=s*c,E=s*f,M=r[0],y=r[1],v=r[2];return t[0]=(1-(p+_))*M,t[1]=(l+E)*M,t[2]=(h-g)*M,t[3]=0,t[4]=(l-E)*y,t[5]=(1-(d+_))*y,t[6]=(b+m)*y,t[7]=0,t[8]=(h+g)*v,t[9]=(b-m)*v,t[10]=(1-(d+p))*v,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function B(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],u=e[3],c=a+a,f=o+o,d=s+s,l=a*c,h=a*f,p=a*d,b=o*f,_=o*d,m=s*d,g=u*c,E=u*f,M=u*d,y=r[0],v=r[1],T=r[2],A=i[0],S=i[1],O=i[2],R=(1-(b+m))*y,F=(h+M)*y,N=(p-E)*y,w=(h-M)*v,I=(1-(l+m))*v,U=(_+g)*v,D=(p+E)*T,L=(_-g)*T,j=(1-(l+b))*T;return t[0]=R,t[1]=F,t[2]=N,t[3]=0,t[4]=w,t[5]=I,t[6]=U,t[7]=0,t[8]=D,t[9]=L,t[10]=j,t[11]=0,t[12]=n[0]+A-(R*A+w*S+D*O),t[13]=n[1]+S-(F*A+I*S+L*O),t[14]=n[2]+O-(N*A+U*S+j*O),t[15]=1,t}function C(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,u=i+i,c=n*o,f=r*o,d=r*s,l=i*o,h=i*s,p=i*u,b=a*o,_=a*s,m=a*u;return t[0]=1-d-p,t[1]=f+m,t[2]=l-_,t[3]=0,t[4]=f-m,t[5]=1-c-p,t[6]=h+b,t[7]=0,t[8]=l+_,t[9]=h-b,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function z(t,e,n,r,i,a,o){var s=1/(n-e),u=1/(i-r),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function G(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function k(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function X(t,e,n,r,i,a,o){var s=1/(e-n),u=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(o+a)*c,t[15]=1,t}function Y(t,e,n,r){var i,a,s,u,c,f,d,l,h,b,_=e[0],m=e[1],g=e[2],E=r[0],M=r[1],y=r[2],v=n[0],T=n[1],A=n[2];return Math.abs(_-v)<o&&Math.abs(m-T)<o&&Math.abs(g-A)<o?p(t):(d=_-v,l=m-T,h=g-A,i=M*(h*=b=1/Math.hypot(d,l,h))-y*(l*=b),a=y*(d*=b)-E*h,s=E*l-M*d,(b=Math.hypot(i,a,s))?(i*=b=1/b,a*=b,s*=b):(i=0,a=0,s=0),u=l*s-h*a,c=h*i-d*s,f=d*a-l*i,(b=Math.hypot(u,c,f))?(u*=b=1/b,c*=b,f*=b):(u=0,c=0,f=0),t[0]=i,t[1]=u,t[2]=d,t[3]=0,t[4]=a,t[5]=c,t[6]=l,t[7]=0,t[8]=s,t[9]=f,t[10]=h,t[11]=0,t[12]=-(i*_+a*m+s*g),t[13]=-(u*_+c*m+f*g),t[14]=-(d*_+l*m+h*g),t[15]=1,t)}function $(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],u=r[1],c=r[2],f=i-n[0],d=a-n[1],l=o-n[2],h=f*f+d*d+l*l;h>0&&(f*=h=1/Math.sqrt(h),d*=h,l*=h);var p=u*l-c*d,b=c*f-s*l,_=s*d-u*f;return(h=p*p+b*b+_*_)>0&&(p*=h=1/Math.sqrt(h),b*=h,_*=h),t[0]=p,t[1]=b,t[2]=_,t[3]=0,t[4]=d*_-l*b,t[5]=l*p-f*_,t[6]=f*b-d*p,t[7]=0,t[8]=f,t[9]=d,t[10]=l,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function V(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function q(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function H(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function W(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function K(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Q(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Z(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function J(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],d=t[8],l=t[9],h=t[10],p=t[11],b=t[12],_=t[13],m=t[14],g=t[15],E=e[0],M=e[1],y=e[2],v=e[3],T=e[4],A=e[5],S=e[6],O=e[7],R=e[8],F=e[9],N=e[10],w=e[11],I=e[12],U=e[13],D=e[14],L=e[15];return Math.abs(n-E)<=o*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(r-M)<=o*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(i-y)<=o*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-v)<=o*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-T)<=o*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(u-A)<=o*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(c-S)<=o*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(f-O)<=o*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(d-R)<=o*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(l-F)<=o*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(h-N)<=o*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(p-w)<=o*Math.max(1,Math.abs(p),Math.abs(w))&&Math.abs(b-I)<=o*Math.max(1,Math.abs(b),Math.abs(I))&&Math.abs(_-U)<=o*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(m-D)<=o*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-L)<=o*Math.max(1,Math.abs(g),Math.abs(L))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var tt=E,et=W;function nt(){var t=new s(3);return s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function rt(t){var e=new s(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function it(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function at(t,e,n){var r=new s(3);return r[0]=t,r[1]=e,r[2]=n,r}function ot(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function st(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function ct(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ft(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function dt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function lt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function ht(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function pt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function bt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function _t(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function mt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function gt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Et(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Mt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function yt(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function vt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Tt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function At(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function St(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ot(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],u=n[2];return t[0]=i*u-a*s,t[1]=a*o-r*u,t[2]=r*s-i*o,t}function Rt(t,e,n,r){var i=e[0],a=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t}function Ft(t,e,n,r,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),f=o*(3-2*a);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*f,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*f,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*f,t}function Nt(t,e,n,r,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,f=3*a*s,d=3*u*o,l=u*a;return t[0]=e[0]*c+n[0]*f+r[0]*d+i[0]*l,t[1]=e[1]*c+n[1]*f+r[1]*d+i[1]*l,t[2]=e[2]*c+n[2]*f+r[2]*d+i[2]*l,t}function wt(t,e){e=e||1;var n=2*u()*Math.PI,r=2*u()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function It(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function Ut(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function Dt(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=e[0],u=e[1],c=e[2],f=i*c-a*u,d=a*s-r*c,l=r*u-i*s,h=i*l-a*d,p=a*f-r*l,b=r*d-i*f,_=2*o;return f*=_,d*=_,l*=_,h*=2,p*=2,b*=2,t[0]=s+f+h,t[1]=u+d+p,t[2]=c+l+b,t}function Lt(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function jt(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Pt(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function xt(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(a*a+o*o+s*s),c=u&&St(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Bt(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ct(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function zt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Gt(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=o*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=o*Math.max(1,Math.abs(i),Math.abs(u))}var kt,Xt=ct,Yt=ft,$t=dt,Vt=Et,qt=Mt,Ht=it,Wt=yt,Kt=(kt=nt(),function(t,e,n,r,i,a){var o,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,o=n;o<s;o+=e)kt[0]=t[o],kt[1]=t[o+1],kt[2]=t[o+2],i(kt,kt,a),t[o]=kt[0],t[o+1]=kt[1],t[o+2]=kt[2];return t});function Qt(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function Zt(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}!function(){var t,e=(t=new s(4),s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function Jt(){var t=new s(4);return s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function te(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ee(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ne(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>o?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function re(t,e){var n=De(t,e);return Math.acos(2*n*n-1)}function ie(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1],c=n[2],f=n[3];return t[0]=r*f+o*s+i*c-a*u,t[1]=i*f+o*u+a*s-r*c,t[2]=a*f+o*c+r*u-i*s,t[3]=o*f-r*s-i*u-a*c,t}function ae(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=a*u-i*s,t[3]=o*u-r*s,t}function oe(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-a*s,t[1]=i*u+o*s,t[2]=a*u+r*s,t[3]=o*u-i*s,t}function se(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t}function ue(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function ce(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),u=o>0?s*Math.sin(o)/o:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(o),t}function fe(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(n*n+r*r+i*i+a*a),t}function de(t,e,n){return fe(t,e),Ue(t,t,n),ce(t,t),t}function le(t,e,n,r){var i,a,s,u,c,f=e[0],d=e[1],l=e[2],h=e[3],p=n[0],b=n[1],_=n[2],m=n[3];return(a=f*p+d*b+l*_+h*m)<0&&(a=-a,p=-p,b=-b,_=-_,m=-m),1-a>o?(i=Math.acos(a),s=Math.sin(i),u=Math.sin((1-r)*i)/s,c=Math.sin(r*i)/s):(u=1-r,c=r),t[0]=u*f+c*p,t[1]=u*d+c*b,t[2]=u*l+c*_,t[3]=u*h+c*m,t}function he(t){var e=u(),n=u(),r=u(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function pe(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,t}function be(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function _e(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}function me(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),f=Math.cos(r);return t[0]=a*u*f-o*s*c,t[1]=o*s*f+a*u*c,t[2]=o*u*c-a*s*f,t[3]=o*u*f+a*s*c,t}function ge(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Ee,Me,ye,ve,Te,Ae,Se,Oe=function(t){var e=new s(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Re=function(t,e,n,r){var i=new s(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},Fe=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Ne=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},we=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Ie=ie,Ue=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},De=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Le=function(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=s+r*(n[3]-s),t},je=Qt,Pe=je,xe=Zt,Be=xe,Ce=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t},ze=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Ge=function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],s=e[0],u=e[1],c=e[2],f=e[3];return Math.abs(n-s)<=o*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=o*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-c)<=o*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-f)<=o*Math.max(1,Math.abs(a),Math.abs(f))},ke=(Ee=nt(),Me=at(1,0,0),ye=at(0,1,0),function(t,e,n){var r=St(e,n);return r<-.999999?(Ot(Ee,Me,e),Ht(Ee)<1e-6&&Ot(Ee,ye,e),At(Ee,Ee),ee(t,Ee,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ot(Ee,e,n),t[0]=Ee[0],t[1]=Ee[1],t[2]=Ee[2],t[3]=1+r,Ce(t,t))}),Xe=(ve=Jt(),Te=Jt(),function(t,e,n,r,i,a){return le(ve,e,i,a),le(Te,n,r,a),le(t,ve,Te,2*a*(1-a)),t}),Ye=(Ae=new s(9),s!=Float32Array&&(Ae[1]=0,Ae[2]=0,Ae[3]=0,Ae[5]=0,Ae[6]=0,Ae[7]=0),Ae[0]=1,Ae[4]=1,Ae[8]=1,Se=Ae,function(t,e,n,r){return Se[0]=n[0],Se[3]=n[1],Se[6]=n[2],Se[1]=r[0],Se[4]=r[1],Se[7]=r[2],Se[2]=-e[0],Se[5]=-e[1],Se[8]=-e[2],Ce(t,_e(t,Se))})},function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"b",(function(){return l}));var r=n(7);function i(t){return t[Object(r.b)(t.length)]}function a(t,e){for(let n=0;n<e;n++)t(n)}function o(t,e,n=[]){for(let r=0;r<e;r++)n[r]=t(r);return n}function s(t,e,n,r=[]){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++)r[a]=t(e[a],n[a]);return r}function u(t,e=[]){for(const n of t){const t=e.length;for(let r=0;r<n.length;r++)e[r+t]=n[r]}return e}function c(t,e,n=[]){return u(d(t,e,n))}const f=c;function d(t,e,n){if(Array.isArray(e))return e.map(t);if(Symbol.iterator in e){const r=n||[];for(let n=0;n<e.length;n++)r[n]=t(e[n],n);return r}{const r=n||{};for(const n in e)r[n]=t(e[n],n);return r}}function l(t,e){for(const n in e)t(e[n],n)}},function(t,e,n){"use strict";var r;function i(t,e){const n=e||t,{element:r=window}=t,i={};function a(t){i[t.keyCode]=Date.now(),n(i)}function o(t){delete i[t.keyCode],n(i)}return r.addEventListener("keyup",o,!1),r.addEventListener("keydown",a,!1),n(i),function(){r.removeEventListener("keyup",o),r.removeEventListener("keydown",a)}}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),function(t){t[t.CANCEL=3]="CANCEL",t[t.HELP=6]="HELP",t[t.BACK_SPACE=8]="BACK_SPACE",t[t.TAB=9]="TAB",t[t.CLEAR=12]="CLEAR",t[t.RETURN=13]="RETURN",t[t.ENTER=14]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CONTROL=17]="CONTROL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESCAPE=27]="ESCAPE",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PRINTSCREEN=44]="PRINTSCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_1=49]="DIGIT_1",t[t.DIGIT_2=50]="DIGIT_2",t[t.DIGIT_3=51]="DIGIT_3",t[t.DIGIT_4=52]="DIGIT_4",t[t.DIGIT_5=53]="DIGIT_5",t[t.DIGIT_6=54]="DIGIT_6",t[t.DIGIT_7=55]="DIGIT_7",t[t.DIGIT_8=56]="DIGIT_8",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.EQUALS=61]="EQUALS",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUMPAD0=96]="NUMPAD0",t[t.NUMPAD1=97]="NUMPAD1",t[t.NUMPAD2=98]="NUMPAD2",t[t.NUMPAD3=99]="NUMPAD3",t[t.NUMPAD4=100]="NUMPAD4",t[t.NUMPAD5=101]="NUMPAD5",t[t.NUMPAD6=102]="NUMPAD6",t[t.NUMPAD7=103]="NUMPAD7",t[t.NUMPAD8=104]="NUMPAD8",t[t.NUMPAD9=105]="NUMPAD9",t[t.MULTIPLY=106]="MULTIPLY",t[t.ADD=107]="ADD",t[t.SEPARATOR=108]="SEPARATOR",t[t.SUBTRACT=109]="SUBTRACT",t[t.DECIMAL=110]="DECIMAL",t[t.DIVIDE=111]="DIVIDE",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.F13=124]="F13",t[t.F14=125]="F14",t[t.F15=126]="F15",t[t.F16=127]="F16",t[t.F17=128]="F17",t[t.F18=129]="F18",t[t.F19=130]="F19",t[t.F20=131]="F20",t[t.F21=132]="F21",t[t.F22=133]="F22",t[t.F23=134]="F23",t[t.F24=135]="F24",t[t.NUM_LOCK=144]="NUM_LOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.BACK_QUOTE=192]="BACK_QUOTE",t[t.OPEN_BRACKET=219]="OPEN_BRACKET",t[t.BACK_SLASH=220]="BACK_SLASH",t[t.CLOSE_BRACKET=221]="CLOSE_BRACKET",t[t.QUOTE=222]="QUOTE",t[t.META=224]="META"}(r||(r={}))},function(t,e,n){"use strict";function r(t,e,n=[]){for(let r=0;r<t.length;r++)n[r]=t[r]+e[r];return n}function i(t,e,n=[]){for(let r=0;r<t.length;r++)n[r]=t[r]-e[r];return n}function a(t,e,n=[]){for(let r=0;r<e.length;r++)n[r]=e[r]*t;return n}function o(t,e,n=[]){for(let r=0;r<e.length;r++)n[r]=e[r]/t;return n}function s(t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];e+=r*r}return Math.sqrt(e)}function u(t,e=[]){return o(s(t),t,e)}function c(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n}function f(t,e,n=[]){return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=t[2]*e[0]-t[0]*e[2],n[2]=t[0]*e[1]-t[1]*e[0],n}function d(t,e){return t[0]*e[1]-t[1]*e[0]}n.d(e,"a",(function(){return r})),n.d(e,"i",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d}));n(11).a},function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return l}));var r=n(35),i=n(29),a=n(25),o=n(17),s=n(43);const u=t=>{const[e,n,r]=Object(i.a)(t)?[t]:t;return{tag:"arg",type:e,id:n||Object(a.a)(),opts:Object.assign({q:"in"},r)}};function c(t,e,n,a){const c=n.map(u),f=a(...c.map(t=>Object(s.c)(t.type,t.id,t.opts))).filter(t=>null!=t),d=Object(o.f)((n,i)=>("ret"===i.tag&&(Object(r.a)(i.type===t,`wrong return type for function '${e}', expected ${t}, got ${i.type}`),n++),n),o.e,0,f);if("void"!==t&&!d)throw new Error(`function '${e}' must return a value of type ${t}`);const l=Object(o.f)((t,e)=>("call"===e.tag&&e.fn&&t.push(e.fn),t),o.a,[],f),h=(...t)=>function(t,...e){return Object(i.a)(t)?{tag:"call",type:e[0],id:t,args:e.slice(1)}:{tag:"call",type:t.type,id:t.id,args:e,fn:t}}(h,...t);return Object.assign(h,{tag:"fn",type:t,id:e,args:c,deps:l,scope:Object(o.d)(f)})}const f=t=>c("void","main",[],t);function d(t){return{tag:"ret",type:t?t.type:"void",val:t}}const l=(t,e,...n)=>({tag:"call_i",type:e,id:t,args:n})},function(t,e,n){"use strict";function r(t){return Math.floor(Math.random()*t)}function i(t,e){return r(e-t)+t}function a(){return(Math.random()+Math.random()+Math.random())/3}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d}));let r=null;const i={};let a=!1,o=0,s=0;function u(t){const e=s?t-s:s;if(s=t,r){for(const t in r)r[t](e);r=null}let n=0;for(const t in i)n++,i[t](e);n?requestAnimationFrame(u):(a=!1,s=0)}function c(t,e){e=e||t.name||o++,r=r||{},r[e]=t,a||(requestAnimationFrame(u),a=!0)}function f(t,e){return e=e||t.name||o++,i[e]=t,a||(requestAnimationFrame(u),a=!0),e}function d(t){"function"==typeof t&&(t=t.name),delete i[t]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));const r={LEFT:0,MIDDLE:1,RIGHT:2};function i(t,e){const n=e||t,{element:i=document,enableRightButton:a,holdDelay:o=400,holdRadius:s=5}=t,u={pressed:{},drag:{x:0,y:0,dX:0,dY:0,xMax:0,yMax:0},dragging:!1,holding:!1};let c=0,f=0,d=0,l=0,h=null;function p(t){t.isPrimary?(u.pressed[t.button]=t,c=d=t.clientX,f=l=t.clientY,u.dragging=!0,null!=h&&clearTimeout(h),h=setTimeout(()=>{u.drag.xMax<s&&u.drag.yMax<s&&(u.holding=!0,n(u))},o)):u.pressed[r.RIGHT]=t,n(u)}function b(t){u.pressed={},delete u.drag.event,u.drag.x=0,u.drag.y=0,u.drag.dX=0,u.drag.dY=0,u.drag.xMax=0,u.drag.yMax=0,u.dragging=!1,u.holding=!1,null!=h&&clearTimeout(h),h=null,n(u)}function _(t){u.dragging&&t.isPrimary&&(u.drag.event=t,u.drag.x=c-t.clientX,u.drag.y=f-t.clientY,u.drag.dX=d-t.clientX,u.drag.dY=l-t.clientY,u.drag.xMax=Math.max(Math.abs(u.drag.x),u.drag.xMax),u.drag.yMax=Math.max(Math.abs(u.drag.y),u.drag.yMax),d=t.clientX,l=t.clientY,n(u))}function m(t){t.preventDefault()}return i.addEventListener("pointerdown",p),document.addEventListener("pointermove",_),document.addEventListener("pointerup",b),document.addEventListener("pointerleave",b),document.addEventListener("pointercancel",b),a&&i.addEventListener("contextmenu",m),n(u),function(){i.removeEventListener("pointerdown",p),document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",b),document.removeEventListener("pointerleave",b),document.removeEventListener("pointercancel",b),a&&i.removeEventListener("contextmenu",m)}}},function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"k",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return g})),n.d(e,"d",(function(){return E})),n.d(e,"b",(function(){return M})),n.d(e,"e",(function(){return y})),n.d(e,"f",(function(){return T})),n.d(e,"l",(function(){return w})),n.d(e,"m",(function(){return I})),n.d(e,"n",(function(){return U})),n.d(e,"j",(function(){return D}));var r=n(18),i=n(40),a=n(12);const o=(t,e,n)=>({tag:"lit",type:t,info:n,val:e}),s=t=>o("bool",Object(r.a)(t)?!!t:t),u=t=>o("float",Object(i.a)(t)?1&t:t),c=t=>o("int",Object(i.a)(t)?1&t:Object(r.a)(t)?0|t:t),f=t=>o("uint",Object(i.a)(t)?1&t:Object(r.a)(t)?t>>>0:t),d=(t,e)=>n=>Object(r.a)(n)?e(n):void 0===n||Object(a.b)(n)||n.type===t?n:e(n),l=d("float",u),h=d("int",c),p=d("uint",f),b=d("bool",s),_=(o("bool",!0),o("bool",!1)),m=u(0),g=u(1),E=u(2),M=u(.5),y=c(0),v=(c(1),f(0)),T=(f(1),u(Math.PI),u(2*Math.PI),u(Math.PI/2),u(Math.SQRT2)),A=(t,e)=>n=>[void 0===n[0]?e:t(n[0]),...n.slice(1).map(t)],S=A(l,m),O=(A(h,y),A(p,v),A(b,_),(t,e,n)=>o(t,n=e(n),["n","n"][n.length])),R=(t,e,n)=>o(t,n=e(n),["n","n","vn"][n.length]),F=(t,e,n)=>o(t,n=e(n),2===n.length?Object(a.b)(n[1])?"vv":"vn":["n","n",,"vnn"][n.length]),N=(t,e,n)=>o(t,n=S(n),e[n.length]);function w(...t){return O("vec2",S,t)}function I(...t){return R("vec3",S,t)}function U(...t){return F("vec4",S,t)}function D(...t){return N("mat2",["n","n","vv"],t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));function r(t,e){if(t===e)return!0;if(!e||!t)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function i(t,e){if(t===e)return!0;if(!e)return!1;const n=Object.keys(t);if(!r(n,Object.keys(e)))return!1;for(const r of n)if(t[r]!==e[r])return!1;return!0}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o}));const r=/^[iub]?vec[234]$/,i=/^mat[234]$/,a=t=>r.test(t.type),o=t=>i.test(t.type)},function(t,e,n){"use strict";function r(t,...e){return e.reduce((e,n)=>e|t[n.toUpperCase()+"_BUFFER_BIT"],0)}function i(t,e=1){let n=t.width,r=t.height;return"clientWidth"in t&&"clientHeight"in t&&(n=t.clientWidth*e|0,r=t.clientHeight*e|0),(t.width!==n||t.height!==r)&&(t.width=n,t.height=r,!0)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u}));var r=n(2),i=n(4),a=n(9);class o extends class{constructor(t){this.position=[0,0,0],this.rotationX=0,this.rotationY=0,this.rotationXMat=r.a.create(),this.rotationYMat=r.a.create(),this.projectionMat=r.a.create(),this.viewMat=r.a.create(),this.needsUpdateView=!0,Object.assign(this,t),this.updateRotationX(),this.updateRotationY()}updateRotationX(t=0){this.rotationX+=t,r.a.fromXRotation(this.rotationXMat,this.rotationX),this.needsUpdateView=!0}updateRotationY(t=0){this.rotationY+=t,r.a.fromYRotation(this.rotationYMat,this.rotationY),this.needsUpdateView=!0}moveForward(t){const e=r.c.fromValues(this.rotationYMat[8],this.rotationYMat[9],this.rotationYMat[10]);r.c.add(this.position,this.position,r.c.scale(e,e,-t)),this.needsUpdateView=!0}moveLeft(t){const e=r.c.fromValues(this.rotationYMat[0],this.rotationYMat[1],this.rotationYMat[2]);r.c.add(this.position,this.position,r.c.scale(e,e,-t)),this.needsUpdateView=!0}moveUp(t){const e=r.c.fromValues(this.rotationYMat[4],this.rotationYMat[5],this.rotationYMat[6]);r.c.add(this.position,this.position,r.c.scale(e,e,t)),this.needsUpdateView=!0}update(){this.needsUpdateView&&(r.a.fromTranslation(this.viewMat,this.position),r.a.multiply(this.viewMat,this.viewMat,this.rotationYMat),r.a.multiply(this.viewMat,this.viewMat,this.rotationXMat),r.a.invert(this.viewMat,this.viewMat),this.needsUpdateView=!1)}}{constructor(t){super(t),this.fovy=.6*Math.PI,this.aspect=1,this.near=.1,this.far=1e3,this.needsUpdateProjection=!0,Object.assign(this,t),this.update()}update(){super.update(),this.needsUpdateProjection&&(r.a.perspective(this.projectionMat,this.fovy,this.aspect,this.near,this.far),this.needsUpdateProjection=!1)}}function s(t){return class extends t{updatePosFromInput(t,e,n){(e||n)&&(((null==e?void 0:e[i.a.UP])||(null==e?void 0:e[i.a.W])||(null==n?void 0:n.holding)&&!n.pressed[a.a.RIGHT])&&this.moveForward(t),((null==e?void 0:e[i.a.DOWN])||(null==e?void 0:e[i.a.S])||(null==n?void 0:n.pressed[a.a.RIGHT]))&&this.moveForward(-t),((null==e?void 0:e[i.a.LEFT])||(null==e?void 0:e[i.a.A]))&&this.moveLeft(t),((null==e?void 0:e[i.a.RIGHT])||(null==e?void 0:e[i.a.D]))&&this.moveLeft(-t))}}}function u(t){return class extends t{constructor(){super(...arguments),this._oldMouse={x:0,y:0}}updateRotFromPointer(t,e){if(e.dragging){const n=this._oldMouse.x-e.drag.x,r=this._oldMouse.y-e.drag.y;this._oldMouse.x=e.drag.x,this._oldMouse.y=e.drag.y,r&&this.updateRotationX(r*t),n&&this.updateRotationY(n*t)}else this._oldMouse.x&&(this._oldMouse.x=0),this._oldMouse.y&&(this._oldMouse.y=0)}}}},function(t,e,n){"use strict";n.d(e,"e",(function(){return K})),n.d(e,"a",(function(){return Q})),n.d(e,"f",(function(){return Z})),n.d(e,"b",(function(){return tt})),n.d(e,"d",(function(){return et})),n.d(e,"c",(function(){return nt}));const r=Array.isArray;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function i(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}var a=n(44);Object.getPrototypeOf;const o=Object.getPrototypeOf({}),s="function",u=(t,e)=>{let n;return t===e||(null==t?t==e:typeof t.equiv===s?t.equiv(e):null==e?t==e:typeof e.equiv===s?e.equiv(t):"string"!=typeof t&&"string"!=typeof e&&(n=Object.getPrototypeOf(t),null!=n&&n!==o||(n=Object.getPrototypeOf(e),null!=n&&n!==o)?typeof t!==s&&void 0!==t.length&&typeof e!==s&&void 0!==e.length?c(t,e):t instanceof Set&&e instanceof Set?f(t,e):t instanceof Map&&e instanceof Map?d(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!=t&&e!=e:l(t,e)))},c=(t,e,n=u)=>{let r=t.length;if(r===e.length)for(;--r>=0&&n(t[r],e[r]););return r<0},f=(t,e,n=u)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),d=(t,e,n=u)=>t.size===e.size&&n([...t].sort(),[...e].sort()),l=(t,e,n=u)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!e.hasOwnProperty(r)||!n(t[r],e[r]))return!1;return!0};function h(t,e){for(let n of e)t.delete(n);return t}var p=n(58);const b=(t,e)=>[t[0],t[1],e],_=(t,e)=>null!=t&&"function"==typeof t[e],m=t=>_(t,"xform")?t.xform():t;class g{constructor(t){this.value=t}deref(){return this.value}}const E=t=>t instanceof g,M=t=>t instanceof g?t.deref():t;var y=n(24);const v=Object(y.a)(()=>"illegal arity"),T=t=>2===t.length?[void 0,t[1]]:3===t.length?[t[1],t[2]]:(t=>{throw new v(t)})(t.length);function A(...t){const e=t[0],n=e[0],r=e[1],i=e[2],a=null==(t=T(t))[0]?n():t[0],o=t[1];return M(r(_(o,"$reduce")?o.$reduce(i,a):null!=(s=o)&&"function"!=typeof s&&void 0!==s.length?S(i,a,o):O(i,a,o)));var s}const S=(t,e,n)=>{for(let r=0,i=n.length;r<i;r++)if(e=t(e,n[r]),E(e)){e=e.deref();break}return e},O=(t,e,n)=>{for(let r of n)if(e=t(e,r),E(e)){e=e.deref();break}return e},R=(t,e)=>[t,t=>t,e];function*F(t,e){const n=m(t)([a.a,a.a,(t,e)=>e])[2];for(let t of e){let e=n(a.b,t);if(E(e))return e=M(e.deref()),void(e!==a.b&&(yield e));e!==a.b&&(yield e)}}function N(t,e){return e?F(N(t),e):e=>{const n=e[2];return b(e,(e,r)=>n(e,t(r)))}}const w=Object(p.a)()?n(49).inspect:null,I=(t,e)=>[...N(t=>w(t,e),t)].join(", "),U=(t,e)=>[...N(([t,n])=>`${w(t,e)} => ${w(n,e)}`,t)].join(", "),D=((t,e={})=>{const n=Reflect.ownKeys(t),r=Reflect.ownKeys(e),i=Symbol("isa");function a(e){for(let r of n){const n=Object.getOwnPropertyDescriptor(e.prototype,r);!n||n.configurable?Object.defineProperty(e.prototype,r,{value:t[r],writable:!0}):console.log(`not patching: ${e.name}.${r.toString()}`)}return Object.defineProperty(e.prototype,i,{value:!0}),e}for(let t of r)Object.defineProperty(a,t,{value:e[t],enumerable:e.propertyIsEnumerable(t)});return Object.defineProperty(a,Symbol.hasInstance,{value:t=>!!t[i]}),a})({[Symbol.for("nodejs.util.inspect.custom")](t,e){const n=this[Symbol.toStringTag],r=Object.assign(Object.assign({},e),{depth:null===e.depth?null:e.depth-1});return t>=0?[`${n}(${this.size||0}) {`,w?this instanceof Set?I(this,r):this instanceof Map?U(this,r):"":"","}"].join(" "):e.stylize(`[${n}]`,"special")}}),L=t=>t instanceof Map;function j(t,e){if(L(t))for(let n of e)t.set(n[0],n[1]);else for(let n of e)t.add(n);return t}var P;const x=new WeakMap,B=t=>x.get(t).vals;let C=P=class extends Set{constructor(t,e={}){super(),x.set(this,{equiv:e.equiv||u,vals:[]}),t&&this.into(t)}*[Symbol.iterator](){yield*B(this)}get[Symbol.species](){return P}get[Symbol.toStringTag](){return"ArraySet"}get size(){return B(this).length}copy(){const t=x.get(this),e=new P(null,{equiv:t.equiv});return x.get(e).vals=t.vals.slice(),e}empty(){return new P(null,this.opts())}clear(){B(this).length=0}first(){if(this.size)return B(this)[0]}add(t){return!this.has(t)&&B(this).push(t),this}into(t){return j(this,t)}has(t){return this.get(t,a.b)!==a.b}get(t,e){const n=x.get(this),r=n.equiv,i=n.vals;for(let e=i.length;--e>=0;)if(r(i[e],t))return i[e];return e}delete(t){const e=x.get(this),n=e.equiv,r=e.vals;for(let e=r.length;--e>=0;)if(n(r[e],t))return r.splice(e,1),!0;return!1}disj(t){return h(this,t)}equiv(t){return((t,e)=>{if(t===e)return!0;if(!(e instanceof Set)||t.size!==e.size)return!1;for(let n of t.keys())if(!e.has(n))return!1;return!0})(this,t)}forEach(t,e){const n=B(this);for(let r=n.length;--r>=0;){const i=n[r];t.call(e,i,i,this)}}*entries(){for(let t of B(this))yield[t,t]}*keys(){yield*B(this)}*values(){yield*B(this)}opts(){return{equiv:x.get(this).equiv}}};C=P=i([D],C);var z;const G=new WeakMap,k=t=>G.get(t).map;let X=z=class extends Map{constructor(t,e){super();const n=Object.assign({equiv:u,keys:C},e);G.set(this,{keys:new n.keys(null,{equiv:n.equiv}),map:new Map,opts:n}),t&&this.into(t)}[Symbol.iterator](){return this.entries()}get[Symbol.species](){return z}get[Symbol.toStringTag](){return"EquivMap"}get size(){return G.get(this).keys.size}clear(){const t=G.get(this);t.keys.clear(),t.map.clear()}empty(){return new z(null,G.get(this).opts)}copy(){const t=G.get(this),e=new z;return G.set(e,{keys:t.keys.copy(),map:new Map(t.map),opts:t.opts}),e}equiv(t){return((t,e)=>{if(t===e)return!0;if(!(e instanceof Map)||t.size!==e.size)return!1;for(let n of t.entries())if(!u(e.get(n[0]),n[1]))return!1;return!0})(this,t)}delete(t){const e=G.get(this);return(t=e.keys.get(t,a.b))!==a.b&&(e.map.delete(t),e.keys.delete(t),!0)}dissoc(t){return h(this,t)}forEach(t,e){for(let n of k(this))t.call(e,n[1],n[0],this)}get(t,e){const n=G.get(this);return(t=n.keys.get(t,a.b))!==a.b?n.map.get(t):e}has(t){return G.get(this).keys.has(t)}set(t,e){const n=G.get(this),r=n.keys.get(t,a.b);return r!==a.b?n.map.set(r,e):(n.keys.add(t),n.map.set(t,e)),this}into(t){return j(this,t)}entries(){return k(this).entries()}keys(){return k(this).keys()}values(){return k(this).values()}opts(){return G.get(this).opts}};X=z=i([D],X);const Y=(t,e,n)=>{if(t.size<e.size){const n=t;t=e,e=n}var r,i;return n=n?j(n,t):(r=t,i=Set,_(r,"copy")?r.copy():new(r[Symbol.species]||i)(r)),t===e?n:j(n,e)};var $=n(48);function V(t,e){return e?F(V(t),e):e=>{const n=e[2];return b(e,(e,r)=>t(r)?n(e,r):e)}}class q{constructor(t){if(this.dependencies=new X,this.dependents=new X,t)for(let[e,n]of t)this.addDependency(e,n)}*[Symbol.iterator](){yield*this.sort()}get[Symbol.species](){return q}copy(){const t=new q;for(let e of this.dependencies)t.dependencies.set(e[0],e[1].copy());for(let e of this.dependents)t.dependents.set(e[0],e[1].copy());return t}addNode(t){return!this.dependencies.has(t)&&this.dependencies.set(t,new C),this}addDependency(t,e){(u(t,e)||this.depends(e,t))&&Object($.a)(`Circular dependency between: ${t} & ${e}`);let n=this.dependencies.get(t);return this.dependencies.set(t,n?n.add(e):new C([e])),n=this.dependents.get(e),this.dependents.set(e,n?n.add(t):new C([t])),this}addDependencies(t,e){for(let n of e)this.addDependency(t,n)}removeEdge(t,e){let n=this.dependencies.get(t);return n&&n.delete(e),n=this.dependents.get(e),n&&n.delete(t),this}removeNode(t){return this.dependencies.delete(t),this}depends(t,e){return this.transitiveDependencies(t).has(e)}dependent(t,e){return this.transitiveDependents(t).has(e)}immediateDependencies(t){return this.dependencies.get(t)||new C}immediateDependents(t){return this.dependents.get(t)||new C}isLeaf(t){return 0===this.immediateDependents(t).size}isRoot(t){return 0===this.immediateDependencies(t).size}nodes(){return Y(new C(this.dependencies.keys()),new C(this.dependents.keys()))}leaves(){return V(t=>this.isLeaf(t),this.nodes())}roots(){return V(t=>this.isRoot(t),this.nodes())}transitiveDependencies(t){return H(this.dependencies,t)}transitiveDependents(t){return H(this.dependents,t)}sort(){const t=[],e=this.copy();let n=new C(e.leaves());for(;;){if(!n.size)return t.reverse();const r=n.first();n.delete(r);for(let t of[...e.immediateDependencies(r)])e.removeEdge(r,t),e.isLeaf(t)&&n.add(t);t.push(r),e.removeNode(r)}}}const H=(t,e)=>{const n=t.get(e);return n?A(R(null,(e,n)=>Y(e,H(t,n))),n,n):new C};var W=n(12);const K=t=>"fn"===t.tag||"for"===t.tag||"while"==t.tag?t.scope.body:"if"===t.tag?t.f?t.t.body.concat(t.f.body):t.t.body:void 0,Q=t=>K(t)||("scope"===t.tag?t.body:"ternary"===t.tag?[t.t,t.f]:"ret"===t.tag?[t.val]:"call"===t.tag||"call_i"===t.tag?t.args:"sym"===t.tag&&t.init?[t.init]:"decl"===t.tag?[t.id]:"op1"===t.tag||"swizzle"===t.tag?[t.val]:"op2"===t.tag?[t.l,t.r]:"assign"===t.tag?[t.r]:Object(W.b)(t)||Object(W.a)(t)?t.val:void 0),Z=(t,e,n,i,a=!0)=>{if(r(i))i.forEach(r=>n=Z(t,e,n,r,a));else{a&&(n=t(n,i));const r=e(i);r&&(n=Z(t,e,n,r,a)),!a&&(n=t(n,i))}return n},J=(t,e=new q)=>t.deps&&t.deps.length?t.deps.reduce((e,n)=>J(n,e.addDependency(t,n)),e):e.addNode(t),tt=t=>({tag:"decl",type:t.type,id:t}),et=(t,e=!1)=>({tag:"scope",type:"void",body:t.filter(t=>null!=t).map(t=>"sym"===t.tag?tt(t):t),global:e}),nt=t=>{const e=t.filter(t=>"fn"!==t.tag),n=t.reduce((t,e)=>"fn"===e.tag?J(e,t):t,new q);return et(e.concat(n.sort()),!0)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>"number"==typeof t},,function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s}));var r=n(10);const i=t=>t.replace("[]",""),a=(t,e)=>{const n=t.type[0];return"i"===n?Object(r.i)(e):"u"===n?Object(r.k)(e):"b"===n?Object(r.g)(e):Object(r.h)(e)},o=(t,e)=>{const n={vec2:r.l,vec3:r.m,vec4:r.n}[t.type];return n?n(e):e},s=t=>({float:"bool",int:"bool",uint:"bool",vec2:"bvec2",ivec2:"bvec2",uvec2:"bvec2",vec3:"bvec3",ivec3:"bvec3",uvec3:"bvec3",vec4:"bvec4",ivec4:"bvec4",uvec4:"bvec4"}[t.type])},function(t,e,n){"use strict";function r(t){return t>0?1:t<0?-1:0}function i(t,e,n){return e+t*(n-e)}function a(t,e,n){return Math.max(t,Math.min(n,e))}n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));Math.PI},,function(t,e,n){"use strict";function r(t,...e){return t.bind(null,...e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=(t,e=(t=>void 0!==t?": "+t:""))=>class extends Error{constructor(n){super(t(n)+e(n))}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));let r=0;const i=()=>`_s${(r++).toString(36)}`},,function(t,e,n){"use strict";n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"g",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"f",(function(){return b})),n.d(e,"h",(function(){return m})),n.d(e,"e",(function(){return g})),n.d(e,"c",(function(){return E}));var r=n(18),i=n(12),a=n(20),o=n(10);const s=(t,e,n=!1)=>({tag:"op1",type:e.type,op:t,val:e,post:n}),u={mave:"mv",vema:"vm",vefl:"vn",mafl:"vn",flve:"nv",flma:"nv",ivin:"vn",iniv:"nv",uvui:"vn",uiuv:"nv"},c=(t,e,n,s,c)=>{const f=Object(r.a)(e),d=Object(r.a)(n);let l,h,p;return f?d?(h=Object(o.h)(e),p=Object(o.h)(n),l="float"):(p=n,h=Object(a.d)(p,e),l=p.type):d?(h=e,p=Object(a.d)(h,n),l=h.type):(h=e,p=n,l=s||(Object(i.b)(h)?h.type:Object(i.b)(p)||Object(i.a)(p)?p.type:h.type)),{tag:"op2",type:s||l,info:c||u[h.type.substr(0,2)+p.type.substr(0,2)],op:t,l:h,r:p}},f=t=>s("++",t,!0);function d(t,e){return c("+",t,e)}function l(t,e){return c("-",t,e)}function h(t,e){return c("*",t,e,!Object(r.a)(t)&&!Object(r.a)(e)&&Object(i.a)(t)&&Object(i.b)(e)?e.type:void 0)}function p(t,e){return c("/",t,e)}const b=(t,e,n)=>d(h(t,e),n),_=t=>(e,n)=>c(t,e,n,"bool"),m=(_("=="),_("!=")),g=(_("<"),_("<=")),E=_(">");_(">=")},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(16);class a{constructor(){this.moveSpeed=2,this.lookSpeed=2,this.camera=new(Object(i.b)(Object(i.c)(i.a)))({fovy:.3*Math.PI,position:[0,0,5]})}}function o({lookSpeed:t,moveSpeed:e,position:n,rotationY:i,rotationX:o,fovy:s}={}){const u=new a;t&&(u.lookSpeed=t),e&&(u.moveSpeed=e),s&&(u.camera.fovy=s,u.camera.needsUpdateProjection=!0),n&&(u.camera.position=n,u.camera.needsUpdateView=!0),o&&(u.camera.rotationX=o,u.camera.updateRotationX()),i&&(u.camera.rotationY=i,u.camera.updateRotationY()),Object(r.m)("viewPort",u,{reset:{moveSpeed:!0,lookSpeed:!0}})}Object(r.a)("viewPort",(t,e)=>{const n=e.viewPort;switch(t){case r.b.FRAME:const t=e.device,i=t.tpf/1e3;n.camera.updatePosFromInput(n.moveSpeed*i,e.device.keys,e.device.pointer);const a=t.pointer,o={dragging:a.dragging,drag:{x:t.sizeMultiplier*a.drag.x/t.canvas.width,y:t.sizeMultiplier*a.drag.y/t.canvas.height}};return n.camera.updateRotFromPointer(n.lookSpeed,o),void n.camera.update();case r.b.RESIZE:n.camera.aspect=e.device.canvas.width/e.device.canvas.height,n.camera.needsUpdateProjection=!0}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>"string"==typeof t},function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return T}));var r=n(40),i=n(18),a=n(24);const o=Object(a.a)(()=>"unsupported operation"),s=t=>{throw new o(t)};var u,c=n(20);!function(t){t[t.FINE=0]="FINE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.SEVERE=4]="SEVERE",t[t.NONE=5]="NONE"}(u||(u={}));const f=Object.freeze({level:u.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});const d=Symbol();let l=f;const h=(t,e,n)=>{const r=e[n];if(r)for(let n of r){let r=t[n]||h(t,e,n);if(r)return r}},p=(t,e,n)=>{const r=e[n];if(r)for(let n of r)t.push(n),p(t,e,n);return t},b=t=>{const e={};for(let n in t){const r=t[n];e[n]=r instanceof Set?r:new Set(r)}return e},_=t=>{const e=function(t,e){const n={},r=e?b(e):{},i=(...e)=>{const i=t(...e),a=n[i]||h(n,r,i)||n[d];return a?a(...e):s(`missing implementation for: "${i.toString()}"`)};return i.add=(t,e)=>(n[t]&&l.warn(`overwriting '${t.toString()}' impl`),n[t]=e,!0),i.addAll=t=>{let e=!0;for(let n in t)e=i.add(n,t[n])&&e;return e},i.remove=t=>!!n[t]&&(delete n[t],!0),i.callable=(...e)=>{const i=t(...e);return!!(n[i]||h(n,r,i)||n[d])},i.isa=(t,e)=>{let n=r[t];!n&&(r[t]=n=new Set),n.add(e)},i.impls=()=>{const t=new Set(Object.keys(n));for(let e in r)h(n,r,e)&&t.add(e);return n[d]&&t.add(d),t},i.rels=()=>r,i.parents=t=>r[t],i.ancestors=t=>new Set(p([],r,t)),i}(t=>t.tag);return e.add(d,t=>s(`no impl for AST node type: '${t.tag}'`)),e.addAll(t),e};var m,g=n(12),E=n(43);!function(t){t.GLES_100="100",t.GLES_300="300 es"}(m||(m={}));const M=/[};]$/,y=t=>{const e=Object.assign({type:"fs",version:m.GLES_300,versionPragma:!0,prelude:""},t),n="vs"===e.type,a=(t,e=", ")=>t.map(f).join(e),o=t=>`${t.id}(${a(t.args)})`,u=(t,r=!1)=>{const{id:i,type:a,opts:o,init:u}=t,d=[];if(o.type){let t;e.version<m.GLES_300?n?t={in:"attribute",out:"varying",uni:"uniform"}[o.type]:(t={in:"varying",out:null,uni:"uniform"}[o.type],!t&&s("GLSL 100 doesn't support fragment shader output variables")):(null!=o.loc&&d.push(`layout(location=${o.loc}) `),t="uni"===o.type?"uniform":o.type),d.push(t+" ")}else o.const&&d.push("const "),r&&o.q&&d.push(o.q+" ");return o.prec&&d.push(o.prec+" "),d.push(Object(c.a)(a)," ",i),o.num&&d.push(`[${o.num}]`),u&&d.push(" = ",f(u)),d.join("")},f=_({arg:t=>u(t,!0),array_init:t=>e.version>=m.GLES_300?`${t.type}(${a(t.init)})`:s(`array initializers not available in GLSL ${e.version}`),assign:t=>f(t.l)+" = "+f(t.r),ctrl:t=>t.id,call:o,call_i:t=>"texture"===t.id&&e.version<m.GLES_300?`${t.id}${t.args[0].type.substr(7)}(${a(t.args)})`:o(t),decl:t=>u(t.id),fn:t=>`${t.type} ${t.id}(${a(t.args)}) ${f(t.scope)}`,for:t=>`for(${t.init?f(t.init):""}; ${f(t.test)}; ${t.iter?f(t.iter):""}) ${f(t.scope)}`,idx:t=>`${f(t.val)}[${f(t.id)}]`,if:t=>{const e=`if (${f(t.test)}) `+f(t.t);return t.f?e+" else "+f(t.f):e},lit:t=>{const e=t.val;switch(t.type){case"bool":return Object(r.a)(e)?String(e):`bool(${f(e)})`;case"float":return Object(i.a)(e)?e===Math.trunc(e)?e+".0":String(e):`float(${f(e)})`;case"int":case"uint":return Object(i.a)(e)?String(e):`${t.type}(${f(e)})`;default:return Object(g.b)(t)||Object(g.a)(t)?`${t.type}(${a(e)})`:s(`unknown type: ${t.type}`)}},op1:t=>t.post?`(${f(t.val)}${t.op})`:`(${t.op}${f(t.val)})`,op2:t=>`(${f(t.l)} ${t.op} ${f(t.r)})`,ret:t=>"return"+(t.val?" "+f(t.val):""),scope:t=>{let n=t.body.map(f).reduce((t,e)=>(t.push(M.test(e)?e:e+";"),t),[]).join("\n");return n+=t.body.length&&!M.test(n)?";":"",t.global?(e.prelude&&(n=e.prelude+"\n"+n),e.versionPragma&&(n=`#version ${e.version}\n`+n),n):`{\n${n}\n}`},swizzle:t=>`${f(t.val)}.${t.id}`,sym:t=>t.id,ternary:t=>`(${f(t.test)} ? ${f(t.t)} : ${f(t.f)})`,while:t=>`while (${f(t.test)}) ${f(t.scope)}`});return Object.assign(f,{gl_FragColor:Object(E.c)("vec4","gl_FragColor"),gl_FragCoord:Object(E.c)("vec4","gl_FragCoord",{const:!0}),gl_FragData:Object(E.c)("vec4[]","gl_FragData",{num:1}),gl_FrontFacing:Object(E.c)("bool","gl_FrontFacing",{const:!0}),gl_PointCoord:Object(E.c)("vec2","gl_PointCoord",{const:!0}),gl_PointSize:Object(E.c)("float","gl_PointSize"),gl_Position:Object(E.c)("vec4","gl_Position")}),f},v=()=>y({version:m.GLES_100,type:"vs"}),T=(t="precision mediump float;")=>y({version:m.GLES_100,type:"fs",prelude:t})},,,,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n(44);const i=void 0===t||"1"===t.env.UMBRELLA_ASSERTS?(t,e="assertion failed")=>{if("function"==typeof t&&!t()||!t)throw new Error("function"==typeof e?e():e)}:r.a}).call(this,n(42))},,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>"boolean"==typeof t},,function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,c=[],f=!1,d=-1;function l(){f&&u&&(f=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!f){var t=s(l);f=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function b(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||f||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=b,i.addListener=b,i.once=b,i.off=b,i.removeListener=b,i.removeAllListeners=b,i.emit=b,i.prependListener=b,i.prependOnceListener=b,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return c}));n(35);var r=n(29),i=n(48),a=n(25);function o(t,...e){let n,o,s;switch(e.length){case 0:Object(r.a)(t)||(s=t,t=s.type);break;case 1:Object(r.a)(e[0])?n=e[0]:e[0].tag?s=e[0]:o=e[0];break;case 2:Object(r.a)(e[0])?[n,o]=e:[o,s]=e;break;case 3:[n,o,s]=e;break;default:Object(i.a)()}return{tag:"sym",type:t,id:n||Object(a.a)(),opts:o||{},init:s}}const s=(t,e,n)=>o(t,e,Object.assign({q:"in",type:"in"},n)),u=(t,e,n)=>o(t,e,Object.assign({q:"out",type:"out"},n)),c=(t,e,n)=>o(t,e,Object.assign({q:"in",type:"uni"},n))},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));const r=Symbol(),i=()=>{}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return b}));n(21);const r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];for(let t=0;t<=256;t++)r[256+t]=r[t];const i=.5*(Math.sqrt(3)-1),a=(3-Math.sqrt(3))/6,o=(Math.sqrt(5)-1)/4,s=(5-Math.sqrt(5))/20,u=new Uint8Array(256),c=new Uint8Array(512),f=new Uint8Array(512);for(let t=0;t<256;t++)u[t]=256*Math.random();for(let t=0;t<512;t++)c[t]=u[255&t],f[t]=c[t]%12;const d=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),l=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);function h(t,e){let n=0,r=0,o=0;const s=(t+e)*i,u=Math.floor(t+s),l=Math.floor(e+s),h=(u+l)*a,p=t-(u-h),b=e-(l-h);let _,m;p>b?(_=1,m=0):(_=0,m=1);const g=p-_+a,E=b-m+a,M=p-1+2*a,y=b-1+2*a,v=255&u,T=255&l;let A=.5-p*p-b*b;if(A>=0){const t=3*f[v+c[T]];A*=A,n=A*A*(d[t]*p+d[t+1]*b)}let S=.5-g*g-E*E;if(S>=0){const t=3*f[v+_+c[T+m]];S*=S,r=S*S*(d[t]*g+d[t+1]*E)}let O=.5-M*M-y*y;if(O>=0){const t=3*f[v+1+c[T+1]];O*=O,o=O*O*(d[t]*M+d[t+1]*y)}return 70*(n+r+o)}function p(t,e,n,r){let i,a,u,f,d;const h=(t+e+n+r)*o,p=Math.floor(t+h),b=Math.floor(e+h),_=Math.floor(n+h),m=Math.floor(r+h),g=(p+b+_+m)*s,E=t-(p-g),M=e-(b-g),y=n-(_-g),v=r-(m-g);let T,A,S,O,R,F,N,w,I,U,D,L,j=0,P=0,x=0,B=0;E>M?j++:P++,E>y?j++:x++,E>v?j++:B++,M>y?P++:x++,M>v?P++:B++,y>v?x++:B++,T=j>=3?1:0,A=P>=3?1:0,S=x>=3?1:0,O=B>=3?1:0,R=j>=2?1:0,F=P>=2?1:0,N=x>=2?1:0,w=B>=2?1:0,I=j>=1?1:0,U=P>=1?1:0,D=x>=1?1:0,L=B>=1?1:0;const C=E-T+s,z=M-A+s,G=y-S+s,k=v-O+s,X=E-R+2*s,Y=M-F+2*s,$=y-N+2*s,V=v-w+2*s,q=E-I+3*s,H=M-U+3*s,W=y-D+3*s,K=v-L+3*s,Q=E-1+4*s,Z=M-1+4*s,J=y-1+4*s,tt=v-1+4*s,et=255&p,nt=255&b,rt=255&_,it=255&m;let at=.6-E*E-M*M-y*y-v*v;if(at<0)i=0;else{const t=c[et+c[nt+c[rt+c[it]]]]%32*4;at*=at,i=at*at*(l[t]*E+l[t+1]*M+l[t+2]*y+l[t+3]*v)}let ot=.6-C*C-z*z-G*G-k*k;if(ot<0)a=0;else{const t=c[et+T+c[nt+A+c[rt+S+c[it+O]]]]%32*4;ot*=ot,a=ot*ot*(l[t]*C+l[t+1]*z+l[t+2]*G+l[t+3]*k)}let st=.6-X*X-Y*Y-$*$-V*V;if(st<0)u=0;else{const t=c[et+R+c[nt+F+c[rt+N+c[it+w]]]]%32*4;st*=st,u=st*st*(l[t]*X+l[t+1]*Y+l[t+2]*$+l[t+3]*V)}let ut=.6-q*q-H*H-W*W-K*K;if(ut<0)f=0;else{const t=c[et+I+c[nt+U+c[rt+D+c[it+L]]]]%32*4;ut*=ut,f=ut*ut*(l[t]*q+l[t+1]*H+l[t+2]*W+l[t+3]*K)}let ct=.6-Q*Q-Z*Z-J*J-tt*tt;if(ct<0)d=0;else{const t=c[et+1+c[nt+1+c[rt+1+c[it+1]]]]%32*4;ct*=ct,d=ct*ct*(l[t]*Q+l[t+1]*Z+l[t+2]*J+l[t+3]*tt)}return 27*(i+a+u+f+d)}function b(t,e,n,r){const i=[];for(let a=0;a<e;a++)for(let o=0;o<t;o++){const s=o/t,u=a/e,c=Math.cos(2*s*Math.PI)*n/(2*Math.PI),f=Math.cos(2*u*Math.PI)*r/(2*Math.PI),d=Math.sin(2*s*Math.PI)*n/(2*Math.PI),l=Math.sin(2*u*Math.PI)*r/(2*Math.PI);i.push(p(c,f,d,l))}return i}},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(24);const i=Object(r.a)(()=>"illegal argument(s)"),a=t=>{throw new i(t)}},function(t,e){},,function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u}));var r=n(6),i=n(54),a=n(27),o=n(10);n(53);Object(r.c)("float","fitNorm1",["float","float","float"],(t,e,n)=>[Object(r.d)(Object(i.b)(Object(a.h)(e,n),Object(a.b)(Object(a.i)(t,e),Object(a.i)(n,e)),o.a))]);const s=t=>Object(a.a)(Object(a.g)(t,o.b),o.b),u=t=>Object(a.i)(Object(a.g)(t,o.d),o.c)},,function(t,e,n){"use strict";n.d(e,"h",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return f})),n.d(e,"k",(function(){return d})),n.d(e,"j",(function(){return l})),n.d(e,"i",(function(){return h})),n.d(e,"l",(function(){return p})),n.d(e,"a",(function(){return b})),n.d(e,"c",(function(){return _})),n.d(e,"d",(function(){return m})),n.d(e,"g",(function(){return g}));var r=n(6);n(20);const i=t=>e=>Object(r.a)(t,e.type,e),a=t=>(e,n)=>Object(r.a)(t,e.type,e,n),o=t=>(e,n,i)=>Object(r.a)(t,e.type,e,n,i),s=t=>Object(r.a)("normalize",t.type,t),u=t=>Object(r.a)("length","float",t),c=(t,e)=>Object(r.a)("dot","float",t,e),f=(a("min"),a("max")),d=(o("clamp"),a("step"),o("smoothstep")),l=(i("radians"),i("degrees"),i("cos"),i("sin"));i("tan"),i("acos"),i("asin");const h=a("pow"),p=(i("exp"),i("log"),i("exp2"),i("log2"),i("sqrt")),b=(i("inversesqrt"),i("abs")),_=(i("sign"),i("floor")),m=(i("ceil"),i("fract"));function g(t,e,n){const i=Object(r.a)("mix",t.type,t,e,n);return"float"===n.type&&(i.info="n"),i}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var r=n(17);const i=(t,e,n)=>({tag:"ternary",type:e.type,test:t,t:e,f:n});function a(...t){const[e,n,i,a]=2===t.length?[,t[0],,t[1]]:3===t.length?[t[0],t[1],,t[2]]:t;return{tag:"for",type:"void",init:e?Object(r.b)(e):void 0,test:n(e),iter:i?i(e):void 0,scope:Object(r.d)(a(e))}}const o=t=>({tag:"ctrl",type:"void",id:t});o("break"),o("continue"),o("discard")},,,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r}));const r=()=>"object"==typeof t&&"object"==typeof t.versions&&void 0!==t.versions.node}).call(this,n(42))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(35);const i=(t,e)=>(Object(r.a)("swizzle"!==t.tag||"sym"===t.val.tag,"can't assign to non-symbol swizzle"),{tag:"assign",type:t.type,l:t,r:e})},function(t,e,n){"use strict";function r(t,e){const n=t.type[0],r=(t,n)=>1===e.length?t:n+e.length;return{tag:"swizzle",type:"i"===n?r("int","ivec"):"u"===n?r("uint","uvec"):"b"===n?r("bool","bvec"):r("float","vec"),val:t,id:e}}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return c}));const i=t=>r(t,"x"),a=t=>r(t,"y"),o=t=>r(t,"z"),s=t=>r(t,"w");function u(t){return r(t,"xy")}function c(t){return r(t,"xyz")}},,,,,,,,,,,,,,,,function(t,e,n){t.exports=n(86)},,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(5),i=n(2);function a({vertex:t=[0,0,0],normal:e=[0,0,1],direction:n=[0,1,0],length:r=1}={}){return{vertex:t,normal:e,direction:n,length:r}}const o=i.b.create(),s=i.b.create(),u=i.b.create(),c=i.b.create(),f=i.c.create();function d(t=1,e){const n=Object(r.b)(e.normal,e.direction);return[Object(r.a)(Object(r.g)(-t,n),e.vertex),Object(r.a)(Object(r.g)(t,n),e.vertex)]}var l=n(3),h=n(1);const p=document.getElementById("canvas"),b=Object(h.i)(p),_=(b.gl,Object(h.l)()),m=Object.assign({},h.b);var g=n(45);Object(h.m)("lines",{line1:[]}),Object(h.a)("lines",(t,e)=>{t===m.FRAME&&(e.lines.line1=Object(l.h)(t=>t,100).reduce((t,n)=>{return t.concat(function({length:t,directionAngle:e=0,normalAngle:n=0,tangentAngle:r=0},d=a()){i.b.setAxisAngle(o,d.normal,n),i.b.setAxisAngle(s,d.direction,e),i.b.setAxisAngle(u,i.c.cross(f,d.direction,d.normal),r),i.b.multiply(c,i.b.multiply(c,s,o),u);const l=i.c.transformQuat(i.c.create(),d.normal,c);i.c.normalize(l,l);const h=i.c.transformQuat(i.c.create(),d.direction,c);i.c.normalize(h,h);const p=i.c.create();return i.c.scale(p,d.direction,d.length),i.c.add(p,p,d.vertex),a({vertex:p,direction:h,normal:l,length:t})}({length:1,normalAngle:Object(g.a)(n/10,e.time/40)/2,tangentAngle:.1},(r=t)[r.length-1]));var r},[a({direction:[0,0,1],normal:[-1,0,0]})]))});var E=n(8),M=n(28),y=n(30),v=n(17),T=n(43),A=n(6),S=n(59),O=n(53),R=n(60),F=n(27),N=n(10),w=n(51);const I=Object(y.a)(),U=Object(y.b)();let D,L,j,P,x,B,C;const z=U(Object(v.c)([L=Object(T.a)("vec3","position"),j=Object(T.a)("vec3","normal"),P=Object(T.d)("mat4","transform"),x=Object(T.d)("mat4","projection"),C=Object(T.d)("mat4","view"),B=Object(T.d)("mat4","normalMatrix"),D=Object(T.b)("vec3","vNormal"),Object(A.b)(()=>[Object(S.a)(D,Object(O.h)(Object(R.e)(Object(F.g)(B,Object(N.n)(j,1))))),Object(S.a)(U.gl_Position,Object(F.g)(Object(F.g)(Object(F.g)(x,C),P),Object(N.n)(L,1)))])])),G=I(Object(v.c)([D=Object(T.a)("vec3","vNormal"),Object(A.b)(()=>{return[Object(S.a)(I.gl_FragColor,Object(N.n)(Object(F.g)((t=Object(O.h)(D),e=Object(N.m)(0,-1,0),Object(w.b)(Object(O.b)(t,e))),Object(N.m)(1,0,0)),1))];var t,e})]));var k=n(13),X=n(23);Object(M.a)({position:[0,10,30]});const Y=Object(h.j)(b,"line").update({vert:z,frag:G}),$=Object(h.f)(b,"line1"),V=i.a.create(),q=Object(h.k)(b,"line1").update({form:$,shade:Y,uniforms:{transform:V}}),H=Object(h.f)(b,"line2"),W=i.a.fromTranslation(i.a.create(),[10,0,0]),K=Object(h.k)(b,"line2").update({form:H,shade:Y,uniforms:{transform:W}}),Q=i.a.create(),Z=Object(h.g)(b,"scene").update({layers:Object(h.h)(b,"scene").update({sketches:[q,K],uniforms:{view:()=>_.viewPort.camera.viewMat,projection:()=>_.viewPort.camera.projectionMat,normalMatrix:()=>i.a.transpose(Q,i.a.invert(Q,_.viewPort.camera.viewMat))},drawSettings:{clearColor:[1,1,1,1],clearBits:Object(k.a)(b.gl,"depth","color"),cullFace:b.gl.BACK,enable:[b.gl.DEPTH_TEST,b.gl.CULL_FACE]}})});Object(h.a)("renderer",(t,e)=>{t===m.FRAME&&($.update({attribs:{position:{buffer:new Float32Array(Object(l.c)(t=>t.vertex,e.lines.line1)),storeType:"DYNAMIC"},normal:{buffer:new Float32Array(Object(l.c)(t=>t.normal,e.lines.line1)),storeType:"DYNAMIC"}},drawType:"LINE_STRIP",itemCount:e.lines.line1.length}),H.update({attribs:{position:{buffer:new Float32Array(Object(l.d)(Object(l.c)(Object(X.a)(d,.4),e.lines.line1)).concat(Object(l.d)(Object(l.c)(t=>d(.4,t).reverse(),e.lines.line1).reverse()))),storeType:"DYNAMIC"},normal:{buffer:new Float32Array(Object(l.d)(Object(l.c)(t=>[t.normal,t.normal],e.lines.line1)).concat(Object(l.d)(Object(l.c)(t=>Object(l.h)(()=>Object(r.g)(-1,t.normal),2),e.lines.line1)).reverse())),storeType:"DYNAMIC"}},drawType:"TRIANGLE_STRIP",itemCount:4*e.lines.line1.length}))}),_.time=0,Object(E.b)(t=>{_.device.tpf=t,_.time+=t/1e3,Object(h.c)(m.FRAME),b.compose(Z).display(Z)},"loop")}]);
//# sourceMappingURL=main.js.map