{"version":3,"sources":["webpack:///experiments/area-light/main.js","webpack:///./experiments/area-light/index.ts","webpack:///./experiments/area-light/flow.ts","webpack:///./experiments/area-light/nodes.json","webpack:///./experiments/area-light/graph \\.ts$","webpack:///./experiments/area-light/graph/renderer.ts","webpack:///./experiments/area-light/graph/shaders/geo-vert.glsl","webpack:///./experiments/area-light/graph/shaders/geo-frag.glsl","webpack:///./experiments/area-light/graph/shaders/light-frag.glsl","webpack:///./experiments/area-light/graph/events.ts","webpack:///../node_modules/geo-3d-box/box.js","webpack:///../libs/tvs-renderer/dist/lib/utils/stackgl.js","webpack:///../libs/tvs-renderer/dist/lib/contants.js","webpack:///../libs/tvs-libs/lib/vr/flow-painter-utils.ts","webpack:///../libs/tvs-libs/lib/utils/predicates.ts","webpack:///../libs/tvs-renderer/dist/lib/utils/context.js","webpack:///./experiments/area-light/graph/painter.ts","webpack:///./experiments/area-light/graph/camera.ts","webpack:///./experiments/area-light/graph/geometries/box.ts","webpack:///./experiments/area-light/graph/geometries/plane.ts","webpack:///./experiments/area-light/graph/state.ts","webpack:///./experiments/area-light/graph/shaders/shaders.ts"],"names":["webpackJsonp","118","module","exports","__webpack_require__","119","__webpack_exports__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__flow__","__WEBPACK_IMPORTED_MODULE_1_shared_utils_reload__","graphModules","setDebug","updateFlow","setTimeout","120","d","flow","tools","__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_runtime__","__WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__","__WEBPACK_IMPORTED_MODULE_2__nodes_json__","n","__WEBPACK_IMPORTED_MODULE_2__nodes_json___default","start","graph","a","window","121","122","webpackContext","req","webpackContextResolve","id","map","Error","./camera.ts","./events.ts","./geometries/box.ts","./geometries/plane.ts","./painter.ts","./renderer.ts","./shaders/shaders.ts","./state.ts","keys","resolve","123","boxForm","planeForm","geoShade","groundSketch","lightSketch","drawSettings","sceneLayer","lightLayer","__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__","__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__","__WEBPACK_IMPORTED_MODULE_2__painter__","__WEBPACK_IMPORTED_MODULE_3__events__","__WEBPACK_IMPORTED_MODULE_4__camera__","__WEBPACK_IMPORTED_MODULE_5__geometries_box__","__WEBPACK_IMPORTED_MODULE_6__geometries_plane__","__WEBPACK_IMPORTED_MODULE_7_tvs_renderer_dist_lib_utils_context__","__WEBPACK_IMPORTED_MODULE_8__state__","__WEBPACK_IMPORTED_MODULE_9__shaders_shaders__","react","HOT","sketch","transform","color","shade","form","update","uniforms","gl","clearBits","COLD","layer","light","ground","view","projection","settings","buffered","textureConfig","count","type","FLOAT","sketches","wrap","minFilter","magFilter","eyePosition","lightMat","scene","frag","positions","texture","normals","uvs","colors","disable","DEPTH_TEST","enable","BLEND","p","compose","124","125","126","15","tick","windowSize","mouse","__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_events_keyboard__","__WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_events_mouse__","__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_dom__","__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_events_animation__","29","_createConfig","properties","config","size","segments","Array","isArray","_flatten","array","results","i","length","subarray","j","push","_generatePanel","rows","_generateGrid","cells","_generateCells","_generateUvs","vertexCount","sx","sy","wx","wy","step","halfY","grid","_generateRow","height","halfX","row","index","x","y","b","c","_clonePanel","panel","_generateBoxPanels","segs","zp","xp","yp","zm","xm","ym","_makeNormals","normal","slice","_generateBox","panels","_offsetCellIndices","offset","offsetCells","cell","v","30","_i","array_1","_a","subarray_1","el","convertStackGLGeometry","stackglGeometry","geometry","drawType","attribs","itemCount","prop","arr","STACK_GL_GEOMETRY_PROP_ELEMENTS","buffer","Uint32Array","Uint16Array","assign","elements","STACK_GL_GEOMETRY_PROP_POSITION","__WEBPACK_IMPORTED_MODULE_0__contants__","Float32Array","STACK_GL_GEOMETRY_PROP_NORMAL","STACK_GL_GEOMETRY_PROP_UV","31","GEOMETRY_PROP_POSITION","GEOMETRY_PROP_NORMAL","GEOMETRY_PROP_UV","33","makeShadeEntity","painter","data","entity","send","createShade","destroy","makeFormEntity","createForm","makeSketchEntity","createSketch","makeDrawingLayerEntity","createDrawingLayer","makeEffectLayerEntity","createEffectLayer","34","unequal","35","makeClear","clearArray","arguments","reduce","res","item","toUpperCase","39","canvas","canvasSize","__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_painter_utils__","__WEBPACK_IMPORTED_MODULE_2__events__","clearColor","reset","updateDrawSettings","65","position","rotX","rotY","rotation","perspectiveSettings","perspective","moveSpeed","lookSpeed","moveForward","moveLeft","mouseDrag","dragDeltas","__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_camera__","__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__","__WEBPACK_IMPORTED_MODULE_4_gl_matrix__","__WEBPACK_IMPORTED_MODULE_5__events__","__assign","this","t","s","prototype","hasOwnProperty","call","val","fromValues","_b","updateVal","fovy","Math","PI","speed","_","UP","W","DOWN","S","LEFT","A","RIGHT","D","m","drag","o","accept","rot","pos","left","add","scale","forward","66","__WEBPACK_IMPORTED_MODULE_1_geo_3d_box__","__WEBPACK_IMPORTED_MODULE_1_geo_3d_box___default","__WEBPACK_IMPORTED_MODULE_2_tvs_renderer_dist_lib_utils_stackgl__","67","props","__WEBPACK_IMPORTED_MODULE_0_tvs_renderer_dist_lib_utils_geometry_plane__","__WEBPACK_IMPORTED_MODULE_1_tvs_flow_dist_lib_utils_entity_reference__","width","segX","segY","68","groundColor","groundTransform","lightRotation","lightPosition","lightColor","lightTransform","__WEBPACK_IMPORTED_MODULE_1_gl_matrix__","create","rotateX","fromTranslation","69","geoSpec","lightFrag","__WEBPACK_IMPORTED_MODULE_1__geo_vert_glsl__","__WEBPACK_IMPORTED_MODULE_1__geo_vert_glsl___default","__WEBPACK_IMPORTED_MODULE_2__geo_frag_glsl__","__WEBPACK_IMPORTED_MODULE_2__geo_frag_glsl___default","__WEBPACK_IMPORTED_MODULE_3__light_frag_glsl__","__WEBPACK_IMPORTED_MODULE_3__light_frag_glsl___default","vert"],"mappings":"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","file":"experiments/area-light/main.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 118:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(119);\n\n\n/***/ }),\n\n/***/ 119:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__flow__ = __webpack_require__(120);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_shared_utils_reload__ = __webpack_require__(18);\n\n\nvar graphModules = __webpack_require__(122);\n__WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */].setDebug(true);\nObject(__WEBPACK_IMPORTED_MODULE_1_shared_utils_reload__[\"a\" /* updateFlow */])(__WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */], graphModules);\n__WEBPACK_IMPORTED_MODULE_0__flow__[\"b\" /* tools */].updateFlow(__WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */]);\nsetTimeout(function () {\n    __WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */].setDebug(false);\n}, 1000);\nif (false) {\n    module.hot.accept(graphModules.id, function () {\n        var newGraphModules = require.context('./graph', true, /\\.ts$/);\n        updateFlow(flow, newGraphModules);\n        tools.updateFlow(flow);\n    });\n}\n\n\n/***/ }),\n\n/***/ 120:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return flow; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return tools; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_runtime__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__nodes_json__ = __webpack_require__(121);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__nodes_json___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__nodes_json__);\n\n\n\nvar flow = __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_runtime__[\"a\" /* create */]();\nvar tools = __WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__[\"ui\"].start('area light', { graph: __WEBPACK_IMPORTED_MODULE_2__nodes_json___default.a });\nwindow['flow'] = flow;\nwindow['tools'] = tools;\n\n\n/***/ }),\n\n/***/ 121:\n/***/ (function(module, exports) {\n\nmodule.exports = {}\n\n/***/ }),\n\n/***/ 122:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar map = {\n\t\"./camera.ts\": 65,\n\t\"./events.ts\": 15,\n\t\"./geometries/box.ts\": 66,\n\t\"./geometries/plane.ts\": 67,\n\t\"./painter.ts\": 39,\n\t\"./renderer.ts\": 123,\n\t\"./shaders/shaders.ts\": 69,\n\t\"./state.ts\": 68\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 122;\n\n/***/ }),\n\n/***/ 123:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"boxForm\", function() { return boxForm; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"planeForm\", function() { return planeForm; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"geoShade\", function() { return geoShade; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"groundSketch\", function() { return groundSketch; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightSketch\", function() { return lightSketch; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"drawSettings\", function() { return drawSettings; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sceneLayer\", function() { return sceneLayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightLayer\", function() { return lightLayer; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__painter__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__events__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__camera__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__geometries_box__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__geometries_plane__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_tvs_renderer_dist_lib_utils_context__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__state__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shaders_shaders__ = __webpack_require__(69);\n\n\n\n\n\n\n\n\n\n\nvar boxForm = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"c\" /* makeFormEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"], __WEBPACK_IMPORTED_MODULE_5__geometries_box__[\"geometry\"]);\nvar planeForm = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"c\" /* makeFormEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"], __WEBPACK_IMPORTED_MODULE_6__geometries_plane__[\"geometry\"]);\nvar geoShade = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"d\" /* makeShadeEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"], __WEBPACK_IMPORTED_MODULE_9__shaders_shaders__[\"geoSpec\"]);\nvar groundSketch = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"e\" /* makeSketchEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"])\n    .react([__WEBPACK_IMPORTED_MODULE_8__state__[\"groundTransform\"].HOT, __WEBPACK_IMPORTED_MODULE_8__state__[\"groundColor\"].HOT, geoShade.HOT, planeForm.HOT], function (sketch, transform, color, shade, form) { return sketch.update({\n    form: form, shade: shade,\n    uniforms: {\n        transform: transform,\n        color: color\n    }\n}); });\nvar lightSketch = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"e\" /* makeSketchEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"])\n    .react([__WEBPACK_IMPORTED_MODULE_8__state__[\"lightTransform\"].HOT, __WEBPACK_IMPORTED_MODULE_8__state__[\"lightColor\"].HOT, geoShade.HOT, planeForm.HOT], function (sketch, transform, color, shade, form) { return sketch.update({\n    form: form, shade: shade,\n    uniforms: {\n        transform: transform,\n        color: color\n    }\n}); });\nvar drawSettings = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_2__painter__[\"gl\"].HOT], function (gl) { return ({\n    clearBits: Object(__WEBPACK_IMPORTED_MODULE_7_tvs_renderer_dist_lib_utils_context__[\"a\" /* makeClear */])(gl, 'color', 'depth')\n}); });\nvar sceneLayer = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"a\" /* makeDrawingLayerEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"])\n    .react([\n    __WEBPACK_IMPORTED_MODULE_2__painter__[\"gl\"].HOT,\n    lightSketch.HOT,\n    groundSketch.HOT,\n    __WEBPACK_IMPORTED_MODULE_4__camera__[\"view\"].COLD,\n    __WEBPACK_IMPORTED_MODULE_4__camera__[\"perspective\"].COLD,\n    drawSettings.HOT\n], function (layer, gl, light, ground, view, projection, settings) { return layer.update({\n    buffered: true,\n    textureConfig: {\n        count: 4,\n        type: gl.FLOAT\n    },\n    sketches: [light, ground],\n    drawSettings: settings,\n    uniforms: {\n        view: view, projection: projection\n    },\n    wrap: 'CLAMP_TO_EDGE',\n    minFilter: 'NEAREST',\n    magFilter: 'NEAREST'\n}); });\nvar lightLayer = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_lib_vr_flow_painter_utils__[\"b\" /* makeEffectLayerEntity */])(__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"])\n    .react([\n    __WEBPACK_IMPORTED_MODULE_4__camera__[\"position\"].HOT,\n    __WEBPACK_IMPORTED_MODULE_8__state__[\"lightTransform\"].HOT,\n    sceneLayer.HOT,\n    __WEBPACK_IMPORTED_MODULE_4__camera__[\"view\"].COLD,\n    __WEBPACK_IMPORTED_MODULE_2__painter__[\"gl\"].HOT,\n    __WEBPACK_IMPORTED_MODULE_9__shaders_shaders__[\"lightFrag\"].HOT\n], function (layer, eyePosition, lightMat, scene, view, gl, frag) { return layer.update({\n    frag: frag,\n    uniforms: {\n        eyePosition: eyePosition,\n        lightMat: lightMat,\n        view: view,\n        positions: scene.texture(0),\n        normals: scene.texture(1),\n        uvs: scene.texture(2),\n        colors: scene.texture(3)\n    },\n    drawSettings: {\n        disable: [gl.DEPTH_TEST],\n        enable: [gl.BLEND],\n        clearBits: Object(__WEBPACK_IMPORTED_MODULE_7_tvs_renderer_dist_lib_utils_context__[\"a\" /* makeClear */])(gl, 'color')\n    }\n}); });\n__WEBPACK_IMPORTED_MODULE_2__painter__[\"painter\"].react([sceneLayer.COLD, lightLayer.COLD, __WEBPACK_IMPORTED_MODULE_3__events__[\"tick\"].HOT], function (p, scene, light) { return p.compose(scene, light); });\n\n\n/***/ }),\n\n/***/ 124:\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nattribute vec3 position;\\nattribute vec3 normal;\\nattribute vec2 uv;\\n\\nuniform mat4 transform;\\nuniform mat4 projection;\\nuniform mat4 view;\\n\\nvarying vec4 vPosition;\\nvarying vec4 vNormal;\\nvarying vec4 vUv;\\n\\nvoid main() {\\n\\tvPosition = transform * vec4(position, 1.0);\\n\\tvNormal = transform * vec4(normal, 0.0);\\n\\tvUv = vec4(uv, 0.0, 0.0);\\n\\tgl_Position = projection * view * vPosition;\\n}\\n\"\n\n/***/ }),\n\n/***/ 125:\n/***/ (function(module, exports) {\n\nmodule.exports = \"#extension GL_EXT_draw_buffers : require\\nprecision highp float;\\n#define GLSLIFY 1\\n\\nuniform vec4 color;\\n\\nvarying vec4 vPosition;\\nvarying vec4 vNormal;\\nvarying vec4 vUv;\\n\\nvoid main() {\\n\\tgl_FragData[0] = vPosition;\\n\\tgl_FragData[1] = vNormal;\\n\\tgl_FragData[2] = vUv;\\n\\tgl_FragData[3] = color;\\n}\\n\"\n\n/***/ }),\n\n/***/ 126:\n/***/ (function(module, exports) {\n\nmodule.exports = \"precision mediump float;\\n#define GLSLIFY 1\\n\\nuniform sampler2D colors;\\nuniform sampler2D positions;\\nuniform sampler2D normals;\\nuniform sampler2D uvs;\\n\\nuniform vec3 eyePosition;\\nuniform mat4 lightMat;\\nuniform mat4 view;\\n\\nvarying vec2 coords;\\n\\n\\nfloat areaLampEnergy(mat4 lampMat, vec3 V, vec3 N, vec3 lampPos, vec2 areaSize) {\\n\\tfloat width = areaSize.x / 2.0;\\n\\tfloat height = areaSize.y / 2.0;\\n\\n\\tvec3 right = normalize(vec3(lampMat * vec4(1.0, 0.0, 0.0, 0.0))); //lamp right axis\\n\\tvec3 up = normalize(vec3(lampMat * vec4(0.0, 1.0, 0.0, 0.0))); //lamp up axis\\n\\tvec3 lampv = normalize(vec3(lampMat * vec4(0.0, 0.0, -1.0, 0.0))); //lamp projection axis\\n\\n\\t/*project onto plane and calculate direction from center to the projection*/\\n\\tfloat dis = dot(lampv, V - lampPos);\\n\\tvec3 projection = V - dis * lampv;\\n\\tvec3 dir = projection - lampPos;\\n\\n\\t/*calculate distance from area*/\\n\\tvec2 diagonal = vec2(dot(dir, right), dot(dir, up));\\n\\tvec2 nearest2D = vec2(clamp(diagonal.x, -width, width), clamp(diagonal.y, -height, height));\\n\\tvec3 nearestPointInside = lampPos + (right * nearest2D.x + up * nearest2D.y);\\n\\n\\tfloat d = distance(V, nearestPointInside); //real distance to area rectangle\\n\\n\\tvec3 L = normalize(nearestPointInside - V);\\n\\n\\tfloat nDotL = clamp(dot(-lampv, L), 0.0, 1.0);\\n\\t//nDotL *= clamp(dot(-N,L),0.0,1.0); //how blender internal works, but too hard falloff\\n\\tnDotL *= clamp(dot(-N, L) * 0.5 + 0.5, 0.0, 1.0); //distribute over hemisphere, looks better. Should be dependant of area size.\\n\\n\\tfloat attenuation = 1.0 / (1.0 + d);\\n\\n\\treturn max(nDotL, 0.0) * attenuation;\\n}\\n\\nvoid areaDiff(vec3 V, vec3 lampPos, vec3 lampVec, vec3 N, mat4 lampMat, float areaSizeX, float areaSizeY, float dist, float k, out float inp) {\\n\\tvec3 vec = V - lampPos;\\n\\tvec2 asize = vec2(areaSizeX, areaSizeY);\\n\\n\\tfloat strength = dist * dist / 4.0;\\n\\n\\tif (dot(vec, lampVec) < 0.0) {\\n\\t\\tinp = 0.0;\\n\\t} else {\\n\\t\\tfloat intens = areaLampEnergy(lampMat, V, N, lampPos, asize);\\n\\t\\tinp = pow(intens * strength, k);\\n\\t}\\n}\\n\\nvoid main() {\\n\\n\\tvec4 position = texture2D(positions, coords);\\n\\tvec4 normal = texture2D(normals, coords);\\n\\tvec4 uv = texture2D(uvs, coords);\\n\\tvec4 color = texture2D(colors, coords);\\n\\n\\tvec3 lightPosition = lightMat[3].xyz;\\n\\tvec3 lightNormal = normalize(lightMat[2].xyz);\\n\\tfloat dist = abs(length(eyePosition - position.xyz));\\n\\n\\tfloat diff = 1.0;\\n\\n\\tareaDiff(position.xyz, lightPosition, lightNormal, normalize(normal.xyz), lightMat, 10.0, 10.0, dist, 1.0, diff);\\n\\t//gl_FragColor = texture2D(colors, coords);\\n\\t//gl_FragColor = vec4((texture2D(normals, coords).xyz + 1.0) / 2.0, 1.0);\\n\\t//gl_FragColor = vec4(color.xyz * diff, 1.0);\\n\\tgl_FragColor = vec4(color.xyz * (lightPosition / 5.0), 1.0);\\n}\\n\"\n\n/***/ }),\n\n/***/ 15:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tick\", function() { return tick; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"windowSize\", function() { return windowSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mouse\", function() { return mouse; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"keys\", function() { return keys; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_events_keyboard__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_events_mouse__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_dom__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_events_animation__ = __webpack_require__(21);\n\n\n\n\n\nvar tick = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_events_animation__[\"a\" /* animateWithTPF */]);\nvar windowSize = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_dom__[\"a\" /* windowSize */]);\nvar mouse = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_events_mouse__[\"a\" /* mouse */]);\nvar keys = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_events_keyboard__[\"b\" /* keyboard */]);\n\n\n/***/ }),\n\n/***/ 29:\n/***/ (function(module, exports) {\n\nfunction _createConfig( properties ) {\n\t\n\tvar config = {\n\t\tsize : [1,1,1],\n\t\tsegments : [1,1,1]\n\t}\n\t\n\tif( properties ) {\n\t\n\t\tif( Array.isArray( properties.size ) ) {\n\t\t\tconfig.size = properties.size\n\t\t} else if( typeof properties.size === \"number\" ) {\n\t\t\tconfig.size = [properties.size, properties.size, properties.size]\n\t\t}\n\t\n\t\tif( Array.isArray( properties.segments ) ) {\n\t\t\tconfig.segments = properties.segments\n\t\t} else if( typeof properties.segments === \"number\" ) {\n\t\t\tconfig.segments = [properties.segments, properties.segments, properties.segments]\n\t\t}\n\t}\n\t\n\treturn config\n}\n\nfunction _flatten( array ) {\n\tvar results = []\n\t\n\tfor( var i=0; i < array.length; i++ ) {\n\t\tvar subarray = array[i]\n\t\tfor( var j=0; j < subarray.length; j++ ) {\n\t\t\tresults.push(subarray[j])\n\t\t}\n\t}\n\treturn results\n}\n\nfunction _generatePanel( config ) {\n\t\t\t\n\tvar rows      = _generateGrid( config )\n\tvar cells     = _generateCells( config, rows )\n\tvar positions = _flatten( rows )\n\tvar uvs       = _generateUvs( config, positions )\n\t\n\treturn {\n\t\tpositions   : positions,\n\t\tcells       : cells,\n\t\tuvs         : uvs,\n\t\tvertexCount : (config.sx + 1) * (config.sy + 1)\n\t}\n}\n\nfunction _generateUvs( config, positions ) {\n\t\n\treturn positions.map(function(p) {\n\t\treturn [\n\t\t\tp[0] / config.wx + 0.5,\n\t\t\tp[1] / config.wy + 0.5\n\t\t]\n\t})\n}\n\nfunction _generateGrid( config ) {\n\t\n\tvar step   = config.wy / config.sy\n\tvar halfY  = config.wy / 2\n\tvar length = config.sy + 1\n\tvar grid   = Array(length)\n\t\n\tfor( var i=0; i < length; i++ ) {\n\t\tgrid[i] = _generateRow( config, step * i - halfY)\n\t}\n\t\n\treturn grid\n}\n\nfunction _generateRow( config, height ) {\n\t\n\tvar halfX  = config.wx / 2\n\tvar step   = config.wx / config.sx\n\tvar length = config.sx + 1\n\tvar row    = Array(length)\n\t\n\tfor( var i=0; i < length; i++ ) {\n\t\trow[i] = [ step * i - halfX, height ]\n\t}\n\t\n\treturn row\n}\n\nfunction _generateCells( config ) {\n\t\n\tfunction index( x, y ) {\n\t\treturn (config.sx + 1) * y + x\n\t}\n\t\n\tvar cells = []\n\t\n\tfor( var x=0; x < config.sx; x++ ) {\n\t\t\n\t\tfor( var y=0; y < config.sy; y++ ) {\n\n\t\t\tvar a = index( x + 0, y + 0 )  //   d __ c\n\t\t\tvar b = index( x + 1, y + 0 )  //    |  |\n\t\t\tvar c = index( x + 1, y + 1 )  //    |__|\n\t\t\tvar d = index( x + 0, y + 1 )  //   a    b\n\t\t\t\n\t\t\tcells.push( [ a, b, c ] )\n\t\t\tcells.push( [ c, d, a ] )\n\t\t}\n\t}\n\t\n\treturn cells\n}\n\nfunction _clonePanel( panel ) {\n\t\n\treturn {\n\t\tpositions   : panel.positions,\n\t\tcells       : panel.cells,\n\t\tuvs         : panel.uvs,\n\t\tvertexCount : panel.vertexCount\n\t}\n}\n\nfunction _generateBoxPanels( config ) {\n\t\n\tvar size = config.size\n\tvar segs = config.segments\n\t\n\t//       yp  zm\n\t//        | /\n\t//        |/\n\t// xm ----+----- xp\n\t//       /|\n\t//      / |\n\t//    zp  ym\n\t\n\tvar zp = _generatePanel({\n\t\twx: size[0], wy: size[1],\n\t\tsx: segs[0], sy: segs[1]\n\t})\n\tvar xp = _generatePanel({\n\t\twx: size[2], wy: size[1],\n\t\tsx: segs[2], sy: segs[1]\n\t})\n\tvar yp = _generatePanel({\n\t\twx: size[0], wy: size[2],\n\t\tsx: segs[0], sy: segs[2]\n\t})\n\t\n\tvar zm = _clonePanel(zp)\n\tvar xm = _clonePanel(xp)\n\tvar ym = _clonePanel(yp)\n\t\n\tzp.positions = zp.positions.map( function(p) { return [       p[0],       p[1],  size[2]/2 ] } )\n\tzm.positions = zm.positions.map( function(p) { return [       p[0],      -p[1], -size[2]/2 ] } )\n\txp.positions = xp.positions.map( function(p) { return [  size[0]/2,      -p[1],       p[0] ] } )\n\txm.positions = xm.positions.map( function(p) { return [ -size[0]/2,       p[1],       p[0] ] } )\n\typ.positions = yp.positions.map( function(p) { return [       p[0],  size[1]/2,      -p[1] ] } )\n\tym.positions = ym.positions.map( function(p) { return [       p[0], -size[1]/2,       p[1] ] } )\n\t\n\tzp.normals = _makeNormals( [ 0, 0, 1], zp.positions.length )\n\tzm.normals = _makeNormals( [ 0, 0,-1], zm.positions.length )\n\txp.normals = _makeNormals( [ 1, 0, 0], xp.positions.length )\n\txm.normals = _makeNormals( [-1, 0, 0], xm.positions.length )\n\typ.normals = _makeNormals( [ 0, 1, 0], yp.positions.length )\n\tym.normals = _makeNormals( [ 0,-1, 0], ym.positions.length )\n\t\n\treturn [ zp, zm, xp, xm, yp, ym ]\n}\n\nfunction _makeNormals( normal, count ) {\n\t\n\tvar normals = Array(count)\n\t\n\tfor( var i=0; i < count; i++ ) {\n\t\tnormals[i] = normal.slice()\n\t}\n\t\n\treturn normals\n}\n\t\nfunction _generateBox( config ) {\n\t\n\tvar panels = _generateBoxPanels( config )\n\t\n\tvar positions = panels.map(function(panel) { return panel.positions })\n\tvar uvs       = panels.map(function(panel) { return panel.uvs       })\n\tvar normals   = panels.map(function(panel) { return panel.normals   })\n\tvar cells     = _offsetCellIndices( panels )\n\t\n\treturn {\n\t\tpositions: _flatten( positions ),\n\t\tuvs:       _flatten( uvs ),\n\t\tcells:     _flatten( cells ),\n\t\tnormals:   _flatten( normals ),\n\t}\n}\n\nfunction _offsetCellIndices( panels ) {\n\t\n\t/*\n\t\tFrom: [[[0,1,2],[2,3,0]],[[0,1,2],[2,3,0]]]\n\t\tTo:   [[[0,1,2],[2,3,0]],[[6,7,8],[8,9,6]]]\n\t*/\n\t\n\tvar offset = 0\n\t\n\treturn panels.map(function(panel) {\n\t\t\n\t\tvar offsetCells = panel.cells.map( function(cell) {\n\t\t\treturn cell.map(function(v) {\n\t\t\t\treturn v + offset\n\t\t\t})\n\t\t})\n\t\n\t\toffset += panel.vertexCount\n\t\n\t\treturn offsetCells\n\t})\n}\n\nmodule.exports = function( properties ) {\n\t\n\tvar config = _createConfig( properties )\n\n\treturn _generateBox( config )\n}\n\n/***/ }),\n\n/***/ 30:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export STACK_GL_GEOMETRY_PROP_POSITION */\n/* unused harmony export STACK_GL_GEOMETRY_PROP_NORMAL */\n/* unused harmony export STACK_GL_GEOMETRY_PROP_UV */\n/* unused harmony export STACK_GL_GEOMETRY_PROP_ELEMENTS */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = convertStackGLGeometry;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__contants__ = __webpack_require__(31);\n\nvar STACK_GL_GEOMETRY_PROP_POSITION = 'positions';\nvar STACK_GL_GEOMETRY_PROP_NORMAL = 'normals';\nvar STACK_GL_GEOMETRY_PROP_UV = 'uvs';\nvar STACK_GL_GEOMETRY_PROP_ELEMENTS = 'cells';\nfunction _flatten(array) {\n    var results = [];\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\n        var subarray = array_1[_i];\n        for (var _a = 0, subarray_1 = subarray; _a < subarray_1.length; _a++) {\n            var el = subarray_1[_a];\n            results.push(el);\n        }\n    }\n    return results;\n}\nfunction convertStackGLGeometry(stackglGeometry) {\n    var geometry = {\n        drawType: 'TRIANGLES',\n        attribs: {},\n        itemCount: 0\n    };\n    for (var prop in stackglGeometry) {\n        var arr = stackglGeometry[prop];\n        if (prop === STACK_GL_GEOMETRY_PROP_ELEMENTS) {\n            var buffer = new (arr.length > 65535 ? Uint32Array : Uint16Array)(_flatten(arr));\n            Object.assign(geometry, {\n                elements: { buffer: buffer },\n                itemCount: buffer.length\n            });\n        }\n        else if (prop === STACK_GL_GEOMETRY_PROP_POSITION) {\n            geometry.attribs[__WEBPACK_IMPORTED_MODULE_0__contants__[\"b\" /* GEOMETRY_PROP_POSITION */]] = {\n                buffer: new Float32Array(_flatten(arr))\n            };\n        }\n        else if (prop === STACK_GL_GEOMETRY_PROP_NORMAL) {\n            geometry.attribs[__WEBPACK_IMPORTED_MODULE_0__contants__[\"a\" /* GEOMETRY_PROP_NORMAL */]] = {\n                buffer: new Float32Array(_flatten(arr))\n            };\n        }\n        else if (prop === STACK_GL_GEOMETRY_PROP_UV) {\n            geometry.attribs[__WEBPACK_IMPORTED_MODULE_0__contants__[\"c\" /* GEOMETRY_PROP_UV */]] = {\n                buffer: new Float32Array(_flatten(arr))\n            };\n        }\n        else {\n            geometry.attribs[prop] = { buffer: new Float32Array(_flatten(arr)) };\n        }\n    }\n    return geometry;\n}\n//# sourceMappingURL=stackgl.js.map\n\n/***/ }),\n\n/***/ 31:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return GEOMETRY_PROP_POSITION; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return GEOMETRY_PROP_NORMAL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return GEOMETRY_PROP_UV; });\n/* unused harmony export UNIFORM_SOURCE_TEXTURE */\n/* unused harmony export VARYING_UV_COORDS */\n/* unused harmony export GL_TYPE */\nvar GEOMETRY_PROP_POSITION = 'position';\nvar GEOMETRY_PROP_NORMAL = 'normal';\nvar GEOMETRY_PROP_UV = 'uv';\nvar UNIFORM_SOURCE_TEXTURE = 'source';\nvar VARYING_UV_COORDS = 'coords';\nvar GL_TYPE = {\n    FLOAT: 0x1406,\n    FLOAT_VEC2: 0x8B50,\n    FLOAT_VEC3: 0x8B51,\n    FLOAT_VEC4: 0x8B52,\n    INT: 0x1404,\n    INT_VEC2: 0x8B53,\n    INT_VEC3: 0x8B54,\n    INT_VEC4: 0x8B55,\n    BOOL: 0x8B56,\n    BOOL_VEC2: 0x8B57,\n    BOOL_VEC3: 0x8B58,\n    BOOL_VEC4: 0x8B59,\n    FLOAT_MAT2: 0x8B5A,\n    FLOAT_MAT3: 0x8B5B,\n    FLOAT_MAT4: 0x8B5C,\n    SAMPLER_2D: 0x8B5E,\n    SAMPLER_CUBE: 0x8B60,\n    SAMPLER_3D: 0x8B5F,\n    SAMPLER_2D_SHADOW: 0x8B62,\n    FLOAT_MAT2X3: 0x8B65,\n    FLOAT_MAT2X4: 0x8B66,\n    FLOAT_MAT3X2: 0x8B67,\n    FLOAT_MAT3X4: 0x8B68,\n    FLOAT_MAT4X2: 0x8B69,\n    FLOAT_MAT4X3: 0x8B6A,\n    SAMPLER_2D_ARRAY: 0x8DC1,\n    SAMPLER_2D_ARRAY_SHADOW: 0x8DC4,\n    SAMPLER_CUBE_SHADOW: 0x8DC5,\n    UNSIGNED_INT: 0x1405,\n    UNSIGNED_INT_VEC2: 0x8DC6,\n    UNSIGNED_INT_VEC3: 0x8DC7,\n    UNSIGNED_INT_VEC4: 0x8DC8,\n    INT_SAMPLER_2D: 0x8DCA,\n    INT_SAMPLER_3D: 0x8DCB,\n    INT_SAMPLER_CUBE: 0x8DCC,\n    INT_SAMPLER_2D_ARRAY: 0x8DCF,\n    UNSIGNED_INT_SAMPLER_2D: 0x8DD2,\n    UNSIGNED_INT_SAMPLER_3D: 0x8DD3,\n    UNSIGNED_INT_SAMPLER_CUBE: 0x8DD4,\n    UNSIGNED_INT_SAMPLER_2D_ARRAY: 0x8DD7,\n    TEXTURE_2D: 0x0DE1,\n    TEXTURE_CUBE_MAP: 0x8513,\n    TEXTURE_3D: 0x806F,\n    TEXTURE_2D_ARRAY: 0x8C1A,\n    BYTE: 0x1400,\n    UNSIGNED_BYTE: 0x1401,\n    SHORT: 0x1402,\n    UNSIGNED_SHORT: 0x1403,\n    UNSIGNED_SHORT_4_4_4_4: 0x8033,\n    UNSIGNED_SHORT_5_5_5_1: 0x8034,\n    UNSIGNED_SHORT_5_6_5: 0x8363,\n    HALF_FLOAT: 0x140B,\n    UNSIGNED_INT_2_10_10_10_REV: 0x8368,\n    UNSIGNED_INT_10F_11F_11F_REV: 0x8C3B,\n    UNSIGNED_INT_5_9_9_9_REV: 0x8C3E,\n    FLOAT_32_UNSIGNED_INT_24_8_REV: 0x8DAD,\n    UNSIGNED_INT_24_8: 0x84FA\n};\n//# sourceMappingURL=contants.js.map\n\n/***/ }),\n\n/***/ 33:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export makePainterCanvas */\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = makeShadeEntity;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = makeFormEntity;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = makeSketchEntity;\n/* unused harmony export makeFlatSketchEntity */\n/* unused harmony export makeStaticLayerEntity */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = makeDrawingLayerEntity;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = makeEffectLayerEntity;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_renderer_dist_lib_painter__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_renderer_dist_lib_utils_context__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_predicates__ = __webpack_require__(34);\n\n\n\n\nfunction makePainterCanvas(windowSizeEntity, painterSettings) {\n    var canvas = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, function (send) {\n        var canvas = document.createElement('canvas');\n        document.body.appendChild(canvas);\n        send(canvas);\n        return function () {\n            document.body.removeChild(canvas);\n        };\n    });\n    var gl = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"c\" /* stream */])([canvas.HOT], __WEBPACK_IMPORTED_MODULE_2_tvs_renderer_dist_lib_utils_context__[\"a\" /* getContext */]);\n    var painter = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([gl.HOT], function (send, gl) {\n        var p = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_renderer_dist_lib_painter__[\"a\" /* create */])(gl);\n        send(p);\n        return p.destroy;\n    })\n        .accept(__WEBPACK_IMPORTED_MODULE_3__utils_predicates__[\"a\" /* unequal */]);\n    var canvasSize = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"c\" /* stream */])([canvas.HOT, windowSizeEntity.HOT], function (canvas) { return ({\n        width: canvas.clientWidth,\n        height: canvas.clientHeight\n    }); });\n    painter.react([canvasSize.HOT], function (p, _) { return p.resize(); }, 'updateSize');\n    if (painterSettings) {\n        painter.react([painterSettings.HOT], function (p, s) { return p.updateDrawSettings(s); });\n    }\n    return { canvas: canvas, painter: painter, gl: gl, canvasSize: canvasSize };\n}\nfunction makeShadeEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var shade = painter.createShade();\n        send(shade);\n        return shade.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\nfunction makeFormEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var form = painter.createForm();\n        send(form);\n        return form.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\nfunction makeSketchEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var sketch = painter.createSketch();\n        send(sketch);\n        return sketch.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\nfunction makeFlatSketchEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var sketch = painter.createFlatSketch();\n        send(sketch);\n        return sketch.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\nfunction makeStaticLayerEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var layer = painter.createStaticLayer();\n        send(layer);\n        return layer.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\nfunction makeDrawingLayerEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var layer = painter.createDrawingLayer();\n        send(layer);\n        return layer.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\nfunction makeEffectLayerEntity(painter, data) {\n    var entity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([painter.HOT], function (send, painter) {\n        var layer = painter.createEffectLayer();\n        send(layer);\n        return layer.destroy;\n    });\n    if (data) {\n        entity.react([data.HOT], function (entity, data) { return entity.update(data); });\n    }\n    return entity;\n}\n\n\n/***/ }),\n\n/***/ 34:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return unequal; });\n/* unused harmony export defined */\n/* unused harmony export notEmpty */\n/* unused harmony export and */\nvar unequal = function (a, b) { return a !== b; };\nvar defined = function (a) { return a != null; };\nvar notEmpty = function (a) { return a && a.length; };\nvar and = function (p1, p2) { return function (a, b) { return p1(a, b) && p2(a, b); }; };\n\n\n/***/ }),\n\n/***/ 35:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export getContext */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = makeClear;\n/* unused harmony export setBlendFunc */\n/* unused harmony export resizeCanvas */\nfunction getContext(canvas) {\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    if (gl == null) {\n        throw Error('Webgl context cannot be initialized');\n    }\n    return gl;\n}\nfunction makeClear(gl) {\n    var clearArray = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        clearArray[_i - 1] = arguments[_i];\n    }\n    return clearArray.reduce(function (res, item) { return res | gl[item.toUpperCase() + '_BUFFER_BIT']; }, 0);\n}\nfunction setBlendFunc(gl, blendOpts) {\n    gl.blendFunc.apply(gl, blendOpts.map(function (opt) { return gl[opt.toUpperCase()]; }));\n}\n/**\n * @param {HTMLCanvasElement} canvas The canvas to resize.\n * @param {number} [multiplier] optional `window.devicePixelRatio`.\n * @return {boolean} true if the canvas was resized.\n */\nfunction resizeCanvas(canvas, multiplier) {\n    if (multiplier === void 0) { multiplier = 1; }\n    multiplier = Math.max(1, multiplier);\n    var width = canvas.clientWidth * multiplier | 0;\n    var height = canvas.clientHeight * multiplier | 0;\n    if (canvas.width !== width ||\n        canvas.height !== height) {\n        canvas.width = width;\n        canvas.height = height;\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=context.js.map\n\n/***/ }),\n\n/***/ 39:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canvas\", function() { return canvas; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"painter\", function() { return painter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"gl\", function() { return gl; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canvasSize\", function() { return canvasSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"settings\", function() { return settings; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_painter_utils__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__events__ = __webpack_require__(15);\n\n\n\nvar canvas = (_a = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_painter_utils__[\"c\" /* makePainterCanvas */])(__WEBPACK_IMPORTED_MODULE_2__events__[\"windowSize\"]), _a.canvas), painter = _a.painter, gl = _a.gl, canvasSize = _a.canvasSize;\nvar settings = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])({\n    clearColor: [0, 0, 0, 1]\n}).reset();\npainter.react([settings.HOT], function (p, settings) { return p.updateDrawSettings(settings); });\nvar _a;\n\n\n/***/ }),\n\n/***/ 65:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"position\", function() { return position; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rotX\", function() { return rotX; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rotY\", function() { return rotY; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rotation\", function() { return rotation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"view\", function() { return view; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"perspectiveSettings\", function() { return perspectiveSettings; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"perspective\", function() { return perspective; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"moveSpeed\", function() { return moveSpeed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lookSpeed\", function() { return lookSpeed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"moveForward\", function() { return moveForward; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"moveLeft\", function() { return moveLeft; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mouseDrag\", function() { return mouseDrag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dragDeltas\", function() { return dragDeltas; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_camera__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__painter__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_gl_matrix__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_gl_matrix___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_gl_matrix__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__events__ = __webpack_require__(15);\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\n\n\n\n\n\n\nvar position = (_a = __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_camera__[\"a\" /* makeFirstPersonView */](), _a.position), rotX = _a.rotX, rotY = _a.rotY, rotation = _a.rotation, view = _a.view;\nposition.val(__WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].fromValues(0, 2, 10));\nvar perspectiveSettings = (_b = __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_vr_flow_camera__[\"b\" /* makePerspective */](__WEBPACK_IMPORTED_MODULE_2__painter__[\"canvasSize\"]), _b.perspectiveSettings), perspective = _b.perspective;\nperspectiveSettings.updateVal(function (s) { return (__assign({}, s, { fovy: Math.PI * 0.4 })); });\nvar moveSpeed = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(0.05);\nvar lookSpeed = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(0.002);\nvar moveForward = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([__WEBPACK_IMPORTED_MODULE_5__events__[\"keys\"].COLD, moveSpeed.COLD, __WEBPACK_IMPORTED_MODULE_5__events__[\"tick\"].HOT], function (send, keys, speed, _) {\n    if (!keys)\n        return;\n    if (keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].UP] || keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].W]) {\n        send(speed);\n    }\n    if (keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].DOWN] || keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].S]) {\n        send(-speed);\n    }\n});\nvar moveLeft = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([__WEBPACK_IMPORTED_MODULE_5__events__[\"keys\"].COLD, moveSpeed.COLD, __WEBPACK_IMPORTED_MODULE_5__events__[\"tick\"].HOT], function (send, keys, speed) {\n    if (!keys)\n        return;\n    if (keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].LEFT] || keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].A]) {\n        send(speed);\n    }\n    if (keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].RIGHT] || keys[__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_keyboard__[\"a\" /* Keys */].D]) {\n        send(-speed);\n    }\n});\nvar mouseDrag = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_5__events__[\"mouse\"].HOT], function (m) { return ({\n    x: m.drag.x,\n    y: m.drag.y\n}); });\nvar dragDeltas = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"c\" /* delta */])(mouseDrag, function (n, o) { return ({\n    x: n.x === 0 ? n.x : o.x - n.x,\n    y: n.y === 0 ? n.y : o.y - n.y\n}); })\n    .accept(function (drag) { return !!(drag && (drag.x || drag.y)); });\nrotX.react([dragDeltas.HOT, lookSpeed.COLD], function (rot, drag, speed) { return rot + drag.y * speed; });\nrotY.react([dragDeltas.HOT, lookSpeed.COLD], function (rot, drag, speed) { return rot + drag.x * speed; });\nposition.react([moveLeft.HOT, rotation.COLD], function (pos, left, rotation) {\n    var v = __WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].fromValues(rotation.rotY[0], rotation.rotY[1], rotation.rotY[2]);\n    return __WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].add(pos, pos, __WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].scale(v, v, -left));\n});\nposition.react([moveForward.HOT, rotation.COLD], function (pos, forward, rotation) {\n    var v = __WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].fromValues(rotation.rotY[8], rotation.rotY[9], rotation.rotY[10]);\n    return __WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].add(pos, pos, __WEBPACK_IMPORTED_MODULE_4_gl_matrix__[\"vec3\"].scale(v, v, -forward));\n});\nvar _a, _b;\n\n\n/***/ }),\n\n/***/ 66:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"size\", function() { return size; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"segments\", function() { return segments; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"geometry\", function() { return geometry; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_geo_3d_box__ = __webpack_require__(29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_geo_3d_box___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_geo_3d_box__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_renderer_dist_lib_utils_stackgl__ = __webpack_require__(30);\n\n\n\nvar size = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([10, 10, 10]);\nvar segments = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([5, 5, 5]);\nvar geometry = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([size.HOT, segments.HOT], function (size, segments) { return Object(__WEBPACK_IMPORTED_MODULE_2_tvs_renderer_dist_lib_utils_stackgl__[\"a\" /* convertStackGLGeometry */])(__WEBPACK_IMPORTED_MODULE_1_geo_3d_box___default()({ size: size, segments: segments })); });\n\n\n/***/ }),\n\n/***/ 67:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"props\", function() { return props; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"geometry\", function() { return geometry; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_renderer_dist_lib_utils_geometry_plane__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n\n\nvar props = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])({\n    width: 10,\n    height: 10,\n    segX: 5,\n    segY: 5\n});\nvar geometry = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([props.HOT], function (props) { return Object(__WEBPACK_IMPORTED_MODULE_0_tvs_renderer_dist_lib_utils_geometry_plane__[\"a\" /* plane */])(props.width, props.height, props.segX, props.segY); });\n\n\n/***/ }),\n\n/***/ 68:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"groundColor\", function() { return groundColor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"groundTransform\", function() { return groundTransform; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightRotation\", function() { return lightRotation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightPosition\", function() { return lightPosition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightColor\", function() { return lightColor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightTransform\", function() { return lightTransform; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_gl_matrix__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_gl_matrix__);\n\n\nvar groundColor = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([0.5, 0.5, 0.5, 1.0]);\nvar groundTransform = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"e\" /* streamStart */])(null, function () {\n    var t = __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].create();\n    __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].rotateX(t, t, Math.PI / 2);\n    __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].scale(t, t, [10, 10, 10]);\n    return t;\n});\nvar lightRotation = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(Math.PI / 6);\nvar lightPosition = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([0, 5, 0]);\nvar lightColor = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([1.0, 1.0, 1.0, 1.0]);\nvar lightTransform = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([lightRotation.HOT, lightPosition.HOT], function (rot, pos) {\n    var t = __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].fromTranslation(__WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].create(), pos);\n    __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].rotateX(t, t, rot);\n    return t;\n});\n\n\n/***/ }),\n\n/***/ 69:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"geoSpec\", function() { return geoSpec; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lightFrag\", function() { return lightFrag; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__geo_vert_glsl__ = __webpack_require__(124);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__geo_vert_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__geo_vert_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__geo_frag_glsl__ = __webpack_require__(125);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__geo_frag_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__geo_frag_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__light_frag_glsl__ = __webpack_require__(126);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__light_frag_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__light_frag_glsl__);\n\n\n\n\nvar geoSpec = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])({\n    vert: __WEBPACK_IMPORTED_MODULE_1__geo_vert_glsl___default.a, frag: __WEBPACK_IMPORTED_MODULE_2__geo_frag_glsl___default.a\n}).reset();\nvar lightFrag = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(__WEBPACK_IMPORTED_MODULE_3__light_frag_glsl___default.a).reset();\n\n\n/***/ })\n\n},[118]);\n\n\n// WEBPACK FOOTER //\n// experiments/area-light/main.js","import { flow, tools } from './flow'\nimport { updateFlow } from 'shared-utils/reload'\n\n\nconst graphModules = require.context('./graph', true, /\\.ts$/)\n\n\nflow.setDebug(true)\n\nupdateFlow(flow, graphModules)\n\ntools.updateFlow(flow)\n\nsetTimeout(function () {\n  flow.setDebug(false)\n}, 1000)\n\n\nif (module.hot) {\n  module.hot.accept((graphModules as any).id, function() {\n    const newGraphModules = require.context('./graph', true, /\\.ts$/)\n    updateFlow(flow, newGraphModules)\n    tools.updateFlow(flow)\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/index.ts","import * as runtime from 'tvs-flow/dist/lib/runtime'\nimport * as tvsTools from 'tvs-flow-tools'\nimport graph from './nodes.json'\n\nexport const flow = runtime.create()\n\nexport const tools = tvsTools.ui.start('area light', { graph })\n\n; (window as any)['flow'] = flow\n; (window as any)['tools'] = tools\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/flow.ts","module.exports = {}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./experiments/area-light/nodes.json\n// module id = 121\n// module chunks = 1","var map = {\n\t\"./camera.ts\": 65,\n\t\"./events.ts\": 15,\n\t\"./geometries/box.ts\": 66,\n\t\"./geometries/plane.ts\": 67,\n\t\"./painter.ts\": 39,\n\t\"./renderer.ts\": 123,\n\t\"./shaders/shaders.ts\": 69,\n\t\"./state.ts\": 68\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 122;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./experiments/area-light/graph \\.ts$\n// module id = 122\n// module chunks = 1","import { stream } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { makeFormEntity, makeShadeEntity, makeSketchEntity, makeDrawingLayerEntity, makeEffectLayerEntity } from 'tvs-libs/lib/vr/flow-painter-utils'\nimport { painter, gl } from './painter'\nimport * as events from './events'\nimport * as camera from './camera'\nimport * as box from './geometries/box'\nimport * as plane from './geometries/plane'\nimport { makeClear } from 'tvs-renderer/dist/lib/utils/context'\nimport { groundTransform, lightTransform, groundColor, lightColor } from './state'\nimport { DrawSettings } from 'tvs-renderer/dist/lib'\nimport { geoSpec, lightFrag } from './shaders/shaders'\n\n\n// Forms\n\nexport const boxForm = makeFormEntity(painter, box.geometry)\n\nexport const planeForm = makeFormEntity(painter, plane.geometry)\n\n\n// Shades\n\nexport const geoShade = makeShadeEntity(painter, geoSpec)\n\n\n// Textures\n\n\n// Sketches\n\nexport const groundSketch = makeSketchEntity(painter)\n.react(\n\t[groundTransform.HOT, groundColor.HOT, geoShade.HOT, planeForm.HOT],\n\t(sketch, transform, color, shade, form) => sketch.update({\n\t\tform, shade,\n\t\tuniforms: {\n\t\t\ttransform,\n\t\t\tcolor\n\t\t}\n\t})\n)\n\n\nexport const lightSketch = makeSketchEntity(painter)\n.react(\n\t[lightTransform.HOT, lightColor.HOT, geoShade.HOT, planeForm.HOT],\n\t(sketch, transform, color, shade, form) => sketch.update({\n\t\tform, shade,\n\t\tuniforms: {\n\t\t\ttransform,\n\t\t\tcolor\n\t\t}\n\t})\n)\n\n\n// Layers\n\n\nexport const drawSettings = stream(\n\t[gl.HOT],\n\tgl => ({\n\t\tclearBits: makeClear(gl, 'color', 'depth')\n\t} as DrawSettings)\n)\n\n\nexport const sceneLayer = makeDrawingLayerEntity(painter)\n.react(\n\t[\n\t\tgl.HOT,\n\t\tlightSketch.HOT,\n\t\tgroundSketch.HOT,\n\t\tcamera.view.COLD,\n\t\tcamera.perspective.COLD,\n\t\tdrawSettings.HOT\n\t],\n\t(layer, gl, light, ground, view, projection, settings) => layer.update({\n\t\tbuffered: true,\n\t\ttextureConfig: {\n\t\t\tcount: 4,\n\t\t\ttype: gl.FLOAT\n\t\t},\n\t\tsketches: [light, ground],\n\t\tdrawSettings: settings,\n\t\tuniforms: {\n\t\t\tview, projection\n\t\t},\n\t\twrap: 'CLAMP_TO_EDGE',\n\t\tminFilter: 'NEAREST',\n\t\tmagFilter: 'NEAREST'\n\t})\n)\n\n\nexport const lightLayer = makeEffectLayerEntity(painter)\n\t.react([\n\t\tcamera.position.HOT,\n\t\tlightTransform.HOT,\n\t\tsceneLayer.HOT,\n\t\tcamera.view.COLD,\n\t\tgl.HOT,\n\t\tlightFrag.HOT\n\t], (layer, eyePosition, lightMat, scene, view, gl, frag) => layer.update({\n\t\tfrag,\n\t\tuniforms: {\n\t\t\teyePosition,\n\t\t\tlightMat,\n\t\t\tview,\n\t\t\tpositions: scene.texture(0),\n\t\t\tnormals: scene.texture(1),\n\t\t\tuvs: scene.texture(2),\n\t\t\tcolors: scene.texture(3)\n\t\t},\n\t\tdrawSettings: {\n\t\t\tdisable: [gl.DEPTH_TEST],\n\t\t\tenable: [gl.BLEND],\n\t\t\tclearBits: makeClear(gl, 'color')\n\t\t}\n\t})\n)\n\n\npainter.react(\n\t[sceneLayer.COLD, lightLayer.COLD, events.tick.HOT],\n\t(p, scene, light) => p.compose(scene, light)\n)\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/renderer.ts","module.exports = \"#define GLSLIFY 1\\nattribute vec3 position;\\nattribute vec3 normal;\\nattribute vec2 uv;\\n\\nuniform mat4 transform;\\nuniform mat4 projection;\\nuniform mat4 view;\\n\\nvarying vec4 vPosition;\\nvarying vec4 vNormal;\\nvarying vec4 vUv;\\n\\nvoid main() {\\n\\tvPosition = transform * vec4(position, 1.0);\\n\\tvNormal = transform * vec4(normal, 0.0);\\n\\tvUv = vec4(uv, 0.0, 0.0);\\n\\tgl_Position = projection * view * vPosition;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./experiments/area-light/graph/shaders/geo-vert.glsl\n// module id = 124\n// module chunks = 1","module.exports = \"#extension GL_EXT_draw_buffers : require\\nprecision highp float;\\n#define GLSLIFY 1\\n\\nuniform vec4 color;\\n\\nvarying vec4 vPosition;\\nvarying vec4 vNormal;\\nvarying vec4 vUv;\\n\\nvoid main() {\\n\\tgl_FragData[0] = vPosition;\\n\\tgl_FragData[1] = vNormal;\\n\\tgl_FragData[2] = vUv;\\n\\tgl_FragData[3] = color;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./experiments/area-light/graph/shaders/geo-frag.glsl\n// module id = 125\n// module chunks = 1","module.exports = \"precision mediump float;\\n#define GLSLIFY 1\\n\\nuniform sampler2D colors;\\nuniform sampler2D positions;\\nuniform sampler2D normals;\\nuniform sampler2D uvs;\\n\\nuniform vec3 eyePosition;\\nuniform mat4 lightMat;\\nuniform mat4 view;\\n\\nvarying vec2 coords;\\n\\n\\nfloat areaLampEnergy(mat4 lampMat, vec3 V, vec3 N, vec3 lampPos, vec2 areaSize) {\\n\\tfloat width = areaSize.x / 2.0;\\n\\tfloat height = areaSize.y / 2.0;\\n\\n\\tvec3 right = normalize(vec3(lampMat * vec4(1.0, 0.0, 0.0, 0.0))); //lamp right axis\\n\\tvec3 up = normalize(vec3(lampMat * vec4(0.0, 1.0, 0.0, 0.0))); //lamp up axis\\n\\tvec3 lampv = normalize(vec3(lampMat * vec4(0.0, 0.0, -1.0, 0.0))); //lamp projection axis\\n\\n\\t/*project onto plane and calculate direction from center to the projection*/\\n\\tfloat dis = dot(lampv, V - lampPos);\\n\\tvec3 projection = V - dis * lampv;\\n\\tvec3 dir = projection - lampPos;\\n\\n\\t/*calculate distance from area*/\\n\\tvec2 diagonal = vec2(dot(dir, right), dot(dir, up));\\n\\tvec2 nearest2D = vec2(clamp(diagonal.x, -width, width), clamp(diagonal.y, -height, height));\\n\\tvec3 nearestPointInside = lampPos + (right * nearest2D.x + up * nearest2D.y);\\n\\n\\tfloat d = distance(V, nearestPointInside); //real distance to area rectangle\\n\\n\\tvec3 L = normalize(nearestPointInside - V);\\n\\n\\tfloat nDotL = clamp(dot(-lampv, L), 0.0, 1.0);\\n\\t//nDotL *= clamp(dot(-N,L),0.0,1.0); //how blender internal works, but too hard falloff\\n\\tnDotL *= clamp(dot(-N, L) * 0.5 + 0.5, 0.0, 1.0); //distribute over hemisphere, looks better. Should be dependant of area size.\\n\\n\\tfloat attenuation = 1.0 / (1.0 + d);\\n\\n\\treturn max(nDotL, 0.0) * attenuation;\\n}\\n\\nvoid areaDiff(vec3 V, vec3 lampPos, vec3 lampVec, vec3 N, mat4 lampMat, float areaSizeX, float areaSizeY, float dist, float k, out float inp) {\\n\\tvec3 vec = V - lampPos;\\n\\tvec2 asize = vec2(areaSizeX, areaSizeY);\\n\\n\\tfloat strength = dist * dist / 4.0;\\n\\n\\tif (dot(vec, lampVec) < 0.0) {\\n\\t\\tinp = 0.0;\\n\\t} else {\\n\\t\\tfloat intens = areaLampEnergy(lampMat, V, N, lampPos, asize);\\n\\t\\tinp = pow(intens * strength, k);\\n\\t}\\n}\\n\\nvoid main() {\\n\\n\\tvec4 position = texture2D(positions, coords);\\n\\tvec4 normal = texture2D(normals, coords);\\n\\tvec4 uv = texture2D(uvs, coords);\\n\\tvec4 color = texture2D(colors, coords);\\n\\n\\tvec3 lightPosition = lightMat[3].xyz;\\n\\tvec3 lightNormal = normalize(lightMat[2].xyz);\\n\\tfloat dist = abs(length(eyePosition - position.xyz));\\n\\n\\tfloat diff = 1.0;\\n\\n\\tareaDiff(position.xyz, lightPosition, lightNormal, normalize(normal.xyz), lightMat, 10.0, 10.0, dist, 1.0, diff);\\n\\t//gl_FragColor = texture2D(colors, coords);\\n\\t//gl_FragColor = vec4((texture2D(normals, coords).xyz + 1.0) / 2.0, 1.0);\\n\\t//gl_FragColor = vec4(color.xyz * diff, 1.0);\\n\\tgl_FragColor = vec4(color.xyz * (lightPosition / 5.0), 1.0);\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./experiments/area-light/graph/shaders/light-frag.glsl\n// module id = 126\n// module chunks = 1","import { asyncStreamStart } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { keyboard } from 'tvs-libs/dist/lib/events/keyboard'\nimport { mouse as getMouse } from 'tvs-libs/dist/lib/events/mouse'\nimport { windowSize as getWindowSize } from 'tvs-libs/dist/lib/events/dom'\nimport { animateWithTPF } from 'tvs-libs/dist/lib/events/animation'\n\n\nexport const tick = asyncStreamStart(null, animateWithTPF)\n\nexport const windowSize = asyncStreamStart(null, getWindowSize)\n\nexport const mouse = asyncStreamStart(null, getMouse)\n\nexport const keys = asyncStreamStart(null, keyboard)\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/events.ts","function _createConfig( properties ) {\n\t\n\tvar config = {\n\t\tsize : [1,1,1],\n\t\tsegments : [1,1,1]\n\t}\n\t\n\tif( properties ) {\n\t\n\t\tif( Array.isArray( properties.size ) ) {\n\t\t\tconfig.size = properties.size\n\t\t} else if( typeof properties.size === \"number\" ) {\n\t\t\tconfig.size = [properties.size, properties.size, properties.size]\n\t\t}\n\t\n\t\tif( Array.isArray( properties.segments ) ) {\n\t\t\tconfig.segments = properties.segments\n\t\t} else if( typeof properties.segments === \"number\" ) {\n\t\t\tconfig.segments = [properties.segments, properties.segments, properties.segments]\n\t\t}\n\t}\n\t\n\treturn config\n}\n\nfunction _flatten( array ) {\n\tvar results = []\n\t\n\tfor( var i=0; i < array.length; i++ ) {\n\t\tvar subarray = array[i]\n\t\tfor( var j=0; j < subarray.length; j++ ) {\n\t\t\tresults.push(subarray[j])\n\t\t}\n\t}\n\treturn results\n}\n\nfunction _generatePanel( config ) {\n\t\t\t\n\tvar rows      = _generateGrid( config )\n\tvar cells     = _generateCells( config, rows )\n\tvar positions = _flatten( rows )\n\tvar uvs       = _generateUvs( config, positions )\n\t\n\treturn {\n\t\tpositions   : positions,\n\t\tcells       : cells,\n\t\tuvs         : uvs,\n\t\tvertexCount : (config.sx + 1) * (config.sy + 1)\n\t}\n}\n\nfunction _generateUvs( config, positions ) {\n\t\n\treturn positions.map(function(p) {\n\t\treturn [\n\t\t\tp[0] / config.wx + 0.5,\n\t\t\tp[1] / config.wy + 0.5\n\t\t]\n\t})\n}\n\nfunction _generateGrid( config ) {\n\t\n\tvar step   = config.wy / config.sy\n\tvar halfY  = config.wy / 2\n\tvar length = config.sy + 1\n\tvar grid   = Array(length)\n\t\n\tfor( var i=0; i < length; i++ ) {\n\t\tgrid[i] = _generateRow( config, step * i - halfY)\n\t}\n\t\n\treturn grid\n}\n\nfunction _generateRow( config, height ) {\n\t\n\tvar halfX  = config.wx / 2\n\tvar step   = config.wx / config.sx\n\tvar length = config.sx + 1\n\tvar row    = Array(length)\n\t\n\tfor( var i=0; i < length; i++ ) {\n\t\trow[i] = [ step * i - halfX, height ]\n\t}\n\t\n\treturn row\n}\n\nfunction _generateCells( config ) {\n\t\n\tfunction index( x, y ) {\n\t\treturn (config.sx + 1) * y + x\n\t}\n\t\n\tvar cells = []\n\t\n\tfor( var x=0; x < config.sx; x++ ) {\n\t\t\n\t\tfor( var y=0; y < config.sy; y++ ) {\n\n\t\t\tvar a = index( x + 0, y + 0 )  //   d __ c\n\t\t\tvar b = index( x + 1, y + 0 )  //    |  |\n\t\t\tvar c = index( x + 1, y + 1 )  //    |__|\n\t\t\tvar d = index( x + 0, y + 1 )  //   a    b\n\t\t\t\n\t\t\tcells.push( [ a, b, c ] )\n\t\t\tcells.push( [ c, d, a ] )\n\t\t}\n\t}\n\t\n\treturn cells\n}\n\nfunction _clonePanel( panel ) {\n\t\n\treturn {\n\t\tpositions   : panel.positions,\n\t\tcells       : panel.cells,\n\t\tuvs         : panel.uvs,\n\t\tvertexCount : panel.vertexCount\n\t}\n}\n\nfunction _generateBoxPanels( config ) {\n\t\n\tvar size = config.size\n\tvar segs = config.segments\n\t\n\t//       yp  zm\n\t//        | /\n\t//        |/\n\t// xm ----+----- xp\n\t//       /|\n\t//      / |\n\t//    zp  ym\n\t\n\tvar zp = _generatePanel({\n\t\twx: size[0], wy: size[1],\n\t\tsx: segs[0], sy: segs[1]\n\t})\n\tvar xp = _generatePanel({\n\t\twx: size[2], wy: size[1],\n\t\tsx: segs[2], sy: segs[1]\n\t})\n\tvar yp = _generatePanel({\n\t\twx: size[0], wy: size[2],\n\t\tsx: segs[0], sy: segs[2]\n\t})\n\t\n\tvar zm = _clonePanel(zp)\n\tvar xm = _clonePanel(xp)\n\tvar ym = _clonePanel(yp)\n\t\n\tzp.positions = zp.positions.map( function(p) { return [       p[0],       p[1],  size[2]/2 ] } )\n\tzm.positions = zm.positions.map( function(p) { return [       p[0],      -p[1], -size[2]/2 ] } )\n\txp.positions = xp.positions.map( function(p) { return [  size[0]/2,      -p[1],       p[0] ] } )\n\txm.positions = xm.positions.map( function(p) { return [ -size[0]/2,       p[1],       p[0] ] } )\n\typ.positions = yp.positions.map( function(p) { return [       p[0],  size[1]/2,      -p[1] ] } )\n\tym.positions = ym.positions.map( function(p) { return [       p[0], -size[1]/2,       p[1] ] } )\n\t\n\tzp.normals = _makeNormals( [ 0, 0, 1], zp.positions.length )\n\tzm.normals = _makeNormals( [ 0, 0,-1], zm.positions.length )\n\txp.normals = _makeNormals( [ 1, 0, 0], xp.positions.length )\n\txm.normals = _makeNormals( [-1, 0, 0], xm.positions.length )\n\typ.normals = _makeNormals( [ 0, 1, 0], yp.positions.length )\n\tym.normals = _makeNormals( [ 0,-1, 0], ym.positions.length )\n\t\n\treturn [ zp, zm, xp, xm, yp, ym ]\n}\n\nfunction _makeNormals( normal, count ) {\n\t\n\tvar normals = Array(count)\n\t\n\tfor( var i=0; i < count; i++ ) {\n\t\tnormals[i] = normal.slice()\n\t}\n\t\n\treturn normals\n}\n\t\nfunction _generateBox( config ) {\n\t\n\tvar panels = _generateBoxPanels( config )\n\t\n\tvar positions = panels.map(function(panel) { return panel.positions })\n\tvar uvs       = panels.map(function(panel) { return panel.uvs       })\n\tvar normals   = panels.map(function(panel) { return panel.normals   })\n\tvar cells     = _offsetCellIndices( panels )\n\t\n\treturn {\n\t\tpositions: _flatten( positions ),\n\t\tuvs:       _flatten( uvs ),\n\t\tcells:     _flatten( cells ),\n\t\tnormals:   _flatten( normals ),\n\t}\n}\n\nfunction _offsetCellIndices( panels ) {\n\t\n\t/*\n\t\tFrom: [[[0,1,2],[2,3,0]],[[0,1,2],[2,3,0]]]\n\t\tTo:   [[[0,1,2],[2,3,0]],[[6,7,8],[8,9,6]]]\n\t*/\n\t\n\tvar offset = 0\n\t\n\treturn panels.map(function(panel) {\n\t\t\n\t\tvar offsetCells = panel.cells.map( function(cell) {\n\t\t\treturn cell.map(function(v) {\n\t\t\t\treturn v + offset\n\t\t\t})\n\t\t})\n\t\n\t\toffset += panel.vertexCount\n\t\n\t\treturn offsetCells\n\t})\n}\n\nmodule.exports = function( properties ) {\n\t\n\tvar config = _createConfig( properties )\n\n\treturn _generateBox( config )\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/geo-3d-box/box.js\n// module id = 29\n// module chunks = 0 1","import * as constants from '../contants';\nexport var STACK_GL_GEOMETRY_PROP_POSITION = 'positions';\nexport var STACK_GL_GEOMETRY_PROP_NORMAL = 'normals';\nexport var STACK_GL_GEOMETRY_PROP_UV = 'uvs';\nexport var STACK_GL_GEOMETRY_PROP_ELEMENTS = 'cells';\nfunction _flatten(array) {\n    var results = [];\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\n        var subarray = array_1[_i];\n        for (var _a = 0, subarray_1 = subarray; _a < subarray_1.length; _a++) {\n            var el = subarray_1[_a];\n            results.push(el);\n        }\n    }\n    return results;\n}\nexport function convertStackGLGeometry(stackglGeometry) {\n    var geometry = {\n        drawType: 'TRIANGLES',\n        attribs: {},\n        itemCount: 0\n    };\n    for (var prop in stackglGeometry) {\n        var arr = stackglGeometry[prop];\n        if (prop === STACK_GL_GEOMETRY_PROP_ELEMENTS) {\n            var buffer = new (arr.length > 65535 ? Uint32Array : Uint16Array)(_flatten(arr));\n            Object.assign(geometry, {\n                elements: { buffer: buffer },\n                itemCount: buffer.length\n            });\n        }\n        else if (prop === STACK_GL_GEOMETRY_PROP_POSITION) {\n            geometry.attribs[constants.GEOMETRY_PROP_POSITION] = {\n                buffer: new Float32Array(_flatten(arr))\n            };\n        }\n        else if (prop === STACK_GL_GEOMETRY_PROP_NORMAL) {\n            geometry.attribs[constants.GEOMETRY_PROP_NORMAL] = {\n                buffer: new Float32Array(_flatten(arr))\n            };\n        }\n        else if (prop === STACK_GL_GEOMETRY_PROP_UV) {\n            geometry.attribs[constants.GEOMETRY_PROP_UV] = {\n                buffer: new Float32Array(_flatten(arr))\n            };\n        }\n        else {\n            geometry.attribs[prop] = { buffer: new Float32Array(_flatten(arr)) };\n        }\n    }\n    return geometry;\n}\n//# sourceMappingURL=stackgl.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../libs/tvs-renderer/dist/lib/utils/stackgl.js\n// module id = 30\n// module chunks = 0 1","export var GEOMETRY_PROP_POSITION = 'position';\nexport var GEOMETRY_PROP_NORMAL = 'normal';\nexport var GEOMETRY_PROP_UV = 'uv';\nexport var UNIFORM_SOURCE_TEXTURE = 'source';\nexport var VARYING_UV_COORDS = 'coords';\nexport var GL_TYPE = {\n    FLOAT: 0x1406,\n    FLOAT_VEC2: 0x8B50,\n    FLOAT_VEC3: 0x8B51,\n    FLOAT_VEC4: 0x8B52,\n    INT: 0x1404,\n    INT_VEC2: 0x8B53,\n    INT_VEC3: 0x8B54,\n    INT_VEC4: 0x8B55,\n    BOOL: 0x8B56,\n    BOOL_VEC2: 0x8B57,\n    BOOL_VEC3: 0x8B58,\n    BOOL_VEC4: 0x8B59,\n    FLOAT_MAT2: 0x8B5A,\n    FLOAT_MAT3: 0x8B5B,\n    FLOAT_MAT4: 0x8B5C,\n    SAMPLER_2D: 0x8B5E,\n    SAMPLER_CUBE: 0x8B60,\n    SAMPLER_3D: 0x8B5F,\n    SAMPLER_2D_SHADOW: 0x8B62,\n    FLOAT_MAT2X3: 0x8B65,\n    FLOAT_MAT2X4: 0x8B66,\n    FLOAT_MAT3X2: 0x8B67,\n    FLOAT_MAT3X4: 0x8B68,\n    FLOAT_MAT4X2: 0x8B69,\n    FLOAT_MAT4X3: 0x8B6A,\n    SAMPLER_2D_ARRAY: 0x8DC1,\n    SAMPLER_2D_ARRAY_SHADOW: 0x8DC4,\n    SAMPLER_CUBE_SHADOW: 0x8DC5,\n    UNSIGNED_INT: 0x1405,\n    UNSIGNED_INT_VEC2: 0x8DC6,\n    UNSIGNED_INT_VEC3: 0x8DC7,\n    UNSIGNED_INT_VEC4: 0x8DC8,\n    INT_SAMPLER_2D: 0x8DCA,\n    INT_SAMPLER_3D: 0x8DCB,\n    INT_SAMPLER_CUBE: 0x8DCC,\n    INT_SAMPLER_2D_ARRAY: 0x8DCF,\n    UNSIGNED_INT_SAMPLER_2D: 0x8DD2,\n    UNSIGNED_INT_SAMPLER_3D: 0x8DD3,\n    UNSIGNED_INT_SAMPLER_CUBE: 0x8DD4,\n    UNSIGNED_INT_SAMPLER_2D_ARRAY: 0x8DD7,\n    TEXTURE_2D: 0x0DE1,\n    TEXTURE_CUBE_MAP: 0x8513,\n    TEXTURE_3D: 0x806F,\n    TEXTURE_2D_ARRAY: 0x8C1A,\n    BYTE: 0x1400,\n    UNSIGNED_BYTE: 0x1401,\n    SHORT: 0x1402,\n    UNSIGNED_SHORT: 0x1403,\n    UNSIGNED_SHORT_4_4_4_4: 0x8033,\n    UNSIGNED_SHORT_5_5_5_1: 0x8034,\n    UNSIGNED_SHORT_5_6_5: 0x8363,\n    HALF_FLOAT: 0x140B,\n    UNSIGNED_INT_2_10_10_10_REV: 0x8368,\n    UNSIGNED_INT_10F_11F_11F_REV: 0x8C3B,\n    UNSIGNED_INT_5_9_9_9_REV: 0x8C3E,\n    FLOAT_32_UNSIGNED_INT_24_8_REV: 0x8DAD,\n    UNSIGNED_INT_24_8: 0x84FA\n};\n//# sourceMappingURL=contants.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../libs/tvs-renderer/dist/lib/contants.js\n// module id = 31\n// module chunks = 0 1","import { EntityRef, asyncStreamStart, stream, asyncStream } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { WindowSizeState } from '../events/dom'\nimport { create } from 'tvs-renderer/dist/lib/painter'\nimport { getContext } from 'tvs-renderer/dist/lib/utils/context'\nimport { Painter, Shade, Form, Sketch, Layer, GL, SketchData, LayerData, ShadeData, FormData, DrawSettings } from 'tvs-renderer/dist/lib/render-types'\nimport { unequal } from '../utils/predicates'\n\n\nexport function makePainterCanvas (\n\twindowSizeEntity: EntityRef<WindowSizeState>,\n\tpainterSettings?: EntityRef<DrawSettings>\n) {\n\n\tconst canvas = asyncStreamStart<HTMLCanvasElement>(\n\t\tnull,\n\t\t(send) => {\n\n\t\t\tconst canvas = document.createElement('canvas')\n\t\t\tdocument.body.appendChild(canvas)\n\n\t\t\tsend(canvas)\n\n\t\t\treturn () => {\n\t\t\t\tdocument.body.removeChild(canvas)\n\t\t\t}\n\t\t}\n\t)\n\n\tconst gl = stream([canvas.HOT], getContext)\n\n\tconst painter = asyncStream<Painter, GL>(\n\t\t[gl.HOT],\n\t\t(send, gl) => {\n\t\t\tconst p = create(gl)\n\t\t\tsend(p)\n\t\t\treturn p.destroy\n\t\t}\n\t)\n\t.accept(unequal)\n\n\tconst canvasSize = stream(\n\t\t[canvas.HOT, windowSizeEntity.HOT],\n\t\t(canvas: HTMLCanvasElement) => ({\n\t\t\twidth: canvas.clientWidth,\n\t\t\theight: canvas.clientHeight\n\t\t})\n\t)\n\n\tpainter.react(\n\t\t[canvasSize.HOT],\n\t\t(p, _) => p.resize(),\n\t\t'updateSize'\n\t)\n\n\tif (painterSettings) {\n\t\tpainter.react([painterSettings.HOT], (p, s) => p.updateDrawSettings(s))\n\t}\n\n\treturn { canvas, painter, gl, canvasSize }\n}\n\n\nexport function makeShadeEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<ShadeData>\n): EntityRef<Shade> {\n\tconst entity = asyncStream<Shade, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst shade = painter.createShade()\n\t\t\tsend(shade)\n\t\t\treturn shade.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react(\n\t\t\t[data.HOT],\n\t\t\t(entity, data) => entity.update(data)\n\t\t)\n\t}\n\n\treturn entity\n}\n\nexport function makeFormEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<FormData>\n): EntityRef<Form> {\n\tconst entity = asyncStream<Form, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst form = painter.createForm()\n\t\t\tsend(form)\n\t\t\treturn form.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react(\n\t\t\t[data.HOT],\n\t\t\t(entity, data) => entity.update(data)\n\t\t)\n\t}\n\n\treturn entity\n}\n\nexport function makeSketchEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<SketchData>\n): EntityRef<Sketch> {\n\tconst entity = asyncStream<Sketch, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst sketch = painter.createSketch()\n\t\t\tsend(sketch)\n\t\t\treturn sketch.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react( [data.HOT], (entity, data) => entity.update(data))\n\t}\n\n\treturn entity\n}\n\nexport function makeFlatSketchEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<SketchData>\n): EntityRef<Sketch> {\n\tconst entity = asyncStream<Sketch, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst sketch = painter.createFlatSketch()\n\t\t\tsend(sketch)\n\t\t\treturn sketch.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react( [data.HOT], (entity, data) => entity.update(data))\n\t}\n\n\treturn entity\n}\n\nexport function makeStaticLayerEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<LayerData>\n): EntityRef<Layer> {\n\tconst entity = asyncStream<Layer, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst layer = painter.createStaticLayer()\n\t\t\tsend(layer)\n\t\t\treturn layer.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react( [data.HOT], (entity, data) => entity.update(data))\n\t}\n\n\treturn entity\n}\n\nexport function makeDrawingLayerEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<LayerData>\n): EntityRef<Layer> {\n\tconst entity = asyncStream<Layer, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst layer = painter.createDrawingLayer()\n\t\t\tsend(layer)\n\t\t\treturn layer.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react( [data.HOT], (entity, data) => entity.update(data))\n\t}\n\n\treturn entity\n}\n\nexport function makeEffectLayerEntity (\n\tpainter: EntityRef<Painter>,\n\tdata?: EntityRef<LayerData>\n): EntityRef<Layer> {\n\tconst entity = asyncStream<Layer, Painter>(\n\t\t[painter.HOT],\n\t\t(send, painter) => {\n\t\t\tconst layer = painter.createEffectLayer()\n\t\t\tsend(layer)\n\t\t\treturn layer.destroy\n\t\t}\n\t)\n\n\tif (data) {\n\t\tentity.react( [data.HOT], (entity, data) => entity.update(data))\n\t}\n\n\treturn entity\n}\n\n\n\n// WEBPACK FOOTER //\n// ../libs/tvs-libs/lib/vr/flow-painter-utils.ts","export type Predicate1 = (a: any) => boolean\nexport type Predicate2 = (a: any, b: any) => boolean\n\n\nexport const unequal: Predicate2 = (a, b) => a !== b\n\nexport const defined: Predicate1 = a => a != null\n\nexport const notEmpty: Predicate1 = a => a && a.length\n\nexport const and = (p1: Predicate2, p2: Predicate2): Predicate2 => (a, b) => p1(a, b) && p2(a, b)\n\n\n\n// WEBPACK FOOTER //\n// ../libs/tvs-libs/lib/utils/predicates.ts","export function getContext(canvas) {\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    if (gl == null) {\n        throw Error('Webgl context cannot be initialized');\n    }\n    return gl;\n}\nexport function makeClear(gl) {\n    var clearArray = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        clearArray[_i - 1] = arguments[_i];\n    }\n    return clearArray.reduce(function (res, item) { return res | gl[item.toUpperCase() + '_BUFFER_BIT']; }, 0);\n}\nexport function setBlendFunc(gl, blendOpts) {\n    gl.blendFunc.apply(gl, blendOpts.map(function (opt) { return gl[opt.toUpperCase()]; }));\n}\n/**\n * @param {HTMLCanvasElement} canvas The canvas to resize.\n * @param {number} [multiplier] optional `window.devicePixelRatio`.\n * @return {boolean} true if the canvas was resized.\n */\nexport function resizeCanvas(canvas, multiplier) {\n    if (multiplier === void 0) { multiplier = 1; }\n    multiplier = Math.max(1, multiplier);\n    var width = canvas.clientWidth * multiplier | 0;\n    var height = canvas.clientHeight * multiplier | 0;\n    if (canvas.width !== width ||\n        canvas.height !== height) {\n        canvas.width = width;\n        canvas.height = height;\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=context.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../libs/tvs-renderer/dist/lib/utils/context.js\n// module id = 35\n// module chunks = 0 1","import { val } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { makePainterCanvas } from 'tvs-libs/dist/lib/vr/flow-painter-utils'\nimport * as events from './events'\nimport { DrawSettings } from 'tvs-renderer/dist/lib'\n\n\nexport const {canvas, painter, gl, canvasSize} =\n\tmakePainterCanvas(events.windowSize)\n\n\nexport const settings = val<DrawSettings>({\n\tclearColor: [0, 0, 0, 1]\n}).reset()\n\n\npainter.react(\n\t[settings.HOT],\n\t(p, settings) => p.updateDrawSettings(settings)\n)\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/painter.ts","import { val, asyncStream, EntityRef, delta, stream } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport * as flowCamera from 'tvs-libs/dist/lib/vr/flow-camera'\nimport { canvasSize } from './painter'\nimport { Keys } from 'tvs-libs/dist/lib/events/keyboard'\nimport { vec3 } from 'gl-matrix'\nimport { keys, tick, mouse } from './events'\n\n\nexport const {\n\tposition, rotX, rotY, rotation, view\n} = flowCamera.makeFirstPersonView()\n\n\nposition.val(vec3.fromValues(0, 2, 10))\n\n\nexport const {\n\tperspectiveSettings, perspective\n} = flowCamera.makePerspective(canvasSize)\n\n\nperspectiveSettings.updateVal(s => ({ ...s, fovy: Math.PI * 0.4 }))\n\n\nexport const moveSpeed = val(0.05)\n\nexport const lookSpeed = val(0.002)\n\n\nexport const moveForward: EntityRef<number> = asyncStream(\n\t[keys.COLD, moveSpeed.COLD, tick.HOT],\n\t(send, keys, speed, _) => {\n\t\tif (!keys) return\n\t\tif (keys[Keys.UP] || keys[Keys.W]) {\n\t\t\tsend(speed)\n\t\t}\n\t\tif (keys[Keys.DOWN] || keys[Keys.S]) {\n\t\t\tsend(-speed)\n\t\t}\n\t}\n)\n\n\nexport const moveLeft: EntityRef<number> = asyncStream(\n\t[keys.COLD, moveSpeed.COLD, tick.HOT],\n\t(send, keys, speed) => {\n\n\t\tif (!keys) return\n\t\tif (keys[Keys.LEFT] || keys[Keys.A]) {\n\t\t\tsend(speed)\n\t\t}\n\t\tif (keys[Keys.RIGHT] || keys[Keys.D]) {\n\t\t\tsend(-speed)\n\t\t}\n\t}\n)\n\n\nexport const mouseDrag = stream(\n\t[mouse.HOT], m => ({\n\t\tx: m.drag.x,\n\t\ty: m.drag.y\n\t})\n)\n\n\nexport const dragDeltas = delta(mouseDrag, (n, o) => ({\n\tx: n.x === 0 ? n.x : o.x - n.x,\n\ty: n.y === 0 ? n.y : o.y - n.y\n}))\n.accept(drag => !!(drag && (drag.x || drag.y)))\n\n\nrotX.react(\n\t[dragDeltas.HOT, lookSpeed.COLD],\n\t(rot, drag, speed) => rot + drag.y * speed\n)\n\n\nrotY.react(\n\t[dragDeltas.HOT, lookSpeed.COLD],\n\t(rot, drag, speed) => rot + drag.x * speed\n)\n\nposition.react(\n\t[moveLeft.HOT, rotation.COLD],\n\t(pos, left, rotation) => {\n\t\tconst v = vec3.fromValues(rotation.rotY[0], rotation.rotY[1], rotation.rotY[2])\n\t\treturn vec3.add(pos, pos, vec3.scale(v, v, -left))\n\t}\n)\n\nposition.react(\n\t[moveForward.HOT, rotation.COLD],\n\t(pos, forward, rotation) => {\n\t\tconst v = vec3.fromValues(rotation.rotY[8], rotation.rotY[9], rotation.rotY[10])\n\t\treturn vec3.add(pos, pos, vec3.scale(v, v, -forward))\n\t}\n)\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/camera.ts","import { val, stream } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport box from 'geo-3d-box'\nimport { convertStackGLGeometry } from 'tvs-renderer/dist/lib/utils/stackgl'\n\n\nexport const size = val([10, 10, 10])\n\nexport const segments = val([5, 5, 5])\n\n\nexport const geometry = stream(\n  [size.HOT, segments.HOT],\n  (size, segments) => convertStackGLGeometry(box({ size, segments }))\n)\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/geometries/box.ts","import { plane } from 'tvs-renderer/dist/lib/utils/geometry/plane'\nimport { val, stream } from 'tvs-flow/dist/lib/utils/entity-reference'\n\n\nexport const props = val({\n  width: 10,\n  height: 10,\n  segX: 5,\n  segY: 5\n})\n\n\nexport const geometry = stream(\n  [props.HOT],\n  props => plane(props.width, props.height, props.segX, props.segY)\n)\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/geometries/plane.ts","import { stream, streamStart, val } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { mat4 } from 'gl-matrix'\n\n\nexport const groundColor = val([0.5, 0.5, 0.5, 1.0])\n\nexport const groundTransform = streamStart(null, () => {\n\tconst t = mat4.create()\n\tmat4.rotateX(t, t, Math.PI / 2)\n\tmat4.scale(t, t, [10, 10, 10])\n\treturn t\n})\n\nexport const lightRotation = val(Math.PI / 6)\nexport const lightPosition = val([0, 5, 0])\n\nexport const lightColor = val([1.0, 1.0, 1.0, 1.0])\n\nexport const lightTransform = stream(\n\t[lightRotation.HOT, lightPosition.HOT],\n\t(rot, pos) => {\n\t\tconst t = mat4.fromTranslation(mat4.create(), pos)\n\t\tmat4.rotateX(t, t, rot)\n\t\treturn t\n\t})\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/state.ts","import { val } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport vert from './geo-vert.glsl'\nimport frag from './geo-frag.glsl'\nimport light from './light-frag.glsl'\n\n\nexport const geoSpec = val({\n\tvert, frag\n}).reset()\n\n\nexport const lightFrag = val(light).reset()\n\n\n\n// WEBPACK FOOTER //\n// ./experiments/area-light/graph/shaders/shaders.ts"],"sourceRoot":""}