{"version":3,"sources":["webpack:///tiles/main.js","webpack:///./tiles/index.ts","webpack:///./tiles/flow.ts","webpack:///./tiles/graph \\.ts$","webpack:///./shared-utils/animation.ts","webpack:///./tiles/graph/view/renderer.ts","webpack:///./tiles/graph/view/shaders/base-vert.glsl","webpack:///./tiles/graph/view/shaders/base-frag.glsl","webpack:///./tiles/graph/events.ts","webpack:///../libs/tvs-libs/dist/lib/math/geometry.js","webpack:///./tiles/graph/state/constants.ts","webpack:///./tiles/graph/view/camera.ts","webpack:///./tiles/graph/view/context.ts","webpack:///../libs/tvs-libs/dist/lib/utils/sequence.js","webpack:///../libs/tvs-libs/dist/lib/math/core.js","webpack:///./tiles/graph/state/tiles.ts","webpack:///./tiles/graph/view/geometries/plane.ts","webpack:///./tiles/graph/view/shaders/base.ts","webpack:///./tiles/graph/state/init.ts"],"names":["webpackJsonp","110","module","exports","__webpack_require__","111","__webpack_exports__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__flow__","__WEBPACK_IMPORTED_MODULE_1_shared_utils_reload__","graphModules","setDebug","setTimeout","112","d","flow","__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_runtime__","__WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__","n","tools","start","window","113","webpackContext","req","webpackContextResolve","id","map","Error","./events.ts","./state/constants.ts","./state/init.ts","./state/tiles.ts","./view/camera.ts","./view/context.ts","./view/geometries/plane.ts","./view/renderer.ts","./view/shaders/base.ts","keys","resolve","114","createAnimation","_a","_b","duration","_c","easeFn","linear","_d","delay","onComplete","onUpdate","progress","oldValue","step","Math","min","newValue","115","settings","shade","form","textures","tilesData","tilesSketch","sceneData","scene","render","__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__","__WEBPACK_IMPORTED_MODULE_1__context__","__WEBPACK_IMPORTED_MODULE_2__geometries_plane__","__WEBPACK_IMPORTED_MODULE_3__state_tiles__","__WEBPACK_IMPORTED_MODULE_4__state_init__","__WEBPACK_IMPORTED_MODULE_5__shaders_base__","__WEBPACK_IMPORTED_MODULE_6__events__","__WEBPACK_IMPORTED_MODULE_7__camera__","__WEBPACK_IMPORTED_MODULE_8_tvs_libs_dist_lib_vr_flow_painter_utils__","HOT","gl","clearColor","enable","DEPTH_TEST","CULL_FACE","react","painter","updateDrawSettings","imgs","reduce","obj","key","img","createStaticLayer","update","minFilter","magFilter","asset","tiles","uniforms","tile","transform","image","tileSpecId","texture","color","connections","view","projection","sketches","COLD","_","compose","116","117","14","tick","windowSize","mouse","__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_events_keyboard__","__WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_events_mouse__","__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_dom__","__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_events_animation__","__WEBPACK_IMPORTED_MODULE_5__state_init__","23","planeFromNormalAndCoplanarPoint","point","__WEBPACK_IMPORTED_MODULE_0_gl_matrix__","dot","fromValues","mirrorMatrixFromPlane","plane","a","b","c","getYawQuat","quat","rotYAngle","sin","cos","getRollQuat","rotZAngle","36","specs","sets","lbA1","file","lbA2","lbA3","lbB1","lbB2","lbB3","lrA1","lrB1","lrC1","lrD1","lrD2","lrD3","lrE1","lrE2","lrE3","lrtbA1","lrtbB1","lrtbC1","ltbA1","ltbB1","37","perspectiveSettings","perspective","distance","__WEBPACK_IMPORTED_MODULE_0__context__","__WEBPACK_IMPORTED_MODULE_1_gl_matrix__","__WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_vr_flow_camera__","__WEBPACK_IMPORTED_MODULE_3_tvs_flow_dist_lib_utils_entity_reference__","__assign","this","assign","t","s","i","arguments","length","p","prototype","hasOwnProperty","call","updateVal","fovy","PI","create","m","dist","fromTranslation","aspect","invert","38","canvas","canvasSize","__WEBPACK_IMPORTED_MODULE_0_tvs_libs_dist_lib_vr_flow_painter_utils__","__WEBPACK_IMPORTED_MODULE_1__events__","4","pickRandom","arr","__WEBPACK_IMPORTED_MODULE_0__math_core__","doTimes","count","fn","yieldTimes","push","zip","as","bs","result","6","randInt","int","floor","random","normalRand","62","rotateHalf","part","smooth","acc","slow","pow","animationDuration","animationChance","liftHeight","sinkHeight","flipped","colCount","rowCount","createTileState","grid","activeTiles","updateActiveTiles","__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__","__WEBPACK_IMPORTED_MODULE_2_gl_matrix__","__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_math_geometry__","__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__","__WEBPACK_IMPORTED_MODULE_5__events__","__WEBPACK_IMPORTED_MODULE_6__init__","__WEBPACK_IMPORTED_MODULE_7__view_camera__","__WEBPACK_IMPORTED_MODULE_8__constants__","__WEBPACK_IMPORTED_MODULE_9_shared_utils_animation__","SIDES_INDEX","UP","RIGHT","DOWN","LEFT","dens","size","width","cols","camera","ceil","set","baseColor","r","g","turn","gridIndex","pos","posOffset","tileSpec","yawDirection","yawDelay","yaw","rollDirection","roll","height","rotation","updateTransform","neighbours","connected","connectionAnimations","newWidth","newHeight","heightDiff","widthDiff","up_1","down_1","forEach","row","unshift","apply","left","right","currentHeight_1","max","x","y","rows","firstLeftIndex","firstUpIndex","widthDelta","activeCols","activeRows","offX","offY","iX","iY","chance","offset","rotateAnimation","rot","undefined","riseAnimation","rise","flipAnimation","i_1","index","side","neighbour","neighbourSide","i_2","multiply","fromRotationTranslation","63","segments","geometry","__WEBPACK_IMPORTED_MODULE_0_tvs_renderer_dist_lib_utils_geometry_plane__","__WEBPACK_IMPORTED_MODULE_1__state_init__","__WEBPACK_IMPORTED_MODULE_2_tvs_flow_dist_lib_utils_entity_reference__","seg","64","spec","__WEBPACK_IMPORTED_MODULE_0__base_vert_glsl__","__WEBPACK_IMPORTED_MODULE_0__base_vert_glsl___default","__WEBPACK_IMPORTED_MODULE_1__base_frag_glsl__","__WEBPACK_IMPORTED_MODULE_1__base_frag_glsl___default","vert","frag","reset","7","tileSize","tileDensity","images","__WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_utils_sequence__","__WEBPACK_IMPORTED_MODULE_3__constants__","send","Promise","all","res","Image","onload","src","then"],"mappings":"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","file":"tiles/main.js","sourcesContent":["webpackJsonp([2],{\n\n/***/ 110:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(111);\n\n\n/***/ }),\n\n/***/ 111:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__flow__ = __webpack_require__(112);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_shared_utils_reload__ = __webpack_require__(18);\n\n\nvar graphModules = __webpack_require__(113);\n__WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */].setDebug(true);\nObject(__WEBPACK_IMPORTED_MODULE_1_shared_utils_reload__[\"a\" /* updateFlow */])(__WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */], graphModules);\nsetTimeout(function () {\n    __WEBPACK_IMPORTED_MODULE_0__flow__[\"a\" /* flow */].setDebug(false);\n}, 1000);\nif (false) {\n    tools.updateFlow(flow);\n    module.hot.accept(graphModules.id, function () {\n        var newGraphModules = require.context('./graph', true, /\\.ts$/);\n        updateFlow(flow, newGraphModules);\n        tools.updateFlow(flow);\n    });\n}\n\n\n/***/ }),\n\n/***/ 112:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return flow; });\n/* unused harmony export tools */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_runtime__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__);\n\n\nvar flow = __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_runtime__[\"a\" /* create */]();\nvar tools = __WEBPACK_IMPORTED_MODULE_1_tvs_flow_tools__[\"ui\"].start('tiles');\nwindow['flow'] = flow;\nwindow['tools'] = tools;\n\n\n/***/ }),\n\n/***/ 113:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar map = {\n\t\"./events.ts\": 14,\n\t\"./state/constants.ts\": 36,\n\t\"./state/init.ts\": 7,\n\t\"./state/tiles.ts\": 62,\n\t\"./view/camera.ts\": 37,\n\t\"./view/context.ts\": 38,\n\t\"./view/geometries/plane.ts\": 63,\n\t\"./view/renderer.ts\": 115,\n\t\"./view/shaders/base.ts\": 64\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 113;\n\n/***/ }),\n\n/***/ 114:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export linear */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = createAnimation;\nvar linear = function (step) { return step; };\nfunction createAnimation(_a) {\n    var _b = _a.duration, duration = _b === void 0 ? 1000 : _b, _c = _a.easeFn, easeFn = _c === void 0 ? linear : _c, _d = _a.delay, delay = _d === void 0 ? 0 : _d, onComplete = _a.onComplete, onUpdate = _a.onUpdate;\n    var progress = -delay;\n    var oldValue = 0;\n    return function animate(step) {\n        if (progress >= duration) {\n            return 0;\n        }\n        if (progress < 0) {\n            progress += Math.min(step, -progress);\n            return 0;\n        }\n        var newValue = (progress < duration - step)\n            ? easeFn((progress + step) / duration)\n            : easeFn(1);\n        var value = newValue - oldValue;\n        progress += step;\n        oldValue = newValue;\n        if (onUpdate)\n            onUpdate(value);\n        if (progress >= duration && onComplete) {\n            onComplete();\n        }\n        return value;\n    };\n}\n\n\n/***/ }),\n\n/***/ 115:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"settings\", function() { return settings; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"shade\", function() { return shade; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"form\", function() { return form; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"textures\", function() { return textures; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tilesData\", function() { return tilesData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tilesSketch\", function() { return tilesSketch; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sceneData\", function() { return sceneData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"scene\", function() { return scene; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"render\", function() { return render; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__context__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__geometries_plane__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__state_tiles__ = __webpack_require__(62);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__state_init__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shaders_base__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__events__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__camera__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_tvs_libs_dist_lib_vr_flow_painter_utils__ = __webpack_require__(11);\n\n\n\n\n\n\n\n\n\nvar settings = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_1__context__[\"gl\"].HOT], function (gl) { return ({\n    clearColor: [1, 1, 1, 1],\n    enable: [gl.DEPTH_TEST, gl.CULL_FACE]\n}); });\n__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"].react([settings.HOT], function (painter, settings) { return painter.updateDrawSettings(settings); });\nvar shade = Object(__WEBPACK_IMPORTED_MODULE_8_tvs_libs_dist_lib_vr_flow_painter_utils__[\"d\" /* makeShadeEntity */])(__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"], __WEBPACK_IMPORTED_MODULE_5__shaders_base__[\"spec\"]);\nvar form = Object(__WEBPACK_IMPORTED_MODULE_8_tvs_libs_dist_lib_vr_flow_painter_utils__[\"b\" /* makeFormEntity */])(__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"], __WEBPACK_IMPORTED_MODULE_2__geometries_plane__[\"geometry\"]);\nvar textures = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"].HOT, __WEBPACK_IMPORTED_MODULE_4__state_init__[\"images\"].HOT], function (painter, imgs) { return imgs.reduce(function (obj, _a) {\n    var key = _a[0], img = _a[1];\n    obj[key] = painter.createStaticLayer().update({\n        minFilter: 'LINEAR',\n        magFilter: 'LINEAR',\n        asset: img\n    });\n    return obj;\n}, {}); });\nvar tilesData = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([\n    form.HOT,\n    shade.HOT,\n    textures.HOT,\n    __WEBPACK_IMPORTED_MODULE_3__state_tiles__[\"activeTiles\"].HOT\n], function (form, shade, textures, tiles) { return ({\n    form: form, shade: shade,\n    uniforms: tiles.map(function (tile) { return ({\n        transform: tile.transform,\n        image: textures[tile.tileSpecId].texture(),\n        color: tile.color,\n        connections: tile.connections\n    }); })\n}); });\nvar tilesSketch = Object(__WEBPACK_IMPORTED_MODULE_8_tvs_libs_dist_lib_vr_flow_painter_utils__[\"e\" /* makeSketchEntity */])(__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"], tilesData);\nvar sceneData = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([\n    tilesSketch.HOT,\n    __WEBPACK_IMPORTED_MODULE_7__camera__[\"view\"].HOT,\n    __WEBPACK_IMPORTED_MODULE_7__camera__[\"perspective\"].HOT\n], function (tiles, view, projection) { return ({\n    sketches: [tiles],\n    uniforms: {\n        view: view,\n        projection: projection\n    }\n}); });\nvar scene = Object(__WEBPACK_IMPORTED_MODULE_8_tvs_libs_dist_lib_vr_flow_painter_utils__[\"a\" /* makeDrawingLayerEntity */])(__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"], sceneData);\nvar render = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_1__context__[\"painter\"].COLD, scene.COLD, __WEBPACK_IMPORTED_MODULE_6__events__[\"tick\"].HOT], function (painter, scene, _) { return painter.compose(scene); });\n\n\n/***/ }),\n\n/***/ 116:\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nattribute vec3 position;\\nattribute vec2 uv;\\n\\nuniform mat4 transform;\\nuniform mat4 projection;\\nuniform mat4 view;\\n\\nvarying vec2 vUv;\\n\\nvoid main() {\\n\\tvUv = uv;\\n\\tgl_Position = projection * view * transform * vec4(position, 1.0);\\n}\\n\"\n\n/***/ }),\n\n/***/ 117:\n/***/ (function(module, exports) {\n\nmodule.exports = \"precision mediump float;\\n#define GLSLIFY 1\\n\\nuniform sampler2D image;\\nuniform vec3 color;\\nuniform vec4 connections;\\n\\nvarying vec2 vUv;\\n\\nvoid main() {\\n  vec4 tex = texture2D(image, vUv);\\n  if (tex.r > 0.9) {\\n    discard;\\n  }\\n\\n  float up = 0.0;\\n  float right = 0.0;\\n  float down = 0.0;\\n  float left = 0.0;\\n  float x = vUv.x - 0.5;\\n  float y = vUv.y;\\n\\n  if (connections[0] > 0.0) {\\n    up = x * x * 2.0 + y * y * 2.0;\\n    up = 1.0 - up;\\n    up = max(0.0, up);\\n    up *= up;\\n  }\\n\\n  if (connections[1] > 0.0) {\\n    x = vUv.x - 1.0;\\n    y = vUv.y - 0.5;\\n    right = x * x * 2.0 + y * y * 2.0;\\n    right = 1.0 - right;\\n    right = max(0.0, right);\\n    right *= right;\\n  }\\n\\n  if (connections[2] > 0.0) {\\n    x = vUv.x - 0.5;\\n    y = vUv.y - 1.0;\\n    down = x * x * 2.0 + y * y * 2.0;\\n    down = 1.0 - down;\\n    down = max(0.0, down);\\n    down *= down;\\n  }\\n\\n  if (connections[3] > 0.0) {\\n    x = vUv.x;\\n    y = vUv.y - 0.5;\\n    left = x * x * 2.0 + y * y * 2.0;\\n    left = 1.0 - left;\\n    left = max(0.0, left);\\n    left *= left;\\n  }\\n\\n  // smooth out border\\n  /* col /= resolution.x * resolution.y * 0.5; */\\n  /* col = sqrt(col); */\\n\\n\\tfloat glow = up + right + left + down;\\n\\n\\tvec3 result = 0.8 - color.rgb * (1.0 - tex.r);\\n\\tfloat red = result.r;\\n\\n\\tif (abs(tex.g - tex.r) > 0.1 && tex.g > 0.9) {\\n\\t\\tred = mix(red, 1.0, glow);\\n\\t}\\n\\n  gl_FragColor = vec4(red, result.gb, 1.0);\\n  // gl_FragColor = vec4(color, 1.0);\\n  // gl_FragColor = connections;\\n}\\n\"\n\n/***/ }),\n\n/***/ 14:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tick\", function() { return tick; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"windowSize\", function() { return windowSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mouse\", function() { return mouse; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"keys\", function() { return keys; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_events_keyboard__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_events_mouse__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_dom__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_events_animation__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__state_init__ = __webpack_require__(7);\n\n\n\n\n\n\nvar tick = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([__WEBPACK_IMPORTED_MODULE_5__state_init__[\"images\"].HOT], __WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_events_animation__[\"a\" /* animateWithTPF */]);\nvar windowSize = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_events_dom__[\"a\" /* windowSize */]);\nvar mouse = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_events_mouse__[\"a\" /* mouse */]);\nvar keys = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"b\" /* asyncStreamStart */])(null, __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_events_keyboard__[\"b\" /* keyboard */]);\n\n\n/***/ }),\n\n/***/ 23:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = planeFromNormalAndCoplanarPoint;\n/* unused harmony export planeFromThreeCoplanarPoints */\n/* unused harmony export normalFromThreeCoplanarPoints */\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = mirrorMatrixFromPlane;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = getYawQuat;\n/* unused harmony export getPitchQuat */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = getRollQuat;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_gl_matrix__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_gl_matrix___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_gl_matrix__);\n\nfunction planeFromNormalAndCoplanarPoint(n, point) {\n    var d = -__WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].dot(n, point);\n    return __WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec4\"].fromValues(n[0], n[1], n[2], d);\n}\nfunction planeFromThreeCoplanarPoints(p1, p2, p3) {\n    return planeFromNormalAndCoplanarPoint(normalFromThreeCoplanarPoints(p1, p2, p3), p1);\n}\nfunction normalFromThreeCoplanarPoints(p1, p2, p3) {\n    var n = __WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].cross(__WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].create(), __WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].sub(__WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].create(), p3, p2), __WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].sub(__WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].create(), p1, p2));\n    return __WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"vec3\"].normalize(n, n);\n}\nfunction mirrorMatrixFromPlane(plane) {\n    var _a = plane, a = _a[0], b = _a[1], c = _a[2], d = _a[3];\n    return __WEBPACK_IMPORTED_MODULE_0_gl_matrix__[\"mat4\"].fromValues(1 - 2 * a * a, -2 * a * b, -2 * a * c, 0, -2 * a * b, 1 - 2 * b * b, -2 * b * c, 0, -2 * a * c, -2 * b * c, 1 - 2 * c * c, 0, -2 * a * d, -2 * b * d, -2 * c * d, 1);\n}\nfunction getYawQuat(quat, rotYAngle) {\n    rotYAngle *= 0.5;\n    quat[0] = 0;\n    quat[1] = Math.sin(rotYAngle);\n    quat[2] = 0;\n    quat[3] = Math.cos(rotYAngle);\n    return quat;\n}\nfunction getPitchQuat(quat, rotXAngle) {\n    rotXAngle *= 0.5;\n    quat[0] = Math.sin(rotXAngle);\n    quat[1] = 0;\n    quat[2] = 0;\n    quat[3] = Math.cos(rotXAngle);\n    return quat;\n}\nfunction getRollQuat(quat, rotZAngle) {\n    rotZAngle *= 0.5;\n    quat[0] = 0;\n    quat[1] = 0;\n    quat[2] = Math.sin(rotZAngle);\n    quat[3] = Math.cos(rotZAngle);\n    return quat;\n}\n//# sourceMappingURL=geometry.js.map\n\n/***/ }),\n\n/***/ 36:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"specs\", function() { return specs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sets\", function() { return sets; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n\nvar specs = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])({\n    lbA1: {\n        file: 'tile_lb_A_1',\n        connections: [0, 0, 1, 1]\n    },\n    lbA2: {\n        file: 'tile_lb_A_2',\n        connections: [0, 0, 1, 1]\n    },\n    lbA3: {\n        file: 'tile_lb_A_3',\n        connections: [0, 0, 1, 1]\n    },\n    lbB1: {\n        file: 'tile_lb_B_1',\n        connections: [0, 0, 1, 1]\n    },\n    lbB2: {\n        file: 'tile_lb_B_2',\n        connections: [0, 0, 1, 1]\n    },\n    lbB3: {\n        file: 'tile_lb_B_3',\n        connections: [0, 0, 1, 1]\n    },\n    lrA1: {\n        file: 'tile_lr_A_1',\n        connections: [0, 1, 0, 1]\n    },\n    lrB1: {\n        file: 'tile_lr_B_1',\n        connections: [0, 1, 0, 1]\n    },\n    lrC1: {\n        file: 'tile_lr_C_1',\n        connections: [0, 1, 0, 1]\n    },\n    lrD1: {\n        file: 'tile_lr_D_1',\n        connections: [0, 1, 0, 1]\n    },\n    lrD2: {\n        file: 'tile_lr_D_2',\n        connections: [0, 1, 0, 1]\n    },\n    lrD3: {\n        file: 'tile_lr_D_3',\n        connections: [0, 1, 0, 1]\n    },\n    lrE1: {\n        file: 'tile_lr_E_1',\n        connections: [0, 1, 0, 1]\n    },\n    lrE2: {\n        file: 'tile_lr_E_2',\n        connections: [0, 1, 0, 1]\n    },\n    lrE3: {\n        file: 'tile_lr_E_3',\n        connections: [0, 1, 0, 1]\n    },\n    lrtbA1: {\n        file: 'tile_lrtb_A_1',\n        connections: [1, 1, 1, 1]\n    },\n    lrtbB1: {\n        file: 'tile_lrtb_B_1',\n        connections: [1, 1, 1, 1]\n    },\n    lrtbC1: {\n        file: 'tile_lrtb_C_1',\n        connections: [1, 1, 1, 1]\n    },\n    ltbA1: {\n        file: 'tile_ltb_A_1',\n        connections: [1, 0, 1, 1]\n    },\n    ltbB1: {\n        file: 'tile_ltb_B_1',\n        connections: [1, 0, 1, 1]\n    }\n});\nvar sets = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([{\n        lbA1: 1,\n        lbA2: 1,\n        lbA3: 1,\n        lbB1: 1,\n        lbB2: 1,\n        lbB3: 1,\n        lrD1: 1,\n        lrD2: 1,\n        lrD3: 1,\n        lrE1: 1,\n        lrE2: 1,\n        lrE3: 1,\n        lrtbA1: 1,\n        lrtbB1: 1,\n        lrtbC1: 1,\n        ltbA1: 1,\n        ltbB1: 1\n    }]);\n\n\n/***/ }),\n\n/***/ 37:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"perspectiveSettings\", function() { return perspectiveSettings; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"perspective\", function() { return perspective; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"distance\", function() { return distance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"view\", function() { return view; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__context__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_gl_matrix__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_gl_matrix__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_vr_flow_camera__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\n\n\n\n\nvar perspectiveSettings = (_a = Object(__WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_vr_flow_camera__[\"b\" /* makePerspective */])(__WEBPACK_IMPORTED_MODULE_0__context__[\"canvasSize\"]), _a.perspectiveSettings), perspective = _a.perspective;\nperspectiveSettings.updateVal(function (s) { return (__assign({}, s, { fovy: Math.PI * 0.5 })); });\nvar distance = Object(__WEBPACK_IMPORTED_MODULE_3_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(103);\nvar view = Object(__WEBPACK_IMPORTED_MODULE_3_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(__WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].create())\n    .react([perspectiveSettings.HOT, distance.HOT], function (m, settings, dist) {\n    __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].fromTranslation(m, [0, 0, dist / settings.aspect]);\n    __WEBPACK_IMPORTED_MODULE_1_gl_matrix__[\"mat4\"].invert(m, m);\n    return m;\n});\nvar _a;\n\n\n/***/ }),\n\n/***/ 38:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canvas\", function() { return canvas; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canvasSize\", function() { return canvasSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"painter\", function() { return painter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"gl\", function() { return gl; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_libs_dist_lib_vr_flow_painter_utils__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__events__ = __webpack_require__(14);\n\n\nvar canvas = (_a = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_libs_dist_lib_vr_flow_painter_utils__[\"c\" /* makePainterCanvas */])(__WEBPACK_IMPORTED_MODULE_1__events__[\"windowSize\"]), _a.canvas), canvasSize = _a.canvasSize, painter = _a.painter, gl = _a.gl;\nvar _a;\n\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = pickRandom;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = doTimes;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = yieldTimes;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = zip;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__math_core__ = __webpack_require__(6);\n\nfunction pickRandom(arr) {\n    return arr[Object(__WEBPACK_IMPORTED_MODULE_0__math_core__[\"b\" /* randInt */])(arr.length)];\n}\nfunction doTimes(count, fn) {\n    for (var i = 0; i < count; i++) {\n        fn(i);\n    }\n}\nfunction yieldTimes(count, fn) {\n    var arr = [];\n    doTimes(count, function (i) { return arr.push(fn(i)); });\n    return arr;\n}\nfunction zip(as, bs, fn) {\n    var length = Math.min(as.length, bs.length);\n    var result = [];\n    for (var i = 0; i < length; i++) {\n        result.push(fn(as[i], bs[i]));\n    }\n    return result;\n}\n//# sourceMappingURL=sequence.js.map\n\n/***/ }),\n\n/***/ 6:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export DEG_TO_RAD_FACTOR */\n/* unused harmony export sign */\n/* unused harmony export lerp */\n/* unused harmony export clamp */\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = randInt;\n/* unused harmony export randIntInRange */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = normalRand;\n/* unused harmony export degToRad */\nvar DEG_TO_RAD_FACTOR = Math.PI / 180;\nfunction sign(num) {\n    if (num > 0) {\n        return 1;\n    }\n    else if (num < 0) {\n        return -1;\n    }\n    else {\n        return 0;\n    }\n}\nfunction lerp(start, end, step) {\n    return start + step * (end - start);\n}\nfunction clamp(value, min, max) {\n    return Math.max(min, Math.min(value, max));\n}\nfunction randInt(int) {\n    return Math.floor(Math.random() * int);\n}\nfunction randIntInRange(from, to) {\n    return randInt(to - from) + from;\n}\nfunction normalRand() {\n    return (Math.random() + Math.random() + Math.random()) / 3;\n}\nfunction degToRad(degrees) {\n    return degrees * DEG_TO_RAD_FACTOR;\n}\n//# sourceMappingURL=core.js.map\n\n/***/ }),\n\n/***/ 62:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"animationDuration\", function() { return animationDuration; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"animationChance\", function() { return animationChance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"liftHeight\", function() { return liftHeight; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sinkHeight\", function() { return sinkHeight; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"flipped\", function() { return flipped; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"colCount\", function() { return colCount; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rowCount\", function() { return rowCount; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createTileState\", function() { return createTileState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"grid\", function() { return grid; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"activeTiles\", function() { return activeTiles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateActiveTiles\", function() { return updateActiveTiles; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_gl_matrix__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_gl_matrix___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_gl_matrix__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_math_geometry__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__events__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__init__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__view_camera__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__constants__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_utils_animation__ = __webpack_require__(114);\n\n\n\n\n\n\n\n\n\n\nfunction rotateHalf(part) {\n    return -Math.cos(part * Math.PI * 2) * 0.5 + 0.5;\n}\nfunction smooth(part) {\n    return -Math.cos(part * Math.PI) * 0.5 + 0.5;\n}\nfunction acc(part) {\n    return part * part * part * part;\n}\nfunction slow(part) {\n    return Math.pow(part, 0.25);\n}\nvar SIDES_INDEX = {\n    UP: 0,\n    RIGHT: 1,\n    DOWN: 2,\n    LEFT: 3\n};\nvar animationDuration = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(1700);\nvar animationChance = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(0.0001);\nvar liftHeight = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(2);\nvar sinkHeight = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(-50);\nvar flipped = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(false);\nvar colCount = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_6__init__[\"tileDensity\"].HOT, __WEBPACK_IMPORTED_MODULE_5__events__[\"windowSize\"].HOT], function (dens, size) { return Math.floor(Math.pow(size.width / 1000, 0.5) * dens); });\nvar rowCount = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([colCount.HOT, __WEBPACK_IMPORTED_MODULE_7__view_camera__[\"perspectiveSettings\"].HOT], function (cols, camera) { return Math.ceil(cols / camera.aspect); });\n__WEBPACK_IMPORTED_MODULE_7__view_camera__[\"distance\"].react([colCount.HOT, __WEBPACK_IMPORTED_MODULE_6__init__[\"tileSize\"].HOT], function (_, cols, size) { return cols * size * 0.47; });\nvar createTileState = function (set, baseColor, specs) {\n    var r = baseColor[0], g = baseColor[1], b = baseColor[2];\n    var color = [\n        r + (Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"a\" /* normalRand */])() - 0.6) * 0.25,\n        g + (Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"a\" /* normalRand */])() - 0.6) * 0.25,\n        b + (Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"a\" /* normalRand */])() - 0.6) * 0.25\n    ];\n    var turn = Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"b\" /* randInt */])(3);\n    var tileSpecId = Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"b\" /* pickRandom */])(Object.keys(set));\n    return {\n        gridIndex: [0, 0],\n        pos: [0, 0],\n        posOffset: [0, 0],\n        tileSpecId: tileSpecId,\n        tileSpec: specs[tileSpecId],\n        turn: turn,\n        flipped: false,\n        yawDirection: 0,\n        yawDelay: 0,\n        yaw: 0,\n        rollDirection: 0,\n        roll: turn * Math.PI / 2,\n        height: 0,\n        color: color,\n        transform: __WEBPACK_IMPORTED_MODULE_2_gl_matrix__[\"mat4\"].create(),\n        rotation: __WEBPACK_IMPORTED_MODULE_2_gl_matrix__[\"quat\"].create(),\n        updateTransform: false,\n        neighbours: [],\n        connected: false,\n        connections: [0, 0, 0, 0],\n        connectionAnimations: []\n    };\n};\nvar grid = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([[]])\n    .react([\n    colCount.HOT,\n    rowCount.HOT,\n    __WEBPACK_IMPORTED_MODULE_6__init__[\"color\"].HOT,\n    __WEBPACK_IMPORTED_MODULE_6__init__[\"set\"].HOT,\n    __WEBPACK_IMPORTED_MODULE_8__constants__[\"specs\"].HOT\n], function (grid, newWidth, newHeight, color, set, specs) {\n    var width = grid.length;\n    var height = grid[0].length;\n    var heightDiff = newHeight - height;\n    var widthDiff = newWidth - width;\n    if (heightDiff > 0) {\n        var up_1 = Math.floor(heightDiff / 2);\n        var down_1 = heightDiff - up_1;\n        grid.forEach(function (row) {\n            row.unshift.apply(row, Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"c\" /* yieldTimes */])(up_1, function () { return createTileState(set, color, specs); }));\n        });\n        grid.forEach(function (row) {\n            Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"a\" /* doTimes */])(down_1, function () { return row.push(createTileState(set, color, specs)); });\n        });\n    }\n    if (widthDiff > 0) {\n        var left = Math.floor(widthDiff / 2);\n        var right = widthDiff - left;\n        var currentHeight_1 = Math.max(newHeight, height);\n        grid.unshift.apply(grid, Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"c\" /* yieldTimes */])(left, function () {\n            return Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"c\" /* yieldTimes */])(currentHeight_1, function () { return createTileState(set, color, specs); });\n        }));\n        Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"a\" /* doTimes */])(right, function () {\n            return grid.push(Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"c\" /* yieldTimes */])(currentHeight_1, function () { return createTileState(set, color, specs); }));\n        });\n    }\n    if (widthDiff > 0 || heightDiff > 0) {\n        for (var x = 0; x < grid.length; x++) {\n            for (var y = 0; y < grid[x].length; y++) {\n                var tile = grid[x][y];\n                tile.gridIndex = [x, y];\n                tile.neighbours[SIDES_INDEX.LEFT] = grid[x - 1] && grid[x - 1][y];\n                tile.neighbours[SIDES_INDEX.RIGHT] = grid[x + 1] && grid[x + 1][y];\n                tile.neighbours[SIDES_INDEX.UP] = grid[x][y - 1];\n                tile.neighbours[SIDES_INDEX.DOWN] = grid[x][y + 1];\n            }\n        }\n    }\n    return grid;\n});\nvar activeTiles = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([\n    grid.HOT,\n    colCount.HOT,\n    rowCount.HOT\n], function (grid, cols, rows) {\n    var tiles = [];\n    var width = grid.length;\n    var height = grid[0].length;\n    var firstLeftIndex = -Math.floor(width / 2);\n    var firstUpIndex = -Math.floor(height / 2);\n    var widthDelta = width - cols;\n    var activeCols = Math.floor(widthDelta / 2);\n    if ((width + 1) % 2 && widthDelta % 2)\n        activeCols++;\n    var activeRows = Math.floor((height - rows) / 2);\n    var offX = ((cols + 1) % 2) * 0.5;\n    var offY = (rows % 2) * 0.5 + 0.5;\n    Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"a\" /* doTimes */])(cols, function (x) {\n        Object(__WEBPACK_IMPORTED_MODULE_4_tvs_libs_dist_lib_utils_sequence__[\"a\" /* doTimes */])(rows, function (y) {\n            var tile = grid[x + activeCols][y + activeRows];\n            var _a = tile.gridIndex, iX = _a[0], iY = _a[1];\n            tile.posOffset = [offX, offY];\n            tile.updateTransform = true;\n            tile.yawDelay = (x + (rows - y + 1)) * 100;\n            tile.pos = [firstLeftIndex + iX, firstUpIndex + iY];\n            tile.connected = !!(tile.height < 0.1 && tile.height > -0.1);\n            tiles.push(tile);\n        });\n    });\n    return tiles;\n});\nvar updateActiveTiles = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([\n    activeTiles.COLD,\n    __WEBPACK_IMPORTED_MODULE_5__events__[\"tick\"].HOT,\n    animationDuration.COLD,\n    animationChance.COLD,\n    liftHeight.COLD,\n    sinkHeight.COLD,\n    __WEBPACK_IMPORTED_MODULE_6__init__[\"tileSize\"].COLD,\n    flipped.COLD\n], function (tiles, tick, duration, chance, liftHeight, sinkHeight, size, flipped) {\n    var offset = size * 0.95;\n    var _loop_1 = function (i) {\n        var tile = tiles[i];\n        if (!tile.rotateAnimation && Math.random() < chance) {\n            tile.rollDirection = 1;\n            tile.connected = false;\n            tile.rotateAnimation = Object(__WEBPACK_IMPORTED_MODULE_9_shared_utils_animation__[\"a\" /* createAnimation */])({\n                duration: duration,\n                easeFn: smooth,\n                onUpdate: function (rot) {\n                    tile.roll += rot * Math.PI / 2 * tile.rollDirection;\n                    tile.updateTransform = true;\n                },\n                onComplete: function () {\n                    tile.rotateAnimation = undefined;\n                }\n            });\n            tile.riseAnimation = Object(__WEBPACK_IMPORTED_MODULE_9_shared_utils_animation__[\"a\" /* createAnimation */])({\n                duration: duration,\n                easeFn: rotateHalf,\n                onUpdate: function (rise) {\n                    tile.height += rise * liftHeight;\n                    tile.updateTransform = true;\n                },\n                onComplete: function () {\n                    tile.riseAnimation = undefined;\n                    tile.connected = true;\n                    tile.turn = tile.rollDirection > 0 ?\n                        (tile.turn + 1) % 4 :\n                        tile.rollDirection < 0 ?\n                            (tile.turn + 3) % 4 :\n                            tile.turn;\n                }\n            });\n        }\n        if (flipped !== tile.flipped && !tile.flipAnimation) {\n            tile.connected = false;\n            tile.flipAnimation = Object(__WEBPACK_IMPORTED_MODULE_9_shared_utils_animation__[\"a\" /* createAnimation */])({\n                duration: duration,\n                easeFn: flipped ? acc : slow,\n                delay: tile.yawDelay,\n                onUpdate: function (rot) {\n                    tile.yaw += rot * Math.PI;\n                    tile.height += rot * sinkHeight * (tile.flipped ? -1 : 1);\n                    tile.updateTransform = true;\n                },\n                onComplete: function () {\n                    tile.flipAnimation = undefined;\n                    tile.flipped = !tile.flipped;\n                    tile.connected = !tile.rotateAnimation;\n                    tile.connected = true;\n                }\n            });\n        }\n        tile.rotateAnimation && tile.rotateAnimation(tick);\n        tile.riseAnimation && tile.riseAnimation(tick);\n        tile.flipAnimation && tile.flipAnimation(tick);\n        if (tile.connected) {\n            for (var i_1 = 0; i_1 < 4; i_1++) {\n                var index = (i_1 + 4 - tile.turn) % 4;\n                var side = tile.tileSpec.connections[index];\n                var neighbour = tile.neighbours[i_1];\n                if (neighbour && neighbour.connected) {\n                    var neighbourSide = neighbour.tileSpec.connections[(i_1 + 6 - neighbour.turn) % 4];\n                    tile.connections[index] = side && neighbourSide;\n                }\n                else {\n                    tile.connections[index] = 0;\n                }\n            }\n        }\n        else {\n            for (var i_2 = 0; i_2 < 4; i_2++) {\n                tile.connections[i_2] = 0;\n            }\n        }\n        if (tile.updateTransform) {\n            tile.updateTransform = false;\n            __WEBPACK_IMPORTED_MODULE_2_gl_matrix__[\"quat\"].multiply(tile.rotation, Object(__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_math_geometry__[\"b\" /* getYawQuat */])(__WEBPACK_IMPORTED_MODULE_2_gl_matrix__[\"quat\"].create(), tile.yaw), Object(__WEBPACK_IMPORTED_MODULE_3_tvs_libs_dist_lib_math_geometry__[\"a\" /* getRollQuat */])(__WEBPACK_IMPORTED_MODULE_2_gl_matrix__[\"quat\"].create(), tile.roll));\n            var _a = tile.pos, x = _a[0], y = _a[1];\n            var _b = tile.posOffset, offX = _b[0], offY = _b[1];\n            __WEBPACK_IMPORTED_MODULE_2_gl_matrix__[\"mat4\"].fromRotationTranslation(tile.transform, tile.rotation, [(x + offX) * offset, (y + offY) * offset, tile.height]);\n        }\n    };\n    for (var i in tiles) {\n        _loop_1(i);\n    }\n    return tiles;\n});\n\n\n/***/ }),\n\n/***/ 63:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"segments\", function() { return segments; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"geometry\", function() { return geometry; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_renderer_dist_lib_utils_geometry_plane__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__state_init__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n\n\n\nvar segments = Object(__WEBPACK_IMPORTED_MODULE_2_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(3);\nvar geometry = Object(__WEBPACK_IMPORTED_MODULE_2_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_1__state_init__[\"tileSize\"].HOT, segments.HOT], function (size, seg) { return Object(__WEBPACK_IMPORTED_MODULE_0_tvs_renderer_dist_lib_utils_geometry_plane__[\"a\" /* plane */])(size, size, seg, seg); });\n\n\n/***/ }),\n\n/***/ 64:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"spec\", function() { return spec; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_vert_glsl__ = __webpack_require__(116);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_vert_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__base_vert_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_frag_glsl__ = __webpack_require__(117);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_frag_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__base_frag_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n\n\n\nvar spec = Object(__WEBPACK_IMPORTED_MODULE_2_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])({\n    vert: __WEBPACK_IMPORTED_MODULE_0__base_vert_glsl___default.a, frag: __WEBPACK_IMPORTED_MODULE_1__base_frag_glsl___default.a\n}).reset();\n\n\n/***/ }),\n\n/***/ 7:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tileSize\", function() { return tileSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tileDensity\", function() { return tileDensity; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"color\", function() { return color; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"set\", function() { return set; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"images\", function() { return images; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_utils_sequence__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__constants__ = __webpack_require__(36);\n\n\n\n\nvar tileSize = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(10);\nvar tileDensity = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])(11);\nvar color = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"f\" /* val */])([Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"a\" /* normalRand */])(), Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"a\" /* normalRand */])(), Object(__WEBPACK_IMPORTED_MODULE_1_tvs_libs_dist_lib_math_core__[\"a\" /* normalRand */])()]);\nvar set = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"d\" /* stream */])([__WEBPACK_IMPORTED_MODULE_3__constants__[\"sets\"].HOT], __WEBPACK_IMPORTED_MODULE_2_tvs_libs_dist_lib_utils_sequence__[\"b\" /* pickRandom */]);\nvar images = Object(__WEBPACK_IMPORTED_MODULE_0_tvs_flow_dist_lib_utils_entity_reference__[\"a\" /* asyncStream */])([__WEBPACK_IMPORTED_MODULE_3__constants__[\"specs\"].HOT, set.HOT], function (send, specs, set) {\n    Promise.all(Object.keys(set).map(function (key) { return new Promise(function (res) {\n        var img = new Image();\n        img.onload = function () { res([key, img]); };\n        img.src = 'img/' + specs[key].file + '.jpg';\n    }); }))\n        .then(send);\n});\n\n\n/***/ })\n\n},[110]);\n\n\n// WEBPACK FOOTER //\n// tiles/main.js","import { flow, tools } from './flow'\nimport { updateFlow } from 'shared-utils/reload'\n\n\nconst graphModules = require.context('./graph', true, /\\.ts$/)\n\n\nflow.setDebug(true)\n\nupdateFlow(flow, graphModules)\n\n\nsetTimeout(function () {\n  flow.setDebug(false)\n}, 1000)\n\n\nif (module.hot) {\n\ttools.updateFlow(flow)\n  module.hot.accept((graphModules as any).id, function() {\n    const newGraphModules = require.context('./graph', true, /\\.ts$/)\n    updateFlow(flow, newGraphModules)\n    tools.updateFlow(flow)\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/index.ts","import * as runtime from 'tvs-flow/dist/lib/runtime'\nimport * as tvsTools from 'tvs-flow-tools'\n\nexport const flow = runtime.create()\n\nexport const tools = tvsTools.ui.start('tiles')\n\nwindow['flow'] = flow\nwindow['tools'] = tools\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/flow.ts","var map = {\n\t\"./events.ts\": 14,\n\t\"./state/constants.ts\": 36,\n\t\"./state/init.ts\": 7,\n\t\"./state/tiles.ts\": 62,\n\t\"./view/camera.ts\": 37,\n\t\"./view/context.ts\": 38,\n\t\"./view/geometries/plane.ts\": 63,\n\t\"./view/renderer.ts\": 115,\n\t\"./view/shaders/base.ts\": 64\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 113;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./tiles/graph \\.ts$\n// module id = 113\n// module chunks = 2","export interface AnimationOptions {\n\tduration?: number\n\teaseFn?: (step: number) => number\n\tdelay?: number\n\tonUpdate?: (step: number) => void\n\tonComplete?: () => void\n}\n\n\nexport interface Animation {\n\t(step: number): number\n}\n\n\nexport const linear = (step: number) => step\n\n\nexport function createAnimation ({\n\tduration = 1000,\n\teaseFn = linear,\n\tdelay = 0,\n\tonComplete,\n\tonUpdate\n}: AnimationOptions) {\n\n\tlet progress = -delay\n\tlet oldValue = 0\n\n\treturn function animate (step: number) {\n\n\t\tif (progress >= duration) {\n\t\t\treturn 0\n\t\t}\n\n\t\tif (progress < 0) {\n\t\t\tprogress += Math.min(step, -progress)\n\t\t\treturn 0\n\t\t}\n\n\t\tconst newValue = (progress < duration - step)\n\t\t\t? easeFn((progress + step) / duration)\n\t\t\t:\teaseFn(1)\n\n\t\tconst value = newValue - oldValue\n\t\tprogress += step\n\t\toldValue = newValue\n\n\t\tif (onUpdate) onUpdate(value)\n\n\t\tif (progress >= duration && onComplete) {\n\t\t\tonComplete()\n\t\t}\n\t\treturn value\n\n\t} as Animation\n}\n\n\n\n// WEBPACK FOOTER //\n// ./shared-utils/animation.ts","import { stream } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { painter, gl } from './context'\nimport * as plane from './geometries/plane'\nimport * as tiles from '../state/tiles'\nimport * as init from '../state/init'\nimport * as shader from './shaders/base'\nimport * as events from '../events'\nimport * as camera from './camera'\nimport { makeShadeEntity, makeFormEntity, makeSketchEntity, makeDrawingLayerEntity } from 'tvs-libs/dist/lib/vr/flow-painter-utils'\nimport { Layer, LayerData, DrawSettings } from 'tvs-renderer/dist/lib'\n\n\n// ===== Settings =====\n\nexport const settings = stream(\n\t[gl.HOT],\n\tgl => ({\n\t\tclearColor: [1, 1, 1, 1],\n\t\tenable: [gl.DEPTH_TEST, gl.CULL_FACE]\n\t} as DrawSettings))\n\n\npainter.react(\n\t[settings.HOT],\n\t(painter, settings) => painter.updateDrawSettings(settings)\n)\n\n\n// ===== shaders =====\n\nexport const shade = makeShadeEntity(painter, shader.spec)\n\n\n// ===== geometries =====\n\nexport const form = makeFormEntity(painter, plane.geometry)\n\n\n// ===== textures =====\n\nexport const textures = stream(\n\t[painter.HOT, init.images.HOT],\n\t(painter, imgs) => imgs.reduce((obj, [key, img]) => {\n\t\tobj[key] = painter.createStaticLayer().update({\n\t\t\tminFilter: 'LINEAR',\n\t\t\tmagFilter: 'LINEAR',\n\t\t\tasset: img\n\t\t})\n\t\treturn obj\n\t}, {} as {[key: string]: Layer})\n)\n\n\n// ===== objects =====\n\nexport const tilesData = stream(\n\t[\n\t\tform.HOT,\n\t\tshade.HOT,\n\t\ttextures.HOT,\n\t\ttiles.activeTiles.HOT\n\t],\n\t(form, shade, textures, tiles) => ({\n\t\tform, shade,\n\t\tuniforms: tiles.map(tile => ({\n\t\t\ttransform: tile.transform,\n\t\t\timage: textures[tile.tileSpecId].texture(),\n\t\t\tcolor: tile.color,\n\t\t\tconnections: tile.connections\n\t\t}))\n\t})\n)\n\nexport const tilesSketch = makeSketchEntity(painter, tilesData)\n\n\n// ===== layers =====\n\nexport const sceneData = stream(\n\t[\n\t\ttilesSketch.HOT,\n\t\tcamera.view.HOT,\n\t\tcamera.perspective.HOT\n\t],\n\t(tiles, view, projection) => ({\n\t\tsketches: [tiles],\n\t\tuniforms: {\n\t\t\tview,\n\t\t\tprojection\n\t\t}\n\t} as LayerData)\n)\n\nexport const scene = makeDrawingLayerEntity(painter, sceneData)\n\n\n// ===== render =====\n\nexport const render = stream(\n\t[painter.COLD, scene.COLD, events.tick.HOT],\n\t(painter, scene, _) => painter.compose(scene)\n)\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/view/renderer.ts","module.exports = \"#define GLSLIFY 1\\nattribute vec3 position;\\nattribute vec2 uv;\\n\\nuniform mat4 transform;\\nuniform mat4 projection;\\nuniform mat4 view;\\n\\nvarying vec2 vUv;\\n\\nvoid main() {\\n\\tvUv = uv;\\n\\tgl_Position = projection * view * transform * vec4(position, 1.0);\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./tiles/graph/view/shaders/base-vert.glsl\n// module id = 116\n// module chunks = 2","module.exports = \"precision mediump float;\\n#define GLSLIFY 1\\n\\nuniform sampler2D image;\\nuniform vec3 color;\\nuniform vec4 connections;\\n\\nvarying vec2 vUv;\\n\\nvoid main() {\\n  vec4 tex = texture2D(image, vUv);\\n  if (tex.r > 0.9) {\\n    discard;\\n  }\\n\\n  float up = 0.0;\\n  float right = 0.0;\\n  float down = 0.0;\\n  float left = 0.0;\\n  float x = vUv.x - 0.5;\\n  float y = vUv.y;\\n\\n  if (connections[0] > 0.0) {\\n    up = x * x * 2.0 + y * y * 2.0;\\n    up = 1.0 - up;\\n    up = max(0.0, up);\\n    up *= up;\\n  }\\n\\n  if (connections[1] > 0.0) {\\n    x = vUv.x - 1.0;\\n    y = vUv.y - 0.5;\\n    right = x * x * 2.0 + y * y * 2.0;\\n    right = 1.0 - right;\\n    right = max(0.0, right);\\n    right *= right;\\n  }\\n\\n  if (connections[2] > 0.0) {\\n    x = vUv.x - 0.5;\\n    y = vUv.y - 1.0;\\n    down = x * x * 2.0 + y * y * 2.0;\\n    down = 1.0 - down;\\n    down = max(0.0, down);\\n    down *= down;\\n  }\\n\\n  if (connections[3] > 0.0) {\\n    x = vUv.x;\\n    y = vUv.y - 0.5;\\n    left = x * x * 2.0 + y * y * 2.0;\\n    left = 1.0 - left;\\n    left = max(0.0, left);\\n    left *= left;\\n  }\\n\\n  // smooth out border\\n  /* col /= resolution.x * resolution.y * 0.5; */\\n  /* col = sqrt(col); */\\n\\n\\tfloat glow = up + right + left + down;\\n\\n\\tvec3 result = 0.8 - color.rgb * (1.0 - tex.r);\\n\\tfloat red = result.r;\\n\\n\\tif (abs(tex.g - tex.r) > 0.1 && tex.g > 0.9) {\\n\\t\\tred = mix(red, 1.0, glow);\\n\\t}\\n\\n  gl_FragColor = vec4(red, result.gb, 1.0);\\n  // gl_FragColor = vec4(color, 1.0);\\n  // gl_FragColor = connections;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./tiles/graph/view/shaders/base-frag.glsl\n// module id = 117\n// module chunks = 2","import { asyncStream, asyncStreamStart } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { keyboard } from 'tvs-libs/dist/lib/events/keyboard'\nimport { mouse as getMouse } from 'tvs-libs/dist/lib/events/mouse'\nimport { windowSize as getWindowSize } from 'tvs-libs/dist/lib/events/dom'\nimport { animateWithTPF } from 'tvs-libs/dist/lib/events/animation'\nimport * as init from './state/init'\n\n\nexport const tick = asyncStream([init.images.HOT], animateWithTPF)\n\nexport const windowSize = asyncStreamStart(null, getWindowSize)\n\nexport const mouse = asyncStreamStart(null, getMouse)\n\nexport const keys = asyncStreamStart(null, keyboard)\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/events.ts","import { vec3, vec4, mat4 } from 'gl-matrix';\nexport function planeFromNormalAndCoplanarPoint(n, point) {\n    var d = -vec3.dot(n, point);\n    return vec4.fromValues(n[0], n[1], n[2], d);\n}\nexport function planeFromThreeCoplanarPoints(p1, p2, p3) {\n    return planeFromNormalAndCoplanarPoint(normalFromThreeCoplanarPoints(p1, p2, p3), p1);\n}\nexport function normalFromThreeCoplanarPoints(p1, p2, p3) {\n    var n = vec3.cross(vec3.create(), vec3.sub(vec3.create(), p3, p2), vec3.sub(vec3.create(), p1, p2));\n    return vec3.normalize(n, n);\n}\nexport function mirrorMatrixFromPlane(plane) {\n    var _a = plane, a = _a[0], b = _a[1], c = _a[2], d = _a[3];\n    return mat4.fromValues(1 - 2 * a * a, -2 * a * b, -2 * a * c, 0, -2 * a * b, 1 - 2 * b * b, -2 * b * c, 0, -2 * a * c, -2 * b * c, 1 - 2 * c * c, 0, -2 * a * d, -2 * b * d, -2 * c * d, 1);\n}\nexport function getYawQuat(quat, rotYAngle) {\n    rotYAngle *= 0.5;\n    quat[0] = 0;\n    quat[1] = Math.sin(rotYAngle);\n    quat[2] = 0;\n    quat[3] = Math.cos(rotYAngle);\n    return quat;\n}\nexport function getPitchQuat(quat, rotXAngle) {\n    rotXAngle *= 0.5;\n    quat[0] = Math.sin(rotXAngle);\n    quat[1] = 0;\n    quat[2] = 0;\n    quat[3] = Math.cos(rotXAngle);\n    return quat;\n}\nexport function getRollQuat(quat, rotZAngle) {\n    rotZAngle *= 0.5;\n    quat[0] = 0;\n    quat[1] = 0;\n    quat[2] = Math.sin(rotZAngle);\n    quat[3] = Math.cos(rotZAngle);\n    return quat;\n}\n//# sourceMappingURL=geometry.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../libs/tvs-libs/dist/lib/math/geometry.js\n// module id = 23\n// module chunks = 0 2","import { val } from 'tvs-flow/dist/lib/utils/entity-reference'\n\n\nexport interface TileSpec {\n\tfile: string,\n\tconnections: [number, number, number, number]\n}\n\n\nexport const specs = val({\n\tlbA1: {\n\t\tfile: 'tile_lb_A_1',\n\t\tconnections: [0, 0, 1, 1]\n\t},\n\tlbA2: {\n\t\tfile: 'tile_lb_A_2',\n\t\tconnections: [0, 0, 1, 1]\n\t},\n\tlbA3: {\n\t\tfile: 'tile_lb_A_3',\n\t\tconnections: [0, 0, 1, 1]\n\t},\n\tlbB1: {\n\t\tfile: 'tile_lb_B_1',\n\t\tconnections: [0, 0, 1, 1]\n\t},\n\tlbB2: {\n\t\tfile: 'tile_lb_B_2',\n\t\tconnections: [0, 0, 1, 1]\n\t},\n\tlbB3: {\n\t\tfile: 'tile_lb_B_3',\n\t\tconnections: [0, 0, 1, 1]\n\t},\n\tlrA1: {\n\t\tfile: 'tile_lr_A_1',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrB1: {\n\t\tfile: 'tile_lr_B_1',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrC1: {\n\t\tfile: 'tile_lr_C_1',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrD1: {\n\t\tfile: 'tile_lr_D_1',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrD2: {\n\t\tfile: 'tile_lr_D_2',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrD3: {\n\t\tfile: 'tile_lr_D_3',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrE1: {\n\t\tfile: 'tile_lr_E_1',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrE2: {\n\t\tfile: 'tile_lr_E_2',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrE3: {\n\t\tfile: 'tile_lr_E_3',\n\t\tconnections: [0, 1, 0, 1]\n\t},\n\tlrtbA1: {\n\t\tfile: 'tile_lrtb_A_1',\n\t\tconnections: [1, 1, 1, 1]\n\t},\n\tlrtbB1: {\n\t\tfile: 'tile_lrtb_B_1',\n\t\tconnections: [1, 1, 1, 1]\n\t},\n\tlrtbC1: {\n\t\tfile: 'tile_lrtb_C_1',\n\t\tconnections: [1, 1, 1, 1]\n\t},\n\tltbA1: {\n\t\tfile: 'tile_ltb_A_1',\n\t\tconnections: [1, 0, 1, 1]\n\t},\n\tltbB1: {\n\t\tfile: 'tile_ltb_B_1',\n\t\tconnections: [1, 0, 1, 1]\n\t}\n} as { [k: string]: TileSpec })\n\n\nexport const sets = val([{\n\tlbA1: 1,\n\tlbA2: 1,\n\tlbA3: 1,\n\tlbB1: 1,\n\tlbB2: 1,\n\tlbB3: 1,\n\tlrD1: 1,\n\tlrD2: 1,\n\tlrD3: 1,\n\tlrE1: 1,\n\tlrE2: 1,\n\tlrE3: 1,\n\tlrtbA1: 1,\n\tlrtbB1: 1,\n\tlrtbC1: 1,\n\tltbA1: 1,\n\tltbB1: 1\n}])\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/state/constants.ts","import { canvasSize } from './context'\nimport { mat4 } from 'gl-matrix'\nimport { makePerspective } from 'tvs-libs/dist/lib/vr/flow-camera'\nimport { val } from 'tvs-flow/dist/lib/utils/entity-reference'\n\n\nexport const { perspectiveSettings, perspective } = makePerspective(canvasSize)\n\n\nperspectiveSettings.updateVal(s => ({ ...s, fovy: Math.PI * 0.5 }))\n\n\nexport const distance = val(103)\n\n\nexport const view = val(mat4.create())\n  .react(\n    [perspectiveSettings.HOT, distance.HOT],\n    (m, settings, dist) => {\n      mat4.fromTranslation(m, [0, 0, dist / settings.aspect])\n      mat4.invert(m, m)\n      return m\n    }\n  )\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/view/camera.ts","import { makePainterCanvas } from 'tvs-libs/dist/lib/vr/flow-painter-utils'\nimport * as events from '../events'\n\n\nexport const { canvas, canvasSize, painter, gl } = makePainterCanvas(events.windowSize)\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/view/context.ts","import { randInt } from '../math/core';\nexport function pickRandom(arr) {\n    return arr[randInt(arr.length)];\n}\nexport function doTimes(count, fn) {\n    for (var i = 0; i < count; i++) {\n        fn(i);\n    }\n}\nexport function yieldTimes(count, fn) {\n    var arr = [];\n    doTimes(count, function (i) { return arr.push(fn(i)); });\n    return arr;\n}\nexport function zip(as, bs, fn) {\n    var length = Math.min(as.length, bs.length);\n    var result = [];\n    for (var i = 0; i < length; i++) {\n        result.push(fn(as[i], bs[i]));\n    }\n    return result;\n}\n//# sourceMappingURL=sequence.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../libs/tvs-libs/dist/lib/utils/sequence.js\n// module id = 4\n// module chunks = 0 2","export var DEG_TO_RAD_FACTOR = Math.PI / 180;\nexport function sign(num) {\n    if (num > 0) {\n        return 1;\n    }\n    else if (num < 0) {\n        return -1;\n    }\n    else {\n        return 0;\n    }\n}\nexport function lerp(start, end, step) {\n    return start + step * (end - start);\n}\nexport function clamp(value, min, max) {\n    return Math.max(min, Math.min(value, max));\n}\nexport function randInt(int) {\n    return Math.floor(Math.random() * int);\n}\nexport function randIntInRange(from, to) {\n    return randInt(to - from) + from;\n}\nexport function normalRand() {\n    return (Math.random() + Math.random() + Math.random()) / 3;\n}\nexport function degToRad(degrees) {\n    return degrees * DEG_TO_RAD_FACTOR;\n}\n//# sourceMappingURL=core.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../libs/tvs-libs/dist/lib/math/core.js\n// module id = 6\n// module chunks = 0 2","import { val, stream } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport {/*sign,*/ randInt, normalRand } from 'tvs-libs/dist/lib/math/core'\nimport { mat4, quat } from 'gl-matrix'\nimport { getRollQuat, getYawQuat } from 'tvs-libs/dist/lib/math/geometry'\nimport { pickRandom, doTimes, yieldTimes } from 'tvs-libs/dist/lib/utils/sequence'\nimport * as events from '../events'\nimport * as init from './init'\nimport * as camera from '../view/camera'\nimport * as constants from './constants'\nimport { Animation, createAnimation } from 'shared-utils/animation'\n\n\ntype Color = number[]\ntype Position = [number, number]\n\nexport interface TileState {\n\tgridIndex: Position\n\tpos: Position\n\tposOffset: Position\n\ttileSpecId: string\n\ttileSpec: constants.TileSpec\n\tturn: number\n\tflipped: boolean\n\tyawDirection: number\n\tyawDelay: number\n\tyaw: number\n\trollDirection: number\n\troll: number\n\theight: number\n\tcolor: Color\n\trotation: quat\n\ttransform: mat4\n\tupdateTransform: boolean\n\tneighbours: (TileState | undefined)[]\n\tconnections: number[]\n\tconnected: boolean\n\trotateAnimation?: Animation\n\tconnectionAnimations: (Animation | null)[]\n\triseAnimation?: Animation\n\tflipAnimation?: Animation\n}\n\n\nfunction rotateHalf (part) {\n\treturn -Math.cos(part * Math.PI * 2) * 0.5 + 0.5\n}\n\n\nfunction smooth (part) {\n\treturn -Math.cos(part * Math.PI) * 0.5 + 0.5\n}\n\n\nfunction acc (part) {\n\treturn part * part * part * part\n}\n\n\nfunction slow (part) {\n\treturn Math.pow(part, 0.25)\n}\n\n\nconst SIDES_INDEX = {\n\tUP: 0,\n\tRIGHT: 1,\n\tDOWN: 2,\n\tLEFT: 3\n}\n\n\n// const SIDES_KEY = {\n//   0: 'UP',\n//   1: 'RIGHT',\n//   2: 'DOWN',\n//   3: 'LEFT'\n// }\n\n\n// ===== basic properties =====\n\nexport const animationDuration = val(1700)\n\nexport const animationChance = val(0.0001)\n\nexport const liftHeight = val(2)\n\nexport const sinkHeight = val(-50)\n\nexport const flipped = val(false)\n\n\nexport const colCount = stream(\n\t[init.tileDensity.HOT, events.windowSize.HOT],\n\t(dens, size) => Math.floor(Math.pow(size.width / 1000, 0.5) * dens)\n)\n\n\nexport const rowCount = stream(\n\t[colCount.HOT, camera.perspectiveSettings.HOT],\n\t(cols, camera) => Math.ceil(cols / camera.aspect)\n)\n\n\ncamera.distance.react(\n\t[colCount.HOT, init.tileSize.HOT],\n\t(_, cols, size) => cols * size * 0.47\n)\n\n\n// ===== primary state =====\n\nexport const createTileState = function(\n\tset: { [id: string]: number },\n\tbaseColor: Color,\n\tspecs: { [id: string]: constants.TileSpec }\n): TileState {\n\n\tconst [r, g, b] = baseColor\n\tconst color = [\n\t\tr + (normalRand() - 0.6) * 0.25,\n\t\tg + (normalRand() - 0.6) * 0.25,\n\t\tb + (normalRand() - 0.6) * 0.25\n\t]\n\tconst turn = randInt(3)\n\tconst tileSpecId = pickRandom(Object.keys(set))\n\n\treturn {\n\t\tgridIndex: [0, 0],\n\t\tpos: [0, 0],\n\t\tposOffset: [0, 0],\n\t\ttileSpecId,\n\t\ttileSpec: specs[tileSpecId],\n\t\tturn,\n\t\tflipped: false,\n\t\tyawDirection: 0,\n\t\tyawDelay: 0,\n\t\tyaw: 0,\n\t\trollDirection: 0,\n\t\troll: turn * Math.PI / 2,\n\t\theight: 0,\n\t\tcolor,\n\t\ttransform: mat4.create(),\n\t\trotation: quat.create(),\n\t\tupdateTransform: false,\n\t\tneighbours: [],\n\t\tconnected: false,\n\t\tconnections: [0, 0, 0, 0],\n\t\tconnectionAnimations: []\n\t}\n}\n\n\nexport const grid = val<TileState[][]>([[]])\n\t.react([\n\t\tcolCount.HOT,\n\t\trowCount.HOT,\n\t\tinit.color.HOT,\n\t\tinit.set.HOT,\n\t\tconstants.specs.HOT\n\t], function(\n\t\tgrid: TileState[][],\n\t\tnewWidth: number,\n\t\tnewHeight: number,\n\t\tcolor,\n\t\tset,\n\t\tspecs\n\t) {\n\n\t\tconst width = grid.length\n\t\tconst height = grid[0].length\n\n\t\tconst heightDiff = newHeight - height\n\t\tconst widthDiff = newWidth - width\n\n\t\t// create new gid rows at top and bottom\n\t\tif (heightDiff > 0) {\n\n\t\t\tconst up = Math.floor(heightDiff / 2)\n\t\t\tconst down = heightDiff - up\n\n\t\t\tgrid.forEach(row => {\n\t\t\t\trow.unshift(...yieldTimes(up, () => createTileState(set, color, specs)))\n\t\t\t})\n\n\t\t\tgrid.forEach(row => {\n\t\t\t\tdoTimes(down, () => row.push(createTileState(set, color, specs)))\n\t\t\t})\n\t\t}\n\n\t\t// create new grid columns left and right\n\t\tif (widthDiff > 0) {\n\n\t\t\tconst left = Math.floor(widthDiff / 2)\n\t\t\tconst right = widthDiff - left\n\t\t\tconst currentHeight = Math.max(newHeight, height)\n\n\t\t\tgrid.unshift(...yieldTimes(left, () =>\n\t\t\t\tyieldTimes(currentHeight, () => createTileState(set, color, specs)))\n\t\t\t)\n\n\t\t\tdoTimes(right, () =>\n\t\t\t\tgrid.push(yieldTimes(currentHeight, () => createTileState(set, color, specs)))\n\t\t\t)\n\t\t}\n\n\t\tif (widthDiff > 0 || heightDiff > 0) {\n\n\t\t\tfor (let x = 0; x < grid.length; x++) {\n\t\t\t\tfor (let y = 0; y < grid[x].length; y++) {\n\t\t\t\t\tconst tile = grid[x][y]\n\t\t\t\t\ttile.gridIndex = [x, y]\n\t\t\t\t\ttile.neighbours[SIDES_INDEX.LEFT] = grid[x - 1] && grid[x - 1][y]\n\t\t\t\t\ttile.neighbours[SIDES_INDEX.RIGHT] = grid[x + 1] && grid[x + 1][y]\n\t\t\t\t\ttile.neighbours[SIDES_INDEX.UP] = grid[x][y - 1]\n\t\t\t\t\ttile.neighbours[SIDES_INDEX.DOWN] = grid[x][y + 1]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn grid\n\t})\n\n\nexport const activeTiles = stream([\n\tgrid.HOT,\n\tcolCount.HOT,\n\trowCount.HOT\n], (grid, cols, rows) => {\n\n\tconst tiles: TileState[] = []\n\tconst width = grid.length\n\tconst height = grid[0].length\n\tconst firstLeftIndex = -Math.floor(width / 2)\n\tconst firstUpIndex = -Math.floor(height / 2)\n\tconst widthDelta = width - cols\n\tlet activeCols = Math.floor(widthDelta / 2)\n\tif ((width + 1) % 2 && widthDelta % 2) activeCols++\n\tconst activeRows = Math.floor((height - rows) / 2)\n\tconst offX = ((cols + 1) % 2) * 0.5\n\tconst offY = (rows % 2) * 0.5 + 0.5\n\n\tdoTimes(cols, x => {\n\t\tdoTimes(rows, y => {\n\t\t\tconst tile: TileState = grid[x + activeCols][y + activeRows]\n\t\t\tconst [iX, iY] = tile.gridIndex\n\t\t\ttile.posOffset = [offX, offY]\n\t\t\ttile.updateTransform = true\n\t\t\ttile.yawDelay = (x + (rows - y + 1)) * 100\n\t\t\ttile.pos = [firstLeftIndex + iX, firstUpIndex + iY]\n\t\t\ttile.connected = !!(tile.height < 0.1 && tile.height > -0.1)\n\t\t\ttiles.push(tile)\n\t\t})\n\t})\n\n\treturn tiles\n})\n\n\nexport const updateActiveTiles = stream([\n\tactiveTiles.COLD,\n\tevents.tick.HOT,\n\tanimationDuration.COLD,\n\tanimationChance.COLD,\n\tliftHeight.COLD,\n\tsinkHeight.COLD,\n\tinit.tileSize.COLD,\n\tflipped.COLD\n], (tiles, tick, duration, chance, liftHeight, sinkHeight, size, flipped) => {\n\n\tconst offset = size * 0.95\n\n\tfor (const i in tiles) {\n\t\tconst tile: TileState = tiles[i]\n\n\t\tif (!tile.rotateAnimation && Math.random() < chance) {\n\t\t\t//tile.rollDirection = sign(Math.random() - 0.5)\n\t\t\ttile.rollDirection = 1\n\t\t\ttile.connected = false\n\n\t\t\ttile.rotateAnimation = createAnimation({\n\t\t\t\tduration,\n\t\t\t\teaseFn: smooth,\n\t\t\t\tonUpdate: rot => {\n\t\t\t\t\ttile.roll += rot * Math.PI / 2 * tile.rollDirection\n\t\t\t\t\ttile.updateTransform = true\n\t\t\t\t},\n\t\t\t\tonComplete: () => {\n\t\t\t\t\ttile.rotateAnimation = undefined\n\t\t\t\t}\n\t\t\t})\n\n\t\t\ttile.riseAnimation = createAnimation({\n\t\t\t\tduration,\n\t\t\t\teaseFn: rotateHalf,\n\t\t\t\tonUpdate: rise => {\n\t\t\t\t\ttile.height += rise * liftHeight\n\t\t\t\t\ttile.updateTransform = true\n\t\t\t\t},\n\t\t\t\tonComplete: () => {\n\t\t\t\t\ttile.riseAnimation = undefined\n\t\t\t\t\ttile.connected = true\n\t\t\t\t\ttile.turn = tile.rollDirection > 0 ?\n\t\t\t\t\t\t(tile.turn + 1) % 4 :\n\t\t\t\t\t\ttile.rollDirection < 0 ?\n\t\t\t\t\t\t\t(tile.turn + 3) % 4 :\n\t\t\t\t\t\t\ttile.turn\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (flipped !== tile.flipped && !tile.flipAnimation) {\n\t\t\ttile.connected = false\n\t\t\ttile.flipAnimation = createAnimation({\n\t\t\t\tduration,\n\t\t\t\teaseFn: flipped ? acc : slow,\n\t\t\t\tdelay: tile.yawDelay,\n\t\t\t\tonUpdate: rot => {\n\t\t\t\t\ttile.yaw += rot * Math.PI\n\t\t\t\t\ttile.height += rot * sinkHeight * (tile.flipped ? -1 : 1)\n\t\t\t\t\ttile.updateTransform = true\n\t\t\t\t},\n\t\t\t\tonComplete: () => {\n\t\t\t\t\ttile.flipAnimation = undefined\n\t\t\t\t\ttile.flipped = !tile.flipped\n\t\t\t\t\ttile.connected = !tile.rotateAnimation\n\t\t\t\t\ttile.connected = true\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\ttile.rotateAnimation && tile.rotateAnimation(tick)\n\t\ttile.riseAnimation && tile.riseAnimation(tick)\n\t\ttile.flipAnimation && tile.flipAnimation(tick)\n\n\t\tif (tile.connected) {\n\t\t\t//console.log('tile position, turn: ', tile.pos, tile.turn, tile)\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\tconst index = (i + 4 - tile.turn) % 4\n\t\t\t\tconst side = tile.tileSpec.connections[index]\n\t\t\t\tconst neighbour = tile.neighbours[i]\n\t\t\t\tif (neighbour && neighbour.connected) {\n\t\t\t\t\tconst neighbourSide = neighbour.tileSpec.connections[(i + 6 - neighbour.turn) % 4]\n\t\t\t\t\ttile.connections[index] = side && neighbourSide\n\t\t\t\t} else {\n\t\t\t\t\ttile.connections[index] = 0\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\ttile.connections[i] = 0\n\t\t\t}\n\t\t}\n\n\t\tif (tile.updateTransform) {\n\t\t\ttile.updateTransform = false\n\t\t\tquat.multiply(tile.rotation, getYawQuat(quat.create(), tile.yaw), getRollQuat(quat.create(), tile.roll))\n\t\t\tconst [x, y] = tile.pos\n\t\t\tconst [offX, offY] = tile.posOffset\n\t\t\tmat4.fromRotationTranslation(\n\t\t\t\ttile.transform,\n\t\t\t\ttile.rotation,\n\t\t\t\t[(x + offX) * offset, (y + offY) * offset, tile.height]\n\t\t\t)\n\t\t}\n\t}\n\treturn tiles\n})\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/state/tiles.ts","import { plane } from 'tvs-renderer/dist/lib/utils/geometry/plane'\nimport * as init from '../../state/init'\nimport { val, stream } from 'tvs-flow/dist/lib/utils/entity-reference'\n\n\nexport const segments = val(3)\n\n\nexport const geometry = stream(\n  [init.tileSize.HOT, segments.HOT],\n  (size, seg) => plane(size, size, seg, seg)\n)\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/view/geometries/plane.ts","import vert from './base-vert.glsl'\nimport frag from './base-frag.glsl'\nimport { val } from 'tvs-flow/dist/lib/utils/entity-reference'\n\n\nexport const spec = val({\n  vert, frag\n}).reset()\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/view/shaders/base.ts","import { val, stream, asyncStream, EntityRef } from 'tvs-flow/dist/lib/utils/entity-reference'\nimport { normalRand } from 'tvs-libs/dist/lib/math/core'\nimport { pickRandom } from 'tvs-libs/dist/lib/utils/sequence'\nimport * as constants from './constants'\n\n\nexport const tileSize = val(10)\n\nexport const tileDensity = val(11)\n\n\nexport const color = val([normalRand(), normalRand(), normalRand()])\n\n\nexport const set = stream([constants.sets.HOT], pickRandom)\n\n\nexport const images: EntityRef<[string, HTMLImageElement][]> = asyncStream(\n\t[constants.specs.HOT, set.HOT],\n\t(send, specs, set) => {\n\n\t\tPromise.all(Object.keys(set).map(key => new Promise<[string, HTMLImageElement]>(res => {\n\t\t\tconst img = new Image()\n\t\t\timg.onload = () => { res([key, img]) }\n\t\t\timg.src = 'img/' + specs[key].file + '.jpg'\n\t\t})))\n\t\t.then(send)\n\n\t}\n)\n\n\n\n// WEBPACK FOOTER //\n// ./tiles/graph/state/init.ts"],"sourceRoot":""}