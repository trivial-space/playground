webpackJsonp([2],{110:function(n,t,e){n.exports=e(111)},111:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e(112),i=e(18),o=e(113);r.a.setDebug(!0),Object(i.a)(r.a,o),setTimeout(function(){r.a.setDebug(!1)},1e3)},112:function(n,t,e){"use strict";e.d(t,"a",function(){return o});var r=e(16),i=e(17),o=(e.n(i),r.a()),c=i.ui.start("tiles");window.flow=o,window.tools=c},113:function(n,t,e){function r(n){return e(i(n))}function i(n){var t=o[n];if(!(t+1))throw new Error("Cannot find module '"+n+"'.");return t}var o={"./events.ts":14,"./state/constants.ts":36,"./state/init.ts":7,"./state/tiles.ts":62,"./view/camera.ts":37,"./view/context.ts":38,"./view/geometries/plane.ts":63,"./view/renderer.ts":115,"./view/shaders/base.ts":64};r.keys=function(){return Object.keys(o)},r.resolve=i,n.exports=r,r.id=113},114:function(n,t,e){"use strict";function r(n){var t=n.duration,e=void 0===t?1e3:t,r=n.easeFn,o=void 0===r?i:r,c=n.delay,a=void 0===c?0:c,u=n.onComplete,f=n.onUpdate,l=-a,s=0;return function(n){if(l>=e)return 0;if(l<0)return l+=Math.min(n,-l),0;var t=o(l<e-n?(l+n)/e:1),r=t-s;return l+=n,s=t,f&&f(r),l>=e&&u&&u(),r}}t.a=r;var i=function(n){return n}},115:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"settings",function(){return d}),e.d(t,"shade",function(){return b}),e.d(t,"form",function(){return v}),e.d(t,"textures",function(){return p}),e.d(t,"tilesData",function(){return O}),e.d(t,"tilesSketch",function(){return m}),e.d(t,"sceneData",function(){return h}),e.d(t,"scene",function(){return _}),e.d(t,"render",function(){return j});var r=e(0),i=e(38),o=e(63),c=e(62),a=e(7),u=e(64),f=e(14),l=e(37),s=e(11),d=Object(r.d)([i.gl.HOT],function(n){return{clearColor:[1,1,1,1],enable:[n.DEPTH_TEST,n.CULL_FACE]}});i.painter.react([d.HOT],function(n,t){return n.updateDrawSettings(t)});var b=Object(s.d)(i.painter,u.spec),v=Object(s.b)(i.painter,o.geometry),p=Object(r.d)([i.painter.HOT,a.images.HOT],function(n,t){return t.reduce(function(t,e){var r=e[0],i=e[1];return t[r]=n.createStaticLayer().update({minFilter:"LINEAR",magFilter:"LINEAR",asset:i}),t},{})}),O=Object(r.d)([v.HOT,b.HOT,p.HOT,c.activeTiles.HOT],function(n,t,e,r){return{form:n,shade:t,uniforms:r.map(function(n){return{transform:n.transform,image:e[n.tileSpecId].texture(),color:n.color,connections:n.connections}})}}),m=Object(s.e)(i.painter,O),h=Object(r.d)([m.HOT,l.view.HOT,l.perspective.HOT],function(n,t,e){return{sketches:[n],uniforms:{view:t,projection:e}}}),_=Object(s.a)(i.painter,h),j=Object(r.d)([i.painter.COLD,_.COLD,f.tick.HOT],function(n,t,e){return n.compose(t)})},116:function(n,t){n.exports="#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 transform;\nuniform mat4 projection;\nuniform mat4 view;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projection * view * transform * vec4(position, 1.0);\n}\n"},117:function(n,t){n.exports="precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D image;\nuniform vec3 color;\nuniform vec4 connections;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 tex = texture2D(image, vUv);\n  if (tex.r > 0.9) {\n    discard;\n  }\n\n  float up = 0.0;\n  float right = 0.0;\n  float down = 0.0;\n  float left = 0.0;\n  float x = vUv.x - 0.5;\n  float y = vUv.y;\n\n  if (connections[0] > 0.0) {\n    up = x * x * 2.0 + y * y * 2.0;\n    up = 1.0 - up;\n    up = max(0.0, up);\n    up *= up;\n  }\n\n  if (connections[1] > 0.0) {\n    x = vUv.x - 1.0;\n    y = vUv.y - 0.5;\n    right = x * x * 2.0 + y * y * 2.0;\n    right = 1.0 - right;\n    right = max(0.0, right);\n    right *= right;\n  }\n\n  if (connections[2] > 0.0) {\n    x = vUv.x - 0.5;\n    y = vUv.y - 1.0;\n    down = x * x * 2.0 + y * y * 2.0;\n    down = 1.0 - down;\n    down = max(0.0, down);\n    down *= down;\n  }\n\n  if (connections[3] > 0.0) {\n    x = vUv.x;\n    y = vUv.y - 0.5;\n    left = x * x * 2.0 + y * y * 2.0;\n    left = 1.0 - left;\n    left = max(0.0, left);\n    left *= left;\n  }\n\n  // smooth out border\n  /* col /= resolution.x * resolution.y * 0.5; */\n  /* col = sqrt(col); */\n\n\tfloat glow = up + right + left + down;\n\n\tvec3 result = 0.8 - color.rgb * (1.0 - tex.r);\n\tfloat red = result.r;\n\n\tif (abs(tex.g - tex.r) > 0.1 && tex.g > 0.9) {\n\t\tred = mix(red, 1.0, glow);\n\t}\n\n  gl_FragColor = vec4(red, result.gb, 1.0);\n  // gl_FragColor = vec4(color, 1.0);\n  // gl_FragColor = connections;\n}\n"},14:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"tick",function(){return f}),e.d(t,"windowSize",function(){return l}),e.d(t,"mouse",function(){return s}),e.d(t,"keys",function(){return d});var r=e(0),i=e(5),o=e(19),c=e(20),a=e(21),u=e(7),f=Object(r.a)([u.images.HOT],a.a),l=Object(r.b)(null,c.a),s=Object(r.b)(null,o.a),d=Object(r.b)(null,i.b)},23:function(n,t,e){"use strict";function r(n,t){var e=-a.vec3.dot(n,t);return a.vec4.fromValues(n[0],n[1],n[2],e)}function i(n){var t=n,e=t[0],r=t[1],i=t[2],o=t[3];return a.mat4.fromValues(1-2*e*e,-2*e*r,-2*e*i,0,-2*e*r,1-2*r*r,-2*r*i,0,-2*e*i,-2*r*i,1-2*i*i,0,-2*e*o,-2*r*o,-2*i*o,1)}function o(n,t){return t*=.5,n[0]=0,n[1]=Math.sin(t),n[2]=0,n[3]=Math.cos(t),n}function c(n,t){return t*=.5,n[0]=0,n[1]=0,n[2]=Math.sin(t),n[3]=Math.cos(t),n}t.d=r,t.c=i,t.b=o,t.a=c;var a=e(24);e.n(a)},36:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"specs",function(){return i}),e.d(t,"sets",function(){return o});var r=e(0),i=Object(r.f)({lbA1:{file:"tile_lb_A_1",connections:[0,0,1,1]},lbA2:{file:"tile_lb_A_2",connections:[0,0,1,1]},lbA3:{file:"tile_lb_A_3",connections:[0,0,1,1]},lbB1:{file:"tile_lb_B_1",connections:[0,0,1,1]},lbB2:{file:"tile_lb_B_2",connections:[0,0,1,1]},lbB3:{file:"tile_lb_B_3",connections:[0,0,1,1]},lrA1:{file:"tile_lr_A_1",connections:[0,1,0,1]},lrB1:{file:"tile_lr_B_1",connections:[0,1,0,1]},lrC1:{file:"tile_lr_C_1",connections:[0,1,0,1]},lrD1:{file:"tile_lr_D_1",connections:[0,1,0,1]},lrD2:{file:"tile_lr_D_2",connections:[0,1,0,1]},lrD3:{file:"tile_lr_D_3",connections:[0,1,0,1]},lrE1:{file:"tile_lr_E_1",connections:[0,1,0,1]},lrE2:{file:"tile_lr_E_2",connections:[0,1,0,1]},lrE3:{file:"tile_lr_E_3",connections:[0,1,0,1]},lrtbA1:{file:"tile_lrtb_A_1",connections:[1,1,1,1]},lrtbB1:{file:"tile_lrtb_B_1",connections:[1,1,1,1]},lrtbC1:{file:"tile_lrtb_C_1",connections:[1,1,1,1]},ltbA1:{file:"tile_ltb_A_1",connections:[1,0,1,1]},ltbB1:{file:"tile_ltb_B_1",connections:[1,0,1,1]}}),o=Object(r.f)([{lbA1:1,lbA2:1,lbA3:1,lbB1:1,lbB2:1,lbB3:1,lrD1:1,lrD2:1,lrD3:1,lrE1:1,lrE2:1,lrE3:1,lrtbA1:1,lrtbB1:1,lrtbC1:1,ltbA1:1,ltbB1:1}])},37:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"perspectiveSettings",function(){return u}),e.d(t,"perspective",function(){return f}),e.d(t,"distance",function(){return s}),e.d(t,"view",function(){return d});var r=e(38),i=e(3),o=(e.n(i),e(26)),c=e(0),a=this&&this.__assign||Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},u=(l=Object(o.b)(r.canvasSize),l.perspectiveSettings),f=l.perspective;u.updateVal(function(n){return a({},n,{fovy:.5*Math.PI})});var l,s=Object(c.f)(103),d=Object(c.f)(i.mat4.create()).react([u.HOT,s.HOT],function(n,t,e){return i.mat4.fromTranslation(n,[0,0,e/t.aspect]),i.mat4.invert(n,n),n})},38:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"canvas",function(){return c}),e.d(t,"canvasSize",function(){return a}),e.d(t,"painter",function(){return u}),e.d(t,"gl",function(){return f});var r,i=e(11),o=e(14),c=(r=Object(i.c)(o.windowSize),r.canvas),a=r.canvasSize,u=r.painter,f=r.gl},4:function(n,t,e){"use strict";function r(n){return n[Object(a.b)(n.length)]}function i(n,t){for(var e=0;e<n;e++)t(e)}function o(n,t){var e=[];return i(n,function(n){return e.push(t(n))}),e}function c(n,t,e){for(var r=Math.min(n.length,t.length),i=[],o=0;o<r;o++)i.push(e(n[o],t[o]));return i}t.b=r,t.a=i,t.c=o,t.d=c;var a=e(6)},6:function(n,t,e){"use strict";function r(n){return Math.floor(Math.random()*n)}function i(){return(Math.random()+Math.random()+Math.random())/3}t.b=r,t.a=i;Math.PI},62:function(n,t,e){"use strict";function r(n){return.5*-Math.cos(n*Math.PI*2)+.5}function i(n){return.5*-Math.cos(n*Math.PI)+.5}function o(n){return n*n*n*n}function c(n){return Math.pow(n,.25)}Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"animationDuration",function(){return h}),e.d(t,"animationChance",function(){return _}),e.d(t,"liftHeight",function(){return j}),e.d(t,"sinkHeight",function(){return g}),e.d(t,"flipped",function(){return y}),e.d(t,"colCount",function(){return T}),e.d(t,"rowCount",function(){return w}),e.d(t,"createTileState",function(){return M}),e.d(t,"grid",function(){return x}),e.d(t,"activeTiles",function(){return D}),e.d(t,"updateActiveTiles",function(){return H});var a=e(0),u=e(6),f=e(3),l=(e.n(f),e(23)),s=e(4),d=e(14),b=e(7),v=e(37),p=e(36),O=e(114),m={UP:0,RIGHT:1,DOWN:2,LEFT:3},h=Object(a.f)(1700),_=Object(a.f)(1e-4),j=Object(a.f)(2),g=Object(a.f)(-50),y=Object(a.f)(!1),T=Object(a.d)([b.tileDensity.HOT,d.windowSize.HOT],function(n,t){return Math.floor(Math.pow(t.width/1e3,.5)*n)}),w=Object(a.d)([T.HOT,v.perspectiveSettings.HOT],function(n,t){return Math.ceil(n/t.aspect)});v.distance.react([T.HOT,b.tileSize.HOT],function(n,t,e){return t*e*.47});var M=function(n,t,e){var r=t[0],i=t[1],o=t[2],c=[r+.25*(Object(u.a)()-.6),i+.25*(Object(u.a)()-.6),o+.25*(Object(u.a)()-.6)],a=Object(u.b)(3),l=Object(s.b)(Object.keys(n));return{gridIndex:[0,0],pos:[0,0],posOffset:[0,0],tileSpecId:l,tileSpec:e[l],turn:a,flipped:!1,yawDirection:0,yawDelay:0,yaw:0,rollDirection:0,roll:a*Math.PI/2,height:0,color:c,transform:f.mat4.create(),rotation:f.quat.create(),updateTransform:!1,neighbours:[],connected:!1,connections:[0,0,0,0],connectionAnimations:[]}},x=Object(a.f)([[]]).react([T.HOT,w.HOT,b.color.HOT,b.set.HOT,p.specs.HOT],function(n,t,e,r,i,o){var c=n.length,a=n[0].length,u=e-a,f=t-c;if(u>0){var l=Math.floor(u/2),d=u-l;n.forEach(function(n){n.unshift.apply(n,Object(s.c)(l,function(){return M(i,r,o)}))}),n.forEach(function(n){Object(s.a)(d,function(){return n.push(M(i,r,o))})})}if(f>0){var b=Math.floor(f/2),v=f-b,p=Math.max(e,a);n.unshift.apply(n,Object(s.c)(b,function(){return Object(s.c)(p,function(){return M(i,r,o)})})),Object(s.a)(v,function(){return n.push(Object(s.c)(p,function(){return M(i,r,o)}))})}if(f>0||u>0)for(var O=0;O<n.length;O++)for(var h=0;h<n[O].length;h++){var _=n[O][h];_.gridIndex=[O,h],_.neighbours[m.LEFT]=n[O-1]&&n[O-1][h],_.neighbours[m.RIGHT]=n[O+1]&&n[O+1][h],_.neighbours[m.UP]=n[O][h-1],_.neighbours[m.DOWN]=n[O][h+1]}return n}),D=Object(a.d)([x.HOT,T.HOT,w.HOT],function(n,t,e){var r=[],i=n.length,o=n[0].length,c=-Math.floor(i/2),a=-Math.floor(o/2),u=i-t,f=Math.floor(u/2);(i+1)%2&&u%2&&f++;var l=Math.floor((o-e)/2),d=(t+1)%2*.5,b=e%2*.5+.5;return Object(s.a)(t,function(t){Object(s.a)(e,function(i){var o=n[t+f][i+l],u=o.gridIndex,s=u[0],v=u[1];o.posOffset=[d,b],o.updateTransform=!0,o.yawDelay=100*(t+(e-i+1)),o.pos=[c+s,a+v],o.connected=!!(o.height<.1&&o.height>-.1),r.push(o)})}),r}),H=Object(a.d)([D.COLD,d.tick.HOT,h.COLD,_.COLD,j.COLD,g.COLD,b.tileSize.COLD,y.COLD],function(n,t,e,a,u,s,d,b){var v=.95*d;for(var p in n)!function(d){var p=n[d];if(!p.rotateAnimation&&Math.random()<a&&(p.rollDirection=1,p.connected=!1,p.rotateAnimation=Object(O.a)({duration:e,easeFn:i,onUpdate:function(n){p.roll+=n*Math.PI/2*p.rollDirection,p.updateTransform=!0},onComplete:function(){p.rotateAnimation=void 0}}),p.riseAnimation=Object(O.a)({duration:e,easeFn:r,onUpdate:function(n){p.height+=n*u,p.updateTransform=!0},onComplete:function(){p.riseAnimation=void 0,p.connected=!0,p.turn=p.rollDirection>0?(p.turn+1)%4:p.rollDirection<0?(p.turn+3)%4:p.turn}})),b===p.flipped||p.flipAnimation||(p.connected=!1,p.flipAnimation=Object(O.a)({duration:e,easeFn:b?o:c,delay:p.yawDelay,onUpdate:function(n){p.yaw+=n*Math.PI,p.height+=n*s*(p.flipped?-1:1),p.updateTransform=!0},onComplete:function(){p.flipAnimation=void 0,p.flipped=!p.flipped,p.connected=!p.rotateAnimation,p.connected=!0}})),p.rotateAnimation&&p.rotateAnimation(t),p.riseAnimation&&p.riseAnimation(t),p.flipAnimation&&p.flipAnimation(t),p.connected)for(var m=0;m<4;m++){var h=(m+4-p.turn)%4,_=p.tileSpec.connections[h],j=p.neighbours[m];if(j&&j.connected){var g=j.tileSpec.connections[(m+6-j.turn)%4];p.connections[h]=_&&g}else p.connections[h]=0}else for(var y=0;y<4;y++)p.connections[y]=0;if(p.updateTransform){p.updateTransform=!1,f.quat.multiply(p.rotation,Object(l.b)(f.quat.create(),p.yaw),Object(l.a)(f.quat.create(),p.roll));var T=p.pos,w=T[0],M=T[1],x=p.posOffset,D=x[0],H=x[1];f.mat4.fromRotationTranslation(p.transform,p.rotation,[(w+D)*v,(M+H)*v,p.height])}}(p);return n})},63:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"segments",function(){return c}),e.d(t,"geometry",function(){return a});var r=e(32),i=e(7),o=e(0),c=Object(o.f)(3),a=Object(o.d)([i.tileSize.HOT,c.HOT],function(n,t){return Object(r.a)(n,n,t,t)})},64:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"spec",function(){return u});var r=e(116),i=e.n(r),o=e(117),c=e.n(o),a=e(0),u=Object(a.f)({vert:i.a,frag:c.a}).reset()},7:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e.d(t,"tileSize",function(){return a}),e.d(t,"tileDensity",function(){return u}),e.d(t,"color",function(){return f}),e.d(t,"set",function(){return l}),e.d(t,"images",function(){return s});var r=e(0),i=e(6),o=e(4),c=e(36),a=Object(r.f)(10),u=Object(r.f)(11),f=Object(r.f)([Object(i.a)(),Object(i.a)(),Object(i.a)()]),l=Object(r.d)([c.sets.HOT],o.b),s=Object(r.a)([c.specs.HOT,l.HOT],function(n,t,e){Promise.all(Object.keys(e).map(function(n){return new Promise(function(e){var r=new Image;r.onload=function(){e([n,r])},r.src="img/"+t[n].file+".jpg"})})).then(n)})}},[110]);
//# sourceMappingURL=main.js.map